module.exports=function(t){function e(n){if(i[n])return i[n].exports;var r=i[n]={i:n,l:!1,exports:{}};return t[n].call(r.exports,r,r.exports,e),r.l=!0,r.exports}var i={};return e.m=t,e.c=i,e.d=function(t,i,n){e.o(t,i)||Object.defineProperty(t,i,{configurable:!1,enumerable:!0,get:n})},e.n=function(t){var i=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(i,"a",i),i},e.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},e.p="",e(e.s=251)}([function(t,e){t.exports=require("assert")},function(t,e,i){"use strict";function n(t){switch(t){case 0:return 1;case 1:return 10;case 2:return 100;case 3:return 1e3;case 4:return 1e4;case 5:return 1e5;case 6:return 1e6;case 7:return 1e7;case 8:return 1e8}throw new Error("Exponent is too large.")}const r=i(0),s=i(54),o=e,a={showHidden:!1,depth:20,colors:!1,customInspect:!0,showProxy:!1,maxArrayLength:1/0,breakLength:60};o.isNumber=function(t){return"number"==typeof t&&isFinite(t)&&t>=-Number.MAX_SAFE_INTEGER&&t<=Number.MAX_SAFE_INTEGER},o.isInt=function(t){return Number.isSafeInteger(t)},o.isUint=function(t){return o.isInt(t)&&t>=0},o.isFloat=function(t){return"number"==typeof t&&isFinite(t)},o.isUfloat=function(t){return o.isFloat(t)&&t>=0},o.isI8=function(t){return(0|t)===t&&t>=-128&&t<=127},o.isI16=function(t){return(0|t)===t&&t>=-32768&&t<=32767},o.isI32=function(t){return(0|t)===t},o.isI64=function(t){return o.isInt(t)},o.isU8=function(t){return(255&t)===t},o.isU16=function(t){return(65535&t)===t},o.isU32=function(t){return t>>>0===t},o.isU64=function(t){return o.isUint(t)},o.isAscii=function(t){return"string"==typeof t&&/^[\t\n\r -~]*$/.test(t)},o.isBase58=function(t){return"string"==typeof t&&/^[1-9A-Za-z]+$/.test(t)},o.isHex=function(t){return"string"==typeof t&&(t.length%2==0&&/^[0-9A-Fa-f]+$/.test(t))},o.isHex160=function(t){return"string"==typeof t&&(40===t.length&&o.isHex(t))},o.isHex256=function(t){return"string"==typeof t&&(64===t.length&&o.isHex(t))},o.isSafeAddition=function(t,e){if(r(t>=0),r(e>=0),t<=0xfffffffffffff&&e<=0xfffffffffffff)return!0;let i=t*(1/4294967296)|0;const n=0|t;let s=e*(1/4294967296)|0;const o=0|e,a=n>>31,h=o>>31;let c=(i+s|0)+(1&(a&h|~((n+o|0)>>31)&(a^h)))|0;return c>>>=0,i>>>=0,s>>>=0,!(c<i||c<s)&&0==(4292870144&c)},o.inspectify=function(t,e){return"string"==typeof t?t:(a.colors=!1!==e,s.inspect(t,a))},o.fmt=s.format,o.format=function(t,e){return t.length>0&&t[0]&&"object"==typeof t[0]?(null==e&&(e=Boolean(process.stdout&&process.stdout.isTTY)),o.inspectify(t[0],e)):o.fmt(...t)},o.log=function(...t){if(!process.stdout){let e;return t.length>0&&(e="object"!=typeof t[0]?o.fmt(...t):t[0]),void console.log(e)}const e=o.format(t);process.stdout.write(e+"\n")},o.error=function(...t){if(!process.stderr){let e;return t.length>0&&(e="object"!=typeof t[0]?o.fmt(...t):t[0]),void console.error(e)}const e=o.format(t);process.stderr.write(e+"\n")},o.hrtime=function(t){if(!process.hrtime){const e=o.ms();if(t){const[i,n]=t;return e-(1e3*i+n/1e6)}const i=e%1e3;return[(e-i)/1e3,1e6*i]}if(t){const[e,i]=process.hrtime(t);return 1e3*e+i/1e6}return process.hrtime()},o.now=function(){return Math.floor(o.ms()/1e3)},o.ms=function(){return Date.now()},o.date=function(t){return null==t&&(t=o.now()),new Date(1e3*t).toISOString().slice(0,-5)+"Z"},o.time=function(t){return null==t?o.now():new Date(t)/1e3|0},o.random=function(t,e){return Math.floor(Math.random()*(e-t))+t},o.nonce=function(t){let e,i;switch(t||(t=8),t){case 8:i=Buffer.allocUnsafe(8),e=o.random(0,4294967296),i.writeUInt32LE(e,0,!0),e=o.random(0,4294967296),i.writeUInt32LE(e,4,!0);break;case 4:i=Buffer.allocUnsafe(4),e=o.random(0,4294967296),i.writeUInt32LE(e,0,!0);break;default:r(!1,"Bad nonce size.")}return i},o.strcmp=function(t,e){const i=Math.min(t.length,e.length);for(let n=0;n<i;n++){if(t[n]<e[n])return-1;if(t[n]>e[n])return 1}return t.length<e.length?-1:t.length>e.length?1:0},o.mb=function(t){return Math.floor(t/1024/1024)},o.indexOf=function(t,e){r(Array.isArray(t)),r(Buffer.isBuffer(e));for(let i=0;i<t.length;i++){const n=t[i];if(r(Buffer.isBuffer(n)),n.equals(e))return i}return-1},o.pad8=function(t){switch(r("number"==typeof t),r(t>=0),(t=t.toString(10)).length){case 1:return"00"+t;case 2:return"0"+t;case 3:return t}throw new Error("Number too big.")},o.pad32=function(t){switch(r("number"==typeof t),r(t>=0),(t=t.toString(10)).length){case 1:return"000000000"+t;case 2:return"00000000"+t;case 3:return"0000000"+t;case 4:return"000000"+t;case 5:return"00000"+t;case 6:return"0000"+t;case 7:return"000"+t;case 8:return"00"+t;case 9:return"0"+t;case 10:return t}throw new Error("Number too big.")},o.hex8=function(t){switch(r("number"==typeof t),r(t>=0),(t=t.toString(16)).length){case 1:return"0"+t;case 2:return t}throw new Error("Number too big.")},o.hex32=function(t){switch(r("number"==typeof t),r(t>=0),(t=t.toString(16)).length){case 1:return"0000000"+t;case 2:return"000000"+t;case 3:return"00000"+t;case 4:return"0000"+t;case 5:return"000"+t;case 6:return"00"+t;case 7:return"0"+t;case 8:return t}throw new Error("Number too big.")},o.revHex=function(t){r("string"==typeof t),r(t.length>0),r(t.length%2==0);let e="";for(let i=0;i<t.length;i+=2)e=t.slice(i,i+2)+e;return e},o.reverse=function(t){const e={};for(const i of Object.keys(t))e[t[i]]=i;return e},o.binarySearch=function(t,e,i,n){let r=0,s=t.length-1;for(;r<=s;){const n=r+s>>>1,o=i(t[n],e);if(0===o)return n;o<0?r=n+1:s=n-1}return n?r:-1},o.binaryInsert=function(t,e,i,n){const r=o.binarySearch(t,e,i,!0);return n&&r<t.length&&0===i(t[r],e)?-1:(0===r?t.unshift(e):r===t.length?t.push(e):t.splice(r,0,e),r)},o.binaryRemove=function(t,e,i){const n=o.binarySearch(t,e,i,!1);return-1!==n&&(t.splice(n,1),!0)},o.isUpperCase=function(t){return r("string"==typeof t),0!==t.length&&0==(32&t.charCodeAt(0))},o.startsWith=function(t,e){return r("string"==typeof t),t.startsWith?t.startsWith(e):0===t.indexOf(e)},o.memoryUsage=function(){if(!process.memoryUsage)return{total:0,jsHeap:0,jsHeapTotal:0,nativeHeap:0,external:0};const t=process.memoryUsage();return{total:o.mb(t.rss),jsHeap:o.mb(t.heapUsed),jsHeapTotal:o.mb(t.heapTotal),nativeHeap:o.mb(t.rss-t.heapTotal),external:o.mb(t.external)}},o.toFixed=function(t,e){r("number"==typeof t),r(Number.isSafeInteger(t),"Invalid integer value.");let i="";t<0&&(t=-t,i="-");const s=n(e);let o=t%s,a=(t-o)/s;for(o=o.toString(10),a=a.toString(10);o.length<e;)o="0"+o;return o=o.replace(/0+$/,""),r(o.length<=e,"Invalid integer value."),0===o.length&&(o="0"),0===e?`${i}${a}`:`${i}${a}.${o}`},o.fromFixed=function(t,e){r("string"==typeof t),r(t.length<=32,"Fixed number string too large.");let i=1;t.length>0&&"-"===t[0]&&(t=t.substring(1),i=-1);let s=t,o="0";const a=t.indexOf(".");for(-1!==a&&(s=t.substring(0,a),o=t.substring(a+1)),s=s.replace(/^0+/,""),o=o.replace(/0+$/,""),r(s.length<=16-e,"Fixed number string exceeds 2^53-1."),r(o.length<=e,"Too many decimal places in fixed number string."),0===s.length&&(s="0");o.length<e;)o+="0";0===o.length&&(o="0"),r(/^\d+$/.test(s)&&/^\d+$/.test(o),"Non-numeric characters in fixed number string."),s=parseInt(s,10),o=parseInt(o,10);const h=n(e),c=function(t){switch(t){case 1:return 0;case 10:return 1;case 100:return 91;case 1e3:case 1e4:return 991;case 1e5:return 40991;case 1e6:return 740991;case 1e7:return 4740991;case 1e8:return 54740991}throw new Error("Exponent is too large.")}(h),u=function(t){switch(t){case 1:return 9007199254740991;case 10:return 900719925474099;case 100:return 90071992547409;case 1e3:return 9007199254740;case 1e4:return 900719925474;case 1e5:return 90071992547;case 1e6:return 9007199254;case 1e7:return 900719925;case 1e8:return 90071992}throw new Error("Exponent is too large.")}(h);return r(s<u||s===u&&o<=c,"Fixed number string exceeds 2^53-1."),i*(s*h+o)},o.toFloat=function(t,e){return Number(o.toFixed(t,e))},o.fromFloat=function(t,e){return r("number"==typeof t&&isFinite(t)),r(Number.isSafeInteger(e)),o.fromFixed(t.toFixed(e),e)},o.concatArrBuf=function(t){r(Array.isArray(t));let e=Buffer.alloc(0);for(let i=0;i<t.length;i++)r(Buffer.isBuffer(t[i])),e=Buffer.concat([e,t[i]]);return e}},function(t,e,i){"use strict";function n(t,e){if(!(this instanceof n))return new n(t,e);r(Buffer.isBuffer(t),"Must pass a Buffer."),this.data=t,this.offset=0,this.zeroCopy=e||!1,this.stack=[]}const r=i(0),s=i(3),o=i(5),a=Buffer.alloc(0);n.prototype.assert=function t(e){if(!e)throw new s.EncodingError(this.offset,"Out of bounds read",t)},n.prototype.enforce=function t(e,i){if(!e)throw new s.EncodingError(this.offset,i,t)},n.prototype.getSize=function(){return this.data.length},n.prototype.left=function(){return this.assert(this.offset<=this.data.length),this.data.length-this.offset},n.prototype.seek=function(t){return this.assert(this.offset+t>=0),this.assert(this.offset+t<=this.data.length),this.offset+=t,t},n.prototype.start=function(){return this.stack.push(this.offset),this.offset},n.prototype.end=function(){r(this.stack.length>0);const t=this.stack.pop();return this.offset-t},n.prototype.endData=function(t){r(this.stack.length>0);const e=this.stack.pop(),i=this.offset,n=i-e,s=this.data;if(n===s.length)return s;if(this.zeroCopy||t)return s.slice(e,i);const o=Buffer.allocUnsafe(n);return s.copy(o,0,e,i),o},n.prototype.destroy=function(){this.data=a,this.offset=0,this.stack.length=0},n.prototype.readU8=function(){this.assert(this.offset+1<=this.data.length);const t=this.data[this.offset];return this.offset+=1,t},n.prototype.readU16=function(){this.assert(this.offset+2<=this.data.length);const t=this.data.readUInt16LE(this.offset,!0);return this.offset+=2,t},n.prototype.readU16BE=function(){this.assert(this.offset+2<=this.data.length);const t=this.data.readUInt16BE(this.offset,!0);return this.offset+=2,t},n.prototype.readU32=function(){this.assert(this.offset+4<=this.data.length);const t=this.data.readUInt32LE(this.offset,!0);return this.offset+=4,t},n.prototype.readU32BE=function(){this.assert(this.offset+4<=this.data.length);const t=this.data.readUInt32BE(this.offset,!0);return this.offset+=4,t},n.prototype.readU64=function(){this.assert(this.offset+8<=this.data.length);const t=s.readU64(this.data,this.offset);return this.offset+=8,t},n.prototype.readU64BE=function(){this.assert(this.offset+8<=this.data.length);const t=s.readU64BE(this.data,this.offset);return this.offset+=8,t},n.prototype.readI8=function(){this.assert(this.offset+1<=this.data.length);const t=this.data.readInt8(this.offset,!0);return this.offset+=1,t},n.prototype.readI16=function(){this.assert(this.offset+2<=this.data.length);const t=this.data.readInt16LE(this.offset,!0);return this.offset+=2,t},n.prototype.readI16BE=function(){this.assert(this.offset+2<=this.data.length);const t=this.data.readInt16BE(this.offset,!0);return this.offset+=2,t},n.prototype.readI32=function(){this.assert(this.offset+4<=this.data.length);const t=this.data.readInt32LE(this.offset,!0);return this.offset+=4,t},n.prototype.readI32BE=function(){this.assert(this.offset+4<=this.data.length);const t=this.data.readInt32BE(this.offset,!0);return this.offset+=4,t},n.prototype.readI64=function(){this.assert(this.offset+8<=this.data.length);const t=s.readI64(this.data,this.offset);return this.offset+=8,t},n.prototype.readI64BE=function(){this.assert(this.offset+8<=this.data.length);const t=s.readI64BE(this.data,this.offset);return this.offset+=8,t},n.prototype.readU64N=function(){this.assert(this.offset+8<=this.data.length);const t=s.readU64N(this.data,this.offset);return this.offset+=8,t},n.prototype.readU64BEN=function(){this.assert(this.offset+8<=this.data.length);const t=s.readU64BEN(this.data,this.offset);return this.offset+=8,t},n.prototype.readI64N=function(){this.assert(this.offset+8<=this.data.length);const t=s.readI64N(this.data,this.offset);return this.offset+=8,t},n.prototype.readI64BEN=function(){this.assert(this.offset+8<=this.data.length);const t=s.readI64BEN(this.data,this.offset);return this.offset+=8,t},n.prototype.readFloat=function(){this.assert(this.offset+4<=this.data.length);const t=this.data.readFloatLE(this.offset,!0);return this.offset+=4,t},n.prototype.readFloatBE=function(){this.assert(this.offset+4<=this.data.length);const t=this.data.readFloatBE(this.offset,!0);return this.offset+=4,t},n.prototype.readDouble=function(){this.assert(this.offset+8<=this.data.length);const t=this.data.readDoubleLE(this.offset,!0);return this.offset+=8,t},n.prototype.readDoubleBE=function(){this.assert(this.offset+8<=this.data.length);const t=this.data.readDoubleBE(this.offset,!0);return this.offset+=8,t},n.prototype.readVarint=function(){const{size:t,value:e}=s.readVarint(this.data,this.offset);return this.offset+=t,e},n.prototype.readVarintN=function(){const{size:t,value:e}=s.readVarintN(this.data,this.offset);return this.offset+=t,e},n.prototype.readVarint2=function(){const{size:t,value:e}=s.readVarint2(this.data,this.offset);return this.offset+=t,e},n.prototype.readVarint2N=function(){const{size:t,value:e}=s.readVarint2N(this.data,this.offset);return this.offset+=t,e},n.prototype.readBytes=function(t,e){r(t>=0),this.assert(this.offset+t<=this.data.length);let i;return this.zeroCopy||e?i=this.data.slice(this.offset,this.offset+t):(i=Buffer.allocUnsafe(t),this.data.copy(i,0,this.offset,this.offset+t)),this.offset+=t,i},n.prototype.readVarBytes=function(t){return this.readBytes(this.readVarint(),t)},n.prototype.readString=function(t,e){r(e>=0),this.assert(this.offset+e<=this.data.length);const i=this.data.toString(t,this.offset,this.offset+e);return this.offset+=e,i},n.prototype.readHash=function(t){return t?this.readString(t,32):this.readBytes(32)},n.prototype.readVarString=function(t,e){const i=this.readVarint();return this.enforce(!e||i<=e,"String exceeds limit."),this.readString(t,i)},n.prototype.readNullString=function(t){this.assert(this.offset+1<=this.data.length);let e=this.offset;for(;e<this.data.length&&0!==this.data[e];e++);this.assert(e!==this.data.length);const i=this.readString(t,e-this.offset);return this.offset=e+1,i},n.prototype.createChecksum=function(){let t=0;this.stack.length>0&&(t=this.stack[this.stack.length-1]);const e=this.data.slice(t,this.offset);return o.hash256(e).readUInt32LE(0,!0)},n.prototype.verifyChecksum=function(){const t=this.createChecksum(),e=this.readU32();return this.enforce(t===e,"Checksum mismatch."),e},t.exports=n},function(t,e,i){"use strict";function n(t,e){return t<0&&(t=~t,0===e&&(t+=1)),0==(4292870144&t)}function r(t,e,i,n){let r=!1;e<0&&(e=-e,r=!0);let s=e*(1/4294967296)|0,o=0|e;return r&&(0===o?s=1+~s|0:(s=~s,o=1+~o)),n?(i=t.writeInt32BE(s,i,!0),i=t.writeInt32BE(o,i,!0)):(i=t.writeInt32LE(o,i,!0),i=t.writeInt32LE(s,i,!0)),i}function s(t,e){this.size=t,this.value=e}function o(t,e){if(!t)throw new l.EncodingError(e,"Out of bounds read",o)}function a(t,e,i){if(!t)throw new l.EncodingError(e,i,a)}const{U64:h,I64:c}=i(49),u=h.UINT64_MAX.shrn(7),f=Number.MAX_SAFE_INTEGER,l=e;l.DUMMY=Buffer.from([0]),l.ONE_HASH=Buffer.from("0100000000000000000000000000000000000000000000000000000000000000","hex"),l.ZERO_HASH=Buffer.from("0000000000000000000000000000000000000000000000000000000000000000","hex"),l.MAX_HASH=Buffer.from("ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff","hex"),l.NULL_HASH="0000000000000000000000000000000000000000000000000000000000000000",l.HIGH_HASH="ffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff",l.ZERO_HASH160=Buffer.from("0000000000000000000000000000000000000000","hex"),l.MAX_HASH160=Buffer.from("ffffffffffffffffffffffffffffffffffffffff","hex"),l.NULL_HASH160="0000000000000000000000000000000000000000",l.HIGH_HASH160="ffffffffffffffffffffffffffffffffffffffff",l.ZERO_KEY=Buffer.from("000000000000000000000000000000000000000000000000000000000000000000","hex"),l.ZERO_SIG=Buffer.from("00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000","hex"),l.ZERO_SIG64=Buffer.from("00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000","hex"),l.ZERO_U32=Buffer.from("00000000","hex"),l.ZERO_U64=Buffer.from("0000000000000000","hex"),l.readU64=function(t,e){const i=t.readUInt32LE(e+4,!0),n=t.readUInt32LE(e,!0);return a(0==(4292870144&i),e,"Number exceeds 2^53-1"),4294967296*i+n},l.readU64BE=function(t,e){const i=t.readUInt32BE(e,!0),n=t.readUInt32BE(e+4,!0);return a(0==(4292870144&i),e,"Number exceeds 2^53-1"),4294967296*i+n},l.readI64=function(t,e){const i=t.readInt32LE(e+4,!0),r=t.readUInt32LE(e,!0);return a(n(i,r),"Number exceeds 2^53-1"),4294967296*i+r},l.readI64BE=function(t,e){const i=t.readInt32BE(e,!0),r=t.readUInt32BE(e+4,!0);return a(n(i,r),"Number exceeds 2^53-1"),4294967296*i+r},l.writeU64=function(t,e,i){return r(t,e,i,!1)},l.writeU64BE=function(t,e,i){return r(t,e,i,!0)},l.writeI64=function(t,e,i){return r(t,e,i,!1)},l.writeI64BE=function(t,e,i){return r(t,e,i,!0)},l.readU64N=function(t,e){return h.readLE(t,e)},l.readU64BEN=function(t,e){return h.readBE(t,e)},l.readI64N=function(t,e){return c.readLE(t,e)},l.readI64BEN=function(t,e){return c.readBE(t,e)},l.writeU64N=function(t,e,i){return a(!e.sign,i,"Signed"),e.writeLE(t,i)},l.writeU64BEN=function(t,e,i){return a(!e.sign,i,"Signed"),e.writeBE(t,i)},l.writeI64N=function(t,e,i){return a(e.sign,i,"Not signed"),e.writeLE(t,i)},l.writeI64BEN=function(t,e,i){return a(e.sign,i,"Not signed"),e.writeBE(t,i)},l.readVarint=function(t,e){let i,n;switch(o(e<t.length,e),t[e]){case 255:o(e+(n=9)<=t.length,e),a((i=l.readU64(t,e+1))>4294967295,e,"Non-canonical varint");break;case 254:o(e+(n=5)<=t.length,e),a((i=t.readUInt32LE(e+1,!0))>65535,e,"Non-canonical varint");break;case 253:o(e+(n=3)<=t.length,e),a((i=t[e+1]|t[e+2]<<8)>=253,e,"Non-canonical varint");break;default:n=1,i=t[e]}return new s(n,i)},l.writeVarint=function(t,e,i){return e<253?(t[i++]=255&e,i):e<=65535?(t[i++]=253,t[i++]=255&e,t[i++]=e>>8&255,i):e<=4294967295?(t[i++]=254,t[i++]=255&e,t[i++]=e>>8&255,t[i++]=e>>16&255,t[i++]=e>>>24,i):(t[i++]=255,i=l.writeU64(t,e,i))},l.sizeVarint=function(t){return t<253?1:t<=65535?3:t<=4294967295?5:9},l.readVarintN=function(t,e){if(o(e<t.length,e),255===t[e]){o(e+9<=t.length,e);const i=l.readU64N(t,e+1);return a(0!==i.hi,e,"Non-canonical varint"),new s(9,i)}const{size:i,value:n}=l.readVarint(t,e);return new s(i,h.fromInt(n))},l.writeVarintN=function(t,e,i){return a(!e.sign,i,"Signed"),0!==e.hi?(t[i++]=255,l.writeU64N(t,e,i)):l.writeVarint(t,e.toInt(),i)},l.sizeVarintN=function(t){return a(!t.sign,0,"Signed"),0!==t.hi?9:l.sizeVarint(t.toInt())},l.readVarint2=function(t,e){let i=0,n=0;for(;;){o(e<t.length,e);const r=t[e++];if(n++,a(i<=70368744177663-(127&r),e,"Number exceeds 2^53-1"),i=128*i+(127&r),0==(128&r))break;a(i!==f,e,"Number exceeds 2^53-1"),i++}return new s(n,i)},l.writeVarint2=function(t,e,i){const n=[];let r=0;for(;n[r]=127&e|(r?128:0),!(e<=127);)e=(e-e%128)/128-1,r++;o(i+r+1<=t.length,i);do{t[i++]=n[r]}while(r--);return i},l.sizeVarint2=function(t){let e=0;for(;e++,!(t<=127);)t=(t-t%128)/128-1;return e},l.readVarint2N=function(t,e){const i=new h;let n=0;for(;;){o(e<t.length,e);const r=t[e++];if(n++,a(i.lte(u),e,"Number exceeds 2^64-1"),i.ishln(7).iorn(127&r),0==(128&r))break;a(!i.eq(h.UINT64_MAX),e,"Number exceeds 2^64-1"),i.iaddn(1)}return new s(n,i)},l.writeVarint2N=function(t,e,i){if(a(!e.sign,i,"Signed"),0===e.hi)return l.writeVarint2(t,e.toInt(),i);e=e.clone();const n=[];let r=0;for(;n[r]=e.andln(127)|(r?128:0),!e.lten(127);)e.ishrn(7).isubn(1),r++;a(i+r+1<=t.length,i,"Out of bounds write");do{t[i++]=n[r]}while(r--);return i},l.sizeVarint2N=function(t){if(a(!t.sign,0,"Signed"),0===t.hi)return l.sizeVarint2(t.toInt());t=t.clone();let e=0;for(;e++,!t.lten(127);)t.ishrn(7).isubn(1);return e},l.U8=function(t){const e=Buffer.allocUnsafe(1);return e[0]=t>>>0,e},l.U16=function(t){const e=Buffer.allocUnsafe(2);return e.writeUInt16LE(t,0,!0),e},l.U32=function(t){const e=Buffer.allocUnsafe(4);return e.writeUInt32LE(t,0,!0),e},l.U32BE=function(t){const e=Buffer.allocUnsafe(4);return e.writeUInt32BE(t,0,!0),e},l.sizeVarBytes=function(t){return l.sizeVarint(t.length)+t.length},l.sizeVarlen=function(t){return l.sizeVarint(t)+t},l.sizeVarString=function(t,e){if("string"!=typeof t)return l.sizeVarBytes(t);const i=Buffer.byteLength(t,e);return l.sizeVarint(i)+i},l.EncodingError=function t(e,i,n){if(!(this instanceof t))return new t(e,i,n);Error.call(this),this.type="EncodingError",this.message=`${i} (offset=${e}).`,Error.captureStackTrace&&Error.captureStackTrace(this,n||t)},Object.setPrototypeOf(l.EncodingError.prototype,Error.prototype)},function(t,e,i){"use strict";function n(t){if(!(this instanceof n))return new n(t);this.data=t?Buffer.allocUnsafe(t):a,this.offset=0}const r=i(0),s=i(3),o=i(5),a=Buffer.alloc(0);let h=null;n.pool=function(t){if(t<=102400){h||(h=Buffer.allocUnsafeSlow(102400));const e=new n(0);return e.data=h.slice(0,t),e}return new n(t)},n.prototype.render=function(){const t=this.data;return r(this.offset===t.length),this.destroy(),t},n.prototype.getSize=function(){return this.offset},n.prototype.seek=function(t){this.offset+=t},n.prototype.destroy=function(){this.data=a,this.offset=0},n.prototype.writeU8=function(t){this.offset=this.data.writeUInt8(t,this.offset,!0)},n.prototype.writeU16=function(t){this.offset=this.data.writeUInt16LE(t,this.offset,!0)},n.prototype.writeU16BE=function(t){this.offset=this.data.writeUInt16BE(t,this.offset,!0)},n.prototype.writeU32=function(t){this.offset=this.data.writeUInt32LE(t,this.offset,!0)},n.prototype.writeU32BE=function(t){this.offset=this.data.writeUInt32BE(t,this.offset,!0)},n.prototype.writeU64=function(t){this.offset=s.writeU64(this.data,t,this.offset)},n.prototype.writeU64BE=function(t){this.offset=s.writeU64BE(this.data,t,this.offset)},n.prototype.writeU64N=function(t){this.offset=s.writeU64N(this.data,t,this.offset)},n.prototype.writeU64BEN=function(t){this.offset=s.writeU64BEN(this.data,t,this.offset)},n.prototype.writeI8=function(t){this.offset=this.data.writeInt8(t,this.offset,!0)},n.prototype.writeI16=function(t){this.offset=this.data.writeInt16LE(t,this.offset,!0)},n.prototype.writeI16BE=function(t){this.offset=this.data.writeInt16BE(t,this.offset,!0)},n.prototype.writeI32=function(t){this.offset=this.data.writeInt32LE(t,this.offset,!0)},n.prototype.writeI32BE=function(t){this.offset=this.data.writeInt32BE(t,this.offset,!0)},n.prototype.writeI64=function(t){this.offset=s.writeI64(this.data,t,this.offset)},n.prototype.writeI64BE=function(t){this.offset=s.writeI64BE(this.data,t,this.offset)},n.prototype.writeI64N=function(t){this.offset=s.writeI64N(this.data,t,this.offset)},n.prototype.writeI64BEN=function(t){this.offset=s.writeI64BEN(this.data,t,this.offset)},n.prototype.writeFloat=function(t){this.offset=this.data.writeFloatLE(t,this.offset,!0)},n.prototype.writeFloatBE=function(t){this.offset=this.data.writeFloatBE(t,this.offset,!0)},n.prototype.writeDouble=function(t){this.offset=this.data.writeDoubleLE(t,this.offset,!0)},n.prototype.writeDoubleBE=function(t){this.offset=this.data.writeDoubleBE(t,this.offset,!0)},n.prototype.writeVarint=function(t){this.offset=s.writeVarint(this.data,t,this.offset)},n.prototype.writeVarintN=function(t){this.offset=s.writeVarintN(this.data,t,this.offset)},n.prototype.writeVarint2=function(t){this.offset=s.writeVarint2(this.data,t,this.offset)},n.prototype.writeVarint2N=function(t){this.offset=s.writeVarint2N(this.data,t,this.offset)},n.prototype.writeBytes=function(t){0!==t.length&&(t.copy(this.data,this.offset),this.offset+=t.length)},n.prototype.writeVarBytes=function(t){this.writeVarint(t.length),this.writeBytes(t)},n.prototype.copy=function(t,e,i){const n=i-e;0!==n&&(t.copy(this.data,this.offset,e,i),this.offset+=n)},n.prototype.writeString=function(t,e){if(0===t.length)return;const i=Buffer.byteLength(t,e);this.data.write(t,this.offset,e),this.offset+=i},n.prototype.writeHash=function(t){if("string"!=typeof t)return r(32===t.length),void this.writeBytes(t);r(64===t.length),this.data.write(t,this.offset,"hex"),this.offset+=32},n.prototype.writeVarString=function(t,e){if(0===t.length)return void this.writeVarint(0);const i=Buffer.byteLength(t,e);this.writeVarint(i),this.data.write(t,this.offset,e),this.offset+=i},n.prototype.writeNullString=function(t,e){this.writeString(t,e),this.writeU8(0)},n.prototype.writeChecksum=function(){const t=this.data.slice(0,this.offset);o.hash256(t).copy(this.data,this.offset,0,4),this.offset+=4},n.prototype.fill=function(t,e){r(e>=0),0!==e&&(this.data.fill(t,this.offset,this.offset+e),this.offset+=e)},t.exports=n},function(t,e,i){"use strict";const n=i(0),r=i(24),s=i(18).binding,o=Buffer.allocUnsafe(64);e.hash=function(t,e){return r.createHash(t).update(e).digest()},e.ripemd160=function(t){return e.hash("ripemd160",t)},e.sha1=function(t){return e.hash("sha1",t)},e.sha256=function(t){return e.hash("sha256",t)},e.hash160=function(t){return e.ripemd160(e.sha256(t))},e.hash256=function(t){return e.sha256(e.sha256(t))},e.root256=function(t,i){const r=o;return n(32===t.length),n(32===i.length),t.copy(r,0),i.copy(r,32),e.hash256(r)},e.hmac=function(t,e,i){return r.createHmac(t,i).update(e).digest()},s&&(e.hash=s.hash,e.hmac=s.hmac,e.ripemd160=s.ripemd160,e.sha1=s.sha1,e.sha256=s.sha256,e.hash160=s.hash160,e.hash256=s.hash256,e.root256=s.root256)},function(t,e,i){"use strict";function n(t){if(!(this instanceof n))return new n(t);d(!n[t.type],"Cannot create two networks."),this.type=t.type,this.seeds=t.seeds,this.magic=t.magic,this.port=t.port,this.checkpointMap=t.checkpointMap,this.lastCheckpoint=t.lastCheckpoint,this.checkpoints=[],this.halvingInterval=t.halvingInterval,this.genesis=t.genesis,this.genesisBlock=t.genesisBlock,this.pow=t.pow,this.block=t.block,this.bip30=t.bip30,this.activationThreshold=t.activationThreshold,this.minerWindow=t.minerWindow,this.deployments=t.deployments,this.deploys=t.deploys,this.unknownBits=~y.VERSION_TOP_MASK,this.keyPrefix=t.keyPrefix,this.addressPrefix=t.addressPrefix,this.requireStandard=t.requireStandard,this.rpcPort=t.rpcPort,this.minRelay=t.minRelay,this.feeRate=t.feeRate,this.maxFeeRate=t.maxFeeRate,this.selfConnect=t.selfConnect,this.requestMempool=t.requestMempool,this.time=new w,this._init()}function r(t,e){return t.bit-e}function s(t,e){return t.height-e.height}function o(t,e){return t.magic===e}function a(t,e){return t.keyPrefix.privkey===e}function h(t,e){return t.keyPrefix.xpubkey===e}function c(t,e){return t.keyPrefix.xprivkey===e}function u(t,e){return t.keyPrefix.xpubkey58===e}function f(t,e){return t.keyPrefix.xprivkey58===e}function l(t,e){const i=t.addressPrefix;switch(e){case i.pubkeyhash:case i.scripthash:case i.witnesspubkeyhash:case i.witnessscripthash:return!0}return!1}function p(t,e){return t.addressPrefix.bech32===e}const d=i(0),m=i(1),g=i(83),y=i(7),w=i(84);n.primary=null,n.type=null,n.mainnet=null,n.testnet=null,n.regtest=null,n.simnet=null,n.prototype._init=function(){let t=0;for(const e of this.deploys)t|=1<<e.bit;t|=y.VERSION_TOP_MASK,this.unknownBits=~t;for(const t of Object.keys(this.checkpointMap)){const e=this.checkpointMap[t],i=Number(t);this.checkpoints.push({hash:e,height:i})}this.checkpoints.sort(s)},n.prototype.byBit=function(t){const e=m.binarySearch(this.deploys,t,r);return-1===e?null:this.deploys[e]},n.prototype.now=function(){return this.time.now()},n.prototype.ms=function(){return this.time.ms()},n.create=function(t){if("string"==typeof t&&(t=g[t]),d(t,"Unknown network."),n[t.type])return n[t.type];const e=new n(t);return n[e.type]=e,n.primary||(n.primary=e),e},n.set=function(t){return d("string"==typeof t,"Bad network."),n.primary=n.get(t),n.type=t,n.primary},n.get=function(t){if(!t)return d(n.primary,"No default network."),n.primary;if(t instanceof n)return t;if("string"==typeof t)return n.create(t);throw new Error("Unknown network.")},n.ensure=function(t){return t?t instanceof n?t:"string"==typeof t&&g[t]?n.create(t):(d(n.primary,"No default network."),n.primary):(d(n.primary,"No default network."),n.primary)},n.by=function(t,e,i,r){if(i){if(i=n.get(i),e(i,t))return i;throw new Error(`Network mismatch for ${r}.`)}for(const r of g.types)if(i=g[r],e(i,t))return n.get(r);throw new Error(`Network not found for ${r}.`)},n.fromMagic=function(t,e){return n.by(t,o,e,"magic number")},n.fromWIF=function(t,e){return n.by(t,a,e,"WIF")},n.fromPublic=function(t,e){return n.by(t,h,e,"xpubkey")},n.fromPrivate=function(t,e){return n.by(t,c,e,"xprivkey")},n.fromPublic58=function(t,e){return n.by(t,u,e,"xpubkey")},n.fromPrivate58=function(t,e){return n.by(t,f,e,"xprivkey")},n.fromAddress=function(t,e){return n.by(t,l,e,"base58 address")},n.fromBech32=function(t,e){return n.by(t,p,e,"bech32 address")},n.prototype.toString=function(){return this.type},n.prototype.inspect=function(){return`<Network: ${this.type}>`},n.isNetwork=function(t){return t instanceof n},n.set(process.env.WMCC_NETWORK||"mainnet"),t.exports=n},function(t,e,i){"use strict";i(0);const n=i(26);e.COIN=1e8,e.INITIAL_COIN=1e7*e.COIN,e.INITIAL_COINRESERVE=1e7*e.COIN,e.BASE_REWARD=50*e.COIN,e.BASE_RESERVE=5*e.COIN,e.HALF_REWARD=e.BASE_REWARD,e.MAX_BLOCK_SIZE=1e6,e.MAX_RAW_BLOCK_SIZE=4e6,e.MAX_BLOCK_WEIGHT=4e6,e.MAX_BLOCK_SIGOPS=2e4,e.MAX_BLOCK_SIGOPS_COST=8e4,e.VERSION_TOP_BITS=536870912,e.VERSION_TOP_MASK=3758096384,e.COINBASE_MATURITY=100,e.WITNESS_SCALE_FACTOR=4,e.LOCKTIME_THRESHOLD=5e8,e.SEQUENCE_DISABLE_FLAG=1<<31>>>0,e.SEQUENCE_TYPE_FLAG=1<<22,e.SEQUENCE_GRANULARITY=9,e.SEQUENCE_MASK=65535,e.MAX_SCRIPT_SIZE=1e4,e.MAX_SCRIPT_STACK=1e3,e.MAX_SCRIPT_PUSH=520,e.MAX_SCRIPT_OPS=201,e.MAX_MULTISIG_PUBKEYS=20,e.BIP16_TIME=1512086400,e.getMaxMoney=function(t){if(!t)return 0x10000000000000000;return e.INITIAL_COIN+e.INITIAL_COINRESERVE+(e.BASE_REWARD+e.BASE_RESERVE)*t},e.fromCompact=function(t){const e=t>>>24,i=t>>>23&1;let r,s=8388607&t;return 0===t?new n(0):(e<=3?r=new n(s>>>=8*(3-e)):(r=new n(s)).iushln(8*(e-3)),i&&r.ineg(),r)},e.toCompact=function(t){let e,i,n;return 0===t.cmpn(0)?0:((i=t.byteLength())<=3?(e=t.toNumber(),e<<=8*(3-i)):e=t.ushrn(8*(i-3)).toNumber(),8388608&e&&(e>>=8,i++),n=i<<24|e,t.isNeg()&&(n|=8388608),n>>>=0)},e.verifyPOW=function(t,i){const r=e.fromCompact(i);return!r.isNeg()&&0!==r.cmpn(0)&&!((t=new n(t,"le")).cmp(r)>0)},e.getReward=function(t,i){return e.BASE_REWARD},e.getTotalReward=function(t,i){return e.BASE_REWARD+e.BASE_RESERVE},e.hasBit=function(t,i){return(t&e.VERSION_TOP_MASK)>>>0===e.VERSION_TOP_BITS&&0!=(t&1<<i)}},function(t,e,i){"use strict";function n(t){if(!(this instanceof n))return new n(t);this.raw=A,this.code=[],t&&this.fromOptions(t)}function r(t,e,i){if(a(Buffer.isBuffer(t)),a("number"==typeof e),a("number"==typeof i),e&n.flags.VERIFY_STRICTENC&&!k.isKeyEncoding(t))throw new b("PUBKEYTYPE");if(1===i&&e&n.flags.VERIFY_WITNESS_PUBKEYTYPE&&!k.isCompressedEncoding(t))throw new b("WITNESS_PUBKEYTYPE");return!0}function s(t,e){if(a(Buffer.isBuffer(t)),a("number"==typeof e),0===t.length)return!0;if((e&n.flags.VERIFY_DERSIG||e&n.flags.VERIFY_LOW_S||e&n.flags.VERIFY_STRICTENC)&&!k.isSignatureEncoding(t))throw new b("SIG_DER");if(e&n.flags.VERIFY_LOW_S&&!k.isLowDER(t))throw new b("SIG_HIGH_S");if(e&n.flags.VERIFY_STRICTENC&&!k.isHashType(t))throw new b("SIG_HASHTYPE");return!0}function o(t,e,i){return E.verify(t,e.slice(0,-1),i)}const a=i(0),h=i(7),c=i(19),u=i(1),f=i(5),l=i(66),p=i(63),d=i(2),m=i(4),g=i(85),y=i(90),w=i(40),b=i(35),v=i(32),k=i(27),S=i(3),E=i(12),R=i(11),x=k.opcodes,_=k.types,I=k.typesByVal,A=Buffer.alloc(0);n.opcodes=k.opcodes,n.opcodesByVal=k.opcodesByVal,n.flags=k.flags,n.hashType=k.hashType,n.hashTypeByVal=k.hashTypeByVal,n.types=k.types,n.typesByVal=k.typesByVal,Object.defineProperty(n.prototype,"length",{get(){return this.code.length},set(t){return this.code.length=t,this.code.length}}),n.prototype.fromOptions=function(t){if(a(t,"Script data is required."),Buffer.isBuffer(t))return this.fromRaw(t);if(Array.isArray(t))return this.fromArray(t);if(t.raw){if(!t.code)return this.fromRaw(t.raw);a(Buffer.isBuffer(t.raw),"Raw must be a Buffer."),this.raw=t.raw}if(t.code){if(!t.raw)return this.fromArray(t.code);a(Array.isArray(t.code),"Code must be an array."),this.code=t.code}return this},n.fromOptions=function(t){return(new n).fromOptions(t)},n.prototype.values=function(){return this.code.values()},n.prototype.entries=function(){return this.code.entries()},n.prototype[Symbol.iterator]=function(){return this.code[Symbol.iterator]()},n.prototype.toArray=function(){return this.code.slice()},n.prototype.fromArray=function(t){a(Array.isArray(t)),this.clear();for(const e of t)this.push(e);return this.compile()},n.fromArray=function(t){return(new n).fromArray(t)},n.prototype.toItems=function(){const t=[];for(const e of this.code){const i=e.toPush();if(!i)throw new Error("Non-push opcode in script.");t.push(i)}return t},n.prototype.fromItems=function(t){a(Array.isArray(t)),this.clear();for(const e of t)this.pushData(e);return this.compile()},n.fromItems=function(t){return(new n).fromItems(t)},n.prototype.toStack=function(){return new w(this.toItems())},n.prototype.fromStack=function(t){return this.fromItems(t.items)},n.fromStack=function(t){return(new n).fromStack(t)},n.prototype.clone=function(){return(new n).inject(this)},n.prototype.inject=function(t){return this.raw=t.raw,this.code=t.code.slice(),this},n.prototype.equals=function(t){return a(n.isScript(t)),this.raw.equals(t.raw)},n.prototype.compare=function(t){return a(n.isScript(t)),this.raw.compare(t.raw)},n.prototype.clear=function(){return this.raw=A,this.code.length=0,this},n.prototype.inspect=function(){return`<Script: ${this.toString()}>`},n.prototype.toString=function(){const t=[];for(const e of this.code)t.push(e.toFormat());return t.join(" ")},n.prototype.toASM=function(t){this.isNulldata()&&(t=!1);const e=[];for(const i of this.code)e.push(i.toASM(t));return e.join(" ")},n.prototype.compile=function(){if(0===this.code.length)return this.clear();let t=0;for(const e of this.code)t+=e.getSize();const e=new m(t);for(const t of this.code)t.toWriter(e);return this.raw=e.render(),this},n.prototype.toWriter=function(t){return t.writeVarBytes(this.raw),t},n.prototype.toRaw=function(){return this.raw},n.prototype.toJSON=function(){return this.toRaw().toString("hex")},n.prototype.fromJSON=function(t){return a("string"==typeof t,"Code must be a string."),this.fromRaw(Buffer.from(t,"hex"))},n.fromJSON=function(t){return(new n).fromJSON(t)},n.prototype.getSubscript=function(t){if(0===t)return this.clone();const e=new n;for(let i=t;i<this.code.length;i++){const t=this.code[i];if(-1===t.value)break;e.code.push(t)}return e.compile()},n.prototype.removeSeparators=function(){let t=!1;for(const e of this.code){if(-1===e.value)break;if(e.value===x.OP_CODESEPARATOR){t=!0;break}}if(!t)return this;const e=new n;for(const t of this.code){if(-1===t.value)break;t.value!==x.OP_CODESEPARATOR&&e.code.push(t)}return e.compile()},n.prototype.execute=function(t,e,i,c,u,l){if(null==e&&(e=n.flags.STANDARD_VERIFY_FLAGS),null==l&&(l=0),this.raw.length>h.MAX_SCRIPT_SIZE)throw new b("SCRIPT_SIZE");const p=[],d=[];let m=0,g=0,y=0,w=!1;e&n.flags.VERIFY_MINIMALDATA&&(w=!0);for(let k=0;k<this.code.length;k++){const S=this.code[k];if(-1===S.value)throw new b("BAD_OPCODE",S,k);if(S.data&&S.data.length>h.MAX_SCRIPT_PUSH)throw new b("PUSH_SIZE",S,k);if(S.value>x.OP_16&&++g>h.MAX_SCRIPT_OPS)throw new b("OP_COUNT",S,k);if(S.isDisabled())throw new b("DISABLED_OPCODE",S,k);if(!y||S.isBranch())if(S.data){if(w&&!S.isMinimal())throw new b("MINIMALDATA",S,k);if(t.push(S.data),t.length+d.length>h.MAX_SCRIPT_STACK)throw new b("STACK_SIZE",S,k)}else{switch(S.value){case x.OP_0:t.pushInt(0);break;case x.OP_1NEGATE:t.pushInt(-1);break;case x.OP_1:case x.OP_2:case x.OP_3:case x.OP_4:case x.OP_5:case x.OP_6:case x.OP_7:case x.OP_8:case x.OP_9:case x.OP_10:case x.OP_11:case x.OP_12:case x.OP_13:case x.OP_14:case x.OP_15:case x.OP_16:t.pushInt(S.value-80);break;case x.OP_NOP:break;case x.OP_CHECKLOCKTIMEVERIFY:{if(!(e&n.flags.VERIFY_CHECKLOCKTIMEVERIFY)){if(e&n.flags.VERIFY_DISCOURAGE_UPGRADABLE_NOPS)throw new b("DISCOURAGE_UPGRADABLE_NOPS",S,k);break}if(!i)throw new b("UNKNOWN_ERROR","No TX passed in.");if(0===t.length)throw new b("INVALID_STACK_OPERATION",S,k);const r=t.getNum(-1,w,5);if(r.isNeg())throw new b("NEGATIVE_LOCKTIME",S,k);const s=r.toDouble();if(!i.verifyLocktime(c,s))throw new b("UNSATISFIED_LOCKTIME",S,k);break}case x.OP_CHECKSEQUENCEVERIFY:{if(!(e&n.flags.VERIFY_CHECKSEQUENCEVERIFY)){if(e&n.flags.VERIFY_DISCOURAGE_UPGRADABLE_NOPS)throw new b("DISCOURAGE_UPGRADABLE_NOPS",S,k);break}if(!i)throw new b("UNKNOWN_ERROR","No TX passed in.");if(0===t.length)throw new b("INVALID_STACK_OPERATION",S,k);const r=t.getNum(-1,w,5);if(r.isNeg())throw new b("NEGATIVE_LOCKTIME",S,k);const s=r.toDouble();if(!i.verifySequence(c,s))throw new b("UNSATISFIED_LOCKTIME",S,k);break}case x.OP_NOP1:case x.OP_NOP4:case x.OP_NOP5:case x.OP_NOP6:case x.OP_NOP7:case x.OP_NOP8:case x.OP_NOP9:case x.OP_NOP10:if(e&n.flags.VERIFY_DISCOURAGE_UPGRADABLE_NOPS)throw new b("DISCOURAGE_UPGRADABLE_NOPS",S,k);break;case x.OP_IF:case x.OP_NOTIF:{let i=!1;if(!y){if(t.length<1)throw new b("UNBALANCED_CONDITIONAL",S,k);if(1===l&&e&n.flags.VERIFY_MINIMALIF){const e=t.get(-1);if(e.length>1)throw new b("MINIMALIF");if(1===e.length&&1!==e[0])throw new b("MINIMALIF")}i=t.getBool(-1),S.value===x.OP_NOTIF&&(i=!i),t.pop()}p.push(i),i||(y+=1);break}case x.OP_ELSE:if(0===p.length)throw new b("UNBALANCED_CONDITIONAL",S,k);p[p.length-1]=!p[p.length-1],p[p.length-1]?y-=1:y+=1;break;case x.OP_ENDIF:if(0===p.length)throw new b("UNBALANCED_CONDITIONAL",S,k);p.pop()||(y-=1);break;case x.OP_VERIFY:if(0===t.length)throw new b("INVALID_STACK_OPERATION",S,k);if(!t.getBool(-1))throw new b("VERIFY",S,k);t.pop();break;case x.OP_RETURN:throw new b("OP_RETURN",S,k);case x.OP_TOALTSTACK:if(0===t.length)throw new b("INVALID_STACK_OPERATION",S,k);d.push(t.pop());break;case x.OP_FROMALTSTACK:if(0===d.length)throw new b("INVALID_ALTSTACK_OPERATION",S,k);t.push(d.pop());break;case x.OP_2DROP:if(t.length<2)throw new b("INVALID_STACK_OPERATION",S,k);t.pop(),t.pop();break;case x.OP_2DUP:{if(t.length<2)throw new b("INVALID_STACK_OPERATION",S,k);const e=t.get(-2),i=t.get(-1);t.push(e),t.push(i);break}case x.OP_3DUP:{if(t.length<3)throw new b("INVALID_STACK_OPERATION",S,k);const e=t.get(-3),i=t.get(-2),n=t.get(-1);t.push(e),t.push(i),t.push(n);break}case x.OP_2OVER:{if(t.length<4)throw new b("INVALID_STACK_OPERATION",S,k);const e=t.get(-4),i=t.get(-3);t.push(e),t.push(i);break}case x.OP_2ROT:{if(t.length<6)throw new b("INVALID_STACK_OPERATION",S,k);const e=t.get(-6),i=t.get(-5);t.erase(-6,-4),t.push(e),t.push(i);break}case x.OP_2SWAP:if(t.length<4)throw new b("INVALID_STACK_OPERATION",S,k);t.swap(-4,-2),t.swap(-3,-1);break;case x.OP_IFDUP:if(0===t.length)throw new b("INVALID_STACK_OPERATION",S,k);if(t.getBool(-1)){const e=t.get(-1);t.push(e)}break;case x.OP_DEPTH:t.pushInt(t.length);break;case x.OP_DROP:if(0===t.length)throw new b("INVALID_STACK_OPERATION",S,k);t.pop();break;case x.OP_DUP:if(0===t.length)throw new b("INVALID_STACK_OPERATION",S,k);t.push(t.get(-1));break;case x.OP_NIP:if(t.length<2)throw new b("INVALID_STACK_OPERATION",S,k);t.remove(-2);break;case x.OP_OVER:if(t.length<2)throw new b("INVALID_STACK_OPERATION",S,k);t.push(t.get(-2));break;case x.OP_PICK:case x.OP_ROLL:{if(t.length<2)throw new b("INVALID_STACK_OPERATION",S,k);const e=t.getInt(-1,w,4);if(t.pop(),e<0||e>=t.length)throw new b("INVALID_STACK_OPERATION",S,k);const i=t.get(-e-1);S.value===x.OP_ROLL&&t.remove(-e-1),t.push(i);break}case x.OP_ROT:if(t.length<3)throw new b("INVALID_STACK_OPERATION",S,k);t.swap(-3,-2),t.swap(-2,-1);break;case x.OP_SWAP:if(t.length<2)throw new b("INVALID_STACK_OPERATION",S,k);t.swap(-2,-1);break;case x.OP_TUCK:if(t.length<2)throw new b("INVALID_STACK_OPERATION",S,k);t.insert(-2,t.get(-1));break;case x.OP_SIZE:if(t.length<1)throw new b("INVALID_STACK_OPERATION",S,k);t.pushInt(t.get(-1).length);break;case x.OP_EQUAL:case x.OP_EQUALVERIFY:{if(t.length<2)throw new b("INVALID_STACK_OPERATION",S,k);const e=t.get(-2),i=t.get(-1),n=e.equals(i);if(t.pop(),t.pop(),t.pushBool(n),S.value===x.OP_EQUALVERIFY){if(!n)throw new b("EQUALVERIFY",S,k);t.pop()}break}case x.OP_1ADD:case x.OP_1SUB:case x.OP_NEGATE:case x.OP_ABS:case x.OP_NOT:case x.OP_0NOTEQUAL:{if(t.length<1)throw new b("INVALID_STACK_OPERATION",S,k);let e,i=t.getNum(-1,w,4);switch(S.value){case x.OP_1ADD:i.iaddn(1);break;case x.OP_1SUB:i.isubn(1);break;case x.OP_NEGATE:i.ineg();break;case x.OP_ABS:i.iabs();break;case x.OP_NOT:e=i.isZero(),i=v.fromBool(e);break;case x.OP_0NOTEQUAL:e=!i.isZero(),i=v.fromBool(e);break;default:a(!1,"Fatal script error.")}t.pop(),t.pushNum(i);break}case x.OP_ADD:case x.OP_SUB:case x.OP_BOOLAND:case x.OP_BOOLOR:case x.OP_NUMEQUAL:case x.OP_NUMEQUALVERIFY:case x.OP_NUMNOTEQUAL:case x.OP_LESSTHAN:case x.OP_GREATERTHAN:case x.OP_LESSTHANOREQUAL:case x.OP_GREATERTHANOREQUAL:case x.OP_MIN:case x.OP_MAX:{if(t.length<2)throw new b("INVALID_STACK_OPERATION",S,k);const e=t.getNum(-2,w,4),i=t.getNum(-1,w,4);let n,r;switch(S.value){case x.OP_ADD:n=e.iadd(i);break;case x.OP_SUB:n=e.isub(i);break;case x.OP_BOOLAND:r=e.toBool()&&i.toBool(),n=v.fromBool(r);break;case x.OP_BOOLOR:r=e.toBool()||i.toBool(),n=v.fromBool(r);break;case x.OP_NUMEQUAL:case x.OP_NUMEQUALVERIFY:r=e.eq(i),n=v.fromBool(r);break;case x.OP_NUMNOTEQUAL:r=!e.eq(i),n=v.fromBool(r);break;case x.OP_LESSTHAN:r=e.lt(i),n=v.fromBool(r);break;case x.OP_GREATERTHAN:r=e.gt(i),n=v.fromBool(r);break;case x.OP_LESSTHANOREQUAL:r=e.lte(i),n=v.fromBool(r);break;case x.OP_GREATERTHANOREQUAL:r=e.gte(i),n=v.fromBool(r);break;case x.OP_MIN:n=v.min(e,i);break;case x.OP_MAX:n=v.max(e,i);break;default:a(!1,"Fatal script error.")}if(t.pop(),t.pop(),t.pushNum(n),S.value===x.OP_NUMEQUALVERIFY){if(!t.getBool(-1))throw new b("NUMEQUALVERIFY",S,k);t.pop()}break}case x.OP_WITHIN:{if(t.length<3)throw new b("INVALID_STACK_OPERATION",S,k);const e=t.getNum(-3,w,4),i=t.getNum(-2,w,4),n=t.getNum(-1,w,4),r=i.lte(e)&&e.lt(n);t.pop(),t.pop(),t.pop(),t.pushBool(r);break}case x.OP_RIPEMD160:if(0===t.length)throw new b("INVALID_STACK_OPERATION",S,k);t.push(f.ripemd160(t.pop()));break;case x.OP_SHA1:if(0===t.length)throw new b("INVALID_STACK_OPERATION",S,k);t.push(f.sha1(t.pop()));break;case x.OP_SHA256:if(0===t.length)throw new b("INVALID_STACK_OPERATION",S,k);t.push(f.sha256(t.pop()));break;case x.OP_HASH160:if(0===t.length)throw new b("INVALID_STACK_OPERATION",S,k);t.push(f.hash160(t.pop()));break;case x.OP_HASH256:if(0===t.length)throw new b("INVALID_STACK_OPERATION",S,k);t.push(f.hash256(t.pop()));break;case x.OP_CODESEPARATOR:m=k+1;break;case x.OP_CHECKSIG:case x.OP_CHECKSIGVERIFY:{if(!i)throw new b("UNKNOWN_ERROR","No TX passed in.");if(t.length<2)throw new b("INVALID_STACK_OPERATION",S,k);const a=t.get(-2),h=t.get(-1),f=this.getSubscript(m);0===l&&f.findAndDelete(a),s(a,e),r(h,e,l);let p=!1;if(a.length>0){const t=a[a.length-1];p=o(i.signatureHash(c,f,u,t,l),a,h)}if(!p&&e&n.flags.VERIFY_NULLFAIL&&0!==a.length)throw new b("NULLFAIL",S,k);if(t.pop(),t.pop(),t.pushBool(p),S.value===x.OP_CHECKSIGVERIFY){if(!p)throw new b("CHECKSIGVERIFY",S,k);t.pop()}break}case x.OP_CHECKMULTISIG:case x.OP_CHECKMULTISIGVERIFY:{if(!i)throw new b("UNKNOWN_ERROR","No TX passed in.");let a=1;if(t.length<a)throw new b("INVALID_STACK_OPERATION",S,k);let f,p,d=t.getInt(-a,w,4),y=d+2;if(d<0||d>h.MAX_MULTISIG_PUBKEYS)throw new b("PUBKEY_COUNT",S,k);if((g+=d)>h.MAX_SCRIPT_OPS)throw new b("OP_COUNT",S,k);if(a+=1,f=a,a+=d,t.length<a)throw new b("INVALID_STACK_OPERATION",S,k);let v=t.getInt(-a,w,4);if(v<0||v>d)throw new b("SIG_COUNT",S,k);if(a+=1,p=a,a+=v,t.length<a)throw new b("INVALID_STACK_OPERATION",S,k);const E=this.getSubscript(m);for(let e=0;e<v;e++){const i=t.get(-p-e);0===l&&E.findAndDelete(i)}let R=!0;for(;R&&v>0;){const n=t.get(-p),a=t.get(-f);if(s(n,e),r(a,e,l),n.length>0){const t=n[n.length-1];o(i.signatureHash(c,E,u,t,l),n,a)&&(p+=1,v-=1)}f+=1,v>(d-=1)&&(R=!1)}for(;a>1;){if(!R&&e&n.flags.VERIFY_NULLFAIL&&0===y&&0!==t.get(-1).length)throw new b("NULLFAIL",S,k);y>0&&(y-=1),t.pop(),a-=1}if(t.length<1)throw new b("INVALID_STACK_OPERATION",S,k);if(e&n.flags.VERIFY_NULLDUMMY&&0!==t.get(-1).length)throw new b("SIG_NULLDUMMY",S,k);if(t.pop(),t.pushBool(R),S.value===x.OP_CHECKMULTISIGVERIFY){if(!R)throw new b("CHECKMULTISIGVERIFY",S,k);t.pop()}break}default:throw new b("BAD_OPCODE",S,k)}if(t.length+d.length>h.MAX_SCRIPT_STACK)throw new b("STACK_SIZE",S,k)}else if(t.length+d.length>h.MAX_SCRIPT_STACK)throw new b("STACK_SIZE",S,k)}if(0!==p.length)throw new b("UNBALANCED_CONDITIONAL")},n.prototype.findAndDelete=function(t){const e=y.fromPush(t);if(this.raw.length<e.getSize())return 0;let i=!1;for(const t of this.code){if(-1===t.value)break;if(t.equals(e)){i=!0;break}}if(!i)return 0;const n=[];let r=0;for(const t of this.code){if(-1===t.value)break;t.equals(e)?r+=1:n.push(t)}return this.code=n,this.compile(),r},n.prototype.indexOf=function(t){for(let e=0;e<this.code.length;e++){const i=this.code[e];if(-1===i.value)break;if(i.data&&i.data.equals(t))return e}return-1},n.prototype.isCode=function(){for(const t of this.code){if(-1===t.value)return!1;if(t.isDisabled())return!1;switch(t.value){case x.OP_RESERVED:case x.OP_NOP:case x.OP_VER:case x.OP_VERIF:case x.OP_VERNOTIF:case x.OP_RESERVED1:case x.OP_RESERVED2:case x.OP_NOP1:return!1}if(t.value>x.OP_CHECKSEQUENCEVERIFY)return!1}return!0},n.prototype.fromPubkey=function(t){return a(Buffer.isBuffer(t)&&(33===t.length||65===t.length)),this.raw=Buffer.allocUnsafe(1+t.length+1),this.raw[0]=t.length,t.copy(this.raw,1),this.raw[1+t.length]=x.OP_CHECKSIG,t=this.raw.slice(1,1+t.length),this.code.length=0,this.code.push(y.fromPush(t)),this.code.push(y.fromOp(x.OP_CHECKSIG)),this},n.fromPubkey=function(t){return(new n).fromPubkey(t)},n.prototype.fromPubkeyhash=function(t){return a(Buffer.isBuffer(t)&&20===t.length),this.raw=Buffer.allocUnsafe(25),this.raw[0]=x.OP_DUP,this.raw[1]=x.OP_HASH160,this.raw[2]=20,t.copy(this.raw,3),this.raw[23]=x.OP_EQUALVERIFY,this.raw[24]=x.OP_CHECKSIG,t=this.raw.slice(3,23),this.code.length=0,this.code.push(y.fromOp(x.OP_DUP)),this.code.push(y.fromOp(x.OP_HASH160)),this.code.push(y.fromPush(t)),this.code.push(y.fromOp(x.OP_EQUALVERIFY)),this.code.push(y.fromOp(x.OP_CHECKSIG)),this},n.fromPubkeyhash=function(t){return(new n).fromPubkeyhash(t)},n.prototype.fromMultisig=function(t,e,i){a(u.isU8(t)&&u.isU8(e)),a(Array.isArray(i)),a(i.length===e,"`n` keys are required for multisig."),a(t>=1&&t<=e),a(e>=1&&e<=15),this.clear(),this.pushSmall(t);for(const t of function(t){return t.slice().sort((t,e)=>t.compare(e))}(i))this.pushData(t);return this.pushSmall(e),this.pushOp(x.OP_CHECKMULTISIG),this.compile()},n.fromMultisig=function(t,e,i){return(new n).fromMultisig(t,e,i)},n.prototype.fromScripthash=function(t){return a(Buffer.isBuffer(t)&&20===t.length),this.raw=Buffer.allocUnsafe(23),this.raw[0]=x.OP_HASH160,this.raw[1]=20,t.copy(this.raw,2),this.raw[22]=x.OP_EQUAL,t=this.raw.slice(2,22),this.code.length=0,this.code.push(y.fromOp(x.OP_HASH160)),this.code.push(y.fromPush(t)),this.code.push(y.fromOp(x.OP_EQUAL)),this},n.fromScripthash=function(t){return(new n).fromScripthash(t)},n.prototype.fromNulldata=function(t){return a(Buffer.isBuffer(t)),a(t.length<=c.MAX_OP_RETURN,"Nulldata too large."),this.clear(),this.pushOp(x.OP_RETURN),this.pushData(t),this.compile()},n.fromNulldata=function(t){return(new n).fromNulldata(t)},n.prototype.fromProgram=function(t,e){return a(u.isU8(t)&&t>=0&&t<=16),a(Buffer.isBuffer(e)&&e.length>=2&&e.length<=40),this.raw=Buffer.allocUnsafe(2+e.length),this.raw[0]=0===t?0:t+80,this.raw[1]=e.length,e.copy(this.raw,2),e=this.raw.slice(2,2+e.length),this.code.length=0,this.code.push(y.fromSmall(t)),this.code.push(y.fromPush(e)),this},n.fromProgram=function(t,e){return(new n).fromProgram(t,e)},n.prototype.fromAddress=function(t){if("string"==typeof t&&(t=R.fromString(t)),a(t instanceof R,"Not an address."),t.isPubkeyhash())return this.fromPubkeyhash(t.hash);if(t.isScripthash())return this.fromScripthash(t.hash);if(t.isProgram())return this.fromProgram(t.version,t.hash);throw new Error("Unknown address type.")},n.fromAddress=function(t){return(new n).fromAddress(t)},n.prototype.fromCommitment=function(t,e){const i=new m(36);return i.writeU32BE(2854332909),i.writeHash(t),this.clear(),this.pushOp(x.OP_RETURN),this.pushData(i.render()),e&&this.pushData(e),this.compile()},n.fromCommitment=function(t,e){return(new n).fromCommitment(t,e)},n.prototype.getRedeem=function(){let t=null;for(const e of this.code){if(-1===e.value)return null;if(e.value>x.OP_16)return null;t=e.data}return t?n.fromRaw(t):null},n.prototype.getType=function(){return this.isPubkey()?_.PUBKEY:this.isPubkeyhash()?_.PUBKEYHASH:this.isScripthash()?_.SCRIPTHASH:this.isWitnessPubkeyhash()?_.WITNESSPUBKEYHASH:this.isWitnessScripthash()?_.WITNESSSCRIPTHASH:this.isWitnessMasthash()?_.WITNESSMASTHASH:this.isMultisig()?_.MULTISIG:this.isNulldata()?_.NULLDATA:_.NONSTANDARD},n.prototype.isUnknown=function(){return this.getType()===_.NONSTANDARD},n.prototype.isStandard=function(){const[t,e]=this.getMultisig();return-1!==t?!(e<1||e>3)&&!(t<1||t>e):this.isNulldata()?this.raw.length<=c.MAX_OP_RETURN_BYTES:this.getType()!==_.NONSTANDARD},n.prototype.getSize=function(){return this.raw.length},n.prototype.getVarSize=function(){return S.sizeVarBytes(this.raw)},n.prototype.getInputAddress=function(){return R.fromInputScript(this)},n.prototype.getAddress=function(){return R.fromScript(this)},n.prototype.hash160=function(t){let e=f.hash160(this.toRaw());return"hex"===t&&(e=e.toString("hex")),e},n.prototype.sha256=function(t){let e=f.sha256(this.toRaw());return"hex"===t&&(e=e.toString("hex")),e},n.prototype.isPubkey=function(t){if(t)return this.raw.length>=35&&(33===this.raw[0]||65===this.raw[0])&&this.raw[0]+2===this.raw.length&&this.raw[this.raw.length-1]===x.OP_CHECKSIG;if(2!==this.code.length)return!1;const e=this.getLength(0);return(33===e||65===e)&&this.getOp(1)===x.OP_CHECKSIG},n.prototype.getPubkey=function(t){return this.isPubkey(t)?t?this.raw.slice(1,1+this.raw[0]):this.getData(0):null},n.prototype.isPubkeyhash=function(t){return t||25===this.raw.length?25===this.raw.length&&this.raw[0]===x.OP_DUP&&this.raw[1]===x.OP_HASH160&&20===this.raw[2]&&this.raw[23]===x.OP_EQUALVERIFY&&this.raw[24]===x.OP_CHECKSIG:5===this.code.length&&(this.getOp(0)===x.OP_DUP&&this.getOp(1)===x.OP_HASH160&&20===this.getLength(2)&&this.getOp(3)===x.OP_EQUALVERIFY&&this.getOp(4)===x.OP_CHECKSIG)},n.prototype.getPubkeyhash=function(t){return this.isPubkeyhash(t)?t?this.raw.slice(3,23):this.getData(2):null},n.prototype.isMultisig=function(t){if(this.code.length<4||this.code.length>19)return!1;if(this.getOp(-1)!==x.OP_CHECKMULTISIG)return!1;const e=this.getSmall(0);if(e<1)return!1;const i=this.getSmall(-2);if(i<1||e>i)return!1;if(this.code.length!==i+3)return!1;for(let e=1;e<i+1;e++){const i=this.code[e],n=i.toLength();if(33!==n&&65!==n)return!1;if(t&&!i.isMinimal())return!1}return!0},n.prototype.getMultisig=function(t){return this.isMultisig(t)?[this.getSmall(0),this.getSmall(-2)]:[-1,-1]},n.prototype.isScripthash=function(){return 23===this.raw.length&&this.raw[0]===x.OP_HASH160&&20===this.raw[1]&&this.raw[22]===x.OP_EQUAL},n.prototype.getScripthash=function(){return this.isScripthash()?this.getData(1):null},n.prototype.isNulldata=function(t){if(0===this.code.length)return!1;if(this.getOp(0)!==x.OP_RETURN)return!1;if(1===this.code.length)return!0;if(t&&this.raw.length>c.MAX_OP_RETURN_BYTES)return!1;for(let e=1;e<this.code.length;e++){const i=this.code[e];if(-1===i.value)return!1;if(i.value>x.OP_16)return!1;if(t&&!i.isMinimal())return!1}return!0},n.prototype.getNulldata=function(t){if(!this.isNulldata(t))return null;for(let t=1;t<this.code.length;t++){const e=this.code[t].toPush();if(e)return e}return A},n.prototype.isCommitment=function(){return this.raw.length>=38&&this.raw[0]===x.OP_RETURN&&36===this.raw[1]&&2854332909===this.raw.readUInt32BE(2,!0)},n.prototype.getCommitment=function(){return this.isCommitment()?this.raw.slice(6,38):null},n.prototype.isProgram=function(){return!(this.raw.length<4||this.raw.length>42)&&((this.raw[0]===x.OP_0||!(this.raw[0]<x.OP_1||this.raw[0]>x.OP_16))&&this.raw[1]+2===this.raw.length)},n.prototype.getProgram=function(){if(!this.isProgram())return null;const t=this.getSmall(0),e=this.getData(1);return new g(t,e)},n.prototype.forWitness=function(){if(this.isProgram())return this.clone();const t=this.getPubkey();if(t){const e=f.hash160(t);return n.fromProgram(0,e)}const e=this.getPubkeyhash();return n.fromProgram(0,e||this.sha256())},n.prototype.isWitnessPubkeyhash=function(){return 22===this.raw.length&&this.raw[0]===x.OP_0&&20===this.raw[1]},n.prototype.getWitnessPubkeyhash=function(){return this.isWitnessPubkeyhash()?this.getData(1):null},n.prototype.isWitnessScripthash=function(){return 34===this.raw.length&&this.raw[0]===x.OP_0&&32===this.raw[1]},n.prototype.getWitnessScripthash=function(){return this.isWitnessScripthash()?this.getData(1):null},n.prototype.isWitnessMasthash=function(){return 34===this.raw.length&&this.raw[0]===x.OP_1&&32===this.raw[1]},n.prototype.getWitnessMasthash=function(){return this.isWitnessMasthash()?this.getData(1):null},n.prototype.isUnspendable=function(){return this.raw.length>h.MAX_SCRIPT_SIZE||this.raw.length>0&&this.raw[0]===x.OP_RETURN},n.prototype.getInputType=function(){return this.isPubkeyInput()?_.PUBKEY:this.isPubkeyhashInput()?_.PUBKEYHASH:this.isScripthashInput()?_.SCRIPTHASH:this.isMultisigInput()?_.MULTISIG:_.NONSTANDARD},n.prototype.getInputTypeVal=function(){return this.isPubkeyInput()?I[_.PUBKEY]:this.isPubkeyhashInput()?I[_.PUBKEYHASH]:this.isScripthashInput()?I[_.SCRIPTHASH]:this.isMultisigInput()?I[_.MULTISIG]:I[_.NONSTANDARD]},n.prototype.isUnknownInput=function(){return this.getInputType()===_.NONSTANDARD},n.prototype.isPubkeyInput=function(){if(1!==this.code.length)return!1;const t=this.getLength(0);return t>=9&&t<=73},n.prototype.getPubkeyInput=function(){return this.isPubkeyInput()?this.getData(0):null},n.prototype.isPubkeyhashInput=function(){if(2!==this.code.length)return!1;const t=this.getLength(0),e=this.getLength(1);return t>=9&&t<=73&&(33===e||65===e)},n.prototype.getPubkeyhashInput=function(){return this.isPubkeyhashInput()?[this.getData(0),this.getData(1)]:[null,null]},n.prototype.isMultisigInput=function(){if(this.code.length<2)return!1;if(this.getOp(0)!==x.OP_0)return!1;if(this.getOp(1)>x.OP_PUSHDATA4)return!1;if(this.isScripthashInput())return!1;for(let t=1;t<this.code.length;t++){const e=this.getLength(t);if(e<9||e>73)return!1}return!0},n.prototype.getMultisigInput=function(){if(!this.isMultisigInput())return null;const t=[];for(let e=1;e<this.code.length;e++)t.push(this.getData(e));return t},n.prototype.isScripthashInput=function(){if(this.code.length<2)return!1;const t=this.getData(-1);if(!t)return!1;if(0===t.length)return!1;if(k.isSignatureEncoding(t))return!1;if(k.isKeyEncoding(t))return!1;const e=n.fromRaw(t);return!!e.isCode()&&(!e.isUnspendable()&&!!this.isPushOnly())},n.prototype.getScripthashInput=function(){return this.isScripthashInput()?this.getData(-1):null},n.prototype.getCoinbaseHeight=function(){return n.getCoinbaseHeight(this.raw)},n.getCoinbaseHeight=function(t){if(0===t.length)return-1;if(t[0]>=x.OP_1&&t[0]<=x.OP_16)return t[0]-80;if(t[0]>6)return-1;const e=y.fromRaw(t),i=e.toNum();return i?i.isNeg()?-1:e.equals(y.fromNum(i))?i.toDouble():-1:1},n.prototype.test=function(t){for(const e of this.code){if(-1===e.value)break;if(e.data&&0!==e.data.length&&t.test(e.data))return!0}return!1},n.prototype.isPushOnly=function(){for(const t of this.code){if(-1===t.value)return!1;if(t.value>x.OP_16)return!1}return!0},n.prototype.getSigops=function(t){let e=0,i=-1;for(const n of this.code){if(-1===n.value)break;switch(n.value){case x.OP_CHECKSIG:case x.OP_CHECKSIGVERIFY:e+=1;break;case x.OP_CHECKMULTISIG:case x.OP_CHECKMULTISIGVERIFY:t&&i>=x.OP_1&&i<=x.OP_16?e+=i-80:e+=h.MAX_MULTISIG_PUBKEYS}i=n.value}return e},n.prototype.getScripthashSigops=function(t){if(!this.isScripthash())return this.getSigops(!0);const e=t.getRedeem();return e?e.getSigops(!0):0},n.prototype.getWitnessSigops=function(t,e){let i=this.getProgram();if(!i&&this.isScripthash()){const e=t.getRedeem();e&&(i=e.getProgram())}if(!i)return 0;if(0===i.version){if(20===i.data.length)return 1;if(32===i.data.length&&e.items.length>0){return e.getRedeem().getSigops(!0)}}return 0},n.prototype.get=function(t){return t<0&&(t+=this.code.length),t<0||t>=this.code.length?null:this.code[t]},n.prototype.pop=function(){return this.code.pop()||null},n.prototype.shift=function(){return this.code.shift()||null},n.prototype.remove=function(t){if(t<0&&(t+=this.code.length),t<0||t>=this.code.length)return null;const e=this.code.splice(t,1);return 0===e.length?null:e[0]},n.prototype.set=function(t,e){return t<0&&(t+=this.code.length),a(y.isOpcode(e)),a(t>=0&&t<=this.code.length),this.code[t]=e,this},n.prototype.push=function(t){return a(y.isOpcode(t)),this.code.push(t),this},n.prototype.unshift=function(t){return a(y.isOpcode(t)),this.code.unshift(t),this},n.prototype.insert=function(t,e){return t<0&&(t+=this.code.length),a(y.isOpcode(e)),a(t>=0&&t<=this.code.length),this.code.splice(t,0,e),this},n.prototype.getOp=function(t){const e=this.get(t);return e?e.value:-1},n.prototype.popOp=function(){const t=this.pop();return t?t.value:-1},n.prototype.shiftOp=function(){const t=this.shift();return t?t.value:-1},n.prototype.removeOp=function(t){const e=this.remove(t);return e?e.value:-1},n.prototype.setOp=function(t,e){return this.set(t,y.fromOp(e))},n.prototype.pushOp=function(t){return this.push(y.fromOp(t))},n.prototype.unshiftOp=function(t){return this.unshift(y.fromOp(t))},n.prototype.insertOp=function(t,e){return this.insert(t,y.fromOp(e))},n.prototype.getData=function(t){const e=this.get(t);return e?e.data:null},n.prototype.popData=function(){const t=this.pop();return t?t.data:null},n.prototype.shiftData=function(){const t=this.shift();return t?t.data:null},n.prototype.removeData=function(t){const e=this.remove(t);return e?e.data:null},n.prototype.setData=function(t,e){return this.set(t,y.fromData(e))},n.prototype.pushData=function(t){return this.push(y.fromData(t))},n.prototype.unshiftData=function(t){return this.unshift(y.fromData(t))},n.prototype.insertData=function(t,e){return this.insert(t,y.fromData(e))},n.prototype.getLength=function(t){const e=this.get(t);return e?e.toLength():-1},n.prototype.getPush=function(t){const e=this.get(t);return e?e.toPush():null},n.prototype.popPush=function(){const t=this.pop();return t?t.toPush():null},n.prototype.shiftPush=function(){const t=this.shift();return t?t.toPush():null},n.prototype.removePush=function(t){const e=this.remove(t);return e?e.toPush():null},n.prototype.setPush=function(t,e){return this.set(t,y.fromPush(e))},n.prototype.pushPush=function(t){return this.push(y.fromPush(t))},n.prototype.unshiftPush=function(t){return this.unshift(y.fromPush(t))},n.prototype.insertPush=function(t,e){return this.insert(t,y.fromPush(e))},n.prototype.getString=function(t,e){const i=this.get(t);return i?i.toString(e):null},n.prototype.popString=function(t){const e=this.pop();return e?e.toString(t):null},n.prototype.shiftString=function(t){const e=this.shift();return e?e.toString(t):null},n.prototype.removeString=function(t,e){const i=this.remove(t);return i?i.toString(e):null},n.prototype.setString=function(t,e,i){return this.set(t,y.fromString(e,i))},n.prototype.pushString=function(t,e){return this.push(y.fromString(t,e))},n.prototype.unshiftString=function(t,e){return this.unshift(y.fromString(t,e))},n.prototype.insertString=function(t,e,i){return this.insert(t,y.fromString(e,i))},n.prototype.getSmall=function(t){const e=this.get(t);return e?e.toSmall():-1},n.prototype.popSmall=function(){const t=this.pop();return t?t.toSmall():-1},n.prototype.shiftSmall=function(){const t=this.shift();return t?t.toSmall():-1},n.prototype.removeSmall=function(t){const e=this.remove(t);return e?e.toSmall():-1},n.prototype.setSmall=function(t,e){return this.set(t,y.fromSmall(e))},n.prototype.pushSmall=function(t){return this.push(y.fromSmall(t))},n.prototype.unshiftSmall=function(t){return this.unshift(y.fromSmall(t))},n.prototype.insertSmall=function(t,e){return this.insert(t,y.fromSmall(e))},n.prototype.getNum=function(t,e,i){const n=this.get(t);return n?n.toNum(e,i):null},n.prototype.popNum=function(t,e){const i=this.pop();return i?i.toNum(t,e):null},n.prototype.shiftNum=function(t,e){const i=this.shift();return i?i.toNum(t,e):null},n.prototype.removeNum=function(t,e,i){const n=this.remove(t);return n?n.toNum(e,i):null},n.prototype.setNum=function(t,e){return this.set(t,y.fromNum(e))},n.prototype.pushNum=function(t){return this.push(y.fromNum(t))},n.prototype.unshiftNum=function(t){return this.unshift(y.fromNum(t))},n.prototype.insertNum=function(t,e){return this.insert(t,y.fromNum(e))},n.prototype.getInt=function(t,e,i){const n=this.get(t);return n?n.toInt(e,i):-1},n.prototype.popInt=function(t,e){const i=this.pop();return i?i.toInt(t,e):-1},n.prototype.shiftInt=function(t,e){const i=this.shift();return i?i.toInt(t,e):-1},n.prototype.removeInt=function(t,e,i){const n=this.remove(t);return n?n.toInt(e,i):-1},n.prototype.setInt=function(t,e){return this.set(t,y.fromInt(e))},n.prototype.pushInt=function(t){return this.push(y.fromInt(t))},n.prototype.unshiftInt=function(t){return this.unshift(y.fromInt(t))},n.prototype.insertInt=function(t,e){return this.insert(t,y.fromInt(e))},n.prototype.getBool=function(t){const e=this.get(t);return!!e&&e.toBool()},n.prototype.popBool=function(){const t=this.pop();return!!t&&t.toBool()},n.prototype.shiftBool=function(){const t=this.shift();return!!t&&t.toBool()},n.prototype.removeBool=function(t){const e=this.remove(t);return!!e&&e.toBool()},n.prototype.setBool=function(t,e){return this.set(t,y.fromBool(e))},n.prototype.pushBool=function(t){return this.push(y.fromBool(t))},n.prototype.unshiftBool=function(t){return this.unshift(y.fromBool(t))},n.prototype.insertBool=function(t,e){return this.insert(t,y.fromBool(e))},n.prototype.getSym=function(t){const e=this.get(t);return e?e.toSymbol():null},n.prototype.popSym=function(){const t=this.pop();return t?t.toSymbol():null},n.prototype.shiftSym=function(){const t=this.shift();return t?t.toSymbol():null},n.prototype.removeSym=function(t){const e=this.remove(t);return e?e.toSymbol():null},n.prototype.setSym=function(t,e){return this.set(t,y.fromSymbol(e))},n.prototype.pushSym=function(t){return this.push(y.fromSymbol(t))},n.prototype.unshiftSym=function(t){return this.unshift(y.fromSymbol(t))},n.prototype.insertSym=function(t,e){return this.insert(t,y.fromSymbol(e))},n.prototype.fromString=function(t){if(a("string"==typeof t),0===(t=t.trim()).length)return this;const e=t.split(/\s+/),i=new p;for(const t of e){let e=t;u.isUpperCase(e)||(e=e.toUpperCase()),u.startsWith(e,"OP_")||(e=`OP_${e}`);const n=x[e];if(null!=n)i.writeU8(n);else{if("'"===t[0]){a("'"===t[t.length-1],"Invalid string.");const e=t.slice(1,-1),n=y.fromString(e);i.writeBytes(n.toRaw());continue}if(/^-?\d+$/.test(t)){const e=v.fromString(t,10),n=y.fromNum(e);i.writeBytes(n.toRaw());continue}a(0===t.indexOf("0x"),"Unknown opcode.");const e=t.substring(2),n=Buffer.from(e,"hex");a(n.length===e.length/2,"Invalid hex string."),i.writeBytes(n)}}return this.fromRaw(i.render())},n.fromString=function(t){return(new n).fromString(t)},n.verify=function(t,e,i,r,s,o,h){if(null==h&&(h=n.flags.STANDARD_VERIFY_FLAGS),h&n.flags.VERIFY_SIGPUSHONLY&&!t.isPushOnly())throw new b("SIG_PUSHONLY");let c=new w;t.execute(c,h,r,s,o,0);let u;if(h&n.flags.VERIFY_P2SH&&(u=c.clone()),i.execute(c,h,r,s,o,0),0===c.length||!c.getBool(-1))throw new b("EVAL_FALSE");let f=!1;if(h&n.flags.VERIFY_WITNESS&&i.isProgram()){if(f=!0,0!==t.raw.length)throw new b("WITNESS_MALLEATED");n.verifyProgram(e,i,h,r,s,o),c.length=1}if(h&n.flags.VERIFY_P2SH&&i.isScripthash()){if(!t.isPushOnly())throw new b("SIG_PUSHONLY");if(0===(c=u).length)throw new b("EVAL_FALSE");const i=c.pop(),a=n.fromRaw(i);if(a.execute(c,h,r,s,o,0),0===c.length||!c.getBool(-1))throw new b("EVAL_FALSE");if(h&n.flags.VERIFY_WITNESS&&a.isProgram()){if(f=!0,!t.raw.equals(y.fromPush(i).toRaw()))throw new b("WITNESS_MALLEATED_P2SH");n.verifyProgram(e,a,h,r,s,o),c.length=1}}if(h&n.flags.VERIFY_CLEANSTACK&&(a(0!=(h&n.flags.VERIFY_P2SH)),1!==c.length))throw new b("CLEANSTACK");if(h&n.flags.VERIFY_WITNESS&&(a(0!=(h&n.flags.VERIFY_P2SH)),!f&&e.items.length>0))throw new b("WITNESS_UNEXPECTED")},n.verifyProgram=function(t,e,i,r,s,o){const c=e.getProgram();a(c,"verifyProgram called on non-witness-program."),a(0!=(i&n.flags.VERIFY_WITNESS));const u=t.toStack();let l;if(0===c.version){if(32===c.data.length){if(0===u.length)throw new b("WITNESS_PROGRAM_WITNESS_EMPTY");const t=u.pop();if(!f.sha256(t).equals(c.data))throw new b("WITNESS_PROGRAM_MISMATCH");l=n.fromRaw(t)}else{if(20!==c.data.length)throw new b("WITNESS_PROGRAM_WRONG_LENGTH");if(2!==u.length)throw new b("WITNESS_PROGRAM_MISMATCH");l=n.fromPubkeyhash(c.data)}for(let t=0;t<u.length;t++)if(u.get(t).length>h.MAX_SCRIPT_PUSH)throw new b("PUSH_SIZE");if(l.execute(u,i,r,s,o,1),1!==u.length||!u.getBool(-1))throw new b("EVAL_FALSE")}else{if(i&n.flags.VERIFY_MAST&&1===c.version)return void n.verifyMast(c,u,e,i,r,s);if(i&n.flags.VERIFY_DISCOURAGE_UPGRADABLE_WITNESS_PROGRAM)throw new b("DISCOURAGE_UPGRADABLE_WITNESS_PROGRAM")}},n.verifyMast=function(t,e,i,r,s,o,c){if(a(1===t.version),a(0!=(r&n.flags.VERIFY_MAST)),e.length<4)throw new b("INVALID_MAST_STACK");const u=e.get(-1);if(u.length<1||u.length>5)throw new b("INVALID_MAST_STACK");const d=u[0];if(0===d||e.length<d+3)throw new b("INVALID_MAST_STACK");let m=d,g=new p;if(g.writeU8(d),0===u[u.length-1])throw new b("INVALID_MAST_STACK");let y=0;for(let t=1;t<u.length;t++)y|=u[t]<<8*(t-1);if(y<0&&(y+=4294967296),y>0&&r&n.flags.DISCOURAGE_UPGRADABLE_WITNESS_PROGRAM)throw new b("DISCOURAGE_UPGRADABLE_WITNESS_PROGRAM");let w=new p;w.writeU32(y);const v=e.get(-2);if(31&v.length)throw new b("INVALID_MAST_STACK");const k=v.length>>>5;if(k>32)throw new b("INVALID_MAST_STACK");if(m+=k,0===y&&m>h.MAX_SCRIPT_OPS)throw new b("OP_COUNT");const S=[];for(let t=0;t<k;t++)S.push(v.slice(32*t,32*t+32));const E=e.get(-3);if(E.length>4)throw new b("INVALID_MAST_STACK");let R=0;if(E.length>0){if(0===E[E.length-1])throw new b("INVALID_MAST_STACK");for(let t=0;t<E.length;t++)R|=E[t]<<8*t;R<0&&(R+=4294967296)}if(k<32&&R>=1<<k>>>0)throw new b("INVALID_MAST_STACK");let x=new p;x.writeBytes(i.raw);for(let t=0;t<d;t++){const i=e.get(-(4+t));if(0===y&&x.offset+i.length>h.MAX_SCRIPT_SIZE)throw new b("SCRIPT_SIZE");g.writeBytes(f.hash256(i)),x.writeBytes(i)}if(g=f.hash256(g.render()),g=l.verifyBranch(g,S,R),w.writeBytes(g),!(w=f.hash256(w.render())).equals(t.data))throw new b("WITNESS_PROGRAM_MISMATCH");if(0===y){e.length-=3+d;for(let t=0;t<e.length;t++)if(e.get(t).length>h.MAX_SCRIPT_PUSH)throw new b("PUSH_SIZE");if(x=x.render(),(i=n.fromRaw(x)).execute(e,r,s,o,c,1),0!==e.length)throw new b("EVAL_FALSE")}},n.prototype.fromReader=function(t){return this.fromRaw(t.readVarBytes())},n.prototype.fromRaw=function(t){const e=new d(t,!0);for(this.raw=t;e.left();)this.code.push(y.fromReader(e));return this},n.fromReader=function(t){return(new n).fromReader(t)},n.fromRaw=function(t,e){return"string"==typeof t&&(t=Buffer.from(t,e)),(new n).fromRaw(t)},n.isScript=function(t){return t instanceof n},t.exports=n},function(t,e,i){"use strict";var n=e;n.version=i(137).version,n.utils=i(138),n.rand=i(139),n.curve=i(38),n.curves=i(145),n.ec=i(153),n.eddsa=i(156)},function(t,e){t.exports=require("events")},function(t,e,i){"use strict";function n(t){if(!(this instanceof n))return new n(t);this.hash=o.ZERO_HASH160,this.type=n.types.PUBKEYHASH,this.version=-1,this.network=s.primary,t&&this.fromOptions(t)}const r=i(0),s=i(6),o=i(3),a=i(1),h=i(5),c=i(2),u=i(4),f=i(25),l=i(100);n.types={PUBKEYHASH:2,SCRIPTHASH:3,WITNESS:4},n.typesByVal=a.reverse(n.types),n.scriptTypes={NONSTANDARD:0,PUBKEYHASH:2,SCRIPTHASH:3,WITNESSSCRIPTHASH:129,WITNESSPUBKEYHASH:130,WITNESSMASTHASH:131},n.scriptTypesByVal=a.reverse(n.scriptTypes),n.prototype.fromOptions=function(t){return"string"==typeof t?this.fromString(t):this.fromHash(t.hash,t.type,t.version,t.network)},n.fromOptions=function(t){return(new n).fromOptions(t)},n.prototype.getHash=function(t){return"hex"===t?this.hash.toString(t):this.hash},n.prototype.isNull=function(){if(20===this.hash.length)return this.hash.equals(o.ZERO_HASH160);if(32===this.hash.length)return this.hash.equals(o.ZERO_HASH);for(let t=0;t<this.hash.length;t++)if(0!==this.hash[t])return!1;return!0},n.prototype.equals=function(t){return r(t instanceof n),this.network===t.network&&this.type===t.type&&this.version===t.version&&this.hash.equals(t.hash)},n.prototype.getType=function(){return n.typesByVal[this.type].toLowerCase()},n.prototype.getScriptType=function(){return this.isPubkeyhash()?n.scriptTypes.PUBKEYHASH:this.isScripthash()?n.scriptTypes.SCRIPTHASH:this.isWitnessPubkeyhash()?n.scriptTypes.WITNESSPUBKEYHASH:this.isWitnessScripthash()?n.scriptTypes.WITNESSSCRIPTHASH:this.isWitnessMasthash()?n.scriptTypes.WITNESSMASTHASH:n.scriptTypes.NONSTANDARD},n.prototype.getPrefix=function(t){t||(t=this.network);const e=(t=s.get(t)).addressPrefix;switch(this.type){case n.types.PUBKEYHASH:return e.pubkeyhash;case n.types.SCRIPTHASH:return e.scripthash;case n.types.WITNESS:if(20===this.hash.length)return e.witnesspubkeyhash;if(32===this.hash.length)return e.witnessscripthash}return-1},n.prototype.getSize=function(){let t=5+this.hash.length;return-1!==this.version&&(t+=2),t},n.prototype.toRaw=function(t){const e=this.getSize(),i=new u(e),n=this.getPrefix(t);return r(-1!==n,"Not a valid address prefix."),i.writeU8(n),-1!==this.version&&(i.writeU8(this.version),i.writeU8(0)),i.writeBytes(this.hash),i.writeChecksum(),i.render()},n.prototype.toBase58=function(t){return f.encode(this.toRaw(t))},n.prototype.toBech32=function(t){const e=this.version,i=this.hash;r(-1!==e,"Cannot convert non-program address to bech32."),t||(t=this.network);const n=(t=s.get(t)).addressPrefix.bech32;return l.encode(n,e,i)},n.prototype.fromString=function(t,e){if(r("string"==typeof t),r(t.length>0),r(t.length<=100),function(t){let e=!1,i=!1;for(let n=0;n<t.length;n++){const s=t.charCodeAt(n);if(!(s>=48&&s<=57)&&(32&s?(r(s>=97&&s<=122),e=!0):(r(s>=65&&s<=90),i=!0),e&&i))return!0}return!1}(t))return this.fromBase58(t,e);try{return this.fromBech32(t,e)}catch(i){return this.fromBase58(t,e)}},n.fromString=function(t,e){return(new n).fromString(t,e)},n.prototype.toString=function(t){return-1!==this.version?this.toBech32(t):this.toBase58(t)},n.prototype.inspect=function(){return"<Address:"+` type=${this.getType()}`+` version=${this.version}`+` str=${this.toString()}`+">"},n.prototype.fromRaw=function(t,e){const i=new c(t,!0);if(t.length>40)throw new Error("Address is too long.");const r=i.readU8();e=s.fromAddress(r,e);const o=n.getType(r,e);let a=-1;if(t.length>25&&(a=i.readU8(),0!==i.readU8()))throw new Error("Address version padding is non-zero.");const h=i.readBytes(i.left()-4);return i.verifyChecksum(),this.fromHash(h,o,a,e)},n.fromRaw=function(t,e){return(new n).fromRaw(t,e)},n.prototype.fromBase58=function(t,e){if(r("string"==typeof t),t.length>55)throw new Error("Address is too long.");return this.fromRaw(f.decode(t),e)},n.fromBase58=function(t,e){return(new n).fromBase58(t,e)},n.prototype.fromBech32=function(t,e){const i=n.types.WITNESS;r("string"==typeof t);const o=l.decode(t);return e=s.fromBech32(o.hrp,e),this.fromHash(o.hash,i,o.version,e)},n.fromBech32=function(t,e){return(new n).fromBech32(t,e)},n.prototype.fromScript=function(t){const e=t.getPubkey();if(e)return this.hash=h.hash160(e),this.type=n.types.PUBKEYHASH,this.version=-1,this;const i=t.getPubkeyhash();if(i)return this.hash=i,this.type=n.types.PUBKEYHASH,this.version=-1,this;const r=t.getScripthash();if(r)return this.hash=r,this.type=n.types.SCRIPTHASH,this.version=-1,this;const s=t.getProgram();return s&&!s.isMalformed()?(this.hash=s.data,this.type=n.types.WITNESS,this.version=s.version,this):t.isMultisig()?(this.hash=t.hash160(),this.type=n.types.SCRIPTHASH,this.version=-1,this):null},n.prototype.fromWitness=function(t){const[,e]=t.getPubkeyhashInput();if(e)return this.hash=h.hash160(e),this.type=n.types.WITNESS,this.version=0,this;const i=t.getScripthashInput();return i?(this.hash=h.sha256(i),this.type=n.types.WITNESS,this.version=0,this):null},n.prototype.fromInputScript=function(t){const[,e]=t.getPubkeyhashInput();if(e)return this.hash=h.hash160(e),this.type=n.types.PUBKEYHASH,this.version=-1,this;const i=t.getScripthashInput();return i?(this.hash=h.hash160(i),this.type=n.types.SCRIPTHASH,this.version=-1,this):null},n.fromWitness=function(t){return(new n).fromWitness(t)},n.fromInputScript=function(t){return(new n).fromInputScript(t)},n.fromScript=function(t){return(new n).fromScript(t)},n.prototype.fromHash=function(t,e,i,o){return"string"==typeof t&&(t=Buffer.from(t,"hex")),"string"==typeof e&&(e=n.types[e.toUpperCase()],r(null!=e,"Not a valid address type.")),null==e&&(e=n.types.PUBKEYHASH),null==i&&(i=-1),o=s.get(o),r(Buffer.isBuffer(t)),r(a.isU8(e)),r(a.isI8(i)),r(e>=n.types.PUBKEYHASH&&e<=n.types.WITNESS,"Not a valid address type."),-1===i?(r(e!==n.types.WITNESS,"Wrong version (witness)"),r(20===t.length,"Hash is the wrong size.")):(r(e===n.types.WITNESS,"Wrong version (non-witness)."),r(i>=0&&i<=16,"Bad program version."),0===i&&e===n.types.WITNESS&&r(20===t.length||32===t.length,"Witness program hash is the wrong size."),r(t.length>=2&&t.length<=40,"Hash is the wrong size.")),this.hash=t,this.type=e,this.version=i,this.network=o,this},n.fromHash=function(t,e,i,r){return(new n).fromHash(t,e,i,r)},n.prototype.fromPubkeyhash=function(t,e){const i=n.types.PUBKEYHASH;return r(20===t.length,"P2PKH must be 20 bytes."),this.fromHash(t,i,-1,e)},n.fromPubkeyhash=function(t,e){return(new n).fromPubkeyhash(t,e)},n.prototype.fromScripthash=function(t,e){const i=n.types.SCRIPTHASH;return r(t&&20===t.length,"P2SH must be 20 bytes."),this.fromHash(t,i,-1,e)},n.fromScripthash=function(t,e){return(new n).fromScripthash(t,e)},n.prototype.fromWitnessPubkeyhash=function(t,e){const i=n.types.WITNESS;return r(t&&20===t.length,"P2WPKH must be 20 bytes."),this.fromHash(t,i,0,e)},n.fromWitnessPubkeyhash=function(t,e){return(new n).fromWitnessPubkeyhash(t,e)},n.prototype.fromWitnessScripthash=function(t,e){const i=n.types.WITNESS;return r(t&&32===t.length,"P2WPKH must be 32 bytes."),this.fromHash(t,i,0,e)},n.fromWitnessScripthash=function(t,e){return(new n).fromWitnessScripthash(t,e)},n.prototype.fromProgram=function(t,e,i){const s=n.types.WITNESS;return r(t>=0,"Bad version for witness program."),"string"==typeof e&&(e=Buffer.from(e,"hex")),this.fromHash(e,s,t,i)},n.fromProgram=function(t,e,i){return(new n).fromProgram(t,e,i)},n.prototype.isPubkeyhash=function(){return this.type===n.types.PUBKEYHASH},n.prototype.isScripthash=function(){return this.type===n.types.SCRIPTHASH},n.prototype.isWitnessPubkeyhash=function(){return 0===this.version&&20===this.hash.length},n.prototype.isWitnessScripthash=function(){return 0===this.version&&32===this.hash.length},n.prototype.isWitnessMasthash=function(){return 1===this.version&&32===this.hash.length},n.prototype.isProgram=function(){return-1!==this.version},n.prototype.isUnknown=function(){return-1!==this.version&&(this.version>0||20!==this.hash.length&&32!==this.hash.length)},n.getHash=function(t,e,i){if(!t)throw new Error("Object is not an address.");let r;if("string"==typeof t){if(40===t.length||64===t.length)return"hex"===e?t:Buffer.from(t,"hex");r=n.fromString(t,i).hash}else if(Buffer.isBuffer(t)){if(20!==t.length&&32!==t.length)throw new Error("Object is not an address.");r=t}else{if(!(t instanceof n))throw new Error("Object is not an address.");if(r=t.hash,i&&(i=s.get(i),t.network!==i))throw new Error("Network mismatch for address.")}return"hex"===e?r.toString("hex"):r},n.getType=function(t,e){const i=e.addressPrefix;switch(t){case i.pubkeyhash:return n.types.PUBKEYHASH;case i.scripthash:return n.types.SCRIPTHASH;case i.witnesspubkeyhash:case i.witnessscripthash:return n.types.WITNESS;default:throw new Error("Unknown address prefix.")}},t.exports=n},function(t,e,i){"use strict";let n;if(1!==Number(process.env.WMCC_NO_SECP256K1))try{n=i(!function(){var t=new Error('Cannot find module "secp256k1/bindings"');throw t.code="MODULE_NOT_FOUND",t}())}catch(t){}t.exports=i(n?134:136)},function(t,e,i){"use strict";function n(t){if(!(this instanceof n))return new n(t);this.value=0,this.script=new c,t&&this.fromOptions(t)}const r=i(0),s=i(1),o=i(20),a=i(6),h=i(11),c=i(8),u=i(4),f=i(2),l=i(7),p=i(19);n.prototype.fromOptions=function(t){return r(t,"Output data is required."),t.value&&(r(s.isU64(t.value),"Value must be a uint64."),this.value=t.value),t.script&&this.script.fromOptions(t.script),t.address&&this.script.fromAddress(t.address),this},n.fromOptions=function(t){return(new n).fromOptions(t)},n.prototype.fromScript=function(t,e){return"string"==typeof t&&(t=h.fromString(t)),t instanceof h&&(t=c.fromAddress(t)),r(t instanceof c,"Script must be a Script."),r(s.isU64(e),"Value must be a uint64."),this.script=t,this.value=e,this},n.fromScript=function(t,e){return(new n).fromScript(t,e)},n.prototype.clone=function(){const t=new n;return t.value=this.value,t.script.inject(this.script),t},n.prototype.equals=function(t){return r(n.isOutput(t)),this.value===t.value&&this.script.equals(t.script)},n.prototype.compare=function(t){r(n.isOutput(t));const e=this.value-t.value;return 0!==e?e:this.script.compare(t.script)},n.prototype.getType=function(){return c.typesByVal[this.script.getType()].toLowerCase()},n.prototype.getAddress=function(){return this.script.getAddress()},n.prototype.getHash=function(t){const e=this.getAddress();return e?e.getHash(t):null},n.prototype.inspect=function(){return{type:this.getType(),value:o.wmcc(this.value),script:this.script,address:this.getAddress()}},n.prototype.toJSON=function(){return this.getJSON()},n.prototype.getJSON=function(t){let e=this.getAddress();return t=a.get(t),e&&(e=e.toString(t)),{value:this.value,script:this.script.toJSON(),address:e}},n.prototype.getDustThreshold=function(t){const e=l.WITNESS_SCALE_FACTOR;if(this.script.isUnspendable())return 0;let i=this.getSize();return this.script.isProgram()?i+=37+(107/e|0)+4:i+=148,3*p.getMinFee(i,t)},n.prototype.getSize=function(){return 8+this.script.getVarSize()},n.prototype.isDust=function(t){return this.value<this.getDustThreshold(t)},n.prototype.fromJSON=function(t){return r(t,"Output data is required."),r(s.isU64(t.value),"Value must be a uint64."),this.value=t.value,this.script.fromJSON(t.script),this},n.fromJSON=function(t){return(new n).fromJSON(t)},n.prototype.toWriter=function(t){return t.writeI64(this.value),t.writeVarBytes(this.script.toRaw()),t},n.prototype.toRaw=function(){const t=this.getSize();return this.toWriter(new u(t)).render()},n.prototype.fromReader=function(t){return this.value=t.readI64(),this.script.fromRaw(t.readVarBytes()),this},n.prototype.fromRaw=function(t){return this.fromReader(new f(t))},n.fromReader=function(t){return(new n).fromReader(t)},n.fromRaw=function(t,e){return"string"==typeof t&&(t=Buffer.from(t,e)),(new n).fromRaw(t)},n.isOutput=function(t){return t instanceof n},t.exports=n},function(t,e,i){"use strict";function n(t){return(t>>>24|t>>>8&65280|t<<8&16711680|(255&t)<<24)>>>0}function r(t){return 1===t.length?"0"+t:t}function s(t){return 7===t.length?"0"+t:6===t.length?"00"+t:5===t.length?"000"+t:4===t.length?"0000"+t:3===t.length?"00000"+t:2===t.length?"000000"+t:1===t.length?"0000000"+t:t}var o=i(22),a=i(39);e.inherits=a,e.toArray=function(t,e){if(Array.isArray(t))return t.slice();if(!t)return[];var i=[];if("string"==typeof t)if(e){if("hex"===e)for((t=t.replace(/[^a-z0-9]+/gi,"")).length%2!=0&&(t="0"+t),n=0;n<t.length;n+=2)i.push(parseInt(t[n]+t[n+1],16))}else for(var n=0;n<t.length;n++){var r=t.charCodeAt(n),s=r>>8,o=255&r;s?i.push(s,o):i.push(o)}else for(n=0;n<t.length;n++)i[n]=0|t[n];return i},e.toHex=function(t){for(var e="",i=0;i<t.length;i++)e+=r(t[i].toString(16));return e},e.htonl=n,e.toHex32=function(t,e){for(var i="",r=0;r<t.length;r++){var o=t[r];"little"===e&&(o=n(o)),i+=s(o.toString(16))}return i},e.zero2=r,e.zero8=s,e.join32=function(t,e,i,n){var r=i-e;o(r%4==0);for(var s=new Array(r/4),a=0,h=e;a<s.length;a++,h+=4){var c;c="big"===n?t[h]<<24|t[h+1]<<16|t[h+2]<<8|t[h+3]:t[h+3]<<24|t[h+2]<<16|t[h+1]<<8|t[h],s[a]=c>>>0}return s},e.split32=function(t,e){for(var i=new Array(4*t.length),n=0,r=0;n<t.length;n++,r+=4){var s=t[n];"big"===e?(i[r]=s>>>24,i[r+1]=s>>>16&255,i[r+2]=s>>>8&255,i[r+3]=255&s):(i[r+3]=s>>>24,i[r+2]=s>>>16&255,i[r+1]=s>>>8&255,i[r]=255&s)}return i},e.rotr32=function(t,e){return t>>>e|t<<32-e},e.rotl32=function(t,e){return t<<e|t>>>32-e},e.sum32=function(t,e){return t+e>>>0},e.sum32_3=function(t,e,i){return t+e+i>>>0},e.sum32_4=function(t,e,i,n){return t+e+i+n>>>0},e.sum32_5=function(t,e,i,n,r){return t+e+i+n+r>>>0},e.sum64=function(t,e,i,n){var r=t[e],s=n+t[e+1]>>>0,o=(s<n?1:0)+i+r;t[e]=o>>>0,t[e+1]=s},e.sum64_hi=function(t,e,i,n){return(e+n>>>0<e?1:0)+t+i>>>0},e.sum64_lo=function(t,e,i,n){return e+n>>>0},e.sum64_4_hi=function(t,e,i,n,r,s,o,a){var h=0,c=e;return h+=(c=c+n>>>0)<e?1:0,h+=(c=c+s>>>0)<s?1:0,t+i+r+o+(h+=(c=c+a>>>0)<a?1:0)>>>0},e.sum64_4_lo=function(t,e,i,n,r,s,o,a){return e+n+s+a>>>0},e.sum64_5_hi=function(t,e,i,n,r,s,o,a,h,c){var u=0,f=e;return u+=(f=f+n>>>0)<e?1:0,u+=(f=f+s>>>0)<s?1:0,u+=(f=f+a>>>0)<a?1:0,t+i+r+o+h+(u+=(f=f+c>>>0)<c?1:0)>>>0},e.sum64_5_lo=function(t,e,i,n,r,s,o,a,h,c){return e+n+s+a+c>>>0},e.rotr64_hi=function(t,e,i){return(e<<32-i|t>>>i)>>>0},e.rotr64_lo=function(t,e,i){return(t<<32-i|e>>>i)>>>0},e.shr64_hi=function(t,e,i){return t>>>i},e.shr64_lo=function(t,e,i){return(t<<32-i|e>>>i)>>>0}},function(t,e,i){"use strict";function n(t){if(!(this instanceof n))return new n(t);this.version=1,this.inputs=[],this.outputs=[],this.locktime=0,this.mutable=!1,this._hash=null,this._hhash=null,this._whash=null,this._raw=null,this._size=-1,this._witness=-1,this._sigops=-1,this._hashPrevouts=null,this._hashSequence=null,this._hashOutputs=null,t&&this.fromOptions(t)}function r(t,e){this.data=null,this.size=t,this.witness=e}const s=i(0),o=i(1),a=i(3),h=i(5),c=i(12),u=i(20),f=i(6),l=i(8),p=i(2),d=i(4),m=i(41),g=i(13),y=i(21),w=i(36),b=i(42),v=i(7),k=i(19),S=i(35),E=l.hashType;n.prototype.fromOptions=function(t){if(s(t,"TX data is required."),null!=t.version&&(s(o.isU32(t.version),"Version must be a uint32."),this.version=t.version),t.inputs){s(Array.isArray(t.inputs),"Inputs must be an array.");for(const e of t.inputs)this.inputs.push(new m(e))}if(t.outputs){s(Array.isArray(t.outputs),"Outputs must be an array.");for(const e of t.outputs)this.outputs.push(new g(e))}return null!=t.locktime&&(s(o.isU32(t.locktime),"Locktime must be a uint32."),this.locktime=t.locktime),this},n.fromOptions=function(t){return(new n).fromOptions(t)},n.prototype.clone=function(){return(new n).inject(this)},n.prototype.inject=function(t){this.version=t.version;for(const e of t.inputs)this.inputs.push(e.clone());for(const e of t.outputs)this.outputs.push(e.clone());return this.locktime=t.locktime,this},n.prototype.refresh=function(){this._hash=null,this._hhash=null,this._whash=null,this._raw=null,this._size=-1,this._witness=-1,this._sigops=-1,this._hashPrevouts=null,this._hashSequence=null,this._hashOutputs=null},n.prototype.hash=function(t){let e=this._hash;if(e||(e=h.hash256(this.toNormal()),this.mutable||(this._hash=e)),"hex"===t){let t=this._hhash;t||(t=e.toString("hex"),this.mutable||(this._hhash=t)),e=t}return e},n.prototype.witnessHash=function(t){if(!this.hasWitness())return this.hash(t);let e=this._whash;return e||(e=h.hash256(this.toRaw()),this.mutable||(this._whash=e)),"hex"===t?e.toString("hex"):e},n.prototype.toRaw=function(){return this.frame().data},n.prototype.toNormal=function(){return this.hasWitness()?this.frameNormal().data:this.toRaw()},n.prototype.toWriter=function(t){return this.mutable?this.hasWitness()?this.writeWitness(t):this.writeNormal(t):(t.writeBytes(this.toRaw()),t)},n.prototype.toNormalWriter=function(t){return this.hasWitness()?(this.writeNormal(t),t):this.toWriter(t)},n.prototype.frame=function(){if(this.mutable)return s(!this._raw),this.hasWitness()?this.frameWitness():this.frameNormal();if(this._raw){s(this._size>=0),s(this._witness>=0);const t=new r(this._size,this._witness);return t.data=this._raw,t}let t;return t=this.hasWitness()?this.frameWitness():this.frameNormal(),this._raw=t.data,this._size=t.size,this._witness=t.witness,t},n.prototype.getSizes=function(){return this.mutable?this.hasWitness()?this.getWitnessSizes():this.getNormalSizes():this.frame()},n.prototype.getVirtualSize=function(){const t=v.WITNESS_SCALE_FACTOR;return(this.getWeight()+t-1)/t|0},n.prototype.getSigopsSize=function(t){const e=v.WITNESS_SCALE_FACTOR,i=k.BYTES_PER_SIGOP;return(Math.max(this.getWeight(),t*i)+e-1)/e|0},n.prototype.getWeight=function(){const t=this.getSizes();return(t.size-t.witness)*(v.WITNESS_SCALE_FACTOR-1)+t.size},n.prototype.getSize=function(){return this.getSizes().size},n.prototype.getBaseSize=function(){const t=this.getSizes();return t.size-t.witness},n.prototype.hasWitness=function(){if(-1!==this._witness)return 0!==this._witness;for(const t of this.inputs)if(t.witness.items.length>0)return!0;return!1},n.prototype.signatureHash=function(t,e,i,n,r){if(s(t>=0&&t<this.inputs.length),s(e instanceof l),s("number"==typeof i),s("number"==typeof n),0===r)return this.signatureHashV0(t,e,n);if(1===r)return this.signatureHashV1(t,e,i,n);throw new Error("Unknown sighash version.")},n.prototype.signatureHashV0=function(t,e,i){if((31&i)===E.SINGLE&&t>=this.outputs.length)return Buffer.from(a.ONE_HASH);e=e.removeSeparators();const n=this.hashSize(t,e,i),r=d.pool(n);if(r.writeU32(this.version),i&E.ANYONECANPAY){const i=this.inputs[t];r.writeVarint(1),i.prevout.toWriter(r),r.writeVarBytes(e.toRaw()),r.writeU32(i.sequence)}else{r.writeVarint(this.inputs.length);for(let n=0;n<this.inputs.length;n++){const s=this.inputs[n];if(s.prevout.toWriter(r),n!==t)switch(r.writeVarint(0),31&i){case E.NONE:case E.SINGLE:r.writeU32(0);break;default:r.writeU32(s.sequence)}else r.writeVarBytes(e.toRaw()),r.writeU32(s.sequence)}}switch(31&i){case E.NONE:r.writeVarint(0);break;case E.SINGLE:{const e=this.outputs[t];r.writeVarint(t+1);for(let e=0;e<t;e++)r.writeI64(-1),r.writeVarint(0);e.toWriter(r);break}default:r.writeVarint(this.outputs.length);for(const t of this.outputs)t.toWriter(r)}return r.writeU32(this.locktime),r.writeU32(i),h.hash256(r.render())},n.prototype.hashSize=function(t,e,i){let n=0;switch(n+=4,i&E.ANYONECANPAY?(n+=1,n+=36,n+=e.getVarSize(),n+=4):(n+=a.sizeVarint(this.inputs.length),n+=41*(this.inputs.length-1),n+=36,n+=e.getVarSize(),n+=4),31&i){case E.NONE:n+=1;break;case E.SINGLE:n+=a.sizeVarint(t+1),n+=9*t,n+=this.outputs[t].getSize();break;default:n+=a.sizeVarint(this.outputs.length);for(const t of this.outputs)n+=t.getSize()}return n+=8},n.prototype.signatureHashV1=function(t,e,i,n){const r=this.inputs[t];let s=a.ZERO_HASH,o=a.ZERO_HASH,c=a.ZERO_HASH;if(!(n&E.ANYONECANPAY))if(this._hashPrevouts)s=this._hashPrevouts;else{const t=d.pool(36*this.inputs.length);for(const e of this.inputs)e.prevout.toWriter(t);s=h.hash256(t.render()),this.mutable||(this._hashPrevouts=s)}if(!(n&E.ANYONECANPAY)&&(31&n)!==E.SINGLE&&(31&n)!==E.NONE)if(this._hashSequence)o=this._hashSequence;else{const t=d.pool(4*this.inputs.length);for(const e of this.inputs)t.writeU32(e.sequence);o=h.hash256(t.render()),this.mutable||(this._hashSequence=o)}if((31&n)!==E.SINGLE&&(31&n)!==E.NONE)if(this._hashOutputs)c=this._hashOutputs;else{let t=0;for(const e of this.outputs)t+=e.getSize();const e=d.pool(t);for(const t of this.outputs)t.toWriter(e);c=h.hash256(e.render()),this.mutable||(this._hashOutputs=c)}else if((31&n)===E.SINGLE&&t<this.outputs.length){const e=this.outputs[t];c=h.hash256(e.toRaw())}const u=156+e.getVarSize(),f=d.pool(u);return f.writeU32(this.version),f.writeBytes(s),f.writeBytes(o),f.writeHash(r.prevout.hash),f.writeU32(r.prevout.index),f.writeVarBytes(e.toRaw()),f.writeI64(i),f.writeU32(r.sequence),f.writeBytes(c),f.writeU32(this.locktime),f.writeU32(n),h.hash256(f.render())},n.prototype.checksig=function(t,e,i,n,r,s){if(0===n.length)return!1;const o=n[n.length-1],a=this.signatureHash(t,e,i,o,s);return c.verify(a,n.slice(0,-1),r)},n.prototype.signature=function(t,e,i,n,r,s){null==r&&(r=E.ALL),null==s&&(s=0);const o=this.signatureHash(t,e,i,r,s),a=c.sign(o,n),h=new d(a.length+1);return h.writeBytes(a),h.writeU8(r),h.render()},n.prototype.check=function(t,e){if(0===this.inputs.length)throw new S("UNKNOWN_ERROR","No inputs.");if(!this.isCoinbase())for(let i=0;i<this.inputs.length;i++){const{prevout:n}=this.inputs[i],r=t.getOutput(n);if(!r)throw new S("UNKNOWN_ERROR","No coin available.");this.checkInput(i,r,e)}},n.prototype.checkInput=function(t,e,i){const n=this.inputs[t];s(n,"Input does not exist."),s(e,"No coin passed."),l.verify(n.script,n.witness,e.script,this,t,e.value,i)},n.prototype.checkAsync=async function(t,e,i){if(0===this.inputs.length)throw new S("UNKNOWN_ERROR","No inputs.");this.isCoinbase()||(i?await i.check(this,t,e):this.check(t,e))},n.prototype.checkInputAsync=async function(t,e,i,n){const r=this.inputs[t];s(r,"Input does not exist."),s(e,"No coin passed."),n?await n.checkInput(this,t,e,i):this.checkInput(t,e,i)},n.prototype.verify=function(t,e){try{this.check(t,e)}catch(t){if("ScriptError"===t.type)return!1;throw t}return!0},n.prototype.verifyInput=function(t,e,i){try{this.checkInput(t,e,i)}catch(t){if("ScriptError"===t.type)return!1;throw t}return!0},n.prototype.verifyAsync=async function(t,e,i){try{await this.checkAsync(t,e,i)}catch(t){if("ScriptError"===t.type)return!1;throw t}return!0},n.prototype.verifyInputAsync=async function(t,e,i,n){try{await this.checkInput(t,e,i,n)}catch(t){if("ScriptError"===t.type)return!1;throw t}return!0},n.prototype.isCoinbase=function(){return 1===this.inputs.length&&this.inputs[0].prevout.isNull()},n.prototype.isRBF=function(){if(2===this.version)return!1;for(const t of this.inputs)if(t.isRBF())return!0;return!1},n.prototype.getFee=function(t){return this.hasCoins(t)?this.getInputValue(t)-this.getOutputValue():0},n.prototype.getInputValue=function(t){let e=0;for(const{prevout:i}of this.inputs){const n=t.getOutput(i);if(!n)return 0;e+=n.value}return e},n.prototype.getOutputValue=function(){let t=0;for(const e of this.outputs)t+=e.value;return t},n.prototype._getInputAddresses=function(t){const e=Object.create(null),i=[];if(this.isCoinbase())return[i,e];for(const n of this.inputs){const r=t?t.getOutputFor(n):null,s=n.getAddress(r);if(!s)continue;const o=s.getHash("hex");e[o]||(e[o]=!0,i.push(s))}return[i,e]},n.prototype._getOutputAddresses=function(){const t=Object.create(null),e=[];for(const i of this.outputs){const n=i.getAddress();if(!n)continue;const r=n.getHash("hex");t[r]||(t[r]=!0,e.push(n))}return[e,t]},n.prototype._getAddresses=function(t){const[e,i]=this._getInputAddresses(t),n=this.getOutputAddresses();for(const t of n){const n=t.getHash("hex");i[n]||(i[n]=!0,e.push(t))}return[e,i]},n.prototype.getInputAddresses=function(t){const[e]=this._getInputAddresses(t);return e},n.prototype.getOutputAddresses=function(){const[t]=this._getOutputAddresses();return t},n.prototype.getAddresses=function(t){const[e]=this._getAddresses(t);return e},n.prototype.getInputHashes=function(t,e){if("hex"===e){const[,e]=this._getInputAddresses(t);return Object.keys(e)}const i=this.getInputAddresses(t),n=[];for(const t of i)n.push(t.getHash());return n},n.prototype.getOutputHashes=function(t){if("hex"===t){const[,t]=this._getOutputAddresses();return Object.keys(t)}const e=this.getOutputAddresses(),i=[];for(const t of e)i.push(t.getHash());return i},n.prototype.getHashes=function(t,e){if("hex"===e){const[,e]=this._getAddresses(t);return Object.keys(e)}const i=this.getAddresses(t),n=[];for(const t of i)n.push(t.getHash());return n},n.prototype.hasCoins=function(t){if(0===this.inputs.length)return!1;for(const{prevout:e}of this.inputs)if(!t.hasEntry(e))return!1;return!0},n.prototype.isFinal=function(t,e){const i=v.LOCKTIME_THRESHOLD;if(0===this.locktime)return!0;if(this.locktime<(this.locktime<i?t:e))return!0;for(const t of this.inputs)if(4294967295!==t.sequence)return!1;return!0},n.prototype.verifyLocktime=function(t,e){const i=v.LOCKTIME_THRESHOLD,n=this.inputs[t];return s(n,"Input does not exist."),s(e>=0,"Locktime must be non-negative."),this.locktime<i==e<i&&(!(e>this.locktime)&&4294967295!==n.sequence)},n.prototype.verifySequence=function(t,e){const i=v.SEQUENCE_DISABLE_FLAG,n=v.SEQUENCE_TYPE_FLAG,r=v.SEQUENCE_MASK,o=this.inputs[t];return s(o,"Input does not exist."),s(e>=0,"Locktime must be non-negative."),!!(e&i)||!(this.version<2)&&(!(o.sequence&i)&&((o.sequence&n)==(e&n)&&!((e&r)>(o.sequence&r))))},n.prototype.getLegacySigops=function(){if(-1!==this._sigops)return this._sigops;let t=0;for(const e of this.inputs)t+=e.script.getSigops(!1);for(const e of this.outputs)t+=e.script.getSigops(!1);return this.mutable||(this._sigops=t),t},n.prototype.getScripthashSigops=function(t){if(this.isCoinbase())return 0;let e=0;for(const i of this.inputs){const n=t.getOutputFor(i);n&&(n.script.isScripthash()&&(e+=n.script.getScripthashSigops(i.script)))}return e},n.prototype.getWitnessSigops=function(t){if(this.isCoinbase())return 0;let e=0;for(const i of this.inputs){const n=t.getOutputFor(i);n&&(e+=n.script.getWitnessSigops(i.script,i.witness))}return e},n.prototype.getSigopsCost=function(t,e){null==e&&(e=l.flags.STANDARD_VERIFY_FLAGS);const i=v.WITNESS_SCALE_FACTOR;let n=this.getLegacySigops()*i;return e&l.flags.VERIFY_P2SH&&(n+=this.getScripthashSigops(t)*i),e&l.flags.VERIFY_WITNESS&&(n+=this.getWitnessSigops(t)),n},n.prototype.getSigops=function(t,e){const i=v.WITNESS_SCALE_FACTOR;return(this.getSigopsCost(t,e)+i-1)/i|0},n.prototype.isSane=function(t){const[e]=this.checkSanity(t);return e},n.prototype.checkSanity=function(t){if(s("number"==typeof t),0===this.inputs.length)return[!1,"bad-txns-vin-empty",100];if(0===this.outputs.length)return[!1,"bad-txns-vout-empty",100];if(this.getBaseSize()>v.MAX_BLOCK_SIZE)return[!1,"bad-txns-oversize",100];let e=0;for(const i of this.outputs){if(i.value<0)return[!1,"bad-txns-vout-negative",100];if(i.value>v.getMaxMoney(t))return[!1,"bad-txns-vout-toolarge",100];if(!o.isSafeAddition(e,i.value))return[!1,"bad-txns-txouttotal-toolarge",100];if((e+=i.value)<0||e>v.getMaxMoney(t))return[!1,"bad-txns-txouttotal-toolarge",100]}const i=new Set;for(const t of this.inputs){const e=t.prevout.toKey();if(i.has(e))return[!1,"bad-txns-inputs-duplicate",100];i.add(e)}if(this.isCoinbase()){const t=this.inputs[0].script.getSize();if(t<2||t>100)return[!1,"bad-cb-length",100]}else for(const t of this.inputs)if(t.prevout.isNull())return[!1,"bad-txns-prevout-null",10];return[!0,"valid",0]},n.prototype.isStandard=function(){const[t]=this.checkStandard();return t},n.prototype.checkStandard=function(){if(this.version<1||this.version>k.MAX_TX_VERSION)return[!1,"version",0];if(this.getWeight()>=k.MAX_TX_WEIGHT)return[!1,"tx-size",0];for(const t of this.inputs){if(t.script.getSize()>1650)return[!1,"scriptsig-size",0];if(!t.script.isPushOnly())return[!1,"scriptsig-not-pushonly",0]}let t=0;for(const e of this.outputs){if(!e.script.isStandard())return[!1,"scriptpubkey",0];if(e.script.isNulldata())t++;else{if(e.script.isMultisig()&&!k.BARE_MULTISIG)return[!1,"bare-multisig",0];if(e.isDust(k.MIN_RELAY))return[!1,"dust",0]}}return t>1?[!1,"multi-op-return",0]:[!0,"valid",0]},n.prototype.hasStandardInputs=function(t){if(this.isCoinbase())return!0;for(const e of this.inputs){const i=t.getOutputFor(e);if(!i)return!1;if(!i.script.isPubkeyhash())if(i.script.isScripthash()){const t=e.script.getRedeem();if(!t)return!1;if(t.getSigops(!0)>k.MAX_P2SH_SIGOPS)return!1}else if(i.script.isUnknown())return!1}return!0},n.prototype.hasStandardWitness=function(t){if(this.isCoinbase())return!0;for(const e of this.inputs){const i=e.witness,n=t.getOutputFor(e);if(!n)continue;if(0===i.items.length)continue;let r=n.script;if(r.isScripthash()&&!(r=e.script.getRedeem()))return!1;if(!r.isProgram())return!1;if(r.isWitnessPubkeyhash()){if(2!==i.items.length)return!1;if(i.items[0].length>73)return!1;if(i.items[1].length>65)return!1}else if(r.isWitnessScripthash()){if(i.items.length-1>k.MAX_P2WSH_STACK)return!1;for(let t=0;t<i.items.length-1;t++){if(i.items[t].length>k.MAX_P2WSH_PUSH)return!1}const t=i.items[i.items.length-1];if(t.length>k.MAX_P2WSH_SIZE)return!1;const n=l.fromRaw(t);if(n.isPubkey()){if(i.items.length-1!=1)return!1;if(i.items[0].length>73)return!1;continue}if(n.isPubkeyhash()){if(e.witness.items.length-1!=2)return!1;if(i.items[0].length>73)return!1;if(i.items[1].length>65)return!1;continue}const[r]=n.getMultisig();if(-1!==r){if(i.items.length-1!==r+1)return!1;if(0!==i.items[0].length)return!1;for(let t=1;t<i.items.length-1;t++){if(i.items[t].length>73)return!1}}}else{if(i.items.length>k.MAX_P2WSH_STACK)return!1;for(const t of i.items)if(t.length>k.MAX_P2WSH_PUSH)return!1}}return!0},n.prototype.verifyInputs=function(t,e){const[i]=this.checkInputs(t,e);return-1!==i},n.prototype.checkInputs=function(t,e){s("number"==typeof e);let i=0;for(const{prevout:n}of this.inputs){const r=t.getEntry(n);if(!r)return[-1,"bad-txns-inputs-missingorspent",0];if(r.coinbase&&e-r.height<v.COINBASE_MATURITY)return[-1,"bad-txns-premature-spend-of-coinbase",0];const a=t.getOutput(n);if(s(a),a.value<0||a.value>v.getMaxMoney(e))return[-1,"bad-txns-inputvalues-outofrange",100];if(!o.isSafeAddition(i,a.value))return[-1,"bad-txns-inputvalues-outofrange",100];if((i+=a.value)<0||i>v.getMaxMoney(e))return[-1,"bad-txns-inputvalues-outofrange",100]}const n=this.getOutputValue();if(i<n)return[-1,"bad-txns-in-belowout",100];const r=i-n;return r<0?[-1,"bad-txns-fee-negative",100]:r>v.getMaxMoney(e)?[-1,"bad-txns-fee-outofrange",100]:[r,"valid",0]},n.prototype.getModifiedSize=function(t){null==t&&(t=this.getVirtualSize());for(const e of this.inputs){const i=41+Math.min(110,e.script.getSize());t>i&&(t-=i)}return t},n.prototype.getPriority=function(t,e,i){if(s("number"==typeof e,"Must pass in height."),this.isCoinbase())return 0;null==i&&(i=this.getVirtualSize());let n=0;for(const{prevout:i}of this.inputs){const r=t.getOutput(i);if(!r)continue;const s=t.getHeight(i);if(-1!==s&&s<=e){const t=e-s;n+=r.value*t}}return Math.floor(n/i)},n.prototype.getChainValue=function(t){if(this.isCoinbase())return 0;let e=0;for(const{prevout:i}of this.inputs){const n=t.getOutput(i);if(!n)continue;-1!==t.getHeight(i)&&(e+=n.value)}return e},n.prototype.isFree=function(t,e,i){return this.getPriority(t,e,i)>k.FREE_THRESHOLD},n.prototype.getMinFee=function(t,e){return null==t&&(t=this.getVirtualSize()),k.getMinFee(t,e)},n.prototype.getRoundFee=function(t,e){return null==t&&(t=this.getVirtualSize()),k.getRoundFee(t,e)},n.prototype.getRate=function(t,e){const i=this.getFee(t);return i<0?0:(null==e&&(e=this.getVirtualSize()),k.getRate(e,i))},n.prototype.getPrevout=function(){if(this.isCoinbase())return[];const t=Object.create(null);for(const e of this.inputs)t[e.prevout.hash]=!0;return Object.keys(t)},n.prototype.isWatched=function(t){let e=!1;t.test(this.hash())&&(e=!0);for(let i=0;i<this.outputs.length;i++){const n=this.outputs[i];if(n.script.test(t)){if(t.update===b.flags.ALL){const e=y.fromTX(this,i);t.add(e.toRaw())}else if(t.update===b.flags.PUBKEY_ONLY&&(n.script.isPubkey()||n.script.isMultisig())){const e=y.fromTX(this,i);t.add(e.toRaw())}e=!0}}if(e)return e;for(const e of this.inputs){const i=e.prevout;if(t.test(i.toRaw()))return!0;if(e.script.test(t))return!0}return!1},n.prototype.rhash=function(){return o.revHex(this.hash("hex"))},n.prototype.rwhash=function(){return o.revHex(this.witnessHash("hex"))},n.prototype.txid=function(){return this.rhash()},n.prototype.wtxid=function(){return this.rwhash()},n.prototype.toInv=function(){return new w(w.types.TX,this.hash("hex"))},n.prototype.inspect=function(){return this.format()},n.prototype.format=function(t,e,i){let n=0,r=0,s=-1,a=null,h=0,c=null;return t&&(r=this.getFee(t),n=this.getRate(t),Number.isSafeInteger(n)||(n=0)),e&&(s=e.height,a=o.revHex(e.hash),h=e.time,c=o.date(h)),null==i&&(i=-1),{hash:this.txid(),witnessHash:this.wtxid(),size:this.getSize(),virtualSize:this.getVirtualSize(),value:u.wmcc(this.getOutputValue()),fee:u.wmcc(r),rate:u.wmcc(n),minFee:u.wmcc(this.getMinFee()),height:s,block:a,time:h,date:c,index:i,version:this.version,inputs:this.inputs.map(e=>{const i=t?t.getOutputFor(e):null;return e.format(i)}),outputs:this.outputs,locktime:this.locktime}},n.prototype.toJSON=function(){return this.getJSON()},n.prototype.getJSON=function(t,e,i,n){let r,s,a,h,c,u;return e&&(s=this.getFee(e),r=this.getRate(e),Number.isSafeInteger(r)||(r=0)),i&&(a=i.height,h=o.revHex(i.hash),c=i.time,u=o.date(c)),t=f.get(t),{hash:this.txid(),witnessHash:this.wtxid(),fee:s,rate:r,mtime:o.now(),height:a,block:h,time:c,date:u,index:n,version:this.version,inputs:this.inputs.map(i=>{const n=e?e.getCoinFor(i):null;return i.getJSON(t,n)}),outputs:this.outputs.map(e=>e.getJSON(t)),locktime:this.locktime,hex:this.toRaw().toString("hex")}},n.prototype.fromJSON=function(t){s(t,"TX data is required."),s(o.isU32(t.version),"Version must be a uint32."),s(Array.isArray(t.inputs),"Inputs must be an array."),s(Array.isArray(t.outputs),"Outputs must be an array."),s(o.isU32(t.locktime),"Locktime must be a uint32."),this.version=t.version;for(const e of t.inputs)this.inputs.push(m.fromJSON(e));for(const e of t.outputs)this.outputs.push(g.fromJSON(e));return this.locktime=t.locktime,this},n.fromJSON=function(t){return(new n).fromJSON(t)},n.fromRaw=function(t,e){return"string"==typeof t&&(t=Buffer.from(t,e)),(new n).fromRaw(t)},n.fromReader=function(t){return(new n).fromReader(t)},n.prototype.fromRaw=function(t){return this.fromReader(new p(t))},n.prototype.fromReader=function(t){if(function(t){return!(t.left()<6)&&0===t.data[t.offset+4]&&0!==t.data[t.offset+5]}(t))return this.fromWitnessReader(t);t.start(),this.version=t.readU32();const e=t.readVarint();for(let i=0;i<e;i++)this.inputs.push(m.fromReader(t));const i=t.readVarint();for(let e=0;e<i;e++)this.outputs.push(g.fromReader(t));return this.locktime=t.readU32(),this.mutable?t.end():(this._raw=t.endData(),this._size=this._raw.length,this._witness=0),this},n.prototype.fromWitnessReader=function(t){t.start(),this.version=t.readU32(),s(0===t.readU8(),"Non-zero marker.");let e=t.readU8();s(0!==e,"Flags byte is zero.");const i=t.readVarint();for(let e=0;e<i;e++)this.inputs.push(m.fromReader(t));const n=t.readVarint();for(let e=0;e<n;e++)this.outputs.push(g.fromReader(t));let r=0,o=!1;if(1&e){e^=1,r=t.offset;for(const e of this.inputs)e.witness.fromReader(t),e.witness.items.length>0&&(o=!0);r=t.offset-r+2}if(0!==e)throw new Error("Unknown witness flag.");if(0===this.inputs.length&&0!==this.outputs.length)throw new Error("Zero input witness tx.");return this.locktime=t.readU32(),!this.mutable&&o?(this._raw=t.endData(),this._size=this._raw.length,this._witness=r):t.end(),this},n.prototype.frameNormal=function(){const t=this.getNormalSizes(),e=new d(t.size);return this.writeNormal(e),t.data=e.render(),t},n.prototype.frameWitness=function(){const t=this.getWitnessSizes(),e=new d(t.size);return this.writeWitness(e),t.data=e.render(),t},n.prototype.writeNormal=function(t){if(0===this.inputs.length&&0!==this.outputs.length)throw new Error("Cannot serialize zero-input tx.");t.writeU32(this.version),t.writeVarint(this.inputs.length);for(const e of this.inputs)e.toWriter(t);t.writeVarint(this.outputs.length);for(const e of this.outputs)e.toWriter(t);return t.writeU32(this.locktime),t},n.prototype.writeWitness=function(t){if(0===this.inputs.length&&0!==this.outputs.length)throw new Error("Cannot serialize zero-input tx.");t.writeU32(this.version),t.writeU8(0),t.writeU8(1),t.writeVarint(this.inputs.length);for(const e of this.inputs)e.toWriter(t);t.writeVarint(this.outputs.length);for(const e of this.outputs)e.toWriter(t);const e=t.offset;for(const e of this.inputs)e.witness.toWriter(t);const i=t.offset-e;if(t.writeU32(this.locktime),i===this.inputs.length)throw new Error("Cannot serialize empty-witness tx.");return t},n.prototype.getNormalSizes=function(){let t=0;t+=4,t+=a.sizeVarint(this.inputs.length);for(const e of this.inputs)t+=e.getSize();t+=a.sizeVarint(this.outputs.length);for(const e of this.outputs)t+=e.getSize();return t+=4,new r(t,0)},n.prototype.getWitnessSizes=function(){let t=0,e=0;t+=4,e+=2,t+=a.sizeVarint(this.inputs.length);for(const i of this.inputs)t+=i.getSize(),e+=i.witness.getVarSize();t+=a.sizeVarint(this.outputs.length);for(const e of this.outputs)t+=e.getSize();return t+=4,new r(t+e,e)},n.isTX=function(t){return t instanceof n},t.exports=n},function(t,e,i){"use strict";function n(t){return new Promise((e,i)=>{const n=(o,a)=>{let h;try{h=a?t.throw(o):t.next(o)}catch(t){return void i(t)}h.done?e(h.value):!function(t){return t&&"function"==typeof t.then}(h.value)?n(h.value,!1):h.value.then(r,s)},r=t=>{n(t,!1)},s=t=>{n(t,!0)};n(void 0,!1)})}function r(t){return function(){return n(t.apply(this,arguments))}}function s(t,e){return function(i,n){i?e(i):t(n)}}const o=i(0);(e=r).exec=n,e.spawn=function(t,e){return n(t.call(e))},e.co=r,e.wait=function(){return new Promise(t=>setImmediate(t))},e.timeout=function(t){return new Promise(e=>setTimeout(e,t))},e.wrap=s,e.promisify=function(t){return function(...e){return new Promise((i,n)=>{e.push(s(i,n)),t.call(this,...e)})}},e.callbackify=function(t){return function(...e){if(0===e.length||"function"!=typeof e[e.length-1])throw new Error(`${t.name||"Function"} requires a callback.`);const i=e.pop();t.call(this,...e).then(t=>{setImmediate(()=>i(null,t))},t=>{setImmediate(()=>i(t))})}},e.every=async function(t){const e=await Promise.all(t);for(const t of e)if(!t)return!1;return!0},e.setInterval=function(t,e,i){const n={timer:null,stopped:!1},r=async()=>{o(null!=n.timer),n.timer=null;try{await t.call(i)}finally{n.stopped||(n.timer=setTimeout(r,e))}};return n.timer=setTimeout(r,e),n},e.clearInterval=function(t){o(t),null!=t.timer&&(clearTimeout(t.timer),t.timer=null),t.stopped=!0},e.setTimeout=function(t,e,i){return{timer:setTimeout(t.bind(i),e),stopped:!1}},e.clearTimeout=function(t){o(t),null!=t.timer&&(clearTimeout(t.timer),t.timer=null),t.stopped=!0},e.job=function(t,e){return new function(t,e){this.resolve=t,this.reject=e}(t,e)},t.exports=e},function(t,e,i){(function(t){!function(t,e){"use strict";function n(t,e){if(!t)throw new Error(e||"Assertion failed")}function r(t,e){t.super_=e;var i=function(){};i.prototype=e.prototype,t.prototype=new i,t.prototype.constructor=t}function s(t,e,i){if(s.isBN(t))return t;this.negative=0,this.words=null,this.length=0,this.red=null,null!==t&&("le"!==e&&"be"!==e||(i=e,e=10),this._init(t||0,e||10,i||"be"))}function o(t,e,i){for(var n=0,r=Math.min(t.length,i),s=e;s<r;s++){var o=t.charCodeAt(s)-48;n<<=4,n|=o>=49&&o<=54?o-49+10:o>=17&&o<=22?o-17+10:15&o}return n}function a(t,e,i,n){for(var r=0,s=Math.min(t.length,i),o=e;o<s;o++){var a=t.charCodeAt(o)-48;r*=n,r+=a>=49?a-49+10:a>=17?a-17+10:a}return r}function h(t,e,i){i.negative=e.negative^t.negative;var n=t.length+e.length|0;i.length=n,n=n-1|0;var r=0|t.words[0],s=0|e.words[0],o=r*s,a=67108863&o,h=o/67108864|0;i.words[0]=a;for(var c=1;c<n;c++){for(var u=h>>>26,f=67108863&h,l=Math.min(c,e.length-1),p=Math.max(0,c-t.length+1);p<=l;p++){var d=c-p|0;u+=(o=(r=0|t.words[d])*(s=0|e.words[p])+f)/67108864|0,f=67108863&o}i.words[c]=0|f,h=0|u}return 0!==h?i.words[c]=0|h:i.length--,i.strip()}function c(t,e,i){return(new u).mulp(t,e,i)}function u(t,e){this.x=t,this.y=e}function f(t,e){this.name=t,this.p=new s(e,16),this.n=this.p.bitLength(),this.k=new s(1).iushln(this.n).isub(this.p),this.tmp=this._tmp()}function l(){f.call(this,"k256","ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe fffffc2f")}function p(){f.call(this,"p224","ffffffff ffffffff ffffffff ffffffff 00000000 00000000 00000001")}function d(){f.call(this,"p192","ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff")}function m(){f.call(this,"25519","7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed")}function g(t){if("string"==typeof t){var e=s._prime(t);this.m=e.p,this.prime=e}else n(t.gtn(1),"modulus must be greater than 1"),this.m=t,this.prime=null}function y(t){g.call(this,t),this.shift=this.m.bitLength(),this.shift%26!=0&&(this.shift+=26-this.shift%26),this.r=new s(1).iushln(this.shift),this.r2=this.imod(this.r.sqr()),this.rinv=this.r._invmp(this.m),this.minv=this.rinv.mul(this.r).isubn(1).div(this.m),this.minv=this.minv.umod(this.r),this.minv=this.r.sub(this.minv)}"object"==typeof t?t.exports=s:e.BN=s,s.BN=s,s.wordSize=26;var w;try{w=i(65).Buffer}catch(t){}s.isBN=function(t){return t instanceof s||null!==t&&"object"==typeof t&&t.constructor.wordSize===s.wordSize&&Array.isArray(t.words)},s.max=function(t,e){return t.cmp(e)>0?t:e},s.min=function(t,e){return t.cmp(e)<0?t:e},s.prototype._init=function(t,e,i){if("number"==typeof t)return this._initNumber(t,e,i);if("object"==typeof t)return this._initArray(t,e,i);"hex"===e&&(e=16),n(e===(0|e)&&e>=2&&e<=36);var r=0;"-"===(t=t.toString().replace(/\s+/g,""))[0]&&r++,16===e?this._parseHex(t,r):this._parseBase(t,e,r),"-"===t[0]&&(this.negative=1),this.strip(),"le"===i&&this._initArray(this.toArray(),e,i)},s.prototype._initNumber=function(t,e,i){t<0&&(this.negative=1,t=-t),t<67108864?(this.words=[67108863&t],this.length=1):t<4503599627370496?(this.words=[67108863&t,t/67108864&67108863],this.length=2):(n(t<9007199254740992),this.words=[67108863&t,t/67108864&67108863,1],this.length=3),"le"===i&&this._initArray(this.toArray(),e,i)},s.prototype._initArray=function(t,e,i){if(n("number"==typeof t.length),t.length<=0)return this.words=[0],this.length=1,this;this.length=Math.ceil(t.length/3),this.words=new Array(this.length);for(var r=0;r<this.length;r++)this.words[r]=0;var s,o,a=0;if("be"===i)for(r=t.length-1,s=0;r>=0;r-=3)o=t[r]|t[r-1]<<8|t[r-2]<<16,this.words[s]|=o<<a&67108863,this.words[s+1]=o>>>26-a&67108863,(a+=24)>=26&&(a-=26,s++);else if("le"===i)for(r=0,s=0;r<t.length;r+=3)o=t[r]|t[r+1]<<8|t[r+2]<<16,this.words[s]|=o<<a&67108863,this.words[s+1]=o>>>26-a&67108863,(a+=24)>=26&&(a-=26,s++);return this.strip()},s.prototype._parseHex=function(t,e){this.length=Math.ceil((t.length-e)/6),this.words=new Array(this.length);for(var i=0;i<this.length;i++)this.words[i]=0;var n,r,s=0;for(i=t.length-6,n=0;i>=e;i-=6)r=o(t,i,i+6),this.words[n]|=r<<s&67108863,this.words[n+1]|=r>>>26-s&4194303,(s+=24)>=26&&(s-=26,n++);i+6!==e&&(r=o(t,e,i+6),this.words[n]|=r<<s&67108863,this.words[n+1]|=r>>>26-s&4194303),this.strip()},s.prototype._parseBase=function(t,e,i){this.words=[0],this.length=1;for(var n=0,r=1;r<=67108863;r*=e)n++;n--,r=r/e|0;for(var s=t.length-i,o=s%n,h=Math.min(s,s-o)+i,c=0,u=i;u<h;u+=n)c=a(t,u,u+n,e),this.imuln(r),this.words[0]+c<67108864?this.words[0]+=c:this._iaddn(c);if(0!==o){var f=1;for(c=a(t,u,t.length,e),u=0;u<o;u++)f*=e;this.imuln(f),this.words[0]+c<67108864?this.words[0]+=c:this._iaddn(c)}},s.prototype.copy=function(t){t.words=new Array(this.length);for(var e=0;e<this.length;e++)t.words[e]=this.words[e];t.length=this.length,t.negative=this.negative,t.red=this.red},s.prototype.clone=function(){var t=new s(null);return this.copy(t),t},s.prototype._expand=function(t){for(;this.length<t;)this.words[this.length++]=0;return this},s.prototype.strip=function(){for(;this.length>1&&0===this.words[this.length-1];)this.length--;return this._normSign()},s.prototype._normSign=function(){return 1===this.length&&0===this.words[0]&&(this.negative=0),this},s.prototype.inspect=function(){return(this.red?"<BN-R: ":"<BN: ")+this.toString(16)+">"};var b=["","0","00","000","0000","00000","000000","0000000","00000000","000000000","0000000000","00000000000","000000000000","0000000000000","00000000000000","000000000000000","0000000000000000","00000000000000000","000000000000000000","0000000000000000000","00000000000000000000","000000000000000000000","0000000000000000000000","00000000000000000000000","000000000000000000000000","0000000000000000000000000"],v=[0,0,25,16,12,11,10,9,8,8,7,7,7,7,6,6,6,6,6,6,6,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5],k=[0,0,33554432,43046721,16777216,48828125,60466176,40353607,16777216,43046721,1e7,19487171,35831808,62748517,7529536,11390625,16777216,24137569,34012224,47045881,64e6,4084101,5153632,6436343,7962624,9765625,11881376,14348907,17210368,20511149,243e5,28629151,33554432,39135393,45435424,52521875,60466176];s.prototype.toString=function(t,e){t=t||10,e=0|e||1;var i;if(16===t||"hex"===t){i="";for(var r=0,s=0,o=0;o<this.length;o++){var a=this.words[o],h=(16777215&(a<<r|s)).toString(16);i=0!==(s=a>>>24-r&16777215)||o!==this.length-1?b[6-h.length]+h+i:h+i,(r+=2)>=26&&(r-=26,o--)}for(0!==s&&(i=s.toString(16)+i);i.length%e!=0;)i="0"+i;return 0!==this.negative&&(i="-"+i),i}if(t===(0|t)&&t>=2&&t<=36){var c=v[t],u=k[t];i="";var f=this.clone();for(f.negative=0;!f.isZero();){var l=f.modn(u).toString(t);i=(f=f.idivn(u)).isZero()?l+i:b[c-l.length]+l+i}for(this.isZero()&&(i="0"+i);i.length%e!=0;)i="0"+i;return 0!==this.negative&&(i="-"+i),i}n(!1,"Base should be between 2 and 36")},s.prototype.toNumber=function(){var t=this.words[0];return 2===this.length?t+=67108864*this.words[1]:3===this.length&&1===this.words[2]?t+=4503599627370496+67108864*this.words[1]:this.length>2&&n(!1,"Number can only safely store up to 53 bits"),0!==this.negative?-t:t},s.prototype.toJSON=function(){return this.toString(16)},s.prototype.toBuffer=function(t,e){return n(void 0!==w),this.toArrayLike(w,t,e)},s.prototype.toArray=function(t,e){return this.toArrayLike(Array,t,e)},s.prototype.toArrayLike=function(t,e,i){var r=this.byteLength(),s=i||Math.max(1,r);n(r<=s,"byte array longer than desired length"),n(s>0,"Requested array length <= 0"),this.strip();var o,a,h="le"===e,c=new t(s),u=this.clone();if(h){for(a=0;!u.isZero();a++)o=u.andln(255),u.iushrn(8),c[a]=o;for(;a<s;a++)c[a]=0}else{for(a=0;a<s-r;a++)c[a]=0;for(a=0;!u.isZero();a++)o=u.andln(255),u.iushrn(8),c[s-a-1]=o}return c},Math.clz32?s.prototype._countBits=function(t){return 32-Math.clz32(t)}:s.prototype._countBits=function(t){var e=t,i=0;return e>=4096&&(i+=13,e>>>=13),e>=64&&(i+=7,e>>>=7),e>=8&&(i+=4,e>>>=4),e>=2&&(i+=2,e>>>=2),i+e},s.prototype._zeroBits=function(t){if(0===t)return 26;var e=t,i=0;return 0==(8191&e)&&(i+=13,e>>>=13),0==(127&e)&&(i+=7,e>>>=7),0==(15&e)&&(i+=4,e>>>=4),0==(3&e)&&(i+=2,e>>>=2),0==(1&e)&&i++,i},s.prototype.bitLength=function(){var t=this.words[this.length-1],e=this._countBits(t);return 26*(this.length-1)+e},s.prototype.zeroBits=function(){if(this.isZero())return 0;for(var t=0,e=0;e<this.length;e++){var i=this._zeroBits(this.words[e]);if(t+=i,26!==i)break}return t},s.prototype.byteLength=function(){return Math.ceil(this.bitLength()/8)},s.prototype.toTwos=function(t){return 0!==this.negative?this.abs().inotn(t).iaddn(1):this.clone()},s.prototype.fromTwos=function(t){return this.testn(t-1)?this.notn(t).iaddn(1).ineg():this.clone()},s.prototype.isNeg=function(){return 0!==this.negative},s.prototype.neg=function(){return this.clone().ineg()},s.prototype.ineg=function(){return this.isZero()||(this.negative^=1),this},s.prototype.iuor=function(t){for(;this.length<t.length;)this.words[this.length++]=0;for(var e=0;e<t.length;e++)this.words[e]=this.words[e]|t.words[e];return this.strip()},s.prototype.ior=function(t){return n(0==(this.negative|t.negative)),this.iuor(t)},s.prototype.or=function(t){return this.length>t.length?this.clone().ior(t):t.clone().ior(this)},s.prototype.uor=function(t){return this.length>t.length?this.clone().iuor(t):t.clone().iuor(this)},s.prototype.iuand=function(t){var e;e=this.length>t.length?t:this;for(var i=0;i<e.length;i++)this.words[i]=this.words[i]&t.words[i];return this.length=e.length,this.strip()},s.prototype.iand=function(t){return n(0==(this.negative|t.negative)),this.iuand(t)},s.prototype.and=function(t){return this.length>t.length?this.clone().iand(t):t.clone().iand(this)},s.prototype.uand=function(t){return this.length>t.length?this.clone().iuand(t):t.clone().iuand(this)},s.prototype.iuxor=function(t){var e,i;this.length>t.length?(e=this,i=t):(e=t,i=this);for(var n=0;n<i.length;n++)this.words[n]=e.words[n]^i.words[n];if(this!==e)for(;n<e.length;n++)this.words[n]=e.words[n];return this.length=e.length,this.strip()},s.prototype.ixor=function(t){return n(0==(this.negative|t.negative)),this.iuxor(t)},s.prototype.xor=function(t){return this.length>t.length?this.clone().ixor(t):t.clone().ixor(this)},s.prototype.uxor=function(t){return this.length>t.length?this.clone().iuxor(t):t.clone().iuxor(this)},s.prototype.inotn=function(t){n("number"==typeof t&&t>=0);var e=0|Math.ceil(t/26),i=t%26;this._expand(e),i>0&&e--;for(var r=0;r<e;r++)this.words[r]=67108863&~this.words[r];return i>0&&(this.words[r]=~this.words[r]&67108863>>26-i),this.strip()},s.prototype.notn=function(t){return this.clone().inotn(t)},s.prototype.setn=function(t,e){n("number"==typeof t&&t>=0);var i=t/26|0,r=t%26;return this._expand(i+1),this.words[i]=e?this.words[i]|1<<r:this.words[i]&~(1<<r),this.strip()},s.prototype.iadd=function(t){var e;if(0!==this.negative&&0===t.negative)return this.negative=0,e=this.isub(t),this.negative^=1,this._normSign();if(0===this.negative&&0!==t.negative)return t.negative=0,e=this.isub(t),t.negative=1,e._normSign();var i,n;this.length>t.length?(i=this,n=t):(i=t,n=this);for(var r=0,s=0;s<n.length;s++)e=(0|i.words[s])+(0|n.words[s])+r,this.words[s]=67108863&e,r=e>>>26;for(;0!==r&&s<i.length;s++)e=(0|i.words[s])+r,this.words[s]=67108863&e,r=e>>>26;if(this.length=i.length,0!==r)this.words[this.length]=r,this.length++;else if(i!==this)for(;s<i.length;s++)this.words[s]=i.words[s];return this},s.prototype.add=function(t){var e;return 0!==t.negative&&0===this.negative?(t.negative=0,e=this.sub(t),t.negative^=1,e):0===t.negative&&0!==this.negative?(this.negative=0,e=t.sub(this),this.negative=1,e):this.length>t.length?this.clone().iadd(t):t.clone().iadd(this)},s.prototype.isub=function(t){if(0!==t.negative){t.negative=0;var e=this.iadd(t);return t.negative=1,e._normSign()}if(0!==this.negative)return this.negative=0,this.iadd(t),this.negative=1,this._normSign();var i=this.cmp(t);if(0===i)return this.negative=0,this.length=1,this.words[0]=0,this;var n,r;i>0?(n=this,r=t):(n=t,r=this);for(var s=0,o=0;o<r.length;o++)s=(e=(0|n.words[o])-(0|r.words[o])+s)>>26,this.words[o]=67108863&e;for(;0!==s&&o<n.length;o++)s=(e=(0|n.words[o])+s)>>26,this.words[o]=67108863&e;if(0===s&&o<n.length&&n!==this)for(;o<n.length;o++)this.words[o]=n.words[o];return this.length=Math.max(this.length,o),n!==this&&(this.negative=1),this.strip()},s.prototype.sub=function(t){return this.clone().isub(t)};var S=function(t,e,i){var n,r,s,o=t.words,a=e.words,h=i.words,c=0,u=0|o[0],f=8191&u,l=u>>>13,p=0|o[1],d=8191&p,m=p>>>13,g=0|o[2],y=8191&g,w=g>>>13,b=0|o[3],v=8191&b,k=b>>>13,S=0|o[4],E=8191&S,R=S>>>13,x=0|o[5],_=8191&x,I=x>>>13,A=0|o[6],O=8191&A,B=A>>>13,P=0|o[7],M=8191&P,N=P>>>13,T=0|o[8],C=8191&T,U=T>>>13,H=0|o[9],L=8191&H,z=H>>>13,D=0|a[0],F=8191&D,V=D>>>13,K=0|a[1],j=8191&K,q=K>>>13,W=0|a[2],X=8191&W,Y=W>>>13,G=0|a[3],J=8191&G,$=G>>>13,Z=0|a[4],Q=8191&Z,tt=Z>>>13,et=0|a[5],it=8191&et,nt=et>>>13,rt=0|a[6],st=8191&rt,ot=rt>>>13,at=0|a[7],ht=8191&at,ct=at>>>13,ut=0|a[8],ft=8191&ut,lt=ut>>>13,pt=0|a[9],dt=8191&pt,mt=pt>>>13;i.negative=t.negative^e.negative,i.length=19;var gt=(c+(n=Math.imul(f,F))|0)+((8191&(r=(r=Math.imul(f,V))+Math.imul(l,F)|0))<<13)|0;c=((s=Math.imul(l,V))+(r>>>13)|0)+(gt>>>26)|0,gt&=67108863,n=Math.imul(d,F),r=(r=Math.imul(d,V))+Math.imul(m,F)|0,s=Math.imul(m,V);var yt=(c+(n=n+Math.imul(f,j)|0)|0)+((8191&(r=(r=r+Math.imul(f,q)|0)+Math.imul(l,j)|0))<<13)|0;c=((s=s+Math.imul(l,q)|0)+(r>>>13)|0)+(yt>>>26)|0,yt&=67108863,n=Math.imul(y,F),r=(r=Math.imul(y,V))+Math.imul(w,F)|0,s=Math.imul(w,V),n=n+Math.imul(d,j)|0,r=(r=r+Math.imul(d,q)|0)+Math.imul(m,j)|0,s=s+Math.imul(m,q)|0;var wt=(c+(n=n+Math.imul(f,X)|0)|0)+((8191&(r=(r=r+Math.imul(f,Y)|0)+Math.imul(l,X)|0))<<13)|0;c=((s=s+Math.imul(l,Y)|0)+(r>>>13)|0)+(wt>>>26)|0,wt&=67108863,n=Math.imul(v,F),r=(r=Math.imul(v,V))+Math.imul(k,F)|0,s=Math.imul(k,V),n=n+Math.imul(y,j)|0,r=(r=r+Math.imul(y,q)|0)+Math.imul(w,j)|0,s=s+Math.imul(w,q)|0,n=n+Math.imul(d,X)|0,r=(r=r+Math.imul(d,Y)|0)+Math.imul(m,X)|0,s=s+Math.imul(m,Y)|0;var bt=(c+(n=n+Math.imul(f,J)|0)|0)+((8191&(r=(r=r+Math.imul(f,$)|0)+Math.imul(l,J)|0))<<13)|0;c=((s=s+Math.imul(l,$)|0)+(r>>>13)|0)+(bt>>>26)|0,bt&=67108863,n=Math.imul(E,F),r=(r=Math.imul(E,V))+Math.imul(R,F)|0,s=Math.imul(R,V),n=n+Math.imul(v,j)|0,r=(r=r+Math.imul(v,q)|0)+Math.imul(k,j)|0,s=s+Math.imul(k,q)|0,n=n+Math.imul(y,X)|0,r=(r=r+Math.imul(y,Y)|0)+Math.imul(w,X)|0,s=s+Math.imul(w,Y)|0,n=n+Math.imul(d,J)|0,r=(r=r+Math.imul(d,$)|0)+Math.imul(m,J)|0,s=s+Math.imul(m,$)|0;var vt=(c+(n=n+Math.imul(f,Q)|0)|0)+((8191&(r=(r=r+Math.imul(f,tt)|0)+Math.imul(l,Q)|0))<<13)|0;c=((s=s+Math.imul(l,tt)|0)+(r>>>13)|0)+(vt>>>26)|0,vt&=67108863,n=Math.imul(_,F),r=(r=Math.imul(_,V))+Math.imul(I,F)|0,s=Math.imul(I,V),n=n+Math.imul(E,j)|0,r=(r=r+Math.imul(E,q)|0)+Math.imul(R,j)|0,s=s+Math.imul(R,q)|0,n=n+Math.imul(v,X)|0,r=(r=r+Math.imul(v,Y)|0)+Math.imul(k,X)|0,s=s+Math.imul(k,Y)|0,n=n+Math.imul(y,J)|0,r=(r=r+Math.imul(y,$)|0)+Math.imul(w,J)|0,s=s+Math.imul(w,$)|0,n=n+Math.imul(d,Q)|0,r=(r=r+Math.imul(d,tt)|0)+Math.imul(m,Q)|0,s=s+Math.imul(m,tt)|0;var kt=(c+(n=n+Math.imul(f,it)|0)|0)+((8191&(r=(r=r+Math.imul(f,nt)|0)+Math.imul(l,it)|0))<<13)|0;c=((s=s+Math.imul(l,nt)|0)+(r>>>13)|0)+(kt>>>26)|0,kt&=67108863,n=Math.imul(O,F),r=(r=Math.imul(O,V))+Math.imul(B,F)|0,s=Math.imul(B,V),n=n+Math.imul(_,j)|0,r=(r=r+Math.imul(_,q)|0)+Math.imul(I,j)|0,s=s+Math.imul(I,q)|0,n=n+Math.imul(E,X)|0,r=(r=r+Math.imul(E,Y)|0)+Math.imul(R,X)|0,s=s+Math.imul(R,Y)|0,n=n+Math.imul(v,J)|0,r=(r=r+Math.imul(v,$)|0)+Math.imul(k,J)|0,s=s+Math.imul(k,$)|0,n=n+Math.imul(y,Q)|0,r=(r=r+Math.imul(y,tt)|0)+Math.imul(w,Q)|0,s=s+Math.imul(w,tt)|0,n=n+Math.imul(d,it)|0,r=(r=r+Math.imul(d,nt)|0)+Math.imul(m,it)|0,s=s+Math.imul(m,nt)|0;var St=(c+(n=n+Math.imul(f,st)|0)|0)+((8191&(r=(r=r+Math.imul(f,ot)|0)+Math.imul(l,st)|0))<<13)|0;c=((s=s+Math.imul(l,ot)|0)+(r>>>13)|0)+(St>>>26)|0,St&=67108863,n=Math.imul(M,F),r=(r=Math.imul(M,V))+Math.imul(N,F)|0,s=Math.imul(N,V),n=n+Math.imul(O,j)|0,r=(r=r+Math.imul(O,q)|0)+Math.imul(B,j)|0,s=s+Math.imul(B,q)|0,n=n+Math.imul(_,X)|0,r=(r=r+Math.imul(_,Y)|0)+Math.imul(I,X)|0,s=s+Math.imul(I,Y)|0,n=n+Math.imul(E,J)|0,r=(r=r+Math.imul(E,$)|0)+Math.imul(R,J)|0,s=s+Math.imul(R,$)|0,n=n+Math.imul(v,Q)|0,r=(r=r+Math.imul(v,tt)|0)+Math.imul(k,Q)|0,s=s+Math.imul(k,tt)|0,n=n+Math.imul(y,it)|0,r=(r=r+Math.imul(y,nt)|0)+Math.imul(w,it)|0,s=s+Math.imul(w,nt)|0,n=n+Math.imul(d,st)|0,r=(r=r+Math.imul(d,ot)|0)+Math.imul(m,st)|0,s=s+Math.imul(m,ot)|0;var Et=(c+(n=n+Math.imul(f,ht)|0)|0)+((8191&(r=(r=r+Math.imul(f,ct)|0)+Math.imul(l,ht)|0))<<13)|0;c=((s=s+Math.imul(l,ct)|0)+(r>>>13)|0)+(Et>>>26)|0,Et&=67108863,n=Math.imul(C,F),r=(r=Math.imul(C,V))+Math.imul(U,F)|0,s=Math.imul(U,V),n=n+Math.imul(M,j)|0,r=(r=r+Math.imul(M,q)|0)+Math.imul(N,j)|0,s=s+Math.imul(N,q)|0,n=n+Math.imul(O,X)|0,r=(r=r+Math.imul(O,Y)|0)+Math.imul(B,X)|0,s=s+Math.imul(B,Y)|0,n=n+Math.imul(_,J)|0,r=(r=r+Math.imul(_,$)|0)+Math.imul(I,J)|0,s=s+Math.imul(I,$)|0,n=n+Math.imul(E,Q)|0,r=(r=r+Math.imul(E,tt)|0)+Math.imul(R,Q)|0,s=s+Math.imul(R,tt)|0,n=n+Math.imul(v,it)|0,r=(r=r+Math.imul(v,nt)|0)+Math.imul(k,it)|0,s=s+Math.imul(k,nt)|0,n=n+Math.imul(y,st)|0,r=(r=r+Math.imul(y,ot)|0)+Math.imul(w,st)|0,s=s+Math.imul(w,ot)|0,n=n+Math.imul(d,ht)|0,r=(r=r+Math.imul(d,ct)|0)+Math.imul(m,ht)|0,s=s+Math.imul(m,ct)|0;var Rt=(c+(n=n+Math.imul(f,ft)|0)|0)+((8191&(r=(r=r+Math.imul(f,lt)|0)+Math.imul(l,ft)|0))<<13)|0;c=((s=s+Math.imul(l,lt)|0)+(r>>>13)|0)+(Rt>>>26)|0,Rt&=67108863,n=Math.imul(L,F),r=(r=Math.imul(L,V))+Math.imul(z,F)|0,s=Math.imul(z,V),n=n+Math.imul(C,j)|0,r=(r=r+Math.imul(C,q)|0)+Math.imul(U,j)|0,s=s+Math.imul(U,q)|0,n=n+Math.imul(M,X)|0,r=(r=r+Math.imul(M,Y)|0)+Math.imul(N,X)|0,s=s+Math.imul(N,Y)|0,n=n+Math.imul(O,J)|0,r=(r=r+Math.imul(O,$)|0)+Math.imul(B,J)|0,s=s+Math.imul(B,$)|0,n=n+Math.imul(_,Q)|0,r=(r=r+Math.imul(_,tt)|0)+Math.imul(I,Q)|0,s=s+Math.imul(I,tt)|0,n=n+Math.imul(E,it)|0,r=(r=r+Math.imul(E,nt)|0)+Math.imul(R,it)|0,s=s+Math.imul(R,nt)|0,n=n+Math.imul(v,st)|0,r=(r=r+Math.imul(v,ot)|0)+Math.imul(k,st)|0,s=s+Math.imul(k,ot)|0,n=n+Math.imul(y,ht)|0,r=(r=r+Math.imul(y,ct)|0)+Math.imul(w,ht)|0,s=s+Math.imul(w,ct)|0,n=n+Math.imul(d,ft)|0,r=(r=r+Math.imul(d,lt)|0)+Math.imul(m,ft)|0,s=s+Math.imul(m,lt)|0;var xt=(c+(n=n+Math.imul(f,dt)|0)|0)+((8191&(r=(r=r+Math.imul(f,mt)|0)+Math.imul(l,dt)|0))<<13)|0;c=((s=s+Math.imul(l,mt)|0)+(r>>>13)|0)+(xt>>>26)|0,xt&=67108863,n=Math.imul(L,j),r=(r=Math.imul(L,q))+Math.imul(z,j)|0,s=Math.imul(z,q),n=n+Math.imul(C,X)|0,r=(r=r+Math.imul(C,Y)|0)+Math.imul(U,X)|0,s=s+Math.imul(U,Y)|0,n=n+Math.imul(M,J)|0,r=(r=r+Math.imul(M,$)|0)+Math.imul(N,J)|0,s=s+Math.imul(N,$)|0,n=n+Math.imul(O,Q)|0,r=(r=r+Math.imul(O,tt)|0)+Math.imul(B,Q)|0,s=s+Math.imul(B,tt)|0,n=n+Math.imul(_,it)|0,r=(r=r+Math.imul(_,nt)|0)+Math.imul(I,it)|0,s=s+Math.imul(I,nt)|0,n=n+Math.imul(E,st)|0,r=(r=r+Math.imul(E,ot)|0)+Math.imul(R,st)|0,s=s+Math.imul(R,ot)|0,n=n+Math.imul(v,ht)|0,r=(r=r+Math.imul(v,ct)|0)+Math.imul(k,ht)|0,s=s+Math.imul(k,ct)|0,n=n+Math.imul(y,ft)|0,r=(r=r+Math.imul(y,lt)|0)+Math.imul(w,ft)|0,s=s+Math.imul(w,lt)|0;var _t=(c+(n=n+Math.imul(d,dt)|0)|0)+((8191&(r=(r=r+Math.imul(d,mt)|0)+Math.imul(m,dt)|0))<<13)|0;c=((s=s+Math.imul(m,mt)|0)+(r>>>13)|0)+(_t>>>26)|0,_t&=67108863,n=Math.imul(L,X),r=(r=Math.imul(L,Y))+Math.imul(z,X)|0,s=Math.imul(z,Y),n=n+Math.imul(C,J)|0,r=(r=r+Math.imul(C,$)|0)+Math.imul(U,J)|0,s=s+Math.imul(U,$)|0,n=n+Math.imul(M,Q)|0,r=(r=r+Math.imul(M,tt)|0)+Math.imul(N,Q)|0,s=s+Math.imul(N,tt)|0,n=n+Math.imul(O,it)|0,r=(r=r+Math.imul(O,nt)|0)+Math.imul(B,it)|0,s=s+Math.imul(B,nt)|0,n=n+Math.imul(_,st)|0,r=(r=r+Math.imul(_,ot)|0)+Math.imul(I,st)|0,s=s+Math.imul(I,ot)|0,n=n+Math.imul(E,ht)|0,r=(r=r+Math.imul(E,ct)|0)+Math.imul(R,ht)|0,s=s+Math.imul(R,ct)|0,n=n+Math.imul(v,ft)|0,r=(r=r+Math.imul(v,lt)|0)+Math.imul(k,ft)|0,s=s+Math.imul(k,lt)|0;var It=(c+(n=n+Math.imul(y,dt)|0)|0)+((8191&(r=(r=r+Math.imul(y,mt)|0)+Math.imul(w,dt)|0))<<13)|0;c=((s=s+Math.imul(w,mt)|0)+(r>>>13)|0)+(It>>>26)|0,It&=67108863,n=Math.imul(L,J),r=(r=Math.imul(L,$))+Math.imul(z,J)|0,s=Math.imul(z,$),n=n+Math.imul(C,Q)|0,r=(r=r+Math.imul(C,tt)|0)+Math.imul(U,Q)|0,s=s+Math.imul(U,tt)|0,n=n+Math.imul(M,it)|0,r=(r=r+Math.imul(M,nt)|0)+Math.imul(N,it)|0,s=s+Math.imul(N,nt)|0,n=n+Math.imul(O,st)|0,r=(r=r+Math.imul(O,ot)|0)+Math.imul(B,st)|0,s=s+Math.imul(B,ot)|0,n=n+Math.imul(_,ht)|0,r=(r=r+Math.imul(_,ct)|0)+Math.imul(I,ht)|0,s=s+Math.imul(I,ct)|0,n=n+Math.imul(E,ft)|0,r=(r=r+Math.imul(E,lt)|0)+Math.imul(R,ft)|0,s=s+Math.imul(R,lt)|0;var At=(c+(n=n+Math.imul(v,dt)|0)|0)+((8191&(r=(r=r+Math.imul(v,mt)|0)+Math.imul(k,dt)|0))<<13)|0;c=((s=s+Math.imul(k,mt)|0)+(r>>>13)|0)+(At>>>26)|0,At&=67108863,n=Math.imul(L,Q),r=(r=Math.imul(L,tt))+Math.imul(z,Q)|0,s=Math.imul(z,tt),n=n+Math.imul(C,it)|0,r=(r=r+Math.imul(C,nt)|0)+Math.imul(U,it)|0,s=s+Math.imul(U,nt)|0,n=n+Math.imul(M,st)|0,r=(r=r+Math.imul(M,ot)|0)+Math.imul(N,st)|0,s=s+Math.imul(N,ot)|0,n=n+Math.imul(O,ht)|0,r=(r=r+Math.imul(O,ct)|0)+Math.imul(B,ht)|0,s=s+Math.imul(B,ct)|0,n=n+Math.imul(_,ft)|0,r=(r=r+Math.imul(_,lt)|0)+Math.imul(I,ft)|0,s=s+Math.imul(I,lt)|0;var Ot=(c+(n=n+Math.imul(E,dt)|0)|0)+((8191&(r=(r=r+Math.imul(E,mt)|0)+Math.imul(R,dt)|0))<<13)|0;c=((s=s+Math.imul(R,mt)|0)+(r>>>13)|0)+(Ot>>>26)|0,Ot&=67108863,n=Math.imul(L,it),r=(r=Math.imul(L,nt))+Math.imul(z,it)|0,s=Math.imul(z,nt),n=n+Math.imul(C,st)|0,r=(r=r+Math.imul(C,ot)|0)+Math.imul(U,st)|0,s=s+Math.imul(U,ot)|0,n=n+Math.imul(M,ht)|0,r=(r=r+Math.imul(M,ct)|0)+Math.imul(N,ht)|0,s=s+Math.imul(N,ct)|0,n=n+Math.imul(O,ft)|0,r=(r=r+Math.imul(O,lt)|0)+Math.imul(B,ft)|0,s=s+Math.imul(B,lt)|0;var Bt=(c+(n=n+Math.imul(_,dt)|0)|0)+((8191&(r=(r=r+Math.imul(_,mt)|0)+Math.imul(I,dt)|0))<<13)|0;c=((s=s+Math.imul(I,mt)|0)+(r>>>13)|0)+(Bt>>>26)|0,Bt&=67108863,n=Math.imul(L,st),r=(r=Math.imul(L,ot))+Math.imul(z,st)|0,s=Math.imul(z,ot),n=n+Math.imul(C,ht)|0,r=(r=r+Math.imul(C,ct)|0)+Math.imul(U,ht)|0,s=s+Math.imul(U,ct)|0,n=n+Math.imul(M,ft)|0,r=(r=r+Math.imul(M,lt)|0)+Math.imul(N,ft)|0,s=s+Math.imul(N,lt)|0;var Pt=(c+(n=n+Math.imul(O,dt)|0)|0)+((8191&(r=(r=r+Math.imul(O,mt)|0)+Math.imul(B,dt)|0))<<13)|0;c=((s=s+Math.imul(B,mt)|0)+(r>>>13)|0)+(Pt>>>26)|0,Pt&=67108863,n=Math.imul(L,ht),r=(r=Math.imul(L,ct))+Math.imul(z,ht)|0,s=Math.imul(z,ct),n=n+Math.imul(C,ft)|0,r=(r=r+Math.imul(C,lt)|0)+Math.imul(U,ft)|0,s=s+Math.imul(U,lt)|0;var Mt=(c+(n=n+Math.imul(M,dt)|0)|0)+((8191&(r=(r=r+Math.imul(M,mt)|0)+Math.imul(N,dt)|0))<<13)|0;c=((s=s+Math.imul(N,mt)|0)+(r>>>13)|0)+(Mt>>>26)|0,Mt&=67108863,n=Math.imul(L,ft),r=(r=Math.imul(L,lt))+Math.imul(z,ft)|0,s=Math.imul(z,lt);var Nt=(c+(n=n+Math.imul(C,dt)|0)|0)+((8191&(r=(r=r+Math.imul(C,mt)|0)+Math.imul(U,dt)|0))<<13)|0;c=((s=s+Math.imul(U,mt)|0)+(r>>>13)|0)+(Nt>>>26)|0,Nt&=67108863;var Tt=(c+(n=Math.imul(L,dt))|0)+((8191&(r=(r=Math.imul(L,mt))+Math.imul(z,dt)|0))<<13)|0;return c=((s=Math.imul(z,mt))+(r>>>13)|0)+(Tt>>>26)|0,Tt&=67108863,h[0]=gt,h[1]=yt,h[2]=wt,h[3]=bt,h[4]=vt,h[5]=kt,h[6]=St,h[7]=Et,h[8]=Rt,h[9]=xt,h[10]=_t,h[11]=It,h[12]=At,h[13]=Ot,h[14]=Bt,h[15]=Pt,h[16]=Mt,h[17]=Nt,h[18]=Tt,0!==c&&(h[19]=c,i.length++),i};Math.imul||(S=h),s.prototype.mulTo=function(t,e){var i=this.length+t.length;return 10===this.length&&10===t.length?S(this,t,e):i<63?h(this,t,e):i<1024?function(t,e,i){i.negative=e.negative^t.negative,i.length=t.length+e.length;for(var n=0,r=0,s=0;s<i.length-1;s++){var o=r;r=0;for(var a=67108863&n,h=Math.min(s,e.length-1),c=Math.max(0,s-t.length+1);c<=h;c++){var u=s-c,f=(0|t.words[u])*(0|e.words[c]),l=67108863&f;a=67108863&(l=l+a|0),r+=(o=(o=o+(f/67108864|0)|0)+(l>>>26)|0)>>>26,o&=67108863}i.words[s]=a,n=o,o=r}return 0!==n?i.words[s]=n:i.length--,i.strip()}(this,t,e):c(this,t,e)},u.prototype.makeRBT=function(t){for(var e=new Array(t),i=s.prototype._countBits(t)-1,n=0;n<t;n++)e[n]=this.revBin(n,i,t);return e},u.prototype.revBin=function(t,e,i){if(0===t||t===i-1)return t;for(var n=0,r=0;r<e;r++)n|=(1&t)<<e-r-1,t>>=1;return n},u.prototype.permute=function(t,e,i,n,r,s){for(var o=0;o<s;o++)n[o]=e[t[o]],r[o]=i[t[o]]},u.prototype.transform=function(t,e,i,n,r,s){this.permute(s,t,e,i,n,r);for(var o=1;o<r;o<<=1)for(var a=o<<1,h=Math.cos(2*Math.PI/a),c=Math.sin(2*Math.PI/a),u=0;u<r;u+=a)for(var f=h,l=c,p=0;p<o;p++){var d=i[u+p],m=n[u+p],g=i[u+p+o],y=n[u+p+o],w=f*g-l*y;y=f*y+l*g,g=w,i[u+p]=d+g,n[u+p]=m+y,i[u+p+o]=d-g,n[u+p+o]=m-y,p!==a&&(w=h*f-c*l,l=h*l+c*f,f=w)}},u.prototype.guessLen13b=function(t,e){var i=1|Math.max(e,t),n=1&i,r=0;for(i=i/2|0;i;i>>>=1)r++;return 1<<r+1+n},u.prototype.conjugate=function(t,e,i){if(!(i<=1))for(var n=0;n<i/2;n++){var r=t[n];t[n]=t[i-n-1],t[i-n-1]=r,r=e[n],e[n]=-e[i-n-1],e[i-n-1]=-r}},u.prototype.normalize13b=function(t,e){for(var i=0,n=0;n<e/2;n++){var r=8192*Math.round(t[2*n+1]/e)+Math.round(t[2*n]/e)+i;t[n]=67108863&r,i=r<67108864?0:r/67108864|0}return t},u.prototype.convert13b=function(t,e,i,r){for(var s=0,o=0;o<e;o++)s+=0|t[o],i[2*o]=8191&s,s>>>=13,i[2*o+1]=8191&s,s>>>=13;for(o=2*e;o<r;++o)i[o]=0;n(0===s),n(0==(-8192&s))},u.prototype.stub=function(t){for(var e=new Array(t),i=0;i<t;i++)e[i]=0;return e},u.prototype.mulp=function(t,e,i){var n=2*this.guessLen13b(t.length,e.length),r=this.makeRBT(n),s=this.stub(n),o=new Array(n),a=new Array(n),h=new Array(n),c=new Array(n),u=new Array(n),f=new Array(n),l=i.words;l.length=n,this.convert13b(t.words,t.length,o,n),this.convert13b(e.words,e.length,c,n),this.transform(o,s,a,h,n,r),this.transform(c,s,u,f,n,r);for(var p=0;p<n;p++){var d=a[p]*u[p]-h[p]*f[p];h[p]=a[p]*f[p]+h[p]*u[p],a[p]=d}return this.conjugate(a,h,n),this.transform(a,h,l,s,n,r),this.conjugate(l,s,n),this.normalize13b(l,n),i.negative=t.negative^e.negative,i.length=t.length+e.length,i.strip()},s.prototype.mul=function(t){var e=new s(null);return e.words=new Array(this.length+t.length),this.mulTo(t,e)},s.prototype.mulf=function(t){var e=new s(null);return e.words=new Array(this.length+t.length),c(this,t,e)},s.prototype.imul=function(t){return this.clone().mulTo(t,this)},s.prototype.imuln=function(t){n("number"==typeof t),n(t<67108864);for(var e=0,i=0;i<this.length;i++){var r=(0|this.words[i])*t,s=(67108863&r)+(67108863&e);e>>=26,e+=r/67108864|0,e+=s>>>26,this.words[i]=67108863&s}return 0!==e&&(this.words[i]=e,this.length++),this},s.prototype.muln=function(t){return this.clone().imuln(t)},s.prototype.sqr=function(){return this.mul(this)},s.prototype.isqr=function(){return this.imul(this.clone())},s.prototype.pow=function(t){var e=function(t){for(var e=new Array(t.bitLength()),i=0;i<e.length;i++){var n=i/26|0,r=i%26;e[i]=(t.words[n]&1<<r)>>>r}return e}(t);if(0===e.length)return new s(1);for(var i=this,n=0;n<e.length&&0===e[n];n++,i=i.sqr());if(++n<e.length)for(var r=i.sqr();n<e.length;n++,r=r.sqr())0!==e[n]&&(i=i.mul(r));return i},s.prototype.iushln=function(t){n("number"==typeof t&&t>=0);var e,i=t%26,r=(t-i)/26,s=67108863>>>26-i<<26-i;if(0!==i){var o=0;for(e=0;e<this.length;e++){var a=this.words[e]&s,h=(0|this.words[e])-a<<i;this.words[e]=h|o,o=a>>>26-i}o&&(this.words[e]=o,this.length++)}if(0!==r){for(e=this.length-1;e>=0;e--)this.words[e+r]=this.words[e];for(e=0;e<r;e++)this.words[e]=0;this.length+=r}return this.strip()},s.prototype.ishln=function(t){return n(0===this.negative),this.iushln(t)},s.prototype.iushrn=function(t,e,i){n("number"==typeof t&&t>=0);var r;r=e?(e-e%26)/26:0;var s=t%26,o=Math.min((t-s)/26,this.length),a=67108863^67108863>>>s<<s,h=i;if(r-=o,r=Math.max(0,r),h){for(var c=0;c<o;c++)h.words[c]=this.words[c];h.length=o}if(0===o);else if(this.length>o)for(this.length-=o,c=0;c<this.length;c++)this.words[c]=this.words[c+o];else this.words[0]=0,this.length=1;var u=0;for(c=this.length-1;c>=0&&(0!==u||c>=r);c--){var f=0|this.words[c];this.words[c]=u<<26-s|f>>>s,u=f&a}return h&&0!==u&&(h.words[h.length++]=u),0===this.length&&(this.words[0]=0,this.length=1),this.strip()},s.prototype.ishrn=function(t,e,i){return n(0===this.negative),this.iushrn(t,e,i)},s.prototype.shln=function(t){return this.clone().ishln(t)},s.prototype.ushln=function(t){return this.clone().iushln(t)},s.prototype.shrn=function(t){return this.clone().ishrn(t)},s.prototype.ushrn=function(t){return this.clone().iushrn(t)},s.prototype.testn=function(t){n("number"==typeof t&&t>=0);var e=t%26,i=(t-e)/26,r=1<<e;if(this.length<=i)return!1;return!!(this.words[i]&r)},s.prototype.imaskn=function(t){n("number"==typeof t&&t>=0);var e=t%26,i=(t-e)/26;if(n(0===this.negative,"imaskn works only with positive numbers"),this.length<=i)return this;if(0!==e&&i++,this.length=Math.min(i,this.length),0!==e){var r=67108863^67108863>>>e<<e;this.words[this.length-1]&=r}return this.strip()},s.prototype.maskn=function(t){return this.clone().imaskn(t)},s.prototype.iaddn=function(t){return n("number"==typeof t),n(t<67108864),t<0?this.isubn(-t):0!==this.negative?1===this.length&&(0|this.words[0])<t?(this.words[0]=t-(0|this.words[0]),this.negative=0,this):(this.negative=0,this.isubn(t),this.negative=1,this):this._iaddn(t)},s.prototype._iaddn=function(t){this.words[0]+=t;for(var e=0;e<this.length&&this.words[e]>=67108864;e++)this.words[e]-=67108864,e===this.length-1?this.words[e+1]=1:this.words[e+1]++;return this.length=Math.max(this.length,e+1),this},s.prototype.isubn=function(t){if(n("number"==typeof t),n(t<67108864),t<0)return this.iaddn(-t);if(0!==this.negative)return this.negative=0,this.iaddn(t),this.negative=1,this;if(this.words[0]-=t,1===this.length&&this.words[0]<0)this.words[0]=-this.words[0],this.negative=1;else for(var e=0;e<this.length&&this.words[e]<0;e++)this.words[e]+=67108864,this.words[e+1]-=1;return this.strip()},s.prototype.addn=function(t){return this.clone().iaddn(t)},s.prototype.subn=function(t){return this.clone().isubn(t)},s.prototype.iabs=function(){return this.negative=0,this},s.prototype.abs=function(){return this.clone().iabs()},s.prototype._ishlnsubmul=function(t,e,i){var r,s=t.length+i;this._expand(s);var o,a=0;for(r=0;r<t.length;r++){o=(0|this.words[r+i])+a;var h=(0|t.words[r])*e;a=((o-=67108863&h)>>26)-(h/67108864|0),this.words[r+i]=67108863&o}for(;r<this.length-i;r++)a=(o=(0|this.words[r+i])+a)>>26,this.words[r+i]=67108863&o;if(0===a)return this.strip();for(n(-1===a),a=0,r=0;r<this.length;r++)a=(o=-(0|this.words[r])+a)>>26,this.words[r]=67108863&o;return this.negative=1,this.strip()},s.prototype._wordDiv=function(t,e){var i=this.length-t.length,n=this.clone(),r=t,o=0|r.words[r.length-1];0!==(i=26-this._countBits(o))&&(r=r.ushln(i),n.iushln(i),o=0|r.words[r.length-1]);var a,h=n.length-r.length;if("mod"!==e){(a=new s(null)).length=h+1,a.words=new Array(a.length);for(var c=0;c<a.length;c++)a.words[c]=0}var u=n.clone()._ishlnsubmul(r,1,h);0===u.negative&&(n=u,a&&(a.words[h]=1));for(var f=h-1;f>=0;f--){var l=67108864*(0|n.words[r.length+f])+(0|n.words[r.length+f-1]);for(l=Math.min(l/o|0,67108863),n._ishlnsubmul(r,l,f);0!==n.negative;)l--,n.negative=0,n._ishlnsubmul(r,1,f),n.isZero()||(n.negative^=1);a&&(a.words[f]=l)}return a&&a.strip(),n.strip(),"div"!==e&&0!==i&&n.iushrn(i),{div:a||null,mod:n}},s.prototype.divmod=function(t,e,i){if(n(!t.isZero()),this.isZero())return{div:new s(0),mod:new s(0)};var r,o,a;return 0!==this.negative&&0===t.negative?(a=this.neg().divmod(t,e),"mod"!==e&&(r=a.div.neg()),"div"!==e&&(o=a.mod.neg(),i&&0!==o.negative&&o.iadd(t)),{div:r,mod:o}):0===this.negative&&0!==t.negative?(a=this.divmod(t.neg(),e),"mod"!==e&&(r=a.div.neg()),{div:r,mod:a.mod}):0!=(this.negative&t.negative)?(a=this.neg().divmod(t.neg(),e),"div"!==e&&(o=a.mod.neg(),i&&0!==o.negative&&o.isub(t)),{div:a.div,mod:o}):t.length>this.length||this.cmp(t)<0?{div:new s(0),mod:this}:1===t.length?"div"===e?{div:this.divn(t.words[0]),mod:null}:"mod"===e?{div:null,mod:new s(this.modn(t.words[0]))}:{div:this.divn(t.words[0]),mod:new s(this.modn(t.words[0]))}:this._wordDiv(t,e)},s.prototype.div=function(t){return this.divmod(t,"div",!1).div},s.prototype.mod=function(t){return this.divmod(t,"mod",!1).mod},s.prototype.umod=function(t){return this.divmod(t,"mod",!0).mod},s.prototype.divRound=function(t){var e=this.divmod(t);if(e.mod.isZero())return e.div;var i=0!==e.div.negative?e.mod.isub(t):e.mod,n=t.ushrn(1),r=t.andln(1),s=i.cmp(n);return s<0||1===r&&0===s?e.div:0!==e.div.negative?e.div.isubn(1):e.div.iaddn(1)},s.prototype.modn=function(t){n(t<=67108863);for(var e=(1<<26)%t,i=0,r=this.length-1;r>=0;r--)i=(e*i+(0|this.words[r]))%t;return i},s.prototype.idivn=function(t){n(t<=67108863);for(var e=0,i=this.length-1;i>=0;i--){var r=(0|this.words[i])+67108864*e;this.words[i]=r/t|0,e=r%t}return this.strip()},s.prototype.divn=function(t){return this.clone().idivn(t)},s.prototype.egcd=function(t){n(0===t.negative),n(!t.isZero());var e=this,i=t.clone();e=0!==e.negative?e.umod(t):e.clone();for(var r=new s(1),o=new s(0),a=new s(0),h=new s(1),c=0;e.isEven()&&i.isEven();)e.iushrn(1),i.iushrn(1),++c;for(var u=i.clone(),f=e.clone();!e.isZero();){for(var l=0,p=1;0==(e.words[0]&p)&&l<26;++l,p<<=1);if(l>0)for(e.iushrn(l);l-- >0;)(r.isOdd()||o.isOdd())&&(r.iadd(u),o.isub(f)),r.iushrn(1),o.iushrn(1);for(var d=0,m=1;0==(i.words[0]&m)&&d<26;++d,m<<=1);if(d>0)for(i.iushrn(d);d-- >0;)(a.isOdd()||h.isOdd())&&(a.iadd(u),h.isub(f)),a.iushrn(1),h.iushrn(1);e.cmp(i)>=0?(e.isub(i),r.isub(a),o.isub(h)):(i.isub(e),a.isub(r),h.isub(o))}return{a:a,b:h,gcd:i.iushln(c)}},s.prototype._invmp=function(t){n(0===t.negative),n(!t.isZero());var e=this,i=t.clone();e=0!==e.negative?e.umod(t):e.clone();for(var r=new s(1),o=new s(0),a=i.clone();e.cmpn(1)>0&&i.cmpn(1)>0;){for(var h=0,c=1;0==(e.words[0]&c)&&h<26;++h,c<<=1);if(h>0)for(e.iushrn(h);h-- >0;)r.isOdd()&&r.iadd(a),r.iushrn(1);for(var u=0,f=1;0==(i.words[0]&f)&&u<26;++u,f<<=1);if(u>0)for(i.iushrn(u);u-- >0;)o.isOdd()&&o.iadd(a),o.iushrn(1);e.cmp(i)>=0?(e.isub(i),r.isub(o)):(i.isub(e),o.isub(r))}var l;return(l=0===e.cmpn(1)?r:o).cmpn(0)<0&&l.iadd(t),l},s.prototype.gcd=function(t){if(this.isZero())return t.abs();if(t.isZero())return this.abs();var e=this.clone(),i=t.clone();e.negative=0,i.negative=0;for(var n=0;e.isEven()&&i.isEven();n++)e.iushrn(1),i.iushrn(1);for(;;){for(;e.isEven();)e.iushrn(1);for(;i.isEven();)i.iushrn(1);var r=e.cmp(i);if(r<0){var s=e;e=i,i=s}else if(0===r||0===i.cmpn(1))break;e.isub(i)}return i.iushln(n)},s.prototype.invm=function(t){return this.egcd(t).a.umod(t)},s.prototype.isEven=function(){return 0==(1&this.words[0])},s.prototype.isOdd=function(){return 1==(1&this.words[0])},s.prototype.andln=function(t){return this.words[0]&t},s.prototype.bincn=function(t){n("number"==typeof t);var e=t%26,i=(t-e)/26,r=1<<e;if(this.length<=i)return this._expand(i+1),this.words[i]|=r,this;for(var s=r,o=i;0!==s&&o<this.length;o++){var a=0|this.words[o];s=(a+=s)>>>26,a&=67108863,this.words[o]=a}return 0!==s&&(this.words[o]=s,this.length++),this},s.prototype.isZero=function(){return 1===this.length&&0===this.words[0]},s.prototype.cmpn=function(t){var e=t<0;if(0!==this.negative&&!e)return-1;if(0===this.negative&&e)return 1;this.strip();var i;if(this.length>1)i=1;else{e&&(t=-t),n(t<=67108863,"Number is too big");var r=0|this.words[0];i=r===t?0:r<t?-1:1}return 0!==this.negative?0|-i:i},s.prototype.cmp=function(t){if(0!==this.negative&&0===t.negative)return-1;if(0===this.negative&&0!==t.negative)return 1;var e=this.ucmp(t);return 0!==this.negative?0|-e:e},s.prototype.ucmp=function(t){if(this.length>t.length)return 1;if(this.length<t.length)return-1;for(var e=0,i=this.length-1;i>=0;i--){var n=0|this.words[i],r=0|t.words[i];if(n!==r){n<r?e=-1:n>r&&(e=1);break}}return e},s.prototype.gtn=function(t){return 1===this.cmpn(t)},s.prototype.gt=function(t){return 1===this.cmp(t)},s.prototype.gten=function(t){return this.cmpn(t)>=0},s.prototype.gte=function(t){return this.cmp(t)>=0},s.prototype.ltn=function(t){return-1===this.cmpn(t)},s.prototype.lt=function(t){return-1===this.cmp(t)},s.prototype.lten=function(t){return this.cmpn(t)<=0},s.prototype.lte=function(t){return this.cmp(t)<=0},s.prototype.eqn=function(t){return 0===this.cmpn(t)},s.prototype.eq=function(t){return 0===this.cmp(t)},s.red=function(t){return new g(t)},s.prototype.toRed=function(t){return n(!this.red,"Already a number in reduction context"),n(0===this.negative,"red works only with positives"),t.convertTo(this)._forceRed(t)},s.prototype.fromRed=function(){return n(this.red,"fromRed works only with numbers in reduction context"),this.red.convertFrom(this)},s.prototype._forceRed=function(t){return this.red=t,this},s.prototype.forceRed=function(t){return n(!this.red,"Already a number in reduction context"),this._forceRed(t)},s.prototype.redAdd=function(t){return n(this.red,"redAdd works only with red numbers"),this.red.add(this,t)},s.prototype.redIAdd=function(t){return n(this.red,"redIAdd works only with red numbers"),this.red.iadd(this,t)},s.prototype.redSub=function(t){return n(this.red,"redSub works only with red numbers"),this.red.sub(this,t)},s.prototype.redISub=function(t){return n(this.red,"redISub works only with red numbers"),this.red.isub(this,t)},s.prototype.redShl=function(t){return n(this.red,"redShl works only with red numbers"),this.red.shl(this,t)},s.prototype.redMul=function(t){return n(this.red,"redMul works only with red numbers"),this.red._verify2(this,t),this.red.mul(this,t)},s.prototype.redIMul=function(t){return n(this.red,"redMul works only with red numbers"),this.red._verify2(this,t),this.red.imul(this,t)},s.prototype.redSqr=function(){return n(this.red,"redSqr works only with red numbers"),this.red._verify1(this),this.red.sqr(this)},s.prototype.redISqr=function(){return n(this.red,"redISqr works only with red numbers"),this.red._verify1(this),this.red.isqr(this)},s.prototype.redSqrt=function(){return n(this.red,"redSqrt works only with red numbers"),this.red._verify1(this),this.red.sqrt(this)},s.prototype.redInvm=function(){return n(this.red,"redInvm works only with red numbers"),this.red._verify1(this),this.red.invm(this)},s.prototype.redNeg=function(){return n(this.red,"redNeg works only with red numbers"),this.red._verify1(this),this.red.neg(this)},s.prototype.redPow=function(t){return n(this.red&&!t.red,"redPow(normalNum)"),this.red._verify1(this),this.red.pow(this,t)};var E={k256:null,p224:null,p192:null,p25519:null};f.prototype._tmp=function(){var t=new s(null);return t.words=new Array(Math.ceil(this.n/13)),t},f.prototype.ireduce=function(t){var e,i=t;do{this.split(i,this.tmp),e=(i=(i=this.imulK(i)).iadd(this.tmp)).bitLength()}while(e>this.n);var n=e<this.n?-1:i.ucmp(this.p);return 0===n?(i.words[0]=0,i.length=1):n>0?i.isub(this.p):i.strip(),i},f.prototype.split=function(t,e){t.iushrn(this.n,0,e)},f.prototype.imulK=function(t){return t.imul(this.k)},r(l,f),l.prototype.split=function(t,e){for(var i=Math.min(t.length,9),n=0;n<i;n++)e.words[n]=t.words[n];if(e.length=i,t.length<=9)return t.words[0]=0,void(t.length=1);var r=t.words[9];for(e.words[e.length++]=4194303&r,n=10;n<t.length;n++){var s=0|t.words[n];t.words[n-10]=(4194303&s)<<4|r>>>22,r=s}r>>>=22,t.words[n-10]=r,0===r&&t.length>10?t.length-=10:t.length-=9},l.prototype.imulK=function(t){t.words[t.length]=0,t.words[t.length+1]=0,t.length+=2;for(var e=0,i=0;i<t.length;i++){var n=0|t.words[i];e+=977*n,t.words[i]=67108863&e,e=64*n+(e/67108864|0)}return 0===t.words[t.length-1]&&(t.length--,0===t.words[t.length-1]&&t.length--),t},r(p,f),r(d,f),r(m,f),m.prototype.imulK=function(t){for(var e=0,i=0;i<t.length;i++){var n=19*(0|t.words[i])+e,r=67108863&n;n>>>=26,t.words[i]=r,e=n}return 0!==e&&(t.words[t.length++]=e),t},s._prime=function(t){if(E[t])return E[t];var e;if("k256"===t)e=new l;else if("p224"===t)e=new p;else if("p192"===t)e=new d;else{if("p25519"!==t)throw new Error("Unknown prime "+t);e=new m}return E[t]=e,e},g.prototype._verify1=function(t){n(0===t.negative,"red works only with positives"),n(t.red,"red works only with red numbers")},g.prototype._verify2=function(t,e){n(0==(t.negative|e.negative),"red works only with positives"),n(t.red&&t.red===e.red,"red works only with red numbers")},g.prototype.imod=function(t){return this.prime?this.prime.ireduce(t)._forceRed(this):t.umod(this.m)._forceRed(this)},g.prototype.neg=function(t){return t.isZero()?t.clone():this.m.sub(t)._forceRed(this)},g.prototype.add=function(t,e){this._verify2(t,e);var i=t.add(e);return i.cmp(this.m)>=0&&i.isub(this.m),i._forceRed(this)},g.prototype.iadd=function(t,e){this._verify2(t,e);var i=t.iadd(e);return i.cmp(this.m)>=0&&i.isub(this.m),i},g.prototype.sub=function(t,e){this._verify2(t,e);var i=t.sub(e);return i.cmpn(0)<0&&i.iadd(this.m),i._forceRed(this)},g.prototype.isub=function(t,e){this._verify2(t,e);var i=t.isub(e);return i.cmpn(0)<0&&i.iadd(this.m),i},g.prototype.shl=function(t,e){return this._verify1(t),this.imod(t.ushln(e))},g.prototype.imul=function(t,e){return this._verify2(t,e),this.imod(t.imul(e))},g.prototype.mul=function(t,e){return this._verify2(t,e),this.imod(t.mul(e))},g.prototype.isqr=function(t){return this.imul(t,t.clone())},g.prototype.sqr=function(t){return this.mul(t,t)},g.prototype.sqrt=function(t){if(t.isZero())return t.clone();var e=this.m.andln(3);if(n(e%2==1),3===e){var i=this.m.add(new s(1)).iushrn(2);return this.pow(t,i)}for(var r=this.m.subn(1),o=0;!r.isZero()&&0===r.andln(1);)o++,r.iushrn(1);n(!r.isZero());var a=new s(1).toRed(this),h=a.redNeg(),c=this.m.subn(1).iushrn(1),u=this.m.bitLength();for(u=new s(2*u*u).toRed(this);0!==this.pow(u,c).cmp(h);)u.redIAdd(h);for(var f=this.pow(u,r),l=this.pow(t,r.addn(1).iushrn(1)),p=this.pow(t,r),d=o;0!==p.cmp(a);){for(var m=p,g=0;0!==m.cmp(a);g++)m=m.redSqr();n(g<d);var y=this.pow(f,new s(1).iushln(d-g-1));l=l.redMul(y),f=y.redSqr(),p=p.redMul(f),d=g}return l},g.prototype.invm=function(t){var e=t._invmp(this.m);return 0!==e.negative?(e.negative=0,this.imod(e).redNeg()):this.imod(e)},g.prototype.pow=function(t,e){if(e.isZero())return new s(1).toRed(this);if(0===e.cmpn(1))return t.clone();var i=new Array(16);i[0]=new s(1).toRed(this),i[1]=t;for(var n=2;n<i.length;n++)i[n]=this.mul(i[n-1],t);var r=i[0],o=0,a=0,h=e.bitLength()%26;for(0===h&&(h=26),n=e.length-1;n>=0;n--){for(var c=e.words[n],u=h-1;u>=0;u--){var f=c>>u&1;r!==i[0]&&(r=this.sqr(r)),0!==f||0!==o?(o<<=1,o|=f,(4===++a||0===n&&0===u)&&(r=this.mul(r,i[o]),a=0,o=0)):a=0}h=26}return r},g.prototype.convertTo=function(t){var e=t.umod(this.m);return e===t?e.clone():e},g.prototype.convertFrom=function(t){var e=t.clone();return e.red=null,e},s.mont=function(t){return new y(t)},r(y,g),y.prototype.convertTo=function(t){return this.imod(t.ushln(this.shift))},y.prototype.convertFrom=function(t){var e=this.imod(t.mul(this.rinv));return e.red=null,e},y.prototype.imul=function(t,e){if(t.isZero()||e.isZero())return t.words[0]=0,t.length=1,t;var i=t.imul(e),n=i.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),r=i.isub(n).iushrn(this.shift),s=r;return r.cmp(this.m)>=0?s=r.isub(this.m):r.cmpn(0)<0&&(s=r.iadd(this.m)),s._forceRed(this)},y.prototype.mul=function(t,e){if(t.isZero()||e.isZero())return new s(0)._forceRed(this);var i=t.mul(e),n=i.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),r=i.isub(n).iushrn(this.shift),o=r;return r.cmp(this.m)>=0?o=r.isub(this.m):r.cmpn(0)<0&&(o=r.iadd(this.m)),o._forceRed(this)},y.prototype.invm=function(t){return this.imod(t._invmp(this.m).mul(this.r2))._forceRed(this)}}(void 0===t||t,this)}).call(e,i(64)(t))},function(t,e,i){"use strict";if(e.binding=null,1!==Number(process.env.WMCC_NO_NATIVE))try{e.binding=i(132)}catch(t){}},function(t,e,i){"use strict";const n=i(0),r=i(7);e.MAX_TX_VERSION=2,e.MAX_TX_SIZE=r.MAX_BLOCK_SIZE/10,e.MAX_TX_WEIGHT=r.MAX_BLOCK_WEIGHT/10,e.MAX_TX_SIGOPS=r.MAX_BLOCK_SIGOPS/5,e.MAX_TX_SIGOPS_COST=r.MAX_BLOCK_SIGOPS_COST/5,e.BYTES_PER_SIGOP=20,e.MIN_RELAY=1e3,e.BARE_MULTISIG=!0,e.FREE_THRESHOLD=144*r.COIN/250,e.MAX_P2SH_SIGOPS=15,e.MAX_OP_RETURN_BYTES=83,e.MAX_OP_RETURN=80,e.MAX_P2WSH_STACK=100,e.MAX_P2WSH_PUSH=80,e.MAX_P2WSH_SIZE=3600,e.MEMPOOL_MAX_ANCESTORS=25,e.MEMPOOL_MAX_SIZE=1e8,e.MEMPOOL_EXPIRY_TIME=259200,e.MEMPOOL_MAX_ORPHANS=100,e.MIN_BLOCK_WEIGHT=0,e.MAX_BLOCK_WEIGHT=1e6*r.WITNESS_SCALE_FACTOR,e.BLOCK_PRIORITY_WEIGHT=0,e.BLOCK_PRIORITY_THRESHOLD=e.FREE_THRESHOLD,e.getMinFee=function(t,i){if(null==i&&(i=e.MIN_RELAY),n(t>=0),n(i>=0),0===t)return 0;let r=Math.floor(i*t/1e3);return 0===r&&i>0&&(r=i),r},e.getRoundFee=function(t,i){if(null==i&&(i=e.MIN_RELAY),n(t>=0),n(i>=0),0===t)return 0;let r=i*Math.ceil(t/1e3);return 0===r&&i>0&&(r=i),r},e.getRate=function(t,e){return n(t>=0),n(e>=0),0===t?0:Math.floor(1e3*e/t)}},function(t,e,i){"use strict";function n(t,e){if(!(this instanceof n))return new n(t,e);this.value=0,this.unit=null,null!=t&&this.fromOptions(t,e)}const r=i(0),s=i(1);n.prototype.fromOptions=function(t,e){return"string"==typeof e?this.from(e,t):"number"==typeof t?this.fromValue(t):this.fromWMCC(t)},n.prototype.toValue=function(){return this.value},n.prototype.toWMCoin=function(t){return t?this.value:this.value.toString(10)},n.prototype.toBits=function(t){return n.encode(this.value,2,t)},n.prototype.toMWMCC=function(t){return n.encode(this.value,5,t)},n.prototype.toWMCC=function(t){return n.encode(this.value,8,t)},n.prototype.to=function(t,e){switch(t){case"wmcoin":return this.toWMCoin(e);case"uwmcc":case"bits":return this.toBits(e);case"mwmcc":return this.toMWMCC(e);case"wmcc":return this.toWMCC(e)}throw new Error(`Unknown unit "${t}".`)},n.prototype.toString=function(){return this.toWMCC()},n.prototype.toText=function(t,e){return`${this.to(t,e)} ${t}`},n.prototype.fromValue=function(t){return r(s.isI64(t),"Value must be an int64."),this.unit="wmcc",this.value=t,this},n.prototype.fromWMCoin=function(t){return this.unit="wmcoin",this.value=n.decode(t,0),this},n.prototype.fromBits=function(t){return this.unit="bits",this.value=n.decode(t,2),this},n.prototype.fromMWMCC=function(t){return this.unit="mwmcc",this.value=n.decode(t,5),this},n.prototype.fromWMCC=function(t){return this.unit="wmcc",this.value=n.decode(t,8),this},n.prototype.from=function(t,e){switch(t){case"wmcoin":return this.fromWMCoin(e);case"uwmcc":case"bits":return this.fromBits(e);case"mwmcc":return this.fromMWMCC(e);case"wmcc":return this.fromWMCC(e)}throw new Error(`Unknown unit "${t}".`)},n.fromOptions=function(t,e){return(new n).fromOptions(t,e)},n.fromValue=function(t){return(new n).fromValue(t)},n.fromWMCoin=function(t){return(new n).fromWMCoin(t)},n.fromBits=function(t){return(new n).fromBits(t)},n.fromMWMCC=function(t){return(new n).fromMWMCC(t)},n.fromWMCC=function(t){return(new n).fromWMCC(t)},n.from=function(t,e){return(new n).from(t,e)},n.prototype.inspect=function(){return`<Amount: ${this.toString()}>`},n.wmcoin=function(t){return n.fromWMCC(t).toWMCoin(!0)},n.wmcc=function(t,e){return"string"==typeof t?t:n.encode(t,8,e)},n.text=function(t,e){return`${n.wmcc(t,e)} wmcc`},n.value=function(t){return"number"==typeof t?t:n.decode(t,8)},n.encode=function(t,e,i){return i?s.toFloat(t,e):s.toFixed(t,e)},n.decode=function(t,e){return"number"==typeof t?s.fromFloat(t,e):s.fromFixed(t,e)},t.exports=n},function(t,e,i){"use strict";function n(t,e){if(!(this instanceof n))return new n(t,e);this.hash=h.NULL_HASH,this.index=4294967295,null!=t&&(r("string"==typeof t,"Hash must be a string."),r(s.isU32(e),"Index must be a uint32."),this.hash=t,this.index=e)}const r=i(0),s=i(1),o=i(4),a=i(2),h=i(3);n.prototype.fromOptions=function(t){return r(t,"Outpoint data is required."),r("string"==typeof t.hash,"Hash must be a string."),r(s.isU32(t.index),"Index must be a uint32."),this.hash=t.hash,this.index=t.index,this},n.fromOptions=function(t){return(new n).fromOptions(t)},n.prototype.clone=function(){const t=new n;return t.hash=this.value,t.index=this.index,t},n.prototype.equals=function(t){return r(n.isOutpoint(t)),this.hash===t.hash&&this.index===t.index},n.prototype.compare=function(t){r(n.isOutpoint(t));const e=s.strcmp(this.txid(),t.txid());return 0!==e?e:this.index-t.index},n.prototype.isNull=function(){return 4294967295===this.index&&this.hash===h.NULL_HASH},n.prototype.rhash=function(){return s.revHex(this.hash)},n.prototype.txid=function(){return this.rhash()},n.prototype.toKey=function(){return n.toKey(this.hash,this.index)},n.prototype.fromKey=function(t){return r(t.length>64),this.hash=t.slice(0,64),this.index=parseInt(t.slice(64),10),this},n.fromKey=function(t){return(new n).fromKey(t)},n.prototype.toWriter=function(t){return t.writeHash(this.hash),t.writeU32(this.index),t},n.prototype.getSize=function(){return 36},n.prototype.toRaw=function(){return this.toWriter(new o(36)).render()},n.prototype.fromReader=function(t){return this.hash=t.readHash("hex"),this.index=t.readU32(),this},n.prototype.fromRaw=function(t){return this.fromReader(new a(t))},n.fromReader=function(t){return(new n).fromReader(t)},n.fromRaw=function(t){return(new n).fromRaw(t)},n.prototype.fromJSON=function(t){return r(t,"Outpoint data is required."),r("string"==typeof t.hash,"Hash must be a string."),r(s.isU32(t.index),"Index must be a uint32."),this.hash=s.revHex(t.hash),this.index=t.index,this},n.prototype.toJSON=function(){return{hash:s.revHex(this.hash),index:this.index}},n.fromJSON=function(t){return(new n).fromJSON(t)},n.prototype.fromTX=function(t,e){return r(t),r("number"==typeof e),r(e>=0),this.hash=t.hash("hex"),this.index=e,this},n.fromTX=function(t,e){return(new n).fromTX(t,e)},n.toKey=function(t,e){return r("string"==typeof t),r(64===t.length),r(e>=0),t+e},n.prototype.inspect=function(){return`<Outpoint: ${this.rhash()}/${this.index}>`},n.isOutpoint=function(t){return t instanceof n},t.exports=n},function(t,e){function i(t,e){if(!t)throw new Error(e||"Assertion failed")}t.exports=i,i.equal=function(t,e,i){if(t!=e)throw new Error(i||"Assertion failed: "+t+" != "+e)}},function(t,e,i){"use strict";function n(t){if(!(this instanceof n))return n.create(t);this.named=!0===t,this.jobs=[],this.busy=!1,this.destroyed=!1,this.map=new Map,this.current=null,this.unlocker=this.unlock.bind(this)}function r(){}const s=i(0);n.create=function(t){const e=new n(t);return function(t,i){return e.lock(t,i)}},n.prototype.has=function(t){if(s(this.named,"Must use named jobs."),this.current===t)return!0;const e=this.map.get(t);return null!=e&&e>0},n.prototype.hasPending=function(t){s(this.named,"Must use named jobs.");const e=this.map.get(t);return null!=e&&e>0},n.prototype.lock=function(t,e){let i,n;if(this.named?(i=t||null,n=e):(i=null,n=t),this.destroyed)return Promise.reject(new Error("Lock is destroyed."));if(n)return s(this.busy),Promise.resolve(r);if(this.busy){if(i){let t=this.map.get(i);t||(t=0),this.map.set(i,t+1)}return new Promise((t,e)=>{this.jobs.push(new function(t,e,i){this.resolve=t,this.reject=e,this.name=i||null}(t,e,i))})}return this.busy=!0,this.current=i,Promise.resolve(this.unlocker)},n.prototype.unlock=function(){if(s(this.destroyed||this.busy),this.busy=!1,this.current=null,0===this.jobs.length)return;s(!this.destroyed);const t=this.jobs.shift();if(t.name){let e=this.map.get(t.name);s(e>0),0==--e?this.map.delete(t.name):this.map.set(t.name,e)}this.busy=!0,this.current=t.name,t.resolve(this.unlocker)},n.prototype.destroy=function(){s(!this.destroyed,"Lock is already destroyed."),this.destroyed=!0;const t=this.jobs;this.busy=!1,this.jobs=[],this.map.clear(),this.current=null;for(const e of t)e.reject(new Error("Lock was destroyed."))},t.exports=n},function(t,e){t.exports=require("crypto")},function(t,e,i){"use strict";const n=i(0),r=i(18).binding,s="123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz",o={};for(let t=0;t<s.length;t++)o[s[t]]=t;e.encode=function(t){let e=0,i=0;for(;i<t.length&&0===t[i];i++)e++;const r=Buffer.allocUnsafe(1+(138*t.length/100|0));r.fill(0);let o=0;for(;i<t.length;i++){let e=t[i],s=0;for(let t=r.length-1;t>=0&&!(0===e&&s>=o);t--,s++)e+=256*r[t],r[t]=e%58,e=e/58|0;n(0===e),o=s}for(i=r.length-o;i<r.length&&0===r[i];)i++;let a="";for(let t=0;t<e;t++)a+="1";for(;i<r.length;i++)a+=s[r[i]];return a},r&&(e.encode=r.toBase58),e.decode=function(t){let e=0,i=0;for(;i<t.length&&"1"===t[i];i++)e++;const r=Buffer.allocUnsafe(1+(733*t.length/1e3|0));r.fill(0);let s=0;for(;i<t.length;i++){const e=o[t[i]];if(null==e)throw new Error("Non-base58 character.");let a=e,h=0;for(let t=r.length-1;t>=0&&!(0===a&&h>=s);t--,h++)a+=58*r[t],r[t]=a%256,a=a/256|0;n(0===a),s=h}for(i=0;i<r.length&&0===r[i];)i++;const a=Buffer.allocUnsafe(e+(r.length-i));let h;for(h=0;h<e;h++)a[h]=0;for(;i<r.length;)a[h++]=r[i++];return a},r&&(e.decode=r.fromBase58)},function(t,e,i){"use strict";t.exports=i(133)},function(t,e,i){"use strict";const n=i(0),r=i(1),s=i(12),o=i(32);e.opcodes={OP_0:0,OP_PUSHDATA1:76,OP_PUSHDATA2:77,OP_PUSHDATA4:78,OP_1NEGATE:79,OP_RESERVED:80,OP_1:81,OP_2:82,OP_3:83,OP_4:84,OP_5:85,OP_6:86,OP_7:87,OP_8:88,OP_9:89,OP_10:90,OP_11:91,OP_12:92,OP_13:93,OP_14:94,OP_15:95,OP_16:96,OP_NOP:97,OP_VER:98,OP_IF:99,OP_NOTIF:100,OP_VERIF:101,OP_VERNOTIF:102,OP_ELSE:103,OP_ENDIF:104,OP_VERIFY:105,OP_RETURN:106,OP_TOALTSTACK:107,OP_FROMALTSTACK:108,OP_2DROP:109,OP_2DUP:110,OP_3DUP:111,OP_2OVER:112,OP_2ROT:113,OP_2SWAP:114,OP_IFDUP:115,OP_DEPTH:116,OP_DROP:117,OP_DUP:118,OP_NIP:119,OP_OVER:120,OP_PICK:121,OP_ROLL:122,OP_ROT:123,OP_SWAP:124,OP_TUCK:125,OP_CAT:126,OP_SUBSTR:127,OP_LEFT:128,OP_RIGHT:129,OP_SIZE:130,OP_INVERT:131,OP_AND:132,OP_OR:133,OP_XOR:134,OP_EQUAL:135,OP_EQUALVERIFY:136,OP_RESERVED1:137,OP_RESERVED2:138,OP_1ADD:139,OP_1SUB:140,OP_2MUL:141,OP_2DIV:142,OP_NEGATE:143,OP_ABS:144,OP_NOT:145,OP_0NOTEQUAL:146,OP_ADD:147,OP_SUB:148,OP_MUL:149,OP_DIV:150,OP_MOD:151,OP_LSHIFT:152,OP_RSHIFT:153,OP_BOOLAND:154,OP_BOOLOR:155,OP_NUMEQUAL:156,OP_NUMEQUALVERIFY:157,OP_NUMNOTEQUAL:158,OP_LESSTHAN:159,OP_GREATERTHAN:160,OP_LESSTHANOREQUAL:161,OP_GREATERTHANOREQUAL:162,OP_MIN:163,OP_MAX:164,OP_WITHIN:165,OP_RIPEMD160:166,OP_SHA1:167,OP_SHA256:168,OP_HASH160:169,OP_HASH256:170,OP_CODESEPARATOR:171,OP_CHECKSIG:172,OP_CHECKSIGVERIFY:173,OP_CHECKMULTISIG:174,OP_CHECKMULTISIGVERIFY:175,OP_NOP1:176,OP_CHECKLOCKTIMEVERIFY:177,OP_CHECKSEQUENCEVERIFY:178,OP_NOP4:179,OP_NOP5:180,OP_NOP6:181,OP_NOP7:182,OP_NOP8:183,OP_NOP9:184,OP_NOP10:185,OP_INVALIDOPCODE:255},e.opcodesByVal=r.reverse(e.opcodes),e.small=[Buffer.from([129]),Buffer.from([]),Buffer.from([1]),Buffer.from([2]),Buffer.from([3]),Buffer.from([4]),Buffer.from([5]),Buffer.from([6]),Buffer.from([7]),Buffer.from([8]),Buffer.from([9]),Buffer.from([10]),Buffer.from([11]),Buffer.from([12]),Buffer.from([13]),Buffer.from([14]),Buffer.from([15]),Buffer.from([16])],e.flags={VERIFY_NONE:0,VERIFY_P2SH:1,VERIFY_STRICTENC:2,VERIFY_DERSIG:4,VERIFY_LOW_S:8,VERIFY_NULLDUMMY:16,VERIFY_SIGPUSHONLY:32,VERIFY_MINIMALDATA:64,VERIFY_DISCOURAGE_UPGRADABLE_NOPS:128,VERIFY_CLEANSTACK:256,VERIFY_CHECKLOCKTIMEVERIFY:512,VERIFY_CHECKSEQUENCEVERIFY:1024,VERIFY_WITNESS:2048,VERIFY_DISCOURAGE_UPGRADABLE_WITNESS_PROGRAM:4096,VERIFY_MINIMALIF:8192,VERIFY_NULLFAIL:16384,VERIFY_WITNESS_PUBKEYTYPE:32768,VERIFY_MAST:65536},e.flags.MANDATORY_VERIFY_FLAGS=e.flags.VERIFY_P2SH,e.flags.STANDARD_VERIFY_FLAGS=0|e.flags.MANDATORY_VERIFY_FLAGS|e.flags.VERIFY_DERSIG|e.flags.VERIFY_STRICTENC|e.flags.VERIFY_MINIMALDATA|e.flags.VERIFY_NULLDUMMY|e.flags.VERIFY_DISCOURAGE_UPGRADABLE_NOPS|e.flags.VERIFY_CLEANSTACK|e.flags.VERIFY_MINIMALIF|e.flags.VERIFY_NULLFAIL|e.flags.VERIFY_CHECKLOCKTIMEVERIFY|e.flags.VERIFY_CHECKSEQUENCEVERIFY|e.flags.VERIFY_LOW_S|e.flags.VERIFY_WITNESS|e.flags.VERIFY_DISCOURAGE_UPGRADABLE_WITNESS_PROGRAM|e.flags.VERIFY_WITNESS_PUBKEYTYPE,e.flags.ONLY_STANDARD_VERIFY_FLAGS=e.flags.STANDARD_VERIFY_FLAGS&~e.flags.MANDATORY_VERIFY_FLAGS,e.hashType={ALL:1,NONE:2,SINGLE:3,ANYONECANPAY:128},e.hashTypeByVal=r.reverse(e.hashType),e.types={NONSTANDARD:0,PUBKEY:1,PUBKEYHASH:2,SCRIPTHASH:3,MULTISIG:4,NULLDATA:5,WITNESSMALFORMED:128,WITNESSSCRIPTHASH:129,WITNESSPUBKEYHASH:130,WITNESSMASTHASH:131},e.typesByVal=r.reverse(e.types),e.isHashType=function(t){if(n(Buffer.isBuffer(t)),0===t.length)return!1;const i=t[t.length-1]&~e.hashType.ANYONECANPAY;return i>=e.hashType.ALL&&i<=e.hashType.SINGLE},e.isLowDER=function(t){return!!e.isSignatureEncoding(t)&&s.isLowS(t.slice(0,-1))},e.isKeyEncoding=function(t){if(n(Buffer.isBuffer(t)),t.length<33)return!1;if(4===t[0]){if(65!==t.length)return!1}else{if(2!==t[0]&&3!==t[0])return!1;if(33!==t.length)return!1}return!0},e.isCompressedEncoding=function(t){return n(Buffer.isBuffer(t)),33===t.length&&(2===t[0]||3===t[0])},e.isSignatureEncoding=function(t){if(n(Buffer.isBuffer(t)),t.length<9)return!1;if(t.length>73)return!1;if(48!==t[0])return!1;if(t[1]!==t.length-3)return!1;const e=t[3];if(5+e>=t.length)return!1;const i=t[5+e];return e+i+7===t.length&&(2===t[2]&&(0!==e&&(!(128&t[4])&&(!(e>1&&0===t[4]&&!(128&t[5]))&&(2===t[e+4]&&(0!==i&&(!(128&t[e+6])&&!(i>1&&0===t[e+6]&&!(128&t[e+7])))))))))},e.toASM=function(t,i){if(t.length<=4){return o.decode(t).toString(10)}if(i&&e.isSignatureEncoding(t)){const i=t[t.length-1];let n=e.hashTypeByVal[31&i]||"";return n&&(i&e.hashType.ANYONECANPAY&&(n+="|ANYONECANPAY"),n=`[${n}]`),t.slice(0,-1).toString("hex")+n}return t.toString("hex")}},function(t,e,i){"use strict";const n=i(24);e.randomBytes=n.randomBytes,e.randomInt=function(){return e.randomBytes(4).readUInt32LE(0,!0)},e.randomRange=function(t,i){const n=e.randomInt();return Math.floor(n/4294967296*(i-t)+t)}},function(t,e,i){"use strict";function n(){if(!(this instanceof n))return new n;this.map=new Map,this.undo=new s}const r=i(102),s=i(91),o=i(50);n.prototype.get=function(t){return this.map.get(t)},n.prototype.has=function(t){return this.map.has(t)},n.prototype.add=function(t,e){return this.map.set(t,e),e},n.prototype.ensure=function(t){const e=this.map.get(t);return e||this.add(t,new r)},n.prototype.remove=function(t){const e=this.map.get(t);return e?(this.map.delete(t),e):null},n.prototype.addTX=function(t,e){const i=t.hash("hex"),n=r.fromTX(t,e);return this.add(i,n)},n.prototype.removeTX=function(t,e){const i=t.hash("hex"),n=r.fromTX(t,e);for(const t of n.outputs.values())t.spent=!0;return this.add(i,n)},n.prototype.addEntry=function(t,e){const{hash:i,index:n}=t;return this.ensure(i).add(n,e)},n.prototype.addCoin=function(t){return this.ensure(t.hash).addCoin(t)},n.prototype.addOutput=function(t,e){const{hash:i,index:n}=t;return this.ensure(i).addOutput(n,e)},n.prototype.addIndex=function(t,e,i){const n=t.hash("hex");return this.ensure(n).addIndex(t,e,i)},n.prototype.spendEntry=function(t){const{hash:e,index:i}=t,n=this.get(e);if(!n)return null;const r=n.spend(i);return r?(this.undo.push(r),r):null},n.prototype.removeEntry=function(t){const{hash:e,index:i}=t,n=this.get(e);return n?n.remove(i):null},n.prototype.hasEntry=function(t){const{hash:e,index:i}=t,n=this.get(e);return!!n&&n.has(i)},n.prototype.getEntry=function(t){const{hash:e,index:i}=t,n=this.get(e);return n?n.get(i):null},n.prototype.isUnspent=function(t){const{hash:e,index:i}=t,n=this.get(e);return!!n&&n.isUnspent(i)},n.prototype.getCoin=function(t){const e=this.get(t.hash);return e?e.getCoin(t):null},n.prototype.getOutput=function(t){const{hash:e,index:i}=t,n=this.get(e);return n?n.getOutput(i):null},n.prototype.getHeight=function(t){const e=this.getEntry(t);return e?e.height:-1},n.prototype.isCoinbase=function(t){const e=this.getEntry(t);return!!e&&e.coinbase},n.prototype.hasEntryFor=function(t){return this.hasEntry(t.prevout)},n.prototype.getEntryFor=function(t){return this.getEntry(t.prevout)},n.prototype.isUnspentFor=function(t){return this.isUnspent(t.prevout)},n.prototype.getCoinFor=function(t){return this.getCoin(t.prevout)},n.prototype.getOutputFor=function(t){return this.getOutput(t.prevout)},n.prototype.getHeightFor=function(t){return this.getHeight(t.prevout)},n.prototype.isCoinbaseFor=function(t){return this.isCoinbase(t.prevout)},n.prototype.readCoin=async function(t,e){const i=this.getEntry(e);if(i)return i;const n=await t.readCoin(e);return n?this.addEntry(e,n):null},n.prototype.readInputs=async function(t,e){let i=!0;for(const{prevout:n}of e.inputs)await this.readCoin(t,n)||(i=!1);return i},n.prototype.spendInputs=async function(t,e){let i=0;for(;i<e.inputs.length;){const n=Math.min(i+4,e.inputs.length),r=[];for(;i<n;i++){const{prevout:n}=e.inputs[i];r.push(this.readCoin(t,n))}const s=await Promise.all(r);for(const t of s){if(!t||t.spent)return!1;t.spent=!0,this.undo.push(t)}}return!0},n.prototype.getSize=function(t){let e=0;e+=t.inputs.length;for(const{prevout:i}of t.inputs){const t=this.getEntry(i);t&&(e+=t.getSize())}return e},n.prototype.toWriter=function(t,e){for(const{prevout:i}of e.inputs){const e=this.getEntry(i);e?(t.writeU8(1),e.toWriter(t)):t.writeU8(0)}return t},n.prototype.fromReader=function(t,e){for(const{prevout:i}of e.inputs){if(0===t.readU8())continue;const e=o.fromReader(t);this.addEntry(i,e)}return this},n.fromReader=function(t,e){return(new n).fromReader(t,e)},t.exports=n},function(t,e,i){"use strict";function n(){r(this instanceof n),s.call(this),this._asyncLock=new o,this._hooks=Object.create(null),this.loading=!1,this.closing=!1,this.loaded=!1}const r=i(0),s=i(10),o=i(23);Object.setPrototypeOf(n.prototype,s.prototype),n.prototype.open=async function(){const t=await this._asyncLock.lock();try{return await this.__open()}finally{t()}},n.prototype.__open=async function(){if(!this.loaded){await this.fire("preopen"),this.loading=!0;try{await this._open()}catch(t){throw this.loading=!1,this.emit("error",t),t}this.loading=!1,this.loaded=!0,await this.fire("open")}},n.prototype.close=async function(){const t=await this._asyncLock.lock();try{return await this.__close()}finally{t()}},n.prototype.__close=async function(){if(this.loaded){await this.fire("preclose"),this.closing=!0;try{await this._close()}catch(t){throw this.closing=!1,this.emit("error",t),t}this.closing=!1,this.loaded=!1,await this.fire("close")}},n.prototype.destroy=n.prototype.close,n.prototype._open=function(t){throw new Error("Abstract method.")},n.prototype._close=function(t){throw new Error("Abstract method.")},n.prototype.hook=function(t,e){r("string"==typeof t,"`type` must be a string."),this._hooks[t]||(this._hooks[t]=[]),this._hooks[t].push(e)},n.prototype.unhook=function(t){r("string"==typeof t,"`type` must be a string."),this._hooks[t]&&delete this._hooks[t]},n.prototype.fire=async function(){await this.fireHook.apply(this,arguments),this.emit.apply(this,arguments)},n.prototype.fireHook=async function(t){r("string"==typeof t,"`type` must be a string.");const e=this._hooks[t];if(!e||0===e.length)return;let i;for(const t of e)switch(arguments.length){case 1:await t();break;case 2:await t(arguments[1]);break;case 3:await t(arguments[1],arguments[2]);break;case 4:await t(arguments[1],arguments[2],arguments[3]);break;default:if(!i){i=new Array(arguments.length-1);for(let t=1;t<arguments.length;t++)i[t-1]=arguments[t]}await t.apply(null,i)}},t.exports=n},function(t,e,i){"use strict";function n(){this.pending=null,this.pendingTotal=0,this.blockSize=this.constructor.blockSize,this.outSize=this.constructor.outSize,this.hmacStrength=this.constructor.hmacStrength,this.padLength=this.constructor.padLength/8,this.endian="big",this._delta8=this.blockSize/8,this._delta32=this.blockSize/32}var r=i(14),s=i(22);e.BlockHash=n,n.prototype.update=function(t,e){if(t=r.toArray(t,e),this.pending?this.pending=this.pending.concat(t):this.pending=t,this.pendingTotal+=t.length,this.pending.length>=this._delta8){var i=(t=this.pending).length%this._delta8;this.pending=t.slice(t.length-i,t.length),0===this.pending.length&&(this.pending=null),t=r.join32(t,0,t.length-i,this.endian);for(var n=0;n<t.length;n+=this._delta32)this._update(t,n,n+this._delta32)}return this},n.prototype.digest=function(t){return this.update(this._pad()),s(null===this.pending),this._digest(t)},n.prototype._pad=function(){var t=this.pendingTotal,e=this._delta8,i=e-(t+this.padLength)%e,n=new Array(i+this.padLength);n[0]=128;for(var r=1;r<i;r++)n[r]=0;if(t<<=3,"big"===this.endian){for(var s=8;s<this.padLength;s++)n[r++]=0;n[r++]=0,n[r++]=0,n[r++]=0,n[r++]=0,n[r++]=t>>>24&255,n[r++]=t>>>16&255,n[r++]=t>>>8&255,n[r++]=255&t}else for(n[r++]=255&t,n[r++]=t>>>8&255,n[r++]=t>>>16&255,n[r++]=t>>>24&255,n[r++]=0,n[r++]=0,n[r++]=0,n[r++]=0,s=8;s<this.padLength;s++)n[r++]=0;return n}},function(t,e,i){"use strict";function n(t,e){if(!(this instanceof n))return new n(t,e);s.call(this,t,e)}const r=i(0),{I64:s}=i(49),o=i(35),a=Buffer.alloc(0);Object.setPrototypeOf(n,s),Object.setPrototypeOf(n.prototype,s.prototype),n.prototype.getInt=function(){return this.lt(s.INT32_MIN)?s.LONG_MIN:this.gt(s.INT32_MAX)?s.LONG_MAX:this.toInt()},n.prototype.toRaw=function(){let t=this;if(t.isZero())return a;let e=!1;t.isNeg()&&(t=t.neg(),e=!0);const i=t.byteLength();let n=0;t.testn(8*i-1)&&(n=1);const s=Buffer.allocUnsafe(i+n);switch(i){case 8:s[7]=t.hi>>>24&255;case 7:s[6]=t.hi>>16&255;case 6:s[5]=t.hi>>8&255;case 5:s[4]=255&t.hi;case 4:s[3]=t.lo>>>24&255;case 3:s[2]=t.lo>>16&255;case 2:s[1]=t.lo>>8&255;case 1:s[0]=255&t.lo}return 128&s[i-1]?(r(1===n),r(s.length===i+n),s[i]=e?128:0):e?(r(0===n),r(s.length===i),s[i-1]|=128):(r(0===n),r(s.length===i)),s},n.prototype.fromRaw=function(t){if(r(Buffer.isBuffer(t)),0===t.length)return this;switch(t.length){case 8:this.hi|=t[7]<<24;case 7:this.hi|=t[6]<<16;case 6:this.hi|=t[5]<<8;case 5:this.hi|=t[4];case 4:this.lo|=t[3]<<24;case 3:this.lo|=t[2]<<16;case 2:this.lo|=t[1]<<8;case 1:this.lo|=t[0];break;default:for(let e=0;e<t.length;e++)this.orb(e,t[e])}return 128&t[t.length-1]&&(this.setn(8*t.length-1,0),this.ineg()),this},n.prototype.encode=function(){return this.toRaw()},n.prototype.decode=function(t,e,i){if(r(Buffer.isBuffer(t)),null!=i&&t.length>i)throw new o("UNKNOWN_ERROR","Script number overflow.");if(e&&!n.isMinimal(t))throw new o("UNKNOWN_ERROR","Non-minimal script number.");return this.fromRaw(t)},n.prototype.inspect=function(){return`<ScriptNum: ${this.toString(10)}>`},n.isMinimal=function(t){if(r(Buffer.isBuffer(t)),0===t.length)return!0;if(0==(127&t[t.length-1])){if(1===t.length)return!1;if(0==(128&t[t.length-2]))return!1}return!0},n.decode=function(t,e,i){return(new n).decode(t,e,i)},n.isScriptNum=function(t){return t instanceof n},t.exports=n},function(t,e){t.exports=require("path")},function(t,e,i){"use strict";function n(t){if(!(this instanceof n))return new n(t);this.level=n.levels.NONE,this.colors=n.HAS_TTY,this.console=!0,this.shrink=!0,this.closed=!0,this.closing=!1,this.filename=null,this.stream=null,this.contexts=Object.create(null),this.locker=new u,t&&this.set(t)}function r(t,e){if(!(this instanceof r))return new r(t,e);o("string"==typeof e),this.logger=t,this.module=e}function s(t){return new Promise((e,i)=>{const n=a.createWriteStream(t,{flags:"a"}),r=()=>{n.removeListener("error",s),n.removeListener("open",o)},s=t=>{try{n.close()}catch(t){}r(),i(t)},o=()=>{r(),e(n)};n.once("error",s),n.once("open",o)})}const o=i(0),a=i(59),h=i(1),c=i(16),u=i(23);n.HAS_TTY=Boolean(process.stdout&&process.stdout.isTTY),n.MAX_FILE_SIZE=20<<20,n.levels={NONE:0,ERROR:1,WARNING:2,INFO:3,DEBUG:4,SPAM:5},n.levelsByVal=["none","error","warning","info","debug","spam"],n.prefixByVal=["N","E","W","I","D","S"],n.styles=["0","1;31","1;33","94","90","90"],n.prototype.set=function(t){o(t),o(this.closed),"string"!=typeof t?(null!=t.level&&(o("string"==typeof t.level),this.setLevel(t.level)),null!=t.colors&&n.HAS_TTY&&(o("boolean"==typeof t.colors),this.colors=t.colors),null!=t.console&&(o("boolean"==typeof t.console),this.console=t.console),null!=t.shrink&&(o("boolean"==typeof t.shrink),this.shrink=t.shrink),null!=t.filename&&(o("string"==typeof t.filename,"Bad file."),this.filename=t.filename)):this.setLevel(t)},n.prototype.open=async function(){const t=await this.locker.lock();try{return await this._open()}finally{t()}},n.prototype._open=async function(){this.filename?this.stream?this.closed=!1:a.unsupported?this.closed=!1:(this.shrink&&await this.truncate(),this.stream=await s(this.filename),this.stream.once("error",this.handleError.bind(this)),this.closed=!1):this.closed=!1},n.prototype.close=async function(){const t=await this.locker.lock();try{return await this._close()}finally{t()}},n.prototype._close=async function(){if(null!=this.timer&&(c.clearTimeout(this.timer),this.timer=null),a.unsupported)return this.closed=!0,void(this.stream=null);if(this.stream){try{this.closing=!0,await function(t){return new Promise((e,i)=>{const n=()=>{t.removeListener("error",r),t.removeListener("close",s)},r=t=>{n(),i(t)},s=()=>{n(),e(t)};t.removeAllListeners("error"),t.removeAllListeners("close"),t.once("error",r),t.once("close",s),t.close()})}(this.stream)}finally{this.closing=!1}this.stream=null}this.closed=!0},n.prototype.truncate=async function(){if(!this.filename)return;if(a.unsupported)return;o(!this.stream);let t;try{t=await a.stat(this.filename)}catch(t){if("ENOENT"===t.code)return;throw t}const e=n.MAX_FILE_SIZE;if(t.size<=e+e/10)return;this.debug("Truncating log file to %d bytes.",e);const i=await a.open(this.filename,"r+"),r=Buffer.allocUnsafe(e);await a.read(i,r,0,e,t.size-e),await a.ftruncate(i,e),await a.write(i,r,0,e,0),await a.close(i)},n.prototype.handleError=function(t){try{this.stream.close()}catch(t){}this.stream=null,this.retry()},n.prototype.reopen=async function(){const t=await this.locker.lock();try{return await this._reopen()}finally{t()}},n.prototype._reopen=async function(){if(!this.stream&&!this.closed&&!a.unsupported){try{this.stream=await s(this.filename)}catch(t){return void this.retry()}this.stream.once("error",this.handleError.bind(this))}},n.prototype.retry=function(){o(null==this.timer),this.timer=c.setTimeout(()=>{this.timer=null,this.reopen()},1e4,this)},n.prototype.setFile=function(t){o("string"==typeof t),o(!this.stream,"Log stream has already been created."),this.filename=t},n.prototype.setLevel=function(t){const e=n.levels[t.toUpperCase()];o(null!=e,"Invalid log level."),this.level=e},n.prototype.error=function(...t){if(this.level<n.levels.ERROR)return;const e=t[0];e instanceof Error?this.logError(n.levels.ERROR,null,e):this.log(n.levels.ERROR,null,t)},n.prototype.warning=function(...t){if(this.level<n.levels.WARNING)return;const e=t[0];e instanceof Error?this.logError(n.levels.WARNING,null,e):this.log(n.levels.WARNING,null,t)},n.prototype.info=function(...t){if(this.level<n.levels.INFO)return;const e=t[0];e instanceof Error?this.logError(n.levels.INFO,null,e):this.log(n.levels.INFO,null,t)},n.prototype.debug=function(...t){if(this.level<n.levels.DEBUG)return;const e=t[0];e instanceof Error?this.logError(n.levels.DEBUG,null,e):this.log(n.levels.DEBUG,null,t)},n.prototype.spam=function(...t){if(this.level<n.levels.SPAM)return;const e=t[0];e instanceof Error?this.logError(n.levels.SPAM,null,e):this.log(n.levels.SPAM,null,t)},n.prototype.log=function(t,e,i){this.closed||this.level<t||(this.writeConsole(t,e,i),this.writeStream(t,e,i))},n.prototype.context=function(t){let e=this.contexts[t];return e||(e=new r(this,t),this.contexts[t]=e),e},n.prototype.writeConsole=function(t,e,i){const r=n.levelsByVal[t];if(o(r,"Invalid log level."),!this.console)return!1;if(!process.stdout){let s=`[${r}] `;return e&&(s+=`(${e}) `),"object"==typeof i[0]?t===n.levels.ERROR?console.error(s,i[0]):console.log(s,i[0]):(s+=h.format(i,!1),t===n.levels.ERROR?(console.error(s),!0):(console.log(s),!0))}let s;if(this.colors){const e=n.styles[t];o(e),s=`[${e}m[${r}][m `}else s=`[${r}] `;return e&&(s+=`(${e}) `),s+=h.format(i,this.colors),s+="\n",t===n.levels.ERROR?process.stderr.write(s):process.stdout.write(s)},n.prototype.writeStream=function(t,e,i){const r=n.prefixByVal[t];if(o(r,"Invalid log level."),!this.stream)return;if(this.closing)return;let s=`[${r}:${h.date()}] `;e&&(s+=`(${e}) `),s+=h.format(i,!1),s+="\n",this.stream.write(s)},n.prototype.logError=function(t,e,i){if(this.closed)return;a.unsupported&&this.console&&t<=n.levels.WARNING&&console.error(i);let r=String(i.message).replace(/^ *Error: */,"");t!==n.levels.ERROR&&(r=`Error: ${r}`),this.log(t,e,[r]),t<=n.levels.WARNING&&this.stream&&this.stream.write(i.stack+"\n")},n.prototype.memory=function(t){const e=h.memoryUsage();this.log(n.levels.DEBUG,t,["Memory: rss=%dmb, js-heap=%d/%dmb native-heap=%dmb",e.total,e.jsHeap,e.jsHeapTotal,e.nativeHeap])},r.prototype.open=function(){return this.logger.open()},r.prototype.close=function(){return this.logger.close()},r.prototype.setFile=function(t){this.logger.setFile(t)},r.prototype.setLevel=function(t){this.logger.setLevel(t)},r.prototype.error=function(...t){if(this.logger.level<n.levels.ERROR)return;const e=t[0];e instanceof Error?this.logError(n.levels.ERROR,e):this.log(n.levels.ERROR,t)},r.prototype.warning=function(...t){if(this.logger.level<n.levels.WARNING)return;const e=t[0];e instanceof Error?this.logError(n.levels.WARNING,e):this.log(n.levels.WARNING,t)},r.prototype.info=function(...t){if(this.logger.level<n.levels.INFO)return;const e=t[0];e instanceof Error?this.logError(n.levels.INFO,e):this.log(n.levels.INFO,t)},r.prototype.debug=function(...t){if(this.logger.level<n.levels.DEBUG)return;const e=t[0];e instanceof Error?this.logError(n.levels.DEBUG,e):this.log(n.levels.DEBUG,t)},r.prototype.spam=function(...t){if(this.logger.level<n.levels.SPAM)return;const e=t[0];e instanceof Error?this.logError(n.levels.SPAM,e):this.log(n.levels.SPAM,t)},r.prototype.log=function(t,e){this.logger.log(t,this.module,e)},r.prototype.context=function(t){return new r(this.logger,t)},r.prototype.logError=function(t,e){this.logger.logError(t,this.module,e)},r.prototype.memory=function(){this.logger.memory(this.module)},n.global=new n,t.exports=n},function(t,e,i){"use strict";function n(t,e,i){if(!(this instanceof n))return new n(t,e,i);Error.call(this),this.type="ScriptError",this.code=t,this.message=t,this.op=-1,this.ip=-1,"string"==typeof e?this.message=e:e&&(this.message=`${t} (op=${e.toSymbol()}, ip=${i})`,this.op=e.value,this.ip=i),Error.captureStackTrace&&Error.captureStackTrace(this,n)}Object.setPrototypeOf(n.prototype,Error.prototype),t.exports=n},function(t,e,i){"use strict";function n(t,e){if(!(this instanceof n))return new n(t,e);this.type=t,this.hash=e}const r=i(2),s=i(4),o=i(1);n.types={ERROR:0,TX:1,BLOCK:2,FILTERED_BLOCK:3,WITNESS_TX:1|1<<30,WITNESS_BLOCK:2|1<<30,WITNESS_FILTERED_BLOCK:3|1<<30,CMPCT_BLOCK:4},n.typesByVal=o.reverse(n.types),n.WITNESS_FLAG=1<<30,n.prototype.getSize=function(){return 36},n.prototype.toWriter=function(t){return t.writeU32(this.type),t.writeHash(this.hash),t},n.prototype.toRaw=function(){return this.toWriter(new s(36)).render()},n.prototype.fromReader=function(t){return this.type=t.readU32(),this.hash=t.readHash("hex"),this},n.prototype.fromRaw=function(t){return this.fromReader(new r(t))},n.fromReader=function(t){return(new n).fromReader(t)},n.fromRaw=function(t,e){return"string"==typeof t&&(t=Buffer.from(t,e)),(new n).fromRaw(t)},n.prototype.isBlock=function(){switch(this.type){case n.types.BLOCK:case n.types.WITNESS_BLOCK:case n.types.FILTERED_BLOCK:case n.types.WITNESS_FILTERED_BLOCK:case n.types.CMPCT_BLOCK:return!0;default:return!1}},n.prototype.isTX=function(){switch(this.type){case n.types.TX:case n.types.WITNESS_TX:return!0;default:return!1}},n.prototype.hasWitness=function(){return 0!=(this.type&n.WITNESS_FLAG)},n.prototype.rhash=function(){return o.revHex(this.hash)},t.exports=n},function(t,e,i){"use strict";function n(t){if(!(this instanceof n))return new n(t);s.call(this),t&&this.parseOptions(t)}const r=i(1),s=i(69),o=i(4),a=i(2);Object.setPrototypeOf(n.prototype,s.prototype),n.prototype.verifyBody=function(t){return!0},n.prototype.getSize=function(){return 81},n.prototype.toWriter=function(t){return this.writeHead(t),t.writeVarint(0),t},n.prototype.toRaw=function(){const t=this.getSize();return this.toWriter(new o(t)).render()},n.prototype.fromReader=function(t){return this.readHead(t),t.readVarint(),this},n.prototype.fromRaw=function(t){return this.fromReader(new a(t))},n.fromReader=function(t){return(new n).fromReader(t)},n.fromRaw=function(t,e){return"string"==typeof t&&(t=Buffer.from(t,e)),(new n).fromRaw(t)},n.fromHead=function(t,e){return"string"==typeof t&&(t=Buffer.from(t,e)),(new n).fromHead(t)},n.fromEntry=function(t){const e=new n;return e.version=t.version,e.prevBlock=t.prevBlock,e.merkleRoot=t.merkleRoot,e.time=t.time,e.bits=t.bits,e.nonce=t.nonce,e._hash=Buffer.from(t.hash,"hex"),e._hhash=t.hash,e},n.prototype.toHeaders=function(){return this},n.fromBlock=function(t){const e=new n(t);return e._hash=t._hash,e._hhash=t._hhash,e},n.prototype.toJSON=function(){return this.getJSON()},n.prototype.getJSON=function(t,e,i){return{hash:this.rhash(),height:i,version:this.version,prevBlock:r.revHex(this.prevBlock),merkleRoot:r.revHex(this.merkleRoot),time:this.time,bits:this.bits,nonce:this.nonce}},n.prototype.fromJSON=function(t){return this.parseJSON(t),this},n.fromJSON=function(t){return(new n).fromJSON(t)},n.prototype.inspect=function(){return this.format()},n.prototype.format=function(t,e){return{hash:this.rhash(),height:null!=e?e:-1,date:r.date(this.time),version:r.hex32(this.version),prevBlock:r.revHex(this.prevBlock),merkleRoot:r.revHex(this.merkleRoot),time:this.time,bits:this.bits,nonce:this.nonce}},n.isHeaders=function(t){return t instanceof n},t.exports=n},function(t,e,i){"use strict";var n=e;n.base=i(140),n.short=i(141),n.mont=i(143),n.edwards=i(144)},function(t,e,i){try{var n=i(54);if("function"!=typeof n.inherits)throw"";t.exports=n.inherits}catch(e){t.exports=i(142)}},function(t,e,i){"use strict";function n(t){if(!(this instanceof n))return new n(t);this.items=t||[]}const r=i(0),s=i(27),o=i(32);Object.defineProperty(n.prototype,"length",{get(){return this.items.length},set(t){return this.items.length=t,this.items.length}}),n.prototype[Symbol.iterator]=function(){return this.items[Symbol.iterator]()},n.prototype.values=function(){return this.items.values()},n.prototype.entries=function(){return this.items.entries()},n.prototype.inspect=function(){return`<Stack: ${this.toString()}>`},n.prototype.toString=function(){const t=[];for(const e of this.items)t.push(e.toString("hex"));return t.join(" ")},n.prototype.toASM=function(t){const e=[];for(const i of this.items)e.push(s.toASM(i,t));return e.join(" ")},n.prototype.clone=function(){return new n(this.items.slice())},n.prototype.clear=function(){return this.items.length=0,this},n.prototype.get=function(t){return t<0&&(t+=this.items.length),t<0||t>=this.items.length?null:this.items[t]},n.prototype.pop=function(){return this.items.pop()||null},n.prototype.shift=function(){return this.items.shift()||null},n.prototype.remove=function(t){if(t<0&&(t+=this.items.length),t<0||t>=this.items.length)return null;const e=this.items.splice(t,1);return 0===e.length?null:e[0]},n.prototype.set=function(t,e){return t<0&&(t+=this.items.length),r(Buffer.isBuffer(e)),r(t>=0&&t<=this.items.length),this.items[t]=e,this},n.prototype.push=function(t){return r(Buffer.isBuffer(t)),this.items.push(t),this},n.prototype.unshift=function(t){return r(Buffer.isBuffer(t)),this.items.unshift(t),this},n.prototype.insert=function(t,e){return t<0&&(t+=this.items.length),r(Buffer.isBuffer(e)),r(t>=0&&t<=this.items.length),this.items.splice(t,0,e),this},n.prototype.erase=function(t,e){t<0&&(t=this.items.length+t),e<0&&(e=this.items.length+e),this.items.splice(t,e-t)},n.prototype.swap=function(t,e){t<0&&(t=this.items.length+t),e<0&&(e=this.items.length+e);const i=this.items[t],n=this.items[e];this.items[t]=n,this.items[e]=i},n.prototype.getData=function(t){return this.get(t)},n.prototype.popData=function(){return this.pop()},n.prototype.shiftData=function(){return this.shift()},n.prototype.removeData=function(t){return this.remove(t)},n.prototype.setData=function(t,e){return this.set(t,e)},n.prototype.pushData=function(t){return this.push(t)},n.prototype.unshiftData=function(t){return this.unshift(t)},n.prototype.insertData=function(t,e){return this.insert(t,e)},n.prototype.getLength=function(t){const e=this.get(t);return e?e.length:-1},n.prototype.getString=function(t,e){const i=this.get(t);return i?n.toString(i,e):null},n.prototype.popString=function(t){const e=this.pop();return e?n.toString(e,t):null},n.prototype.shiftString=function(t){const e=this.shift();return e?n.toString(e,t):null},n.prototype.removeString=function(t,e){const i=this.remove(t);return i?n.toString(i,e):null},n.prototype.setString=function(t,e,i){return this.set(t,n.fromString(e,i))},n.prototype.pushString=function(t,e){return this.push(n.fromString(t,e))},n.prototype.unshiftString=function(t,e){return this.unshift(n.fromString(t,e))},n.prototype.insertString=function(t,e,i){return this.insert(t,n.fromString(e,i))},n.prototype.getNum=function(t,e,i){const r=this.get(t);return r?n.toNum(r,e,i):null},n.prototype.popNum=function(t,e){const i=this.pop();return i?n.toNum(i,t,e):null},n.prototype.shiftNum=function(t,e){const i=this.shift();return i?n.toNum(i,t,e):null},n.prototype.removeNum=function(t,e,i){const r=this.remove(t);return r?n.toNum(r,e,i):null},n.prototype.setNum=function(t,e){return this.set(t,n.fromNum(e))},n.prototype.pushNum=function(t){return this.push(n.fromNum(t))},n.prototype.unshiftNum=function(t){return this.unshift(n.fromNum(t))},n.prototype.insertNum=function(t,e){return this.insert(t,n.fromNum(e))},n.prototype.getInt=function(t,e,i){const r=this.get(t);return r?n.toInt(r,e,i):-1},n.prototype.popInt=function(t,e){const i=this.pop();return i?n.toInt(i,t,e):-1},n.prototype.shiftInt=function(t,e){const i=this.shift();return i?n.toInt(i,t,e):-1},n.prototype.removeInt=function(t,e,i){const r=this.remove(t);return r?n.toInt(r,e,i):-1},n.prototype.setInt=function(t,e){return this.set(t,n.fromInt(e))},n.prototype.pushInt=function(t){return this.push(n.fromInt(t))},n.prototype.unshiftInt=function(t){return this.unshift(n.fromInt(t))},n.prototype.insertInt=function(t,e){return this.insert(t,n.fromInt(e))},n.prototype.getBool=function(t){const e=this.get(t);return!!e&&n.toBool(e)},n.prototype.popBool=function(){const t=this.pop();return!!t&&n.toBool(t)},n.prototype.shiftBool=function(){const t=this.shift();return!!t&&n.toBool(t)},n.prototype.removeBool=function(t){const e=this.remove(t);return!!e&&n.toBool(e)},n.prototype.setBool=function(t,e){return this.set(t,n.fromBool(e))},n.prototype.pushBool=function(t){return this.push(n.fromBool(t))},n.prototype.unshiftBool=function(t){return this.unshift(n.fromBool(t))},n.prototype.insertBool=function(t,e){return this.insert(t,n.fromBool(e))},n.isStack=function(t){return t instanceof n},n.toString=function(t,e){return r(Buffer.isBuffer(t)),t.toString(e||"utf8")},n.fromString=function(t,e){return r("string"==typeof t),Buffer.from(t,e||"utf8")},n.toNum=function(t,e,i){return o.decode(t,e,i)},n.fromNum=function(t){return r(o.isScriptNum(t)),t.encode()},n.toInt=function(t,e,i){return n.toNum(t,e,i).getInt()},n.fromInt=function(t){if(r("number"==typeof t),t>=-1&&t<=16)return s.small[t+1];const e=o.fromNumber(t);return n.fromNum(e)},n.toBool=function(t){r(Buffer.isBuffer(t));for(let e=0;e<t.length;e++)if(0!==t[e])return e!==t.length-1||128!==t[e];return!1},n.fromBool=function(t){return r("boolean"==typeof t),n.fromInt(t?1:0)},t.exports=n},function(t,e,i){"use strict";function n(t){if(!(this instanceof n))return new n(t);this.prevout=new c,this.script=new a,this.sequence=4294967295,this.witness=new h,t&&this.fromOptions(t)}const r=i(0),s=i(1),o=i(6),a=i(8),h=i(56),c=i(21),u=i(4),f=i(2);n.prototype.fromOptions=function(t){return r(t,"Input data is required."),this.prevout.fromOptions(t.prevout),t.script&&this.script.fromOptions(t.script),null!=t.sequence&&(r(s.isU32(t.sequence),"Sequence must be a uint32."),this.sequence=t.sequence),t.witness&&this.witness.fromOptions(t.witness),this},n.fromOptions=function(t){return(new n).fromOptions(t)},n.prototype.clone=function(){const t=new n;return t.prevout=this.prevout,t.script.inject(this.script),t.sequence=this.sequence,t.witness.inject(this.witness),t},n.prototype.equals=function(t){return r(n.isInput(t)),this.prevout.equals(t.prevout)},n.prototype.compare=function(t){return r(n.isInput(t)),this.prevout.compare(t.prevout)},n.prototype.getType=function(t){if(this.isCoinbase())return"coinbase";if(t)return t.getType();let e;return e=this.witness.items.length>0?this.witness.getInputType():this.script.getInputType(),a.typesByVal[e].toLowerCase()},n.prototype.getRedeem=function(t){if(this.isCoinbase())return null;if(!t)return this.witness.isScripthashInput()?this.witness.getRedeem():this.script.isScripthashInput()?this.script.getRedeem():null;let e=t.script,i=null;return e.isScripthash()&&(i=e=this.script.getRedeem()),e&&e.isWitnessScripthash()&&(i=e=this.witness.getRedeem()),i},n.prototype.getSubtype=function(t){if(this.isCoinbase())return null;const e=this.getRedeem(t);if(!e)return null;const i=e.getType();return a.typesByVal[i].toLowerCase()},n.prototype.getAddress=function(t){return this.isCoinbase()?null:t?t.getAddress():this.witness.items.length>0?this.witness.getInputAddress():this.script.getInputAddress()},n.prototype.getHash=function(t){const e=this.getAddress();return e?e.getHash(t):null},n.prototype.isFinal=function(){return 4294967295===this.sequence},n.prototype.isRBF=function(){return this.sequence<4294967294},n.prototype.isCoinbase=function(){return this.prevout.isNull()},n.prototype.inspect=function(){return this.format()},n.prototype.format=function(t){return{type:this.getType(t),subtype:this.getSubtype(t),address:this.getAddress(t),script:this.script,witness:this.witness,redeem:this.getRedeem(t),sequence:this.sequence,prevout:this.prevout,coin:t||null}},n.prototype.toJSON=function(t,e){return this.getJSON()},n.prototype.getJSON=function(t,e){t=o.get(t);let i;return e||(i=this.getAddress())&&(i=i.toString(t)),{prevout:this.prevout.toJSON(),script:this.script.toJSON(),witness:this.witness.toJSON(),sequence:this.sequence,address:i,coin:e?e.getJSON(t,!0):void 0}},n.prototype.fromJSON=function(t){return r(t,"Input data is required."),r(s.isU32(t.sequence),"Sequence must be a uint32."),this.prevout.fromJSON(t.prevout),this.script.fromJSON(t.script),this.witness.fromJSON(t.witness),this.sequence=t.sequence,this},n.fromJSON=function(t){return(new n).fromJSON(t)},n.prototype.getSize=function(){return 40+this.script.getVarSize()},n.prototype.toRaw=function(){const t=this.getSize();return this.toWriter(new u(t)).render()},n.prototype.toWriter=function(t){return this.prevout.toWriter(t),t.writeVarBytes(this.script.toRaw()),t.writeU32(this.sequence),t},n.prototype.fromReader=function(t){return this.prevout.fromReader(t),this.script.fromRaw(t.readVarBytes()),this.sequence=t.readU32(),this},n.prototype.fromRaw=function(t){return this.fromReader(new f(t))},n.fromReader=function(t){return(new n).fromReader(t)},n.fromRaw=function(t,e){return"string"==typeof t&&(t=Buffer.from(t,e)),(new n).fromRaw(t)},n.prototype.fromOutpoint=function(t){return r("string"==typeof t.hash),r("number"==typeof t.index),this.prevout.hash=t.hash,this.prevout.index=t.index,this},n.fromOutpoint=function(t){return(new n).fromOutpoint(t)},n.prototype.fromCoin=function(t){return r("string"==typeof t.hash),r("number"==typeof t.index),this.prevout.hash=t.hash,this.prevout.index=t.index,this},n.fromCoin=function(t){return(new n).fromCoin(t)},n.prototype.fromTX=function(t,e){return r(t),r("number"==typeof e),r(e>=0&&e<t.outputs.length),this.prevout.hash=t.hash("hex"),this.prevout.index=e,this},n.fromTX=function(t,e){return(new n).fromTX(t,e)},n.isInput=function(t){return t instanceof n},t.exports=n},function(t,e,i){"use strict";function n(t,e,i,r){if(!(this instanceof n))return new n(t,e,i,r);this.filter=f,this.size=0,this.n=0,this.tweak=0,this.update=n.flags.NONE,null!=t&&this.fromOptions(t,e,i,r)}const r=i(0),s=i(68),o=i(2),a=i(4),h=i(3),c=s.sum32,u=s.mul32,f=Buffer.alloc(0);n.MAX_BLOOM_FILTER_SIZE=36e3,n.MAX_HASH_FUNCS=50,n.flags={NONE:0,ALL:1,PUBKEY_ONLY:2},n.flagsByVal={0:"NONE",1:"ALL",2:"PUBKEY_ONLY"},n.prototype.fromOptions=function(t,e,i,s){r("number"==typeof t,"`size` must be a number."),r(t>0,"`size` must be greater than zero."),r(Number.isSafeInteger(t),"`size` must be an integer."),t-=t%8;const o=Buffer.allocUnsafe(t/8);return o.fill(0),null!=i&&-1!==i||(i=4294967296*Math.random()>>>0),null!=s&&-1!==s||(s=n.flags.NONE),"string"==typeof s&&(s=n.flags[s.toUpperCase()],r(null!=s,"Unknown update flag.")),r(t>0,"`size` must be greater than zero."),r(e>0,"`n` must be greater than zero."),r(Number.isSafeInteger(e),"`n` must be an integer."),r("number"==typeof i,"`tweak` must be a number."),r(Number.isSafeInteger(i),"`tweak` must be an integer."),r(n.flagsByVal[s],"Unknown update flag."),this.filter=o,this.size=t,this.n=e,this.tweak=i,this.update=s,this},n.fromOptions=function(t,e,i,r){return(new n).fromOptions(t,e,i,r)},n.prototype.hash=function(t,e){return s(t,c(u(e,4221880213),this.tweak))%this.size},n.prototype.reset=function(){this.filter.fill(0)},n.prototype.add=function(t,e){"string"==typeof t&&(t=Buffer.from(t,e));for(let e=0;e<this.n;e++){const i=this.hash(t,e);this.filter[i>>>3]|=1<<(7&i)}},n.prototype.test=function(t,e){"string"==typeof t&&(t=Buffer.from(t,e));for(let e=0;e<this.n;e++){const i=this.hash(t,e);if(0==(this.filter[i>>>3]&1<<(7&i)))return!1}return!0},n.prototype.added=function(t,e){let i=!1;"string"==typeof t&&(t=Buffer.from(t,e));for(let e=0;e<this.n;e++){const n=this.hash(t,e);i||0!=(this.filter[n>>>3]&1<<(7&n))||(i=!0),this.filter[n>>>3]|=1<<(7&n)}return i},n.fromRate=function(t,e,i){r("number"==typeof t,"`items` must be a number."),r(t>0,"`items` must be greater than zero."),r(Number.isSafeInteger(t),"`items` must be an integer."),r("number"==typeof e,"`rate` must be a number."),r(e>=0&&e<=1,"`rate` must be between 0.0 and 1.0.");const s=-2.0813689810056077*t*Math.log(e)|0,o=Math.max(8,s);-1!==i&&r(o<=8*n.MAX_BLOOM_FILTER_SIZE,"Bloom filter size violates policy limits!");const a=Math.max(1,o/t*.6931471805599453|0);return-1!==i&&r(a<=n.MAX_HASH_FUNCS,"Bloom filter size violates policy limits!"),new n(o,a,-1,i)},n.prototype.isWithinConstraints=function(){return!(this.size>8*n.MAX_BLOOM_FILTER_SIZE)&&!(this.n>n.MAX_HASH_FUNCS)},n.prototype.getSize=function(){return h.sizeVarBytes(this.filter)+9},n.prototype.toWriter=function(t){return t.writeVarBytes(this.filter),t.writeU32(this.n),t.writeU32(this.tweak),t.writeU8(this.update),t},n.prototype.toRaw=function(){const t=this.getSize();return this.toWriter(new a(t)).render()},n.prototype.fromReader=function(t){return this.filter=t.readVarBytes(),this.n=t.readU32(),this.tweak=t.readU32(),this.update=t.readU8(),r(null!=n.flagsByVal[this.update],"Unknown update flag."),this},n.prototype.fromRaw=function(t){return this.fromReader(new o(t))},n.fromReader=function(t){return(new n).fromReader(t)},n.fromRaw=function(t,e){return"string"==typeof t&&(t=Buffer.from(t,e)),(new n).fromRaw(t)},t.exports=n},function(t,e,i){"use strict";function n(t){if(!(this instanceof n))return new n(t);this.version=1,this.height=-1,this.value=0,this.script=new h,this.coinbase=!1,this.hash=l.NULL_HASH,this.index=0,t&&this.fromOptions(t)}const r=i(0),s=i(1),o=i(20),a=i(13),h=i(8),c=i(6),u=i(2),f=i(4),l=i(3);Object.setPrototypeOf(n.prototype,a.prototype),n.prototype.fromOptions=function(t){return r(t,"Coin data is required."),null!=t.version&&(r(s.isU32(t.version),"Version must be a uint32."),this.version=t.version),null!=t.height&&(-1!==t.height?(r(s.isU32(t.height),"Height must be a uint32."),this.height=t.height):this.height=-1),null!=t.value&&(r(s.isU64(t.value),"Value must be a uint64."),this.value=t.value),t.script&&this.script.fromOptions(t.script),null!=t.coinbase&&(r("boolean"==typeof t.coinbase,"Coinbase must be a boolean."),this.coinbase=t.coinbase),null!=t.hash&&(r("string"==typeof t.hash,"Hash must be a string."),this.hash=t.hash),null!=t.index&&(r(s.isU32(t.index),"Index must be a uint32."),this.index=t.index),this},n.fromOptions=function(t){return(new n).fromOptions(t)},n.prototype.clone=function(){r(!1,"Coins are not cloneable.")},n.prototype.getDepth=function(t){return r("number"==typeof t,"Must pass a height."),-1===this.height?0:-1===t?0:t<this.height?0:t-this.height+1},n.prototype.toKey=function(){return this.hash+this.index},n.prototype.fromKey=function(t){return r(t.length>64),this.hash=t.slice(0,64),this.index=parseInt(t.slice(64),10),this},n.fromKey=function(t){return(new n).fromKey(t)},n.prototype.rhash=function(){return s.revHex(this.hash)},n.prototype.txid=function(){return this.rhash()},n.prototype.inspect=function(){return{type:this.getType(),version:this.version,height:this.height,value:o.wmcc(this.value),script:this.script,coinbase:this.coinbase,hash:this.hash?s.revHex(this.hash):null,index:this.index,address:this.getAddress()}},n.prototype.toJSON=function(){return this.getJSON()},n.prototype.getJSON=function(t,e){let i=this.getAddress();return t=c.get(t),i&&(i=i.toString(t)),{version:this.version,height:this.height,value:this.value,script:this.script.toJSON(),address:i,coinbase:this.coinbase,hash:e?void 0:this.rhash(),index:e?void 0:this.index}},n.prototype.fromJSON=function(t){return r(t,"Coin data required."),r(s.isU32(t.version),"Version must be a uint32."),r(-1===t.height||s.isU32(t.height),"Height must be a uint32."),r(s.isU64(t.value),"Value must be a uint64."),r("boolean"==typeof t.coinbase,"Coinbase must be a boolean."),this.version=t.version,this.height=t.height,this.value=t.value,this.script.fromJSON(t.script),this.coinbase=t.coinbase,null!=t.hash&&(r("string"==typeof t.hash,"Hash must be a string."),r(64===t.hash.length,"Hash must be a string."),r(s.isU32(t.index),"Index must be a uint32."),this.hash=s.revHex(t.hash),this.index=t.index),this},n.fromJSON=function(t){return(new n).fromJSON(t)},n.prototype.getSize=function(){return 17+this.script.getVarSize()},n.prototype.toWriter=function(t){let e=this.height;return-1===e&&(e=2147483647),t.writeU32(this.version),t.writeU32(e),t.writeI64(this.value),t.writeVarBytes(this.script.toRaw()),t.writeU8(this.coinbase?1:0),t},n.prototype.toRaw=function(){const t=this.getSize();return this.toWriter(new f(t)).render()},n.prototype.fromReader=function(t){return this.version=t.readU32(),this.height=t.readU32(),this.value=t.readI64(),this.script.fromRaw(t.readVarBytes()),this.coinbase=1===t.readU8(),2147483647===this.height&&(this.height=-1),this},n.prototype.fromRaw=function(t){return this.fromReader(new u(t))},n.fromReader=function(t){return(new n).fromReader(t)},n.fromRaw=function(t,e){return"string"==typeof t&&(t=Buffer.from(t,e)),(new n).fromRaw(t)},n.prototype.fromTX=function(t,e,i){return r("number"==typeof e),r("number"==typeof i),r(e>=0&&e<t.outputs.length),this.version=t.version,this.height=i,this.value=t.outputs[e].value,this.script=t.outputs[e].script,this.coinbase=t.isCoinbase(),this.hash=t.hash("hex"),this.index=e,this},n.fromTX=function(t,e,i){return(new n).fromTX(t,e,i)},n.isCoin=function(t){return t instanceof n},t.exports=n},function(t,e,i){"use strict";function n(t,e,i,n,r,s){if(n*r>=1<<30)throw new Error("EFBIG");if(0!=(i&i-1)||0===i)throw new Error("EINVAL");if(i>4294967295)throw new Error("EINVAL");const o=Buffer.allocUnsafe(256*n),f=Buffer.allocUnsafe(128*n*i),p=l.derive(t,e,1,128*r*n,"sha256");for(let t=0;t<r;t++)!function(t,e,i,n,r,s){const o=s,f=s;c(o,t,0,e,128*i);for(let t=0;t<n;t++)c(r,o,t*(128*i),0,128*i),a(o,f,128*i,i);for(let t=0;t<n;t++){const t=h(o,i)&n-1;u(o,r,0,t*(128*i),128*i),a(o,f,128*i,i)}c(t,o,e,0,128*i)}(p,128*t*n,n,i,f,o);return l.derive(t,p,1,s,"sha256")}async function r(t,e,i,n,r,s){if(n*r>=1<<30)throw new Error("EFBIG");if(0!=(i&i-1)||0===i)throw new Error("EINVAL");if(i>4294967295)throw new Error("EINVAL");const o=Buffer.allocUnsafe(256*n),p=Buffer.allocUnsafe(128*n*i),d=await l.deriveAsync(t,e,1,128*r*n,"sha256");for(let t=0;t<r;t++)await async function(t,e,i,n,r,s){const o=s,l=s;c(o,t,0,e,128*i);for(let t=0;t<n;t++)c(r,o,t*(128*i),0,128*i),a(o,l,128*i,i),await f.wait();for(let t=0;t<n;t++){const t=h(o,i)&n-1;u(o,r,0,t*(128*i),128*i),a(o,l,128*i,i),await f.wait()}c(t,o,e,0,128*i)}(d,128*t*n,n,i,p,o);return await l.deriveAsync(t,d,1,s,"sha256")}function s(t){const e=new Uint32Array(16),i=new Uint32Array(16);for(let i=0;i<16;i++)e[i]=t.readUInt32LE(4*i,!0);for(let t=0;t<16;t++)i[t]=e[t];for(let t=0;t<8;t+=2)i[4]^=o(i[0]+i[12],7),i[8]^=o(i[4]+i[0],9),i[12]^=o(i[8]+i[4],13),i[0]^=o(i[12]+i[8],18),i[9]^=o(i[5]+i[1],7),i[13]^=o(i[9]+i[5],9),i[1]^=o(i[13]+i[9],13),i[5]^=o(i[1]+i[13],18),i[14]^=o(i[10]+i[6],7),i[2]^=o(i[14]+i[10],9),i[6]^=o(i[2]+i[14],13),i[10]^=o(i[6]+i[2],18),i[3]^=o(i[15]+i[11],7),i[7]^=o(i[3]+i[15],9),i[11]^=o(i[7]+i[3],13),i[15]^=o(i[11]+i[7],18),i[1]^=o(i[0]+i[3],7),i[2]^=o(i[1]+i[0],9),i[3]^=o(i[2]+i[1],13),i[0]^=o(i[3]+i[2],18),i[6]^=o(i[5]+i[4],7),i[7]^=o(i[6]+i[5],9),i[4]^=o(i[7]+i[6],13),i[5]^=o(i[4]+i[7],18),i[11]^=o(i[10]+i[9],7),i[8]^=o(i[11]+i[10],9),i[9]^=o(i[8]+i[11],13),i[10]^=o(i[9]+i[8],18),i[12]^=o(i[15]+i[14],7),i[13]^=o(i[12]+i[15],9),i[14]^=o(i[13]+i[12],13),i[15]^=o(i[14]+i[13],18);for(let t=0;t<16;t++)e[t]+=i[t];for(let i=0;i<16;i++)t.writeUInt32LE(e[i],4*i,!0)}function o(t,e){return t<<e|t>>>32-e}function a(t,e,i,n){const r=Buffer.allocUnsafe(64);c(r,t,0,64*(2*n-1),64);for(let o=0;o<2*n;o++)u(r,t,0,64*o,64),s(r),c(e,r,i+64*o,0,64);for(let r=0;r<n;r++)c(t,e,64*r,i+2*r*64,64);for(let r=0;r<n;r++)c(t,e,64*(r+n),i+64*(2*r+1),64)}function h(t,e){return t.readUInt32LE(64*(2*e-1),!0)}function c(t,e,i,n,r){e.copy(t,i,n,n+r)}function u(t,e,i,n,r){for(let s=0;s<r;s++)t[i+s]^=e[n+s]}const f=i(16),l=i(70),p=i(18).binding;p&&(n=p.scrypt),p&&(r=p.scryptAsync),e.derive=n,e.deriveAsync=r},function(t,e,i){"undefined"!=typeof process&&"renderer"===process.type?t.exports=i(274):t.exports=i(276)},function(t,e,i){"use strict";function n(t,e,i,n,r){this.host=t||"0.0.0.0",this.port=e||0,this.type=i||a.types.IPV4,this.hostname=n||"0.0.0.0:0",this.raw=r||h}const r=i(0),s=i(116),o=i(175),a=e,h=Buffer.from("00000000000000000000000000000000","hex"),c=Buffer.from("00000000000000000000000000000001","hex"),u=Buffer.from("0064ff9b0000000000000000","hex"),f=Buffer.from("fe80000000000000","hex"),l=Buffer.from("0000000000000000ffff0000","hex"),p=Buffer.from("fd87d87eeb43","hex"),d=Buffer.from("00000000000000ffff","hex"),m=/^(\d{1,3}\.){3}\d{1,3}$/,g=/^(::)?(((\d{1,3}\.){3}(\d{1,3}){1})?([0-9a-f]){0,4}:{0,2}){1,8}(::)?$/i;a.ZERO_IP=h,a.types={DNS:-1,IPV4:4,IPV6:6,ONION:10,TEREDO:11},a.fromHostname=function(t,e){r("string"==typeof t),r(t.length>0,"Bad address.");let i,s;if("["===t[0])if("]"===t[t.length-1])i=t.slice(1,-1),s=null;else{const e=(t=t.slice(1)).split("]:");r(2===e.length,"Bad IPv6 address."),i=e[0],s=e[1]}else{const e=t.split(":");switch(e.length){case 2:i=e[0],s=e[1];break;case 1:i=e[0],s=null;break;default:r(a.isV6String(t),"Bad IPv6 address."),i=t,s=null}}r(i.length>0,"Bad host."),null!=s?(r(s.length<=5,"Bad port."),r(/^\d+$/.test(s),"Bad port."),s=parseInt(s,10),r(s<=65535)):s=e||0;const o=a.getStringType(i);let h;o!==a.types.DNS&&(h=a.toBuffer(i),i=a.toString(h));let c;return c=o===a.types.IPV6?`[${i}]:${s}`:`${i}:${s}`,new n(i,s,o,c,h)},a.toHostname=function(t,e){r("string"==typeof t),r(t.length>0),r("number"==typeof e),r(e>=0&&e<=65535),r(!/[\[\]]/.test(t),"Bad host.");const i=a.getStringType(t);return-1!==t.indexOf(":")&&r(i===a.types.IPV6,"Bad host."),i!==a.types.DNS&&(t=a.normalize(t)),i===a.types.IPV6?`[${t}]:${e}`:`${t}:${e}`},a.getStringType=function(t){return a.isV4String(t)?a.types.IPV4:a.isV6String(t)?a.types.IPV6:a.isOnionString(t)?a.types.ONION:a.types.DNS},a.isV4String=function(t){return r("string"==typeof t),!(t.length<7)&&(!(t.length>15)&&m.test(t))},a.isV6String=function(t){return r("string"==typeof t),!(t.length<2)&&(!(t.length>39)&&g.test(t))},a.isOnionString=function(t){return r("string"==typeof t),!(t.length<7)&&".onion"===t.slice(-6)},a.isMapped=function(t){return r(Buffer.isBuffer(t)),r(16===t.length),0===t[0]&&0===t[1]&&0===t[2]&&0===t[3]&&0===t[4]&&0===t[5]&&0===t[6]&&0===t[7]&&0===t[8]&&0===t[9]&&255===t[10]&&255===t[11]},a.toBuffer=function(t){r("string"==typeof t);const e=Buffer.allocUnsafe(16);if(a.isV4String(t))return e.fill(0),e[10]=255,e[11]=255,a.parseV4(t,e,12);if(a.isOnionString(t)){p.copy(e,0);const i=o.decode(t.slice(0,-6));return r(10===i.length,"Invalid onion address."),i.copy(e,6),e}return a.parseV6(t,e,0)},a.parseV4=function(t,e,i){const n=t.split(".");r(4===n.length);for(let t of n)r(t.length>0),r(t.length<=3),t=parseInt(t,10),r(t>=0&&t<=255),e[i++]=t;return e},a.parseV6=function(t,e,i){const n=t.split(":");let s=8-n.length;r(n.length>=2,"Not an IPv6 address.");for(const t of n)a.isV4String(t)&&s--;const o=i;let h=!1;for(let t=0;t<n.length;t++){let o=n[t];if(0!==o.length)a.isV4String(o)?(a.parseV4(o,e,i),i+=4):(r(o.length<=4),o=parseInt(o,16),r(o==o,"Non-number in IPv6 address."),e[i++]=o>>8&255,e[i++]=255&o);else{for(r(!h,"Overuse of double colon in IPv6 address."),h=!0,s+=1;t+1<n.length&&0===(o=n[t+1]).length;)s+=1,t++;for(;s>0;)e[i++]=0,e[i++]=0,s--}}return r(0===s,"IPv6 address has missing sections."),r.strictEqual(i,o+16),e},a.toString=function(t){if(r(Buffer.isBuffer(t)),4===t.length){let e="";return e+=t[0],e+="."+t[1],e+="."+t[2],e+="."+t[3]}if(16===t.length){if(a.isMapped(t)){let e="";return e+=t[12],e+="."+t[13],e+="."+t[14],e+="."+t[15]}if(a.isOnion(t)){return`${o.encode(t.slice(6))}.onion`}let e="";e+=t.readUInt16BE(0,!0).toString(16);for(let i=2;i<16;i+=2)e+=":",e+=t.readUInt16BE(i,!0).toString(16);return e=e.replace(/(^|:)0(:0)*:0(:|$)/,"$1::$3"),e=e.replace(/:{3,4}/,"::")}throw new Error(`Invalid IP address: ${t.toString("hex")}.`)},a.normalize=function(t){return a.toString(a.toBuffer(t))},a.isIPv4=function(t){return a.isMapped(t)},a.isIPv6=function(t){return!a.isMapped(t)&&!a.isOnion(t)},a.getType=function(t){if(a.isIPv4(t))return a.types.IPV4;if(a.isIPv6(t))return a.types.IPV6;if(a.isOnion(t))return a.types.ONION;throw new Error("Unknown type.")},a.getNetwork=function(t){return a.isRFC4380(t)?a.types.TEREDO:a.getType(t)},a.isNull=function(t){return a.isIPv4(t)?0===t[12]&&0===t[13]&&0===t[14]&&0===t[15]:a.isEqual(t,h)},a.isBroadcast=function(t){return!!a.isIPv4(t)&&(255===t[12]&&255===t[13]&&255===t[14]&&255===t[15])},a.isRFC1918=function(t){return!!a.isIPv4(t)&&(10===t[12]||(192===t[12]&&168===t[13]||172===t[12]&&t[13]>=16&&t[13]<=31))},a.isRFC2544=function(t){return!!a.isIPv4(t)&&(198===t[12]&&(18===t[13]||19===t[13])||169===t[12]&&254===t[13])},a.isRFC3927=function(t){return!!a.isIPv4(t)&&(169===t[12]&&254===t[13])},a.isRFC6598=function(t){return!!a.isIPv4(t)&&(100===t[12]&&t[13]>=64&&t[13]<=127)},a.isRFC5737=function(t){return!!a.isIPv4(t)&&(192===t[12]&&0===t[13]&&2===t[14]||(198===t[12]&&51===t[13]&&100===t[14]||203===t[12]&&0===t[13]&&113===t[14]))},a.isRFC3849=function(t){return 32===t[0]&&1===t[1]&&13===t[2]&&184===t[3]},a.isRFC3964=function(t){return 32===t[0]&&2===t[1]},a.isRFC6052=function(t){return a.hasPrefix(t,u)},a.isRFC4380=function(t){return 32===t[0]&&1===t[1]&&0===t[2]&&0===t[3]},a.isRFC4862=function(t){return a.hasPrefix(t,f)},a.isRFC4193=function(t){return 252==(254&t[0])},a.isRFC6145=function(t){return a.hasPrefix(t,l)},a.isRFC4843=function(t){return 32===t[0]&&1===t[1]&&0===t[2]&&16==(240&t[3])},a.isOnion=function(t){return a.hasPrefix(t,p)},a.isLocal=function(t){return a.isIPv4(t)?127===t[12]&&0===t[13]:!!a.isEqual(t,c)},a.isMulticast=function(t){return a.isIPv4(t)?224==(240&t[12]):255===t[0]},a.isValid=function(t){return!a.hasPrefix(t,d)&&(!a.isNull(t)&&(!a.isBroadcast(t)&&!a.isRFC3849(t)))},a.isRoutable=function(t){return!!a.isValid(t)&&(!a.isRFC1918(t)&&(!a.isRFC2544(t)&&(!a.isRFC3927(t)&&(!a.isRFC4862(t)&&(!a.isRFC6598(t)&&(!a.isRFC5737(t)&&(!(a.isRFC4193(t)&&!a.isOnion(t))&&(!a.isRFC4843(t)&&!a.isLocal(t)))))))))},a.getReachability=function(t,e){if(!a.isRoutable(t))return 0;const i=a.getNetwork(t),n=a.getNetwork(e),r=a.types;switch(n){case r.IPV4:switch(i){case r.IPV4:return 4;default:return 1}break;case r.IPV6:switch(i){case r.TEREDO:return 2;case r.IPV4:return 4;case r.IPV6:return a.isRFC3964(t)||a.isRFC6052(t)||a.isRFC6145(t)?3:5;default:return 1}break;case r.ONION:switch(i){case r.IPV4:return 4;case r.ONION:return 6;default:return 1}break;case r.TEREDO:switch(i){case r.TEREDO:return 2;case r.IPV6:return 3;case r.IPV4:return 4;default:return 1}break;default:switch(i){case r.TEREDO:return 2;case r.IPV6:return 3;case r.IPV4:return 4;case r.ONION:return 6;default:return 1}}},a.hasPrefix=function(t,e){r(Buffer.isBuffer(t)),r(Buffer.isBuffer(e)),r(t.length>=e.length);for(let i=0;i<e.length;i++)if(t[i]!==e[i])return!1;return!0},a.isEqual=function(t,e){return r(16===t.length),r(16===e.length),t.equals(e)},a.getInterfaces=function(t,e){const i=s.networkInterfaces(),n=[];for(const r of Object.keys(i)){const s=i[r];for(const i of s){const r=i.family.toLowerCase();if(e&&r!==e)continue;if(i.internal)continue;let s;try{s=a.toBuffer(i.address)}catch(t){continue}if(!a.isNull(s)&&!a.isLocal(s)){if("public"===t){if(!a.isRoutable(s))continue}else if("private"===t&&a.isRoutable(s))continue;n.push(a.toString(s))}}}return n},a.getPrivate=function(t){return a.getInterfaces("private",t)},a.getPublic=function(t){return a.getInterfaces("public",t)},a.Address=n},function(t,e,i){"use strict";function n(t,e){if(!(this instanceof n))return new n(t,e);this.network=h.primary,this.witness=!1,this.nested=!1,this.publicKey=o.ZERO_KEY,this.privateKey=null,this.script=null,this._keyHash=null,this._keyAddress=null,this._program=null,this._nestedHash=null,this._nestedAddress=null,this._scriptHash160=null,this._scriptHash256=null,this._scriptAddress=null,t&&this.fromOptions(t,e)}function r(t){return t?t.privateKey?t.privateKey:t.publicKey?t.publicKey:t:t}const s=i(0),o=i(3),a=i(5),h=i(6),c=i(2),u=i(4),f=i(25),l=i(8),p=i(11),d=i(13),m=i(12);n.prototype.fromOptions=function(t,e){e||(e=t.network);let i=r(t);if(Buffer.isBuffer(i))return this.fromKey(i,e);i=r(t.key),t.publicKey&&(i=r(t.publicKey)),t.privateKey&&(i=r(t.privateKey)),null!=t.witness&&(s("boolean"==typeof t.witness),this.witness=t.witness),null!=t.nested&&(s("boolean"==typeof t.nested),this.nested=t.nested);const n=t.script,o=t.compressed;return n?this.fromScript(i,n,o,e):this.fromKey(i,o,e)},n.fromOptions=function(t){return(new n).fromOptions(t)},n.prototype.refresh=function(){this._keyHash=null,this._keyAddress=null,this._program=null,this._nestedHash=null,this._nestedAddress=null,this._scriptHash160=null,this._scriptHash256=null,this._scriptAddress=null},n.prototype.fromPrivate=function(t,e,i){return s(Buffer.isBuffer(t),"Private key must be a buffer."),s(m.privateKeyVerify(t),"Not a valid private key."),"boolean"!=typeof e&&(i=e,e=null),this.network=h.get(i),this.privateKey=t,this.publicKey=m.publicKeyCreate(t,!1!==e),this},n.fromPrivate=function(t,e,i){return(new n).fromPrivate(t,e,i)},n.prototype.fromPublic=function(t,e){return s(Buffer.isBuffer(t),"Public key must be a buffer."),s(m.publicKeyVerify(t),"Not a valid public key."),this.network=h.get(e),this.publicKey=t,this},n.prototype.generate=function(t,e){"boolean"!=typeof t&&(e=t,t=null);const i=m.generatePrivateKey();return this.fromKey(i,t,e)},n.generate=function(t,e){return(new n).generate(t,e)},n.fromPublic=function(t,e){return(new n).fromPublic(t,e)},n.prototype.fromKey=function(t,e,i){return s(Buffer.isBuffer(t),"Key must be a buffer."),"boolean"!=typeof e&&(i=e,e=null),32===t.length?this.fromPrivate(t,!1!==e,i):this.fromPublic(t,i)},n.fromKey=function(t,e,i){return(new n).fromKey(t,e,i)},n.prototype.fromScript=function(t,e,i,n){return s(e instanceof l,"Non-script passed into KeyRing."),"boolean"!=typeof i&&(n=i,i=null),this.fromKey(t,i,n),this.script=e,this},n.fromScript=function(t,e,i,r){return(new n).fromScript(t,e,i,r)},n.prototype.getSecretSize=function(){let t=0;return t+=1,t+=this.privateKey.length,33===this.publicKey.length&&(t+=1),t+=4},n.prototype.toSecret=function(t){const e=this.getSecretSize(),i=new u(e);return s(this.privateKey,"Cannot serialize without private key."),t||(t=this.network),t=h.get(t),i.writeU8(t.keyPrefix.privkey),i.writeBytes(this.privateKey),33===this.publicKey.length&&i.writeU8(1),i.writeChecksum(),f.encode(i.render())},n.prototype.fromSecret=function(t,e){const i=new c(f.decode(t),!0),n=i.readU8();e=h.fromWIF(n,e);const r=i.readBytes(32);let o=!1;return i.left()>4&&(s(1===i.readU8(),"Bad compression flag."),o=!0),i.verifyChecksum(),this.fromPrivate(r,o,e)},n.fromSecret=function(t,e){return(new n).fromSecret(t,e)},n.prototype.getPrivateKey=function(t){return this.privateKey?"base58"===t?this.toSecret():"hex"===t?this.privateKey.toString("hex"):this.privateKey:null},n.prototype.getPublicKey=function(t){return"base58"===t?f.encode(this.publicKey):"hex"===t?this.publicKey.toString("hex"):this.publicKey},n.prototype.getScript=function(){return this.script},n.prototype.getProgram=function(){if(!this.witness)return null;if(!this._program){let t;if(this.script){const e=this.script.sha256();t=l.fromProgram(0,e)}else{const e=a.hash160(this.publicKey);t=l.fromProgram(0,e)}this._program=t}return this._program},n.prototype.getNestedHash=function(t){return this.witness?(this._nestedHash||(this._nestedHash=this.getProgram().hash160()),"hex"===t?this._nestedHash.toString("hex"):this._nestedHash):null},n.prototype.getNestedAddress=function(t){if(!this.witness)return null;if(!this._nestedAddress){const t=this.getNestedHash(),e=p.fromScripthash(t,this.network);this._nestedAddress=e}return"base58"===t?this._nestedAddress.toBase58():"string"===t?this._nestedAddress.toString():this._nestedAddress},n.prototype.getScriptHash=function(t){return this.witness?this.getScriptHash256(t):this.getScriptHash160(t)},n.prototype.getScriptHash160=function(t){return this.script?(this._scriptHash160||(this._scriptHash160=this.script.hash160()),"hex"===t?this._scriptHash160.toString("hex"):this._scriptHash160):null},n.prototype.getScriptHash256=function(t){return this.script?(this._scriptHash256||(this._scriptHash256=this.script.sha256()),"hex"===t?this._scriptHash256.toString("hex"):this._scriptHash256):null},n.prototype.getScriptAddress=function(t){if(!this.script)return null;if(!this._scriptAddress){let t;if(this.witness){const e=this.getScriptHash256();t=p.fromWitnessScripthash(e,this.network)}else{const e=this.getScriptHash160();t=p.fromScripthash(e,this.network)}this._scriptAddress=t}return"base58"===t?this._scriptAddress.toBase58():"string"===t?this._scriptAddress.toString():this._scriptAddress},n.prototype.getKeyHash=function(t){return this._keyHash||(this._keyHash=a.hash160(this.publicKey)),"hex"===t?this._keyHash.toString("hex"):this._keyHash},n.prototype.getKeyAddress=function(t){if(!this._keyAddress){const t=this.getKeyHash();let e;e=this.witness?p.fromWitnessPubkeyhash(t,this.network):p.fromPubkeyhash(t,this.network),this._keyAddress=e}return"base58"===t?this._keyAddress.toBase58():"string"===t?this._keyAddress.toString():this._keyAddress},n.prototype.getHash=function(t){return this.nested?this.getNestedHash(t):this.script?this.getScriptHash(t):this.getKeyHash(t)},n.prototype.getAddress=function(t){return this.nested?this.getNestedAddress(t):this.script?this.getScriptAddress(t):this.getKeyAddress(t)},n.prototype.ownHash=function(t){return!!t&&(!!t.equals(this.getKeyHash())||(!(!this.script||!t.equals(this.getScriptHash()))||!(!this.witness||!t.equals(this.getNestedHash()))))},n.prototype.ownOutput=function(t,e){let i;return t instanceof d?i=t:(i=t.outputs[e],s(i,"Output does not exist.")),this.ownHash(i.getHash())},n.prototype.getRedeem=function(t){if(this.witness&&t.equals(this.getNestedHash()))return this.getProgram();if(this.script){if(t.equals(this.getScriptHash160()))return this.script;if(t.equals(this.getScriptHash256()))return this.script}return null},n.prototype.sign=function(t){return s(this.privateKey,"Cannot sign without private key."),m.sign(t,this.privateKey)},n.prototype.verify=function(t,e){return m.verify(t,e,this.publicKey)},n.prototype.getVersion=function(){return this.witness?this.nested?-1:0:-1},n.prototype.getType=function(){return this.nested?p.types.SCRIPTHASH:this.witness?p.types.WITNESS:this.script?p.types.SCRIPTHASH:p.types.PUBKEYHASH},n.prototype.inspect=function(){return this.toJSON()},n.prototype.toJSON=function(){return{network:this.network.type,witness:this.witness,nested:this.nested,publicKey:this.publicKey.toString("hex"),script:this.script?this.script.toRaw().toString("hex"):null,program:this.witness?this.getProgram().toRaw().toString("hex"):null,type:p.typesByVal[this.getType()].toLowerCase(),address:this.getAddress("string")}},n.prototype.fromJSON=function(t){return s(t),s("string"==typeof t.network),s("boolean"==typeof t.witness),s("boolean"==typeof t.nested),s("string"==typeof t.publicKey),s(!t.script||"string"==typeof t.script),this.nework=h.get(t.network),this.witness=t.witness,this.nested=t.nested,this.publicKey=Buffer.from(t.publicKey,"hex"),t.script&&(this.script=Buffer.from(t.script,"hex")),this},n.fromJSON=function(t){return(new n).fromJSON(t)},n.prototype.getSize=function(){let t=0;return t+=1,this.privateKey?(t+=o.sizeVarBytes(this.privateKey),t+=1):t+=o.sizeVarBytes(this.publicKey),t+=this.script?this.script.getVarSize():1},n.prototype.toWriter=function(t){let e=0;return this.witness&&(e|=1),this.nested&&(e|=2),t.writeU8(e),this.privateKey?(t.writeVarBytes(this.privateKey),t.writeU8(33===this.publicKey.length)):t.writeVarBytes(this.publicKey),this.script?t.writeVarBytes(this.script.toRaw()):t.writeVarint(0),t},n.prototype.toRaw=function(){const t=this.getSize();return this.toWriter(new u(t)).render()},n.prototype.fromReader=function(t,e){this.network=h.get(e);const i=t.readU8();this.witness=0!=(1&i),this.nested=0!=(2&i);const n=t.readVarBytes();if(32===n.length){const e=1===t.readU8();this.privateKey=n,this.publicKey=m.publicKeyCreate(n,e)}else this.publicKey=n,s(m.publicKeyVerify(n),"Invalid public key.");const r=t.readVarBytes();return r.length>0&&(this.script=l.fromRaw(r)),this},n.prototype.fromRaw=function(t,e){return this.fromReader(new c(t),e)},n.fromReader=function(t){return(new n).fromReader(t)},n.fromRaw=function(t){return(new n).fromRaw(t)},n.isKeyRing=function(t){return t instanceof n},t.exports=n},function(t,e,i){"use strict";function n(t){if(!(this instanceof n))return new n(t);d.call(this),this.mutable=!0,this.changeIndex=-1,this.view=new b,t&&this.fromOptions(t)}function r(t,e){if(!(this instanceof r))return new r(t,e);this.tx=t.clone(),this.coins=[],this.outputValue=0,this.index=0,this.chosen=[],this.change=0,this.fee=r.MIN_FEE,this.selection="value",this.subtractFee=!1,this.subtractIndex=-1,this.height=-1,this.depth=-1,this.hardFee=-1,this.rate=r.FEE_RATE,this.maxFee=-1,this.round=!1,this.changeAddress=null,this.estimate=null,e&&this.fromOptions(e)}function s(t,e,i){Error.call(this),this.type="FundingError",this.message=t,this.availableFunds=-1,this.requiredFunds=-1,null!=e&&(this.message+=` (available=${R.wmcc(e)},`,this.message+=` required=${R.wmcc(i)})`,this.availableFunds=e,this.requiredFunds=i),Error.captureStackTrace&&Error.captureStackTrace(this,s)}function o(t,e){return t=-1===t.height?2147483647:t.height,e=-1===e.height?2147483647:e.height,t-e}function a(t,e){return Math.random()>.5?1:-1}function h(t,e){return-1===t.height&&-1!==e.height?1:-1!==t.height&&-1===e.height?-1:e.value-t.value}function c(t,e){return t.compare(e)}function u(t,e){return t.compare(e)}const f=i(0),l=i(1),p=i(8),d=i(15),m=i(41),g=i(13),y=i(43),w=i(21),b=i(29),v=i(11),k=i(3),S=i(7),E=i(19),R=i(20),x=i(40);Object.setPrototypeOf(n.prototype,d.prototype),n.prototype.fromOptions=function(t){if(null!=t.version&&(f(l.isU32(t.version),"Version must a be uint32."),this.version=t.version),t.inputs){f(Array.isArray(t.inputs),"Inputs must be an array.");for(const e of t.inputs)this.addInput(e)}if(t.outputs){f(Array.isArray(t.outputs),"Outputs must be an array.");for(const e of t.outputs)this.addOutput(e)}return null!=t.locktime&&(f(l.isU32(t.locktime),"Locktime must be a uint32."),this.locktime=t.locktime),null!=t.changeIndex&&(-1!==t.changeIndex?(f(l.isU32(t.changeIndex),"Change index must be a uint32."),this.changeIndex=t.changeIndex):this.changeIndex=-1),this},n.fromOptions=function(t){return(new n).fromOptions(t)},n.prototype.clone=function(){const t=new n;return t.inject(this),t.changeIndex=this.changeIndex,t},n.prototype.addInput=function(t){const e=m.fromOptions(t);return this.inputs.push(e),e},n.prototype.addOutpoint=function(t){const e=w.fromOptions(t),i=m.fromOutpoint(e);return this.inputs.push(i),i},n.prototype.addCoin=function(t){f(t instanceof y,"Cannot add non-coin.");const e=m.fromCoin(t);return this.inputs.push(e),this.view.addCoin(t),e},n.prototype.addTX=function(t,e,i){f(t instanceof d,"Cannot add non-transaction."),null==i&&(i=-1);const n=m.fromTX(t,e);return this.inputs.push(n),this.view.addIndex(t,e,i),n},n.prototype.addOutput=function(t,e){let i;return null!=e?(f(l.isU64(e),"Value must be a uint64."),i=g.fromScript(t,e)):i=g.fromOptions(t),this.outputs.push(i),i},n.prototype.check=function(t){return d.prototype.check.call(this,this.view,t)},n.prototype.checkAsync=function(t,e){return d.prototype.checkAsync.call(this,this.view,t,e)},n.prototype.verify=function(t){try{this.check(t)}catch(t){if("ScriptError"===t.type)return!1;throw t}return!0},n.prototype.verifyAsync=async function(t,e){try{await this.checkAsync(t,e)}catch(t){if("ScriptError"===t.type)return!1;throw t}return!0},n.prototype.getFee=function(){return d.prototype.getFee.call(this,this.view)},n.prototype.getInputValue=function(){return d.prototype.getInputValue.call(this,this.view)},n.prototype.getInputAddresses=function(){return d.prototype.getInputAddresses.call(this,this.view)},n.prototype.getAddresses=function(){return d.prototype.getAddresses.call(this,this.view)},n.prototype.getInputHashes=function(t){return d.prototype.getInputHashes.call(this,this.view,t)},n.prototype.getHashes=function(t){return d.prototype.getHashes.call(this,this.view,t)},n.prototype.hasCoins=function(){return d.prototype.hasCoins.call(this,this.view)},n.prototype.getSigops=function(t){return d.prototype.getSigops.call(this,this.view,t)},n.prototype.getSigopsCost=function(t){return d.prototype.getSigopsCost.call(this,this.view,t)},n.prototype.getSigopsSize=function(){return d.prototype.getSigopsSize.call(this,this.getSigopsCost())},n.prototype.verifyInputs=function(t){const[e]=this.checkInputs(t);return-1!==e},n.prototype.checkInputs=function(t){return d.prototype.checkInputs.call(this,this.view,t)},n.prototype.scriptInput=function(t,e,i){const n=this.inputs[t];if(f(n,"Input does not exist."),f(e,"No coin passed."),0!==n.script.raw.length||0!==n.witness.items.length)return!0;const r=e.script,s=r.getScripthash();if(s){const t=i.getRedeem(s);if(!t)return!1;if(t.isProgram()){const e=t.getWitnessScripthash();if(e){const r=i.getRedeem(e);if(!r)return!1;const s=this.scriptVector(r,i);return!!s&&(s.push(r.toRaw()),n.witness.fromStack(s),n.script.fromItems([t.toRaw()]),!0)}const r=t.getWitnessPubkeyhash();if(r){const e=p.fromPubkeyhash(r),s=this.scriptVector(e,i);return!!s&&(n.witness.fromStack(s),n.script.fromItems([t.toRaw()]),!0)}return!1}const e=this.scriptVector(t,i);return!!e&&(e.push(t.toRaw()),n.script.fromStack(e),!0)}if(r.isProgram()){const t=r.getWitnessScripthash();if(t){const e=i.getRedeem(t);if(!e)return!1;const r=this.scriptVector(e,i);return!!r&&(r.push(e.toRaw()),n.witness.fromStack(r),!0)}const e=r.getWitnessPubkeyhash();if(e){const t=p.fromPubkeyhash(e),r=this.scriptVector(t,i);return!!r&&(n.witness.fromStack(r),!0)}return!1}const o=this.scriptVector(r,i);return!!o&&(n.script.fromStack(o),!0)},n.prototype.scriptVector=function(t,e){const i=t.getPubkey();if(i){if(!i.equals(e.publicKey))return null;const t=new x;return t.pushInt(0),t}const n=t.getPubkeyhash();if(n){if(!n.equals(e.getKeyHash()))return null;const t=new x;return t.pushInt(0),t.pushData(e.publicKey),t}const[,r]=t.getMultisig();if(-1!==r){if(-1===t.indexOf(e.publicKey))return null;const i=new x;i.pushInt(0);for(let t=0;t<r;t++)i.pushInt(0);return i}return null},n.prototype.signInputAsync=async function(t,e,i,n,r){return r?await r.signInput(this,t,e,i,n,r):this.signInput(t,e,i,n)},n.prototype.signInput=function(t,e,i,n){const r=this.inputs[t],s=i.privateKey;f(r,"Input does not exist."),f(e,"No coin passed.");const o=e.value;let a=e.script,h=r.script,c=0,u=!1;if(a.isScripthash()){if(!(a=r.script.getRedeem()))throw new Error("Input has not been templated.");u=!0}if(a.isWitnessScripthash()){if(!(a=r.witness.getRedeem()))throw new Error("Input has not been templated.");h=r.witness,u=!0,c=1}else{const t=a.getWitnessPubkeyhash();t&&(a=p.fromPubkeyhash(t),h=r.witness,u=!1,c=1)}const l=this.signature(t,a,o,s,n,c);if(u){const t=h.toStack(),e=t.pop(),n=this.signVector(a,t,l,i);return!!n&&(n.push(e),h.fromStack(n),!0)}const d=h.toStack(),m=this.signVector(a,d,l,i);return!!m&&(h.fromStack(m),!0)},n.prototype.signVector=function(t,e,i,n){const r=t.getPubkey();if(r){if(!n.publicKey.equals(r))return null;if(0===e.length)throw new Error("Input has not been templated.");return e.get(0).length>0?e:(e.set(0,i),e)}const s=t.getPubkeyhash();if(s){if(!n.getKeyHash().equals(s))return null;if(2!==e.length)throw new Error("Input has not been templated.");if(0===e.get(1).length)throw new Error("Input has not been templated.");return e.get(0).length>0?e:(e.set(0,i),e)}const[o,a]=t.getMultisig();if(-1!==o){if(e.length<2)throw new Error("Input has not been templated.");if(0!==e.get(0).length)throw new Error("Input has not been templated.");if(e.length-1>a)throw new Error("Input has not been templated.");let r=0;for(let t=1;t<e.length;t++){e.get(t).length>0&&r++}if(r===o&&e.length-1===o)return e;for(;e.length-1<a;)e.pushInt(0);const s=[];for(const e of t.code)e.data&&s.push(e.data);let h=l.indexOf(s,n.publicKey);if(-1===h)return null;if(++h<e.length&&r<o&&0===e.get(h).length&&(e.set(h,i),r++),r>=o){for(let t=e.length-1;t>=1;t--){0===e.get(t).length&&e.remove(t)}for(;r>o;)e.pop(),r--;f(r===o),f(e.length-1===o)}return e}return null},n.prototype.isSigned=function(){for(let t=0;t<this.inputs.length;t++){const{prevout:e}=this.inputs[t],i=this.view.getOutput(e);if(!i)return!1;if(!this.isInputSigned(t,i))return!1}return!0},n.prototype.isInputSigned=function(t,e){const i=this.inputs[t];f(i,"Input does not exist."),f(e,"No coin passed.");let n=e.script,r=i.script,s=!1;if(n.isScripthash()){if(!(n=i.script.getRedeem()))return!1;s=!0}if(n.isWitnessScripthash()){if(!(n=i.witness.getRedeem()))return!1;r=i.witness,s=!0}else{const t=n.getWitnessPubkeyhash();t&&(n=p.fromPubkeyhash(t),r=i.witness,s=!1)}const o=r.toStack();return s&&o.pop(),this.isVectorSigned(n,o)},n.prototype.isVectorSigned=function(t,e){if(t.isPubkey())return 1===e.length&&0!==e.get(0).length;if(t.isPubkeyhash())return 2===e.length&&(0!==e.get(0).length&&0!==e.get(1).length);const[i]=t.getMultisig();if(-1!==i){if(e.length-1!==i)return!1;for(let t=1;t<e.length;t++){if(0===e.get(t).length)return!1}return!0}return!1},n.prototype.template=function(t){if(Array.isArray(t)){let e=0;for(const i of t)e+=this.template(i);return e}let e=0;for(let i=0;i<this.inputs.length;i++){const{prevout:n}=this.inputs[i],r=this.view.getOutput(n);r&&(t.ownOutput(r)&&this.scriptInput(i,r,t)&&e++)}return e},n.prototype.sign=function(t,e){if(Array.isArray(t)){let i=0;for(const n of t)i+=this.sign(n,e);return i}f(t.privateKey,"No private key available.");let i=0;for(let n=0;n<this.inputs.length;n++){const{prevout:r}=this.inputs[n],s=this.view.getOutput(r);s&&(t.ownOutput(s)&&this.scriptInput(n,s,t)&&this.signInput(n,s,t,e)&&i++)}return i},n.prototype.signAsync=async function(t,e,i){return i?await i.sign(this,t,e):this.sign(t,e)},n.prototype.estimateSize=async function(t){const e=S.WITNESS_SCALE_FACTOR;let i=0;i+=4,i+=k.sizeVarint(this.inputs.length),i+=40*this.inputs.length,i+=k.sizeVarint(this.outputs.length);for(const t of this.outputs)i+=t.getSize();i+=4;for(const{prevout:n}of this.inputs){const r=this.view.getOutput(n);if(!r){i+=110;continue}const s=r.script;if(s.isPubkey()){i+=1,i+=74;continue}if(s.isPubkeyhash()){i+=1,i+=74,i+=34;continue}const[o]=s.getMultisig();if(-1===o)if(s.isWitnessPubkeyhash()){let t=0;t+=1,t+=74,i+=t=((t+=34)+e-1)/e|0}else{if(t){const e=await t(s);if(-1!==e){i+=e;continue}}if(s.isScripthash())i+=1,i+=149;else if(s.isWitnessScripthash()){let t=0;t+=1,i+=t=((t+=149)+e-1)/e|0}else i+=110}else{let t=0;t+=1,t+=74*o,i+=t+=k.sizeVarint(t)}}return i},n.prototype.selectCoins=function(t,e){return new r(this,e).select(t)},n.prototype.subtractIndex=function(t,e){f("number"==typeof t),f("number"==typeof e);const i=this.outputs[t];if(!i)throw new Error("Subtraction index does not exist.");if(i.value<e+i.getDustThreshold())throw new Error("Could not subtract fee.");i.value-=e},n.prototype.subtractFee=function(t){f("number"==typeof t);let e=0;for(const t of this.outputs)t.script.isUnspendable()||(e+=1);if(0===e)throw new Error("Could not subtract fee.");const i=t%e,n=(t-i)/e;for(const t of this.outputs)if(!t.script.isUnspendable()){if(t.value<n+t.getDustThreshold())throw new Error("Could not subtract fee.");t.value-=n}for(const t of this.outputs)if(!t.script.isUnspendable()&&t.value>=i+t.getDustThreshold())return void(t.value-=i);throw new Error("Could not subtract fee.")},n.prototype.fund=async function(t,e){f(e,"Options are required."),f(e.changeAddress,"Change address is required."),f(0===this.inputs.length,"TX is already funded.");const i=await this.selectCoins(t,e);for(const t of i.chosen)this.addCoin(t);if(i.subtractFee){const t=i.subtractIndex;-1!==t?this.subtractIndex(t,i.fee):this.subtractFee(i.fee)}const n=new g;return n.value=i.change,n.script.fromAddress(i.changeAddress),n.isDust(E.MIN_RELAY)?(this.changeIndex=-1,f.strictEqual(this.getFee(),i.fee+i.change)):(this.outputs.push(n),this.changeIndex=this.outputs.length-1,f.strictEqual(this.getFee(),i.fee)),i},n.prototype.sortMembers=function(){let t=null;-1!==this.changeIndex&&(t=this.outputs[this.changeIndex],f(t)),this.inputs.sort(c),this.outputs.sort(u),-1!==this.changeIndex&&(this.changeIndex=this.outputs.indexOf(t),f(-1!==this.changeIndex))},n.prototype.avoidFeeSniping=function(t){f("number"==typeof t,"Must pass in height."),0===l.random(0,10)&&(t-=l.random(0,100))<0&&(t=0),this.setLocktime(t)},n.prototype.setLocktime=function(t){f(l.isU32(t),"Locktime must be a uint32."),f(this.inputs.length>0,"Cannot set sequence with no inputs.");for(const t of this.inputs)4294967295===t.sequence&&(t.sequence=4294967294);this.locktime=t},n.prototype.setSequence=function(t,e,i){const n=this.inputs[t];f(n,"Input does not exist."),f(l.isU32(e),"Locktime must be a uint32."),this.version=2,i?(e>>>=S.SEQUENCE_GRANULARITY,e&=S.SEQUENCE_MASK,e|=S.SEQUENCE_TYPE_FLAG):e&=S.SEQUENCE_MASK,n.sequence=e},n.prototype.inspect=function(){return this.format()},n.prototype.format=function(){return d.prototype.format.call(this,this.view)},n.prototype.toJSON=function(){return d.prototype.getJSON.call(this,null,this.view)},n.prototype.getJSON=function(t){return d.prototype.getJSON.call(this,t,this.view)},n.fromJSON=function(t){return(new n).fromJSON(t)},n.fromReader=function(t){return(new n).fromReader(t)},n.fromRaw=function(t,e){return"string"==typeof t&&(t=Buffer.from(t,e)),(new n).fromRaw(t)},n.prototype.toTX=function(){return(new d).inject(this)},n.prototype.commit=function(){return[this.toTX(),this.view]},n.fromTX=function(t){return(new n).inject(t)},n.isMTX=function(t){return t instanceof n},r.FEE_RATE=1e4,r.MIN_FEE=1e4,r.MAX_FEE=S.COIN/10,r.prototype.fromOptions=function(t){if(t.selection&&(f("string"==typeof t.selection),this.selection=t.selection),null!=t.subtractFee&&("number"==typeof t.subtractFee?(f(l.isInt(t.subtractFee)),f(t.subtractFee>=-1),this.subtractIndex=t.subtractFee,this.subtractFee=-1!==this.subtractIndex):(f("boolean"==typeof t.subtractFee),this.subtractFee=t.subtractFee)),null!=t.subtractIndex&&(f(l.isInt(t.subtractIndex)),f(t.subtractIndex>=-1),this.subtractIndex=t.subtractIndex,this.subtractFee=-1!==this.subtractIndex),null!=t.height&&(f(l.isInt(t.height)),f(t.height>=-1),this.height=t.height),null!=t.confirmations&&(f(l.isInt(t.confirmations)),f(t.confirmations>=-1),this.depth=t.confirmations),null!=t.depth&&(f(l.isInt(t.depth)),f(t.depth>=-1),this.depth=t.depth),null!=t.hardFee&&(f(l.isInt(t.hardFee)),f(t.hardFee>=-1),this.hardFee=t.hardFee),null!=t.rate&&(f(l.isU64(t.rate)),this.rate=t.rate),null!=t.maxFee&&(f(l.isInt(t.maxFee)),f(t.maxFee>=-1),this.maxFee=t.maxFee),null!=t.round&&(f("boolean"==typeof t.round),this.round=t.round),t.changeAddress){const e=t.changeAddress;"string"==typeof e?this.changeAddress=v.fromString(e):(f(e instanceof v),this.changeAddress=e)}return t.estimate&&(f("function"==typeof t.estimate),this.estimate=t.estimate),this},r.prototype.init=function(t){switch(this.coins=t.slice(),this.outputValue=this.tx.getOutputValue(),this.index=0,this.chosen=[],this.change=0,this.fee=r.MIN_FEE,this.tx.inputs.length=0,this.selection){case"all":case"random":this.coins.sort(a);break;case"age":this.coins.sort(o);break;case"value":this.coins.sort(h);break;default:throw new s(`Bad selection type: ${this.selection}.`)}},r.prototype.total=function(){return this.subtractFee?this.outputValue:this.outputValue+this.fee},r.prototype.isFull=function(){return this.tx.getInputValue()>=this.total()},r.prototype.isSpendable=function(t){if(-1===this.height)return!0;if(t.coinbase)return-1!==t.height&&!(this.height+1<t.height+S.COINBASE_MATURITY);if(-1===this.depth)return!0;return!(t.getDepth(this.height)<this.depth)},r.prototype.getFee=function(t){if(this.round){const e=E.getRoundFee(t,this.rate);return Math.min(e,r.MAX_FEE)}const e=E.getMinFee(t,this.rate);return Math.min(e,r.MAX_FEE)},r.prototype.fund=function(){for(;this.index<this.coins.length;){const t=this.coins[this.index++];if(this.isSpendable(t)&&(this.tx.addCoin(t),this.chosen.push(t),"all"!==this.selection&&this.isFull()))break}},r.prototype.select=async function(t){if(this.init(t),-1!==this.hardFee?this.selectHard():await this.selectEstimate(),!this.isFull())throw new s("Not enough funds.",this.tx.getInputValue(),this.total());return this.change=this.tx.getInputValue()-this.total(),this},r.prototype.selectEstimate=async function(){this.fee=r.MIN_FEE,this.fund();const t=new g;this.changeAddress?t.script.fromAddress(this.changeAddress):t.script.fromPubkeyhash(k.ZERO_HASH160),this.tx.outputs.push(t);do{const t=await this.tx.estimateSize(this.estimate);if(this.fee=this.getFee(t),this.maxFee>0&&this.fee>this.maxFee)throw new s("Fee is too high.");this.isFull()||this.fund()}while(!this.isFull()&&this.index<this.coins.length)},r.prototype.selectHard=function(){this.fee=Math.min(this.hardFee,r.MAX_FEE),this.fund()},Object.setPrototypeOf(s.prototype,Error.prototype),(e=n).MTX=n,e.Selector=r,e.FundingError=s,t.exports=e},function(t,e,i){"use strict";t.exports=i(131)},function(t,e,i){"use strict";function n(){if(!(this instanceof n))return new n;this.version=1,this.height=-1,this.coinbase=!1,this.output=new o,this.spent=!1,this.raw=null}const r=i(0),s=i(43),o=i(13),a=i(2),h=i(4),c=i(3),u=i(103);n.prototype.toOutput=function(){return this.output},n.prototype.toCoin=function(t){const e=new s;return e.version=this.version,e.height=this.height,e.coinbase=this.coinbase,e.script=this.output.script,e.value=this.output.value,e.hash=t.hash,e.index=t.index,e},n.prototype.fromOutput=function(t){return this.output=t,this},n.fromOutput=function(t){return(new n).fromOutput(t)},n.prototype.fromCoin=function(t){return this.version=t.version,this.height=t.height,this.coinbase=t.coinbase,this.output.script=t.script,this.output.value=t.value,this},n.fromCoin=function(t){return(new n).fromCoin(t)},n.prototype.fromTX=function(t,e,i){return r("number"==typeof e),r("number"==typeof i),r(e>=0&&e<t.outputs.length),this.version=t.version,this.height=i,this.coinbase=t.isCoinbase(),this.output=t.outputs[e],this},n.fromTX=function(t,e,i){return(new n).fromTX(t,e,i)},n.prototype.getSize=function(){if(this.raw)return this.raw.length;let t=0;return t+=c.sizeVarint(this.version),t+=4,t+=u.size(this.output)},n.prototype.toWriter=function(t){if(this.raw)return t.writeBytes(this.raw),t;let e=this.height,i=0;return this.coinbase&&(i|=1),-1===e&&(e=2147483647),i|=e<<1,t.writeVarint(this.version),t.writeU32(i),u.pack(this.output,t),t},n.prototype.toRaw=function(){if(this.raw)return this.raw;const t=this.getSize(),e=new h(t);return this.toWriter(e),this.raw=e.render(),this.raw},n.prototype.fromReader=function(t){const e=t.readVarint(),i=t.readU32();let n=i>>>1;return 2147483647===n&&(n=-1),this.version=e,this.coinbase=0!=(1&i),this.height=n,u.unpack(this.output,t),this},n.fromReader=function(t){return(new n).fromReader(t)},n.prototype.fromRaw=function(t){return this.fromReader(new a(t)),this.raw=t,this},n.fromRaw=function(t){return(new n).fromRaw(t)},t.exports=n},function(t,e,i){"use strict";function n(t){if(!(this instanceof n))return new n(t);f.call(this),this.txs=[],this._raw=null,this._size=-1,this._witness=-1,t&&this.fromOptions(t)}function r(t,e){this.data=null,this.size=t,this.witness=e}const s=i(0),o=i(1),a=i(3),h=i(5),c=i(66),u=i(7),f=i(69),l=i(2),p=i(4),d=i(15),m=i(71),g=i(37),y=i(6);Object.setPrototypeOf(n.prototype,f.prototype),n.prototype.fromOptions=function(t){if(this.parseOptions(t),t.txs){s(Array.isArray(t.txs));for(const e of t.txs)s(e instanceof d),this.txs.push(e)}},n.fromOptions=function(t){return(new n).fromOptions(t)},n.prototype.refresh=function(t){if(this._refresh(),this._raw=null,this._size=-1,this._witness=-1,t)for(const t of this.txs)t.refresh()},n.prototype.toRaw=function(){return this.frame().data},n.prototype.toNormal=function(){return this.hasWitness()?this.frameNormal().data:this.toRaw()},n.prototype.toWriter=function(t){if(this.mutable)return this.writeWitness(t);const e=this.frame();return t.writeBytes(e.data),t},n.prototype.toNormalWriter=function(t){return this.hasWitness()?(this.writeNormal(t),t):this.toWriter(t)},n.prototype.frame=function(){if(this.mutable)return s(!this._raw),this.frameWitness();if(this._raw){s(this._size>=0),s(this._witness>=0);const t=new r(this._size,this._witness);return t.data=this._raw,t}const t=this.frameWitness();return this._raw=t.data,this._size=t.size,this._witness=t.witness,t},n.prototype.getSizes=function(){return this.mutable?this.getWitnessSizes():this.frame()},n.prototype.getVirtualSize=function(){const t=u.WITNESS_SCALE_FACTOR;return(this.getWeight()+t-1)/t|0},n.prototype.getWeight=function(){const t=this.getSizes();return(t.size-t.witness)*(u.WITNESS_SCALE_FACTOR-1)+t.size},n.prototype.getSize=function(){return this.getSizes().size},n.prototype.getBaseSize=function(){const t=this.getSizes();return t.size-t.witness},n.prototype.hasWitness=function(){if(-1!==this._witness)return 0!==this._witness;for(const t of this.txs)if(t.hasWitness())return!0;return!1},n.prototype.hasTX=function(t){return-1!==this.indexOf(t)},n.prototype.indexOf=function(t){for(let e=0;e<this.txs.length;e++){if(this.txs[e].hash("hex")===t)return e}return-1},n.prototype.createMerkleRoot=function(t){const e=[];for(const t of this.txs)e.push(t.hash());const[i,n]=c.createRoot(e);return n?null:"hex"===t?i.toString("hex"):i},n.prototype.createWitnessNonce=function(){return Buffer.from(a.ZERO_HASH)},n.prototype.createCommitmentHash=function(t){const e=this.getWitnessNonce(),i=[];s(e,"No witness nonce present."),i.push(a.ZERO_HASH);for(let t=1;t<this.txs.length;t++){const e=this.txs[t];i.push(e.witnessHash())}const[n]=c.createRoot(i),r=h.root256(n,e);return"hex"===t?r.toString("hex"):r},n.prototype.getMerkleRoot=function(t){return"hex"===t?this.merkleRoot:Buffer.from(this.merkleRoot,"hex")},n.prototype.getWitnessNonce=function(){if(0===this.txs.length)return null;const t=this.txs[0];if(1!==t.inputs.length)return null;const e=t.inputs[0];return 1!==e.witness.items.length?null:32!==e.witness.items[0].length?null:e.witness.items[0]},n.prototype.getCommitmentHash=function(t){if(0===this.txs.length)return null;const e=this.txs[0];let i;for(let t=e.outputs.length-1;t>=0;t--){const n=e.outputs[t];if(n.script.isCommitment()){i=n.script.getCommitment();break}}return i?"hex"===t?i.toString("hex"):i:null},n.prototype.verifyBody=function(){const[t]=this.checkBody();return t},n.prototype.checkBody=function(){const t=this.createMerkleRoot("hex");if(!t)return[!1,"bad-txns-duplicate",100];if(this.merkleRoot!==t)return[!1,"bad-txnmrklroot",100];if(0===this.txs.length||this.txs.length>u.MAX_BLOCK_SIZE||this.getBaseSize()>u.MAX_BLOCK_SIZE)return[!1,"bad-blk-length",100];if(0===this.txs.length||!this.txs[0].isCoinbase())return[!1,"bad-cb-missing",100];const e=u.WITNESS_SCALE_FACTOR;let i=0;for(let t=0;t<this.txs.length;t++){const n=this.txs[t];if(t>0&&n.isCoinbase())return[!1,"bad-cb-multiple",100];const[r,s,o]=n.checkSanity(this.getCoinbaseHeight());if(!r)return[r,s,o];if((i+=n.getLegacySigops())*e>u.MAX_BLOCK_SIGOPS_COST)return[!1,"bad-blk-sigops",100]}return[!0,"valid",0]},n.prototype.getCoinbaseHeight=function(){if(this.version<2)return-1;if(0===this.txs.length)return-1;const t=this.txs[0];return 0===t.inputs.length?-1:t.inputs[0].script.getCoinbaseHeight()},n.prototype.getClaimed=function(){return s(this.txs.length>0),s(this.txs[0].isCoinbase()),this.txs[0].getOutputValue()},n.prototype.getPrevout=function(){const t=Object.create(null);for(let e=1;e<this.txs.length;e++){const i=this.txs[e];for(const e of i.inputs)t[e.prevout.hash]=!0}return Object.keys(t)},n.prototype.getCoinreserve=function(){return s(this.txs.length>0),s(this.txs[0].isCoinbase()),this.txs[0].outputs[1]},n.prototype.inspect=function(){return this.format()},n.prototype.format=function(t,e){const i=this.getCommitmentHash("hex");return{hash:this.rhash(),height:null!=e?e:-1,size:this.getSize(),virtualSize:this.getVirtualSize(),date:o.date(this.time),version:o.hex32(this.version),prevBlock:o.revHex(this.prevBlock),merkleRoot:o.revHex(this.merkleRoot),commitmentHash:i?o.revHex(i):null,time:this.time,bits:this.bits,nonce:this.nonce,txs:this.txs.map((e,i)=>e.format(t,null,i))}},n.prototype.toJSON=function(){return this.getJSON()},n.prototype.getJSON=function(t,e,i){return t=y.get(t),{hash:this.rhash(),height:i,version:this.version,prevBlock:o.revHex(this.prevBlock),merkleRoot:o.revHex(this.merkleRoot),time:this.time,bits:this.bits,nonce:this.nonce,txs:this.txs.map((i,n)=>i.getJSON(t,e,null,n))}},n.prototype.fromJSON=function(t){s(t,"Block data is required."),s(Array.isArray(t.txs)),this.parseJSON(t);for(const e of t.txs)this.txs.push(d.fromJSON(e));return this},n.fromJSON=function(t){return(new n).fromJSON(t)},n.prototype.fromReader=function(t){t.start(),this.readHead(t);const e=t.readVarint();let i=0;for(let n=0;n<e;n++){const e=d.fromReader(t);i+=e._witness,this.txs.push(e)}return this.mutable||(this._raw=t.endData(),this._size=this._raw.length,this._witness=i),this},n.prototype.fromRaw=function(t){return this.fromReader(new l(t))},n.fromReader=function(t){return(new n).fromReader(t)},n.fromRaw=function(t,e){return"string"==typeof t&&(t=Buffer.from(t,e)),(new n).fromRaw(t)},n.prototype.toMerkle=function(t){return m.fromBlock(this,t)},n.prototype.writeNormal=function(t){this.writeHead(t),t.writeVarint(this.txs.length);for(const e of this.txs)e.toNormalWriter(t);return t},n.prototype.writeWitness=function(t){this.writeHead(t),t.writeVarint(this.txs.length);for(const e of this.txs)e.toWriter(t);return t},n.prototype.frameNormal=function(){const t=this.getNormalSizes(),e=new p(t.size);return this.writeNormal(e),t.data=e.render(),t},n.prototype.frameWitness=function(){const t=this.getWitnessSizes(),e=new p(t.size);return this.writeWitness(e),t.data=e.render(),t},n.prototype.toHeaders=function(){return g.fromBlock(this)},n.prototype.getNormalSizes=function(){let t=0;t+=80,t+=a.sizeVarint(this.txs.length);for(const e of this.txs)t+=e.getBaseSize();return new r(t,0)},n.prototype.getWitnessSizes=function(){let t=0,e=0;t+=80,t+=a.sizeVarint(this.txs.length);for(const i of this.txs){const n=i.getSizes();t+=n.size,e+=n.witness}return new r(t,e)},n.isBlock=function(t){return t instanceof n},t.exports=n},function(t,e,i){"use strict";const n=i(0);t.exports=function(t,e){if(n(Buffer.isBuffer(t)),n(Buffer.isBuffer(e)),0===e.length)return 0===t.length;let i=t.length^e.length;for(let n=0;n<t.length;n++)i|=t[n]^e[n%e.length];return 0===i}},function(t,e,i){"use strict";function n(){this.id=++n.id>>>0}function r(t){n.call(this),this.env=t||{},this.json=JSON.stringify(this.env)}function s(t){n.call(this),this.items=t||[],this.json=JSON.stringify(this.items)}function o(t){n.call(this),this.text=t||""}function a(t){n.call(this),this.error=t||new Error}function h(t){a.call(this,t)}function c(t,e,i){n.call(this),this.tx=t||null,this.view=e||null,this.flags=null!=i?i:null}function u(t){n.call(this),this.error=t||null}function f(t,e,i){n.call(this),this.tx=t||null,this.rings=e||[],this.type=null!=i?i:1}function l(t,e,i){n.call(this),this.total=t||0,this.script=i||[],this.witness=e||[]}function p(t,e,i,r){n.call(this),this.tx=t||null,this.index=e,this.coin=i||null,this.flags=null!=r?r:null}function d(t){u.call(this,t)}function m(t,e,i,r,s){n.call(this),this.tx=t||null,this.index=e,this.coin=i||null,this.ring=r||null,this.type=null!=s?s:1}function g(t,e,i){n.call(this),this.value=t||!1,this.script=i||null,this.witness=e||null}function y(t,e,i){n.call(this),this.msg=t||null,this.sig=e||null,this.key=i||null}function w(t){n.call(this),this.value=t}function b(t,e){n.call(this),this.msg=t||null,this.key=e||null}function v(t){n.call(this),this.sig=t}function k(t,e,i,r){n.call(this),this.data=t||null,this.target=e||null,this.min=null!=i?i:-1,this.max=null!=r?r:-1}function S(t){n.call(this),this.nonce=null!=t?t:-1}function E(t,e,i,r,s,o){n.call(this),this.passwd=t||null,this.salt=e||null,this.N=null!=i?i:-1,this.r=null!=r?r:-1,this.p=null!=s?s:-1,this.len=null!=o?o:-1}function R(t){n.call(this),this.key=t||null}function x(t){return"string"!=typeof t?"":t}const _=i(0),I=i(2),A=i(3),O=i(8),B=i(56),P=i(13),M=i(48),N=i(15),T=i(47),C=i(29),U=i(35),H={ENV:0,EVENT:1,LOG:2,ERROR:3,ERRORRESULT:4,CHECK:5,CHECKRESULT:6,SIGN:7,SIGNRESULT:8,CHECKINPUT:9,CHECKINPUTRESULT:10,SIGNINPUT:11,SIGNINPUTRESULT:12,ECVERIFY:13,ECVERIFYRESULT:14,ECSIGN:15,ECSIGNRESULT:16,MINE:17,MINERESULT:18,SCRYPT:19,SCRYPTRESULT:20};n.id=0,n.prototype.cmd=-1,n.prototype.getSize=function(){throw new Error("Abstract method.")},n.prototype.toWriter=function(){throw new Error("Abstract method.")},n.prototype.fromRaw=function(){throw new Error("Abstract method.")},n.fromRaw=function(){throw new Error("Abstract method.")},Object.setPrototypeOf(r.prototype,n.prototype),r.prototype.cmd=H.ENV,r.prototype.getSize=function(){return A.sizeVarString(this.json,"utf8")},r.prototype.toWriter=function(t){return t.writeVarString(this.json,"utf8"),t},r.prototype.fromRaw=function(t){const e=new I(t,!0);return this.json=e.readVarString("utf8"),this.env=JSON.parse(this.json),this},r.fromRaw=function(t){return(new r).fromRaw(t)},Object.setPrototypeOf(s.prototype,n.prototype),s.prototype.cmd=H.EVENT,s.prototype.getSize=function(){return A.sizeVarString(this.json,"utf8")},s.prototype.toWriter=function(t){return t.writeVarString(this.json,"utf8"),t},s.prototype.fromRaw=function(t){const e=new I(t,!0);return this.json=e.readVarString("utf8"),this.items=JSON.parse(this.json),this},s.fromRaw=function(t){return(new s).fromRaw(t)},Object.setPrototypeOf(o.prototype,n.prototype),o.prototype.cmd=H.LOG,o.prototype.getSize=function(){return A.sizeVarString(this.text,"utf8")},o.prototype.toWriter=function(t){return t.writeVarString(this.text,"utf8"),t},o.prototype.fromRaw=function(t){const e=new I(t,!0);return this.text=e.readVarString("utf8"),this},o.fromRaw=function(t){return(new o).fromRaw(t)},Object.setPrototypeOf(a.prototype,n.prototype),a.prototype.cmd=H.ERROR,a.prototype.getSize=function(){const t=this.error;let e=0;switch(e+=A.sizeVarString(x(t.message),"utf8"),e+=A.sizeVarString(x(t.stack),"utf8"),e+=A.sizeVarString(x(t.type),"utf8"),typeof t.code){case"number":e+=1,e+=4;break;case"string":e+=1,e+=A.sizeVarString(t.code,"utf8");break;default:e+=1}return e},a.prototype.toWriter=function(t){const e=this.error;switch(t.writeVarString(x(e.message),"utf8"),t.writeVarString(x(e.stack),"utf8"),t.writeVarString(x(e.type),"utf8"),typeof e.code){case"number":t.writeU8(2),t.writeI32(e.code);break;case"string":t.writeU8(1),t.writeVarString(e.code,"utf8");break;default:t.writeU8(0)}return t},a.prototype.fromRaw=function(t){const e=new I(t,!0),i=this.error;switch(i.message=e.readVarString("utf8"),i.stack=e.readVarString("utf8"),i.type=e.readVarString("utf8"),e.readU8()){case 2:i.code=e.readI32();break;case 1:i.code=e.readVarString("utf8");break;default:i.code=null}return this},a.fromRaw=function(t){return(new a).fromRaw(t)},Object.setPrototypeOf(h.prototype,a.prototype),h.prototype.cmd=H.ERRORRESULT,h.fromRaw=function(t){return(new h).fromRaw(t)},Object.setPrototypeOf(c.prototype,n.prototype),c.prototype.cmd=H.CHECK,c.prototype.getSize=function(){return this.tx.getSize()+this.view.getSize(this.tx)+4},c.prototype.toWriter=function(t){return this.tx.toWriter(t),this.view.toWriter(t,this.tx),t.writeI32(null!=this.flags?this.flags:-1),t},c.prototype.fromRaw=function(t){const e=new I(t,!0);return this.tx=N.fromReader(e),this.view=C.fromReader(e,this.tx),this.flags=e.readI32(),-1===this.flags&&(this.flags=null),this},c.fromRaw=function(t){return(new c).fromRaw(t)},Object.setPrototypeOf(u.prototype,n.prototype),u.prototype.cmd=H.CHECKRESULT,u.prototype.getSize=function(){const t=this.error;let e=0;return t?(e+=1,e+=A.sizeVarString(x(t.message),"utf8"),e+=A.sizeVarString(x(t.stack),"utf8"),e+=A.sizeVarString(x(t.code),"utf8"),e+=1,e+=4):e+=1},u.prototype.toWriter=function(t){const e=this.error;return e?(t.writeU8(1),t.writeVarString(x(e.message),"utf8"),t.writeVarString(x(e.stack),"utf8"),t.writeVarString(x(e.code),"utf8"),t.writeU8(-1===e.op?255:e.op),t.writeU32(-1===e.ip?4294967295:e.ip),t):(t.writeU8(0),t)},u.prototype.fromRaw=function(t){const e=new I(t,!0);if(0===e.readU8())return this;const i=new U("");return i.message=e.readVarString("utf8"),i.stack=e.readVarString("utf8"),i.code=e.readVarString("utf8"),i.op=e.readU8(),i.ip=e.readU32(),255===i.op&&(i.op=-1),4294967295===i.ip&&(i.ip=-1),this.error=i,this},u.fromRaw=function(t){return(new u).fromRaw(t)},Object.setPrototypeOf(f.prototype,n.prototype),f.prototype.cmd=H.SIGN,f.prototype.getSize=function(){let t=0;t+=this.tx.getSize(),t+=this.tx.view.getSize(this.tx),t+=A.sizeVarint(this.rings.length);for(const e of this.rings)t+=e.getSize();return t+=1},f.prototype.toWriter=function(t){this.tx.toWriter(t),this.tx.view.toWriter(t,this.tx),t.writeVarint(this.rings.length);for(const e of this.rings)e.toWriter(t);return t.writeU8(this.type),t},f.prototype.fromRaw=function(t){const e=new I(t,!0);this.tx=M.fromReader(e),this.tx.view.fromReader(e,this.tx);const i=e.readVarint();for(let t=0;t<i;t++){const t=T.fromReader(e);this.rings.push(t)}return this.type=e.readU8(),this},f.fromRaw=function(t){return(new f).fromRaw(t)},Object.setPrototypeOf(l.prototype,n.prototype),l.prototype.cmd=H.SIGNRESULT,l.prototype.fromTX=function(t,e){this.total=e;for(const e of t.inputs)this.script.push(e.script),this.witness.push(e.witness);return this},l.fromTX=function(t,e){return(new l).fromTX(t,e)},l.prototype.getSize=function(){let t=0;t+=A.sizeVarint(this.total),t+=A.sizeVarint(this.script.length);for(let e=0;e<this.script.length;e++){const i=this.script[e],n=this.witness[e];t+=i.getVarSize(),t+=n.getVarSize()}return t},l.prototype.toWriter=function(t){_(this.script.length===this.witness.length),t.writeVarint(this.total),t.writeVarint(this.script.length);for(let e=0;e<this.script.length;e++)this.script[e].toWriter(t),this.witness[e].toWriter(t);return t},l.prototype.inject=function(t){_(this.script.length===t.inputs.length),_(this.witness.length===t.inputs.length);for(let e=0;e<t.inputs.length;e++){const i=t.inputs[e];i.script=this.script[e],i.witness=this.witness[e]}},l.prototype.fromRaw=function(t){const e=new I(t,!0);this.total=e.readVarint();const i=e.readVarint();for(let t=0;t<i;t++)this.script.push(O.fromReader(e)),this.witness.push(B.fromReader(e));return this},l.fromRaw=function(t){return(new l).fromRaw(t)},Object.setPrototypeOf(p.prototype,n.prototype),p.prototype.cmd=H.CHECKINPUT,p.prototype.getSize=function(){let t=0;return t+=this.tx.getSize(),t+=A.sizeVarint(this.index),t+=A.sizeVarint(this.coin.value),t+=this.coin.script.getVarSize(),t+=4},p.prototype.toWriter=function(t){return this.tx.toWriter(t),t.writeVarint(this.index),t.writeVarint(this.coin.value),this.coin.script.toWriter(t),t.writeI32(null!=this.flags?this.flags:-1),t},p.prototype.fromRaw=function(t){const e=new I(t,!0);return this.tx=N.fromReader(e),this.index=e.readVarint(),this.coin=new P,this.coin.value=e.readVarint(),this.coin.script.fromReader(e),this.flags=e.readI32(),-1===this.flags&&(this.flags=null),this},p.fromRaw=function(t){return(new p).fromRaw(t)},Object.setPrototypeOf(d.prototype,u.prototype),d.prototype.cmd=H.CHECKINPUTRESULT,d.fromRaw=function(t){return(new d).fromRaw(t)},Object.setPrototypeOf(m.prototype,n.prototype),m.prototype.cmd=H.SIGNINPUT,m.prototype.getSize=function(){let t=0;return t+=this.tx.getSize(),t+=A.sizeVarint(this.index),t+=A.sizeVarint(this.coin.value),t+=this.coin.script.getVarSize(),t+=this.ring.getSize(),t+=1},m.prototype.toWriter=function(t){return this.tx.toWriter(t),t.writeVarint(this.index),t.writeVarint(this.coin.value),this.coin.script.toWriter(t),this.ring.toWriter(t),t.writeU8(this.type),t},m.prototype.fromRaw=function(t){const e=new I(t,!0);return this.tx=M.fromReader(e),this.index=e.readVarint(),this.coin=new P,this.coin.value=e.readVarint(),this.coin.script.fromReader(e),this.ring=T.fromReader(e),this.type=e.readU8(),this},m.fromRaw=function(t){return(new m).fromRaw(t)},Object.setPrototypeOf(g.prototype,n.prototype),g.prototype.cmd=H.SIGNINPUTRESULT,g.prototype.fromTX=function(t,e,i){const n=t.inputs[e];return _(n),this.value=i,this.script=n.script,this.witness=n.witness,this},g.fromTX=function(t,e,i){return(new g).fromTX(t,e,i)},g.prototype.getSize=function(){return 1+this.script.getVarSize()+this.witness.getVarSize()},g.prototype.toWriter=function(t){return t.writeU8(this.value?1:0),this.script.toWriter(t),this.witness.toWriter(t),t},g.prototype.inject=function(t,e){const i=t.inputs[e];_(i),i.script=this.script,i.witness=this.witness},g.prototype.fromRaw=function(t){const e=new I(t,!0);return this.value=1===e.readU8(),this.script=O.fromReader(e),this.witness=B.fromReader(e),this},g.fromRaw=function(t){return(new g).fromRaw(t)},Object.setPrototypeOf(y.prototype,n.prototype),y.prototype.cmd=H.ECVERIFY,y.prototype.getSize=function(){let t=0;return t+=A.sizeVarBytes(this.msg),t+=A.sizeVarBytes(this.sig),t+=A.sizeVarBytes(this.key)},y.prototype.toWriter=function(t){return t.writeVarBytes(this.msg),t.writeVarBytes(this.sig),t.writeVarBytes(this.key),t},y.prototype.fromRaw=function(t){const e=new I(t,!0);return this.msg=e.readVarBytes(),this.sig=e.readVarBytes(),this.key=e.readVarBytes(),this},y.fromRaw=function(t){return(new y).fromRaw(t)},Object.setPrototypeOf(w.prototype,n.prototype),w.prototype.cmd=H.ECVERIFYRESULT,w.prototype.getSize=function(){return 1},w.prototype.toWriter=function(t){return t.writeU8(this.value?1:0),t},w.prototype.fromRaw=function(t){const e=new I(t,!0);return this.value=1===e.readU8(),this},w.fromRaw=function(t){return(new w).fromRaw(t)},Object.setPrototypeOf(b.prototype,n.prototype),b.prototype.cmd=H.ECSIGN,b.prototype.getSize=function(){let t=0;return t+=A.sizeVarBytes(this.msg),t+=A.sizeVarBytes(this.key)},b.prototype.toWriter=function(t){return t.writeVarBytes(this.msg),t.writeVarBytes(this.key),t},b.prototype.fromRaw=function(t){const e=new I(t,!0);return this.msg=e.readVarBytes(),this.key=e.readVarBytes(),this},b.fromRaw=function(t){return(new b).fromRaw(t)},Object.setPrototypeOf(v.prototype,n.prototype),v.prototype.cmd=H.ECSIGNRESULT,v.prototype.getSize=function(){return A.sizeVarBytes(this.sig)},v.prototype.toWriter=function(t){return t.writeVarBytes(this.sig),t},v.prototype.fromRaw=function(t){const e=new I(t,!0);return this.sig=e.readVarBytes(),this},v.fromRaw=function(t){return(new v).fromRaw(t)},Object.setPrototypeOf(k.prototype,n.prototype),k.prototype.cmd=H.MINE,k.prototype.getSize=function(){return 120},k.prototype.toWriter=function(t){return t.writeBytes(this.data),t.writeBytes(this.target),t.writeU32(this.min),t.writeU32(this.max),t},k.prototype.fromRaw=function(t){const e=new I(t,!0);return this.data=e.readBytes(80),this.target=e.readBytes(32),this.min=e.readU32(),this.max=e.readU32(),this},k.fromRaw=function(t){return(new k).fromRaw(t)},Object.setPrototypeOf(S.prototype,n.prototype),S.prototype.cmd=H.MINERESULT,S.prototype.getSize=function(){return 5},S.prototype.toWriter=function(t){return t.writeU8(-1!==this.nonce?1:0),t.writeU32(this.nonce),t},S.prototype.fromRaw=function(t){const e=new I(t,!0);return this.nonce=-1,1===e.readU8()&&(this.nonce=e.readU32()),this},S.fromRaw=function(t){return(new S).fromRaw(t)},Object.setPrototypeOf(E.prototype,n.prototype),E.prototype.cmd=H.SCRYPT,E.prototype.getSize=function(){let t=0;return t+=A.sizeVarBytes(this.passwd),t+=A.sizeVarBytes(this.salt),t+=16},E.prototype.toWriter=function(t){return t.writeVarBytes(this.passwd),t.writeVarBytes(this.salt),t.writeU32(this.N),t.writeU32(this.r),t.writeU32(this.p),t.writeU32(this.len),t},E.prototype.fromRaw=function(t){const e=new I(t,!0);return this.passwd=e.readVarBytes(),this.salt=e.readVarBytes(),this.N=e.readU32(),this.r=e.readU32(),this.p=e.readU32(),this.len=e.readU32(),this},E.fromRaw=function(t){return(new E).fromRaw(t)},Object.setPrototypeOf(R.prototype,n.prototype),R.prototype.cmd=H.SCRYPTRESULT,R.prototype.getSize=function(){return A.sizeVarBytes(this.key)},R.prototype.toWriter=function(t){return t.writeVarBytes(this.key),t},R.prototype.fromRaw=function(t){const e=new I(t,!0);return this.key=e.readVarBytes(),this},R.fromRaw=function(t){return(new R).fromRaw(t)},e.types=H,e.EnvPacket=r,e.EventPacket=s,e.LogPacket=o,e.ErrorPacket=a,e.ErrorResultPacket=h,e.CheckPacket=c,e.CheckResultPacket=u,e.SignPacket=f,e.SignResultPacket=l,e.CheckInputPacket=p,e.CheckInputResultPacket=d,e.SignInputPacket=m,e.SignInputResultPacket=g,e.ECVerifyPacket=y,e.ECVerifyResultPacket=w,e.ECSignPacket=b,e.ECSignResultPacket=v,e.MinePacket=k,e.MineResultPacket=S,e.ScryptPacket=E,e.ScryptResultPacket=R},function(t,e){t.exports=require("util")},function(t,e,i){var n=e;n.utils=i(14),n.common=i(31),n.sha=i(146),n.ripemd=i(150),n.hmac=i(151),n.sha1=n.sha.sha1,n.sha256=n.sha.sha256,n.sha224=n.sha.sha224,n.sha384=n.sha.sha384,n.sha512=n.sha.sha512,n.ripemd160=n.ripemd.ripemd160},function(t,e,i){"use strict";function n(t){if(!(this instanceof n))return new n(t);l.call(this,[]),t&&this.fromOptions(t)}const r=i(0),s=i(1),o=i(8),a=i(27),h=i(3),c=i(2),u=i(4),f=i(11),l=i(40),p=a.types,d=a.typesByVal;Object.setPrototypeOf(n.prototype,l.prototype),n.prototype.fromOptions=function(t){return r(t,"Witness data is required."),Array.isArray(t)?this.fromArray(t):t.items?this.fromArray(t.items):this},n.fromOptions=function(t){return(new n).fromOptions(t)},n.prototype.toArray=function(){return this.items.slice()},n.prototype.fromArray=function(t){return r(Array.isArray(t)),this.items=t,this},n.fromArray=function(t){return(new n).fromArray(t)},n.prototype.toItems=function(){return this.items.slice()},n.prototype.fromItems=function(t){return r(Array.isArray(t)),this.items=t,this},n.fromItems=function(t){return(new n).fromItems(t)},n.prototype.toStack=function(){return new l(this.toArray())},n.prototype.fromStack=function(t){return this.fromArray(t.items)},n.fromStack=function(t){return(new n).fromStack(t)},n.prototype.inspect=function(){return`<Witness: ${this.toString()}>`},n.prototype.clone=function(){return(new n).inject(this)},n.prototype.inject=function(t){return this.items=t.items.slice(),this},n.prototype.compile=function(){return this},n.prototype.getInputType=function(){return this.isPubkeyhashInput()?p.WITNESSPUBKEYHASH:this.isScripthashInput()?p.WITNESSSCRIPTHASH:p.NONSTANDARD},n.prototype.getInputTypeVal=function(){return this.isPubkeyhashInput()?d[p.WITNESSPUBKEYHASH]:this.isScripthashInput()?d[p.WITNESSSCRIPTHASH]:d[p.NONSTANDARD]},n.prototype.getInputAddress=function(){return f.fromWitness(this)},n.prototype.isPubkeyInput=function(){return!1},n.prototype.getPubkeyInput=function(){return null},n.prototype.isPubkeyhashInput=function(){return 2===this.items.length&&a.isSignatureEncoding(this.items[0])&&a.isKeyEncoding(this.items[1])},n.prototype.getPubkeyhashInput=function(){return this.isPubkeyhashInput()?[this.items[0],this.items[1]]:[null,null]},n.prototype.isMultisigInput=function(){return!1},n.prototype.getMultisigInput=function(){return null},n.prototype.isScripthashInput=function(){return this.items.length>0&&!this.isPubkeyhashInput()},n.prototype.getScripthashInput=function(){return this.isScripthashInput()?this.items[this.items.length-1]:null},n.prototype.isUnknownInput=function(){return this.getInputType()===p.NONSTANDARD},n.prototype.test=function(t){for(const e of this.items)if(0!==e.length&&t.test(e))return!0;return!1},n.prototype.getRedeem=function(){if(0===this.items.length)return null;const t=this.items[this.items.length-1];return t?o.fromRaw(t):null},n.prototype.indexOf=function(t){return s.indexOf(this.items,t)},n.prototype.getSize=function(){let t=0;for(const e of this.items)t+=h.sizeVarBytes(e);return t},n.prototype.getVarSize=function(){return h.sizeVarint(this.items.length)+this.getSize()},n.prototype.toWriter=function(t){t.writeVarint(this.items.length);for(const e of this.items)t.writeVarBytes(e);return t},n.prototype.toRaw=function(){const t=this.getVarSize();return this.toWriter(new u(t)).render()},n.prototype.toJSON=function(){return this.toRaw().toString("hex")},n.prototype.fromJSON=function(t){return r("string"==typeof t,"Witness must be a string."),this.fromRaw(Buffer.from(t,"hex"))},n.fromJSON=function(t){return(new n).fromJSON(t)},n.prototype.fromReader=function(t){const e=t.readVarint();for(let i=0;i<e;i++)this.items.push(t.readVarBytes());return this},n.prototype.fromRaw=function(t){return this.fromReader(new c(t))},n.fromReader=function(t){return(new n).fromReader(t)},n.fromRaw=function(t,e){return"string"==typeof t&&(t=Buffer.from(t,e)),(new n).fromRaw(t)},n.prototype.fromString=function(t){if(!Array.isArray(t)){if(r("string"==typeof t),0===(t=t.trim()).length)return this;t=t.split(/\s+/)}for(const e of t)this.items.push(Buffer.from(e,"hex"));return this},n.fromString=function(t){return(new n).fromString(t)},n.isWitness=function(t){return t instanceof n},t.exports=n},function(t,e,i){"use strict";function n(t,e){if(!(this instanceof n))return new n(t,e);this.map=new Map,this.size=0,this.items=0,this.head=null,this.tail=null,this.pending=null,o("number"==typeof t,"Capacity must be a number."),o(t>=0,"Capacity cannot be negative."),o(!e||"function"==typeof e,"Bad size callback."),this.capacity=t,this.getSize=e}function r(t){this.lru=t,this.ops=[]}function s(t,e,i){this.remove=t,this.key=e,this.value=i}const o=i(0);n.prototype._getSize=function(t){if(this.getSize){return 120+Math.floor(1.375*t.key.length)+this.getSize(t.value)}return 1},n.prototype._compact=function(){if(this.size<=this.capacity)return;let t,e;for(t=this.head;t&&!(this.size<=this.capacity);t=e)this.size-=this._getSize(t),this.items--,this.map.delete(t.key),e=t.next,t.prev=null,t.next=null;if(!t)return this.head=null,void(this.tail=null);this.head=t,t.prev=null},n.prototype.reset=function(){let t,e;for(t=this.head;t;t=e)this.map.delete(t.key),this.items--,e=t.next,t.prev=null,t.next=null;o(!t),this.size=0,this.head=null,this.tail=null},n.prototype.set=function(t,e){if(0===this.capacity)return;t=String(t);let i=this.map.get(t);if(i)return this.size-=this._getSize(i),i.value=e,this.size+=this._getSize(i),this._removeList(i),this._appendList(i),void this._compact();i=new function(t,e){this.key=t,this.value=e,this.next=null,this.prev=null}(t,e),this.map.set(t,i),this._appendList(i),this.size+=this._getSize(i),this.items++,this._compact()},n.prototype.get=function(t){if(0===this.capacity)return null;t=String(t);const e=this.map.get(t);return e?(this._removeList(e),this._appendList(e),e.value):null},n.prototype.has=function(t){return 0!==this.capacity&&this.map.has(String(t))},n.prototype.remove=function(t){if(0===this.capacity)return!1;t=String(t);const e=this.map.get(t);return!!e&&(this.size-=this._getSize(e),this.items--,this.map.delete(t),this._removeList(e),!0)},n.prototype._prependList=function(t){this._insertList(null,t)},n.prototype._appendList=function(t){this._insertList(this.tail,t)},n.prototype._insertList=function(t,e){o(!e.next),o(!e.prev),null!=t?(e.next=t.next,e.prev=t,t.next=e,t===this.tail&&(this.tail=e)):this.head?(this.head.prev=e,e.next=this.head,this.head=e):(this.head=e,this.tail=e)},n.prototype._removeList=function(t){t.prev&&(t.prev.next=t.next),t.next&&(t.next.prev=t.prev),t===this.head&&(this.head=t.next),t===this.tail&&(this.tail=t.prev||this.head),this.head||o(!this.tail),this.tail||o(!this.head),t.prev=null,t.next=null},n.prototype.keys=function(){const t=[];for(let e=this.head;e;e=e.next)e===this.head&&o(!e.prev),e.prev||o(e===this.head),e.next||o(e===this.tail),t.push(e.key);return t},n.prototype.values=function(){const t=[];for(let e=this.head;e;e=e.next)t.push(e.value);return t},n.prototype.toArray=function(){const t=[];for(let e=this.head;e;e=e.next)t.push(e);return t},n.prototype.batch=function(){return new r(this)},n.prototype.start=function(){o(!this.pending),this.pending=this.batch()},n.prototype.clear=function(){o(this.pending),this.pending.clear()},n.prototype.drop=function(){o(this.pending),this.pending=null},n.prototype.commit=function(){o(this.pending),this.pending.commit(),this.pending=null},n.prototype.push=function(t,e){o(this.pending),0!==this.capacity&&this.pending.set(t,e)},n.prototype.unpush=function(t){o(this.pending),0!==this.capacity&&this.pending.remove(t)},r.prototype.set=function(t,e){this.ops.push(new s(!1,t,e))},r.prototype.remove=function(t){this.ops.push(new s(!0,t,null))},r.prototype.clear=function(){this.ops.length=0},r.prototype.commit=function(){for(const t of this.ops)t.remove?this.lru.remove(t.key):this.lru.set(t.key,t.value);this.ops.length=0},t.exports=n},function(t,e,i){"use strict";t.exports=i(161)},function(t,e,i){"use strict";function n(t){const e=(t=(t=(t=t.replace(/\\/g,"/")).replace(/(^|\/)\.\//,"$1")).replace(/\/+\.?$/,"")).split(/\/+/);let i="";return"win32"===process.platform&&-1!==e[0].indexOf(":")&&(i=e.shift()+"/"),e.length>0&&0===e[0].length&&(e.shift(),i="/"),[i,e]}const r=i(106),s=i(16);e.access=s.promisify(r.access),e.accessSync=r.accessSync,e.appendFile=s.promisify(r.appendFile),e.appendFileSync=r.appendFileSync,e.chmod=s.promisify(r.chmod),e.chmodSync=r.chmodSync,e.chown=s.promisify(r.chown),e.chownSync=r.chownSync,e.close=s.promisify(r.close),e.closeSync=r.closeSync,e.constants=r.constants,e.createReadStream=r.createReadStream,e.createWriteStream=r.createWriteStream,e.exists=s.promisify(r.exists),e.existsSync=r.existsSync,e.fchmod=s.promisify(r.fchmod),e.fchmodSync=r.fchmodSync,e.fchown=s.promisify(r.fchown),e.fchownSync=r.fchownSync,e.fdatasync=s.promisify(r.fdatasync),e.fdatasyncSync=r.fdatasyncSync,e.fstat=s.promisify(r.fstat),e.fstatSync=r.fstatSync,e.fsync=s.promisify(r.fsync),e.fsyncSync=r.fsyncSync,e.ftruncate=s.promisify(r.ftruncate),e.ftruncateSync=r.ftruncateSync,e.futimes=s.promisify(r.futimes),e.futimesSync=r.futimesSync,e.lchmod=s.promisify(r.lchmod),e.lchmodSync=r.lchmodSync,e.lchown=s.promisify(r.lchown),e.lchownSync=r.lchownSync,e.link=s.promisify(r.link),e.linkSync=r.linkSync,e.lstat=s.promisify(r.lstat),e.lstatSync=r.lstatSync,e.mkdir=s.promisify(r.mkdir),e.mkdirSync=r.mkdirSync,e.mkdtemp=s.promisify(r.mkdtemp),e.mkdtempSync=r.mkdtempSync,e.open=s.promisify(r.open),e.openSync=r.openSync,e.read=s.promisify(r.read),e.readSync=r.readSync,e.readdir=s.promisify(r.readdir),e.readdirSync=r.readdirSync,e.readFile=s.promisify(r.readFile),e.readFileSync=r.readFileSync,e.readlink=s.promisify(r.readlink),e.readlinkSync=r.readlinkSync,e.realpath=s.promisify(r.realpath),e.realpathSync=r.realpathSync,e.rename=s.promisify(r.rename),e.renameSync=r.renameSync,e.rmdir=s.promisify(r.rmdir),e.rmdirSync=r.rmdirSync,e.stat=s.promisify(r.stat),e.statSync=r.statSync,e.symlink=s.promisify(r.symlink),e.symlinkSync=r.symlinkSync,e.truncate=s.promisify(r.truncate),e.truncateSync=r.truncateSync,e.unlink=s.promisify(r.unlink),e.unlinkSync=r.unlinkSync,e.unwatchFile=r.unwatchFile,e.utimes=s.promisify(r.utimes),e.utimesSync=r.utimesSync,e.watch=r.watch,e.watchFile=r.watchFile,e.write=s.promisify(r.write),e.writeSync=r.writeSync,e.writeFile=s.promisify(r.writeFile),e.writeFileSync=r.writeFileSync,e.mkdirpSync=function(t,i){null==i&&(i=488);let[r,s]=n(t);for(const t of s){r+=t;try{if(!e.statSync(r).isDirectory())throw new Error("Could not create directory.")}catch(t){if("ENOENT"!==t.code)throw t;e.mkdirSync(r,i)}r+="/"}},e.mkdirp=async function(t,i){null==i&&(i=488);let[r,s]=n(t);for(const t of s){r+=t;try{if(!(await e.stat(r)).isDirectory())throw new Error("Could not create directory.")}catch(t){if("ENOENT"!==t.code)throw t;await e.mkdir(r,i)}r+="/"}}},function(t,e,i){"use strict";const n=i(96);e.PROTOCOL_VERSION=70015,e.MIN_VERSION=70001,e.HEADERS_VERSION=31800,e.PONG_VERSION=6e4,e.BLOOM_VERSION=70011,e.SENDHEADERS_VERSION=7012,e.COMPACT_VERSION=70014,e.COMPACT_WITNESS_VERSION=70015,e.services={NETWORK:1,GETUTXO:2,BLOOM:4,WITNESS:8},e.LOCAL_SERVICES=0|e.services.NETWORK|e.services.WITNESS,e.REQUIRED_SERVICES=0|e.services.NETWORK,e.USER_AGENT=`/wmcc:${n.version}/`,e.MAX_MESSAGE=4e6,e.BAN_TIME=86400,e.BAN_SCORE=100},function(t,e,i){"use strict";function n(){}function r(t){if(!(this instanceof r))return new r(t);n.call(this),this.version=U.PROTOCOL_VERSION,this.services=U.LOCAL_SERVICES,this.time=H.now(),this.remote=new F,this.local=new F,this.nonce=G.ZERO_U64,this.agent=U.USER_AGENT,this.height=0,this.noRelay=!1,t&&this.fromOptions(t)}function s(){if(!(this instanceof s))return new s;n.call(this)}function o(t){if(!(this instanceof o))return new o(t);n.call(this),this.nonce=t||null}function a(t){if(!(this instanceof a))return new a(t);n.call(this),this.nonce=t||G.ZERO_U64}function h(){if(!(this instanceof h))return new h;n.call(this)}function c(t){if(!(this instanceof c))return new c(t);n.call(this),this.items=t||[]}function u(t){if(!(this instanceof u))return new u(t);n.call(this),this.items=t||[]}function f(t){if(!(this instanceof f))return new f(t);u.call(this,t)}function l(t){if(!(this instanceof l))return new l(t);u.call(this,t)}function p(t,e){if(!(this instanceof p))return new p(t,e);n.call(this),this.version=U.PROTOCOL_VERSION,this.locator=t||[],this.stop=e||null}function d(t,e){if(!(this instanceof d))return new d(t,e);p.call(this,t,e)}function m(t){if(!(this instanceof m))return new m(t);n.call(this),this.items=t||[]}function g(){if(!(this instanceof g))return new g;n.call(this)}function y(t,e){if(!(this instanceof y))return new y(t,e);n.call(this),this.block=t||new j,this.witness=e||!1}function w(t,e){if(!(this instanceof w))return new w(t,e);n.call(this),this.tx=t||new W,this.witness=e||!1}function b(t){if(!(this instanceof b))return new b(t);n.call(this),this.message="",this.code=b.codes.INVALID,this.reason="",this.hash=null,t&&this.fromOptions(t)}function v(){if(!(this instanceof v))return new v;n.call(this)}function k(t){if(!(this instanceof k))return new k(t);n.call(this),this.filter=t||new z}function S(t){if(!(this instanceof S))return new S(t);n.call(this),this.data=t||J}function E(){if(!(this instanceof E))return new E;n.call(this)}function R(t){if(!(this instanceof R))return new R(t);n.call(this),this.block=t||new q}function x(t){if(!(this instanceof x))return new x(t);n.call(this),this.rate=t||0}function _(t,e){if(!(this instanceof _))return new _(t,e);n.call(this),this.mode=t||0,this.version=e||1}function I(t,e){if(!(this instanceof I))return new I(t,e);n.call(this),this.block=t||new D.CompactBlock,this.witness=e||!1}function A(t){if(!(this instanceof A))return new A(t);n.call(this),this.request=t||new D.TXRequest}function O(t,e){if(!(this instanceof O))return new O(t,e);n.call(this),this.response=t||new D.TXResponse,this.witness=e||!1}function B(t,e){if(!(this instanceof B))return new B(t,e);n.call(this),this.publicKey=t||G.ZERO_KEY,this.cipher=e||0}function P(t){if(!(this instanceof P))return new P(t);n.call(this),this.publicKey=t||G.ZERO_KEY}function M(t){if(!(this instanceof M))return new M(t);n.call(this),this.hash=t||G.ZERO_HASH}function N(t){if(!(this instanceof N))return new N(t);n.call(this),this.signature=t||G.ZERO_SIG64}function T(t){if(!(this instanceof T))return new T(t);n.call(this),this.hash=t||G.ZERO_HASH}function C(t,e){if(!(this instanceof C))return new C(t,e);n.call(this),this.cmd=t,this.data=e}const U=i(60),H=i(1),L=i(0),z=i(42),D=i(98),F=i(79),V=i(37),K=i(36),j=i(234),q=i(71),W=i(15),X=i(2),Y=i(4),G=i(3),J=Buffer.alloc(0);e.types={VERSION:0,VERACK:1,PING:2,PONG:3,GETADDR:4,ADDR:5,INV:6,GETDATA:7,NOTFOUND:8,GETBLOCKS:9,GETHEADERS:10,HEADERS:11,SENDHEADERS:12,BLOCK:13,TX:14,REJECT:15,MEMPOOL:16,FILTERLOAD:17,FILTERADD:18,FILTERCLEAR:19,MERKLEBLOCK:20,FEEFILTER:21,SENDCMPCT:22,CMPCTBLOCK:23,GETBLOCKTXN:24,BLOCKTXN:25,ENCINIT:26,ENCACK:27,AUTHCHALLENGE:28,AUTHREPLY:29,AUTHPROPOSE:30,UNKNOWN:31,INTERNAL:100,DATA:101},e.typesByVal=H.reverse(e.types),n.prototype.type=-1,n.prototype.cmd="",n.prototype.getSize=function(){return 0},n.prototype.toWriter=function(t){return t},n.prototype.toRaw=function(){return J},n.prototype.fromReader=function(t){return this},n.prototype.fromRaw=function(t){return this},Object.setPrototypeOf(r.prototype,n.prototype),r.prototype.cmd="version",r.prototype.type=e.types.VERSION,r.prototype.fromOptions=function(t){return null!=t.version&&(this.version=t.version),null!=t.services&&(this.services=t.services),null!=t.time&&(this.time=t.time),t.remote&&this.remote.fromOptions(t.remote),t.local&&this.local.fromOptions(t.local),t.nonce&&(this.nonce=t.nonce),t.agent&&(this.agent=t.agent),null!=t.height&&(this.height=t.height),null!=t.noRelay&&(this.noRelay=t.noRelay),this},r.fromOptions=function(t){return(new r).fromOptions(t)},r.prototype.getSize=function(){let t=0;return t+=20,t+=this.remote.getSize(!1),t+=this.local.getSize(!1),t+=8,t+=G.sizeVarString(this.agent,"ascii"),t+=5},r.prototype.toWriter=function(t){return t.writeI32(this.version),t.writeU32(this.services),t.writeU32(0),t.writeI64(this.time),this.remote.toWriter(t,!1),this.local.toWriter(t,!1),t.writeBytes(this.nonce),t.writeVarString(this.agent,"ascii"),t.writeI32(this.height),t.writeU8(this.noRelay?0:1),t},r.prototype.toRaw=function(){const t=this.getSize();return this.toWriter(new Y(t)).render()},r.prototype.fromReader=function(t){return this.version=t.readI32(),this.services=t.readU32(),t.readU32(),this.time=t.readI64(),this.remote.fromReader(t,!1),t.left()>0&&(this.local.fromReader(t,!1),this.nonce=t.readBytes(8)),t.left()>0&&(this.agent=t.readVarString("ascii",256)),t.left()>0&&(this.height=t.readI32()),t.left()>0&&(this.noRelay=0===t.readU8()),10300===this.version&&(this.version=300),L(this.version>=0,"Version is negative."),L(this.time>=0,"Timestamp is negative."),this.height<0&&(this.height=0),this},r.fromReader=function(t){return(new r).fromReader(t)},r.prototype.fromRaw=function(t){return this.fromReader(new X(t))},r.fromRaw=function(t,e){return"string"==typeof t&&(t=Buffer.from(t,e)),(new r).fromRaw(t,e)},Object.setPrototypeOf(s.prototype,n.prototype),s.prototype.cmd="verack",s.prototype.type=e.types.VERACK,s.fromReader=function(t){return(new s).fromReader(t)},s.fromRaw=function(t,e){return"string"==typeof t&&(t=Buffer.from(t,e)),(new s).fromRaw(t)},Object.setPrototypeOf(o.prototype,n.prototype),o.prototype.cmd="ping",o.prototype.type=e.types.PING,o.prototype.getSize=function(){return this.nonce?8:0},o.prototype.toRaw=function(){const t=this.getSize();return this.toWriter(new Y(t)).render()},o.prototype.toWriter=function(t){return this.nonce&&t.writeBytes(this.nonce),t},o.prototype.fromReader=function(t){return t.left()>=8&&(this.nonce=t.readBytes(8)),this},o.prototype.fromRaw=function(t){return this.fromReader(new X(t))},o.fromReader=function(t){return(new o).fromRaw(t)},o.fromRaw=function(t,e){return"string"==typeof t&&(t=Buffer.from(t,e)),(new o).fromRaw(t)},Object.setPrototypeOf(a.prototype,n.prototype),a.prototype.cmd="pong",a.prototype.type=e.types.PONG,a.prototype.getSize=function(){return 8},a.prototype.toWriter=function(t){return t.writeBytes(this.nonce),t},a.prototype.toRaw=function(){return this.toWriter(new Y(8)).render()},a.prototype.fromReader=function(t){return this.nonce=t.readBytes(8),this},a.prototype.fromRaw=function(t){return this.fromReader(new X(t))},a.fromReader=function(t){return(new a).fromReader(t)},a.fromRaw=function(t,e){return"string"==typeof t&&(t=Buffer.from(t,e)),(new a).fromRaw(t)},Object.setPrototypeOf(h.prototype,n.prototype),h.prototype.cmd="getaddr",h.prototype.type=e.types.GETADDR,h.fromReader=function(t){return(new h).fromReader(t)},h.fromRaw=function(t,e){return"string"==typeof t&&(t=Buffer.from(t,e)),(new h).fromRaw(t)},Object.setPrototypeOf(c.prototype,n.prototype),c.prototype.cmd="addr",c.prototype.type=e.types.ADDR,c.prototype.getSize=function(){let t=0;return t+=G.sizeVarint(this.items.length),t+=30*this.items.length},c.prototype.toWriter=function(t){t.writeVarint(this.items.length);for(const e of this.items)e.toWriter(t,!0);return t},c.prototype.toRaw=function(){const t=this.getSize();return this.toWriter(new Y(t)).render()},c.prototype.fromRaw=function(t){const e=new X(t),i=e.readVarint();for(let t=0;t<i;t++)this.items.push(F.fromReader(e,!0));return this},c.fromReader=function(t){return(new c).fromReader(t)},c.fromRaw=function(t,e){return"string"==typeof t&&(t=Buffer.from(t,e)),(new c).fromRaw(t)},Object.setPrototypeOf(u.prototype,n.prototype),u.prototype.cmd="inv",u.prototype.type=e.types.INV,u.prototype.getSize=function(){let t=0;return t+=G.sizeVarint(this.items.length),t+=36*this.items.length},u.prototype.toWriter=function(t){L(this.items.length<=5e4),t.writeVarint(this.items.length);for(const e of this.items)e.toWriter(t);return t},u.prototype.toRaw=function(){const t=this.getSize();return this.toWriter(new Y(t)).render()},u.prototype.fromReader=function(t){const e=t.readVarint();L(e<=5e4,"Inv item count too high.");for(let i=0;i<e;i++)this.items.push(K.fromReader(t));return this},u.prototype.fromRaw=function(t){return this.fromReader(new X(t))},u.fromReader=function(t){return(new u).fromRaw(t)},u.fromRaw=function(t,e){return"string"==typeof t&&(t=Buffer.from(t,e)),(new u).fromRaw(t)},Object.setPrototypeOf(f.prototype,u.prototype),f.prototype.cmd="getdata",f.prototype.type=e.types.GETDATA,f.fromReader=function(t){return(new f).fromReader(t)},f.fromRaw=function(t,e){return"string"==typeof t&&(t=Buffer.from(t,e)),(new f).fromRaw(t)},Object.setPrototypeOf(l.prototype,u.prototype),l.prototype.cmd="notfound",l.prototype.type=e.types.NOTFOUND,l.fromReader=function(t){return(new l).fromReader(t)},l.fromRaw=function(t,e){return"string"==typeof t&&(t=Buffer.from(t,e)),(new l).fromRaw(t)},Object.setPrototypeOf(p.prototype,n.prototype),p.prototype.cmd="getblocks",p.prototype.type=e.types.GETBLOCKS,p.prototype.getSize=function(){let t=0;return t+=4,t+=G.sizeVarint(this.locator.length),t+=32*this.locator.length,t+=32},p.prototype.toWriter=function(t){L(this.locator.length<=5e4,"Too many block hashes."),t.writeU32(this.version),t.writeVarint(this.locator.length);for(const e of this.locator)t.writeHash(e);return t.writeHash(this.stop||G.ZERO_HASH),t},p.prototype.toRaw=function(){const t=this.getSize();return this.toWriter(new Y(t)).render()},p.prototype.fromReader=function(t){this.version=t.readU32();const e=t.readVarint();L(e<=5e4,"Too many block hashes.");for(let i=0;i<e;i++)this.locator.push(t.readHash("hex"));return this.stop=t.readHash("hex"),this.stop===G.NULL_HASH&&(this.stop=null),this},p.prototype.fromRaw=function(t){return this.fromReader(new X(t))},p.fromRaw=function(t,e){return"string"==typeof t&&(t=Buffer.from(t,e)),(new p).fromRaw(t)},Object.setPrototypeOf(d.prototype,p.prototype),d.prototype.cmd="getheaders",d.prototype.type=e.types.GETHEADERS,d.fromReader=function(t){return(new d).fromReader(t)},d.fromRaw=function(t,e){return"string"==typeof t&&(t=Buffer.from(t,e)),(new d).fromRaw(t)},Object.setPrototypeOf(m.prototype,n.prototype),m.prototype.cmd="headers",m.prototype.type=e.types.HEADERS,m.prototype.getSize=function(){let t=0;t+=G.sizeVarint(this.items.length);for(const e of this.items)t+=e.getSize();return t},m.prototype.toWriter=function(t){L(this.items.length<=2e3,"Too many headers."),t.writeVarint(this.items.length);for(const e of this.items)e.toWriter(t);return t},m.prototype.toRaw=function(){const t=this.getSize();return this.toWriter(new Y(t)).render()},m.prototype.fromReader=function(t){const e=t.readVarint();L(e<=2e3,"Too many headers.");for(let i=0;i<e;i++)this.items.push(V.fromReader(t));return this},m.prototype.fromRaw=function(t){return this.fromReader(new X(t))},m.fromRaw=function(t,e){return"string"==typeof t&&(t=Buffer.from(t,e)),(new m).fromRaw(t)},Object.setPrototypeOf(g.prototype,n.prototype),g.prototype.cmd="sendheaders",g.prototype.type=e.types.SENDHEADERS,g.fromReader=function(t){return(new g).fromReader(t)},g.fromRaw=function(t,e){return"string"==typeof t&&(t=Buffer.from(t,e)),(new g).fromRaw(t)},Object.setPrototypeOf(y.prototype,n.prototype),y.prototype.cmd="block",y.prototype.type=e.types.BLOCK,y.prototype.getSize=function(){return this.witness?this.block.getSize():this.block.getBaseSize()},y.prototype.toWriter=function(t){return this.witness?this.block.toWriter(t):this.block.toNormalWriter(t)},y.prototype.toRaw=function(){return this.witness?this.block.toRaw():this.block.toNormal()},y.prototype.fromReader=function(t){return this.block.fromReader(t),this},y.prototype.fromRaw=function(t){return this.block.fromRaw(t),this},y.fromReader=function(t){return(new y).fromReader(t)},y.fromRaw=function(t,e){return"string"==typeof t&&(t=Buffer.from(t,e)),(new y).fromRaw(t)},Object.setPrototypeOf(w.prototype,n.prototype),w.prototype.cmd="tx",w.prototype.type=e.types.TX,w.prototype.getSize=function(){return this.witness?this.tx.getSize():this.tx.getBaseSize()},w.prototype.toWriter=function(t){return this.witness?this.tx.toWriter(t):this.tx.toNormalWriter(t)},w.prototype.toRaw=function(){return this.witness?this.tx.toRaw():this.tx.toNormal()},w.prototype.fromReader=function(t){return this.tx.fromRaw(t),this},w.prototype.fromRaw=function(t){return this.tx.fromRaw(t),this},w.fromReader=function(t){return(new w).fromReader(t)},w.fromRaw=function(t,e){return"string"==typeof t&&(t=Buffer.from(t,e)),(new w).fromRaw(t)},Object.setPrototypeOf(b.prototype,n.prototype),b.codes={MALFORMED:1,INVALID:16,OBSOLETE:17,DUPLICATE:18,NONSTANDARD:64,DUST:65,INSUFFICIENTFEE:66,CHECKPOINT:67,INTERNAL:256,HIGHFEE:256,ALREADYKNOWN:257,CONFLICT:258},b.codesByVal=H.reverse(b.codes),b.prototype.cmd="reject",b.prototype.type=e.types.REJECT,b.prototype.fromOptions=function(t){let e=t.code;return t.message&&(this.message=t.message),null!=e&&("string"==typeof e&&(e=b.codes[e.toUpperCase()]),e>=b.codes.INTERNAL&&(e=b.codes.INVALID),this.code=e),t.reason&&(this.reason=t.reason),t.hash&&(this.hash=t.hash),this},b.fromOptions=function(t){return(new b).fromOptions(t)},b.prototype.rhash=function(){return this.hash?H.revHex(this.hash):null},b.prototype.getCode=function(){const t=b.codesByVal[this.code];return t?t.toLowerCase():this.code.toString(10)},b.prototype.getSize=function(){let t=0;return t+=G.sizeVarString(this.message,"ascii"),t+=1,t+=G.sizeVarString(this.reason,"ascii"),this.hash&&(t+=32),t},b.prototype.toWriter=function(t){return L(this.message.length<=12),L(this.reason.length<=111),t.writeVarString(this.message,"ascii"),t.writeU8(this.code),t.writeVarString(this.reason,"ascii"),this.hash&&t.writeHash(this.hash),t},b.prototype.toRaw=function(){const t=this.getSize();return this.toWriter(new Y(t)).render()},b.prototype.fromReader=function(t){switch(this.message=t.readVarString("ascii",12),this.code=t.readU8(),this.reason=t.readVarString("ascii",111),this.message){case"block":case"tx":this.hash=t.readHash("hex");break;default:this.hash=null}return this},b.prototype.fromRaw=function(t){return this.fromReader(new X(t))},b.fromReader=function(t){return(new b).fromReader(t)},b.fromRaw=function(t,e){return"string"==typeof t&&(t=Buffer.from(t,e)),(new b).fromRaw(t,e)},b.prototype.fromReason=function(t,e,i,n){return"string"==typeof t&&(t=b.codes[t.toUpperCase()]),t||(t=b.codes.INVALID),t>=b.codes.INTERNAL&&(t=b.codes.INVALID),this.message="",this.code=t,this.reason=e,i&&(L(n),this.message=i,this.hash=n),this},b.fromReason=function(t,e,i,n){return(new b).fromReason(t,e,i,n)},b.fromError=function(t,e){return b.fromReason(t.code,t.reason,e)},b.prototype.inspect=function(){const t=b.codesByVal[this.code]||this.code,e=this.hash?H.revHex(this.hash):null;return"<Reject:"+` msg=${this.message}`+` code=${t}`+` reason=${this.reason}`+` hash=${e}`+">"},Object.setPrototypeOf(v.prototype,n.prototype),v.prototype.cmd="mempool",v.prototype.type=e.types.MEMPOOL,v.fromReader=function(t){return(new v).fromReader(t)},v.fromRaw=function(t,e){return"string"==typeof t&&(t=Buffer.from(t,e)),(new v).fromRaw(t)},Object.setPrototypeOf(k.prototype,n.prototype),k.prototype.cmd="filterload",k.prototype.type=e.types.FILTERLOAD,k.prototype.getSize=function(){return this.filter.getSize()},k.prototype.toWriter=function(t){return this.filter.toWriter(t)},k.prototype.toRaw=function(){return this.filter.toRaw()},k.prototype.fromReader=function(t){return this.filter.fromReader(t),this},k.prototype.fromRaw=function(t){return this.filter.fromRaw(t),this},k.fromReader=function(t){return(new k).fromReader(t)},k.fromRaw=function(t,e){return"string"==typeof t&&(t=Buffer.from(t,e)),(new k).fromRaw(t)},k.prototype.isWithinConstraints=function(){return this.filter.isWithinConstraints()},Object.setPrototypeOf(S.prototype,n.prototype),S.prototype.cmd="filteradd",S.prototype.type=e.types.FILTERADD,S.prototype.getSize=function(){return G.sizeVarBytes(this.data)},S.prototype.toWriter=function(t){return t.writeVarBytes(this.data),t},S.prototype.toRaw=function(){const t=this.getSize();return this.toWriter(new Y(t)).render()},S.prototype.fromReader=function(t){return this.data=t.readVarBytes(),this},S.prototype.fromRaw=function(t){return this.fromReader(new X(t))},S.fromRaw=function(t,e){return"string"==typeof t&&(t=Buffer.from(t,e)),(new S).fromRaw(t)},Object.setPrototypeOf(E.prototype,n.prototype),E.prototype.cmd="filterclear",E.prototype.type=e.types.FILTERCLEAR,E.fromRaw=function(t,e){return"string"==typeof t&&(t=Buffer.from(t,e)),(new E).fromRaw(t)},Object.setPrototypeOf(R.prototype,n.prototype),R.prototype.cmd="merkleblock",R.prototype.type=e.types.MERKLEBLOCK,R.prototype.getSize=function(){return this.block.getSize()},R.prototype.toWriter=function(t){return this.block.toWriter(t)},R.prototype.toRaw=function(){return this.block.toRaw()},R.prototype.fromReader=function(t){return this.block.fromReader(t),this},R.prototype.fromRaw=function(t){return this.block.fromRaw(t),this},R.fromRaw=function(t,e){return"string"==typeof t&&(t=Buffer.from(t,e)),(new R).fromRaw(t)},Object.setPrototypeOf(x.prototype,n.prototype),x.prototype.cmd="feefilter",x.prototype.type=e.types.FEEFILTER,x.prototype.getSize=function(){return 8},x.prototype.toWriter=function(t){return t.writeI64(this.rate),t},x.prototype.toRaw=function(){return this.toWriter(new Y(8)).render()},x.prototype.fromReader=function(t){return this.rate=t.readI64(),this},x.prototype.fromRaw=function(t){return this.fromReader(new X(t))},x.fromReader=function(t){return(new x).fromReader(t)},x.fromRaw=function(t,e){return"string"==typeof t&&(t=Buffer.from(t,e)),(new x).fromRaw(t)},Object.setPrototypeOf(_.prototype,n.prototype),_.prototype.cmd="sendcmpct",_.prototype.type=e.types.SENDCMPCT,_.prototype.getSize=function(){return 9},_.prototype.toWriter=function(t){return t.writeU8(this.mode),t.writeU64(this.version),t},_.prototype.toRaw=function(){return this.toWriter(new Y(9)).render()},_.prototype.fromReader=function(t){return this.mode=t.readU8(),this.version=t.readU64(),this},_.prototype.fromRaw=function(t){return this.fromReader(new X(t))},_.fromReader=function(t){return(new _).fromReader(t)},_.fromReader=function(t){return(new _).fromReader(t)},_.fromRaw=function(t,e){return"string"==typeof t&&(t=Buffer.from(t,e)),(new _).fromRaw(t)},Object.setPrototypeOf(I.prototype,n.prototype),I.prototype.cmd="cmpctblock",I.prototype.type=e.types.CMPCTBLOCK,I.prototype.getSize=function(){return this.witness?this.block.getSize(!0):this.block.getSize(!1)},I.prototype.toWriter=function(t){return this.witness?this.block.toWriter(t):this.block.toNormalWriter(t)},I.prototype.toRaw=function(){return this.witness?this.block.toRaw():this.block.toNormal()},I.prototype.fromReader=function(t){return this.block.fromReader(t),this},I.prototype.fromRaw=function(t){return this.block.fromRaw(t),this},I.fromReader=function(t){return(new I).fromRaw(t)},I.fromRaw=function(t,e){return"string"==typeof t&&(t=Buffer.from(t,e)),(new I).fromRaw(t)},Object.setPrototypeOf(A.prototype,n.prototype),A.prototype.cmd="getblocktxn",A.prototype.type=e.types.GETBLOCKTXN,A.prototype.getSize=function(){return this.request.getSize()},A.prototype.toWriter=function(t){return this.request.toWriter(t)},A.prototype.toRaw=function(){return this.request.toRaw()},A.prototype.fromReader=function(t){return this.request.fromReader(t),this},A.prototype.fromRaw=function(t){return this.request.fromRaw(t),this},A.fromReader=function(t){return(new A).fromReader(t)},A.fromRaw=function(t,e){return"string"==typeof t&&(t=Buffer.from(t,e)),(new A).fromRaw(t)},Object.setPrototypeOf(O.prototype,n.prototype),O.prototype.cmd="blocktxn",O.prototype.type=e.types.BLOCKTXN,O.prototype.getSize=function(){return this.witness?this.response.getSize(!0):this.response.getSize(!1)},O.prototype.toWriter=function(t){return this.witness?this.response.toWriter(t):this.response.toNormalWriter(t)},O.prototype.toRaw=function(){return this.witness?this.response.toRaw():this.response.toNormal()},O.prototype.fromReader=function(t){return this.response.fromReader(t),this},O.prototype.fromRaw=function(t){return this.response.fromRaw(t),this},O.fromReader=function(t){return(new O).fromReader(t)},O.fromRaw=function(t,e){return"string"==typeof t&&(t=Buffer.from(t,e)),(new O).fromRaw(t)},Object.setPrototypeOf(B.prototype,n.prototype),B.prototype.cmd="encinit",B.prototype.type=e.types.ENCINIT,B.prototype.getSize=function(){return 34},B.prototype.toWriter=function(t){return t.writeBytes(this.publicKey),t.writeU8(this.cipher),t},B.prototype.toRaw=function(){return this.toWriter(new Y(34)).render()},B.prototype.fromReader=function(t){return this.publicKey=t.readBytes(33),this.cipher=t.readU8(),this},B.prototype.fromRaw=function(t){return this.fromReader(new X(t))},B.fromReader=function(t){return(new B).fromReader(t)},B.fromRaw=function(t,e){return"string"==typeof t&&(t=Buffer.from(t,e)),(new B).fromRaw(t)},Object.setPrototypeOf(P.prototype,n.prototype),P.prototype.cmd="encack",P.prototype.type=e.types.ENCACK,P.prototype.getSize=function(){return 33},P.prototype.toWriter=function(t){return t.writeBytes(this.publicKey),t},P.prototype.toRaw=function(){return this.publicKey},P.prototype.fromReader=function(t){return this.publicKey=t.readBytes(33),this},P.prototype.fromRaw=function(t){return this.fromReader(new X(t))},P.fromReader=function(t){return(new P).fromReader(t)},P.fromRaw=function(t,e){return"string"==typeof t&&(t=Buffer.from(t,e)),(new P).fromRaw(t)},Object.setPrototypeOf(M.prototype,n.prototype),M.prototype.cmd="authchallenge",M.prototype.type=e.types.AUTHCHALLENGE,P.prototype.getSize=function(){return 32},M.prototype.toWriter=function(t){return t.writeBytes(this.hash),t},M.prototype.toRaw=function(){return this.hash},M.prototype.fromReader=function(t){return this.hash=t.readHash(),this},M.prototype.fromRaw=function(t){return this.fromReader(new X(t))},M.fromReader=function(t){return(new M).fromReader(t)},M.fromRaw=function(t,e){return"string"==typeof t&&(t=Buffer.from(t,e)),(new M).fromRaw(t)},Object.setPrototypeOf(N.prototype,n.prototype),N.prototype.cmd="authreply",N.prototype.type=e.types.AUTHREPLY,N.prototype.getSize=function(){return 64},N.prototype.toWriter=function(t){return t.writeBytes(this.signature),t},N.prototype.toRaw=function(){return this.signature},N.prototype.fromReader=function(t){return this.signature=t.readBytes(64),this},N.prototype.fromRaw=function(t){return this.fromReader(new X(t))},N.fromReader=function(t){return(new N).fromReader(t)},N.fromRaw=function(t,e){return"string"==typeof t&&(t=Buffer.from(t,e)),(new N).fromRaw(t)},Object.setPrototypeOf(T.prototype,n.prototype),T.prototype.cmd="authpropose",T.prototype.type=e.types.AUTHPROPOSE,T.prototype.getSize=function(){return 32},T.prototype.toWriter=function(t){return t.writeBytes(this.hash),t},T.prototype.toRaw=function(){return this.hash},T.prototype.fromReader=function(t){return this.hash=t.readHash(),this},T.prototype.fromRaw=function(t){return this.fromReader(new X(t))},T.fromReader=function(t){return(new T).fromReader(t)},T.fromRaw=function(t,e){return"string"==typeof t&&(t=Buffer.from(t,e)),(new T).fromRaw(t)},Object.setPrototypeOf(C.prototype,n.prototype),C.prototype.type=e.types.UNKNOWN,C.prototype.getSize=function(){return this.data.length},C.prototype.toWriter=function(t){return t.writeBytes(this.data),t},C.prototype.toRaw=function(){return this.data},C.prototype.fromRaw=function(t,e){return L(Buffer.isBuffer(e)),this.cmd=t,this.data=e,this},C.fromRaw=function(t,e,i){return"string"==typeof e&&(e=Buffer.from(e,i)),(new C).fromRaw(t,e)},e.fromRaw=function(t,e){switch(t){case"version":return r.fromRaw(e);case"verack":return s.fromRaw(e);case"ping":return o.fromRaw(e);case"pong":return a.fromRaw(e);case"getaddr":return h.fromRaw(e);case"addr":return c.fromRaw(e);case"inv":return u.fromRaw(e);case"getdata":return f.fromRaw(e);case"notfound":return l.fromRaw(e);case"getblocks":return p.fromRaw(e);case"getheaders":return d.fromRaw(e);case"headers":return m.fromRaw(e);case"sendheaders":return g.fromRaw(e);case"block":return y.fromRaw(e);case"tx":return w.fromRaw(e);case"reject":return b.fromRaw(e);case"mempool":return v.fromRaw(e);case"filterload":return k.fromRaw(e);case"filteradd":return S.fromRaw(e);case"filterclear":return E.fromRaw(e);case"merkleblock":return R.fromRaw(e);case"feefilter":return x.fromRaw(e);case"sendcmpct":return _.fromRaw(e);case"cmpctblock":return I.fromRaw(e);case"getblocktxn":return A.fromRaw(e);case"blocktxn":return O.fromRaw(e);case"encinit":return B.fromRaw(e);case"encack":return P.fromRaw(e);case"authchallenge":return M.fromRaw(e);case"authreply":return N.fromRaw(e);case"authpropose":return T.fromRaw(e);default:return C.fromRaw(t,e)}},e.Packet=n,e.VersionPacket=r,e.VerackPacket=s,e.PingPacket=o,e.PongPacket=a,e.GetAddrPacket=h,e.AddrPacket=c,e.InvPacket=u,e.GetDataPacket=f,e.NotFoundPacket=l,e.GetBlocksPacket=p,e.GetHeadersPacket=d,e.HeadersPacket=m,e.SendHeadersPacket=g,e.BlockPacket=y,e.TXPacket=w,e.RejectPacket=b,e.MempoolPacket=v,e.FilterLoadPacket=k,e.FilterAddPacket=S,e.FilterClearPacket=E,e.MerkleBlockPacket=R,e.FeeFilterPacket=x,e.SendCmpctPacket=_,e.CmpctBlockPacket=I,e.GetBlockTxnPacket=A,e.BlockTxnPacket=O,e.EncinitPacket=B,e.EncackPacket=P,e.AuthChallengePacket=M,e.AuthReplyPacket=N,e.AuthProposePacket=T,e.UnknownPacket=C},function(t,e,i){"use strict";const n=e;n.isName=function(t){if("string"!=typeof t)return!1;if(0===t.length)return!1;if(!/^[\-\._0-9A-Za-z ]+$/.test(t))return!1;if(/[ ]{2,}/.test(t))return!1;switch(t[0]){case"_":case"-":case".":return!1}switch(t[t.length-1]){case"_":case"-":case".":return!1}return t.length>=1&&t.length<=40},n.sortTX=function(t){return t.sort((t,e)=>t.mtime-e.mtime)},n.sortCoins=function(t){return t.sort((t,e)=>(t=-1===t.height?2147483647:t.height,e=-1===e.height?2147483647:e.height,t-e))},n.sortDeps=function(t){const e=new Map;for(const i of t){const t=i.hash("hex");e.set(t,i)}const i=new Map,n=new Map,r=[];for(const[t,s]of e){n.set(t,0);let o=!1;for(const r of s.inputs){const a=r.prevout.hash;if(!e.has(a))continue;const h=n.get(t);n.set(t,h+1),o=!0,i.has(a)||i.set(a,[]),i.get(a).push(s)}o||r.push(s)}const s=[];for(const t of r){const e=t.hash("hex"),o=i.get(e);if(s.push(t),o)for(const t of o){const e=t.hash("hex");let i=n.get(e);0==--i&&r.push(t),n.set(e,i)}}return s}},function(t,e,i){"use strict";function n(){if(!(this instanceof n))return new n;this.ops=[],this.offset=0}function r(t,e,i,n){this.type=t,this.value=e,this.enc=i,this.size=n}const s=i(0),o=i(3),a=i(5);n.prototype.render=function(){const t=Buffer.allocUnsafe(this.offset);let e=0;for(const i of this.ops)switch(i.type){case 0:e+=i.value;break;case 1:e=t.writeUInt8(i.value,e,!0);break;case 2:e=t.writeUInt16LE(i.value,e,!0);break;case 3:e=t.writeUInt16BE(i.value,e,!0);break;case 4:e=t.writeUInt32LE(i.value,e,!0);break;case 5:e=t.writeUInt32BE(i.value,e,!0);break;case 6:e=o.writeU64(t,i.value,e);break;case 7:e=o.writeU64BE(t,i.value,e);break;case 8:e=o.writeU64N(t,i.value,e);break;case 9:e=o.writeU64BEN(t,i.value,e);break;case 10:e=t.writeInt8(i.value,e,!0);break;case 11:e=t.writeInt16LE(i.value,e,!0);break;case 12:e=t.writeInt16BE(i.value,e,!0);break;case 13:e=t.writeInt32LE(i.value,e,!0);break;case 14:e=t.writeInt32BE(i.value,e,!0);break;case 15:e=o.writeI64(t,i.value,e);break;case 16:e=o.writeI64BE(t,i.value,e);break;case 17:e=o.writeI64N(t,i.value,e);break;case 18:e=o.writeI64BEN(t,i.value,e);break;case 19:e=t.writeFloatLE(i.value,e,!0);break;case 20:e=t.writeFloatBE(i.value,e,!0);break;case 21:e=t.writeDoubleLE(i.value,e,!0);break;case 22:e=t.writeDoubleBE(i.value,e,!0);break;case 23:e=o.writeVarint(t,i.value,e);break;case 24:e=o.writeVarintN(t,i.value,e);break;case 25:e=o.writeVarint2(t,i.value,e);break;case 26:e=o.writeVarint2N(t,i.value,e);break;case 27:e+=i.value.copy(t,e);break;case 28:e+=t.write(i.value,e,i.enc);break;case 29:e+=a.hash256(t.slice(0,e)).copy(t,e,0,4);break;case 30:t.fill(i.value,e,e+i.size),e+=i.size;break;default:s(!1,"Bad type.")}return s(e===t.length),this.destroy(),t},n.prototype.getSize=function(){return this.offset},n.prototype.seek=function(t){this.offset+=t,this.ops.push(new r(0,t))},n.prototype.destroy=function(){this.ops.length=0,this.offset=0},n.prototype.writeU8=function(t){this.offset+=1,this.ops.push(new r(1,t))},n.prototype.writeU16=function(t){this.offset+=2,this.ops.push(new r(2,t))},n.prototype.writeU16BE=function(t){this.offset+=2,this.ops.push(new r(3,t))},n.prototype.writeU32=function(t){this.offset+=4,this.ops.push(new r(4,t))},n.prototype.writeU32BE=function(t){this.offset+=4,this.ops.push(new r(5,t))},n.prototype.writeU64=function(t){this.offset+=8,this.ops.push(new r(6,t))},n.prototype.writeU64BE=function(t){this.offset+=8,this.ops.push(new r(7,t))},n.prototype.writeU64N=function(t){this.offset+=8,this.ops.push(new r(8,t))},n.prototype.writeU64BEN=function(t){this.offset+=8,this.ops.push(new r(9,t))},n.prototype.writeI8=function(t){this.offset+=1,this.ops.push(new r(10,t))},n.prototype.writeI16=function(t){this.offset+=2,this.ops.push(new r(11,t))},n.prototype.writeI16BE=function(t){this.offset+=2,this.ops.push(new r(12,t))},n.prototype.writeI32=function(t){this.offset+=4,this.ops.push(new r(13,t))},n.prototype.writeI32BE=function(t){this.offset+=4,this.ops.push(new r(14,t))},n.prototype.writeI64=function(t){this.offset+=8,this.ops.push(new r(15,t))},n.prototype.writeI64BE=function(t){this.offset+=8,this.ops.push(new r(16,t))},n.prototype.writeI64N=function(t){this.offset+=8,this.ops.push(new r(17,t))},n.prototype.writeI64BEN=function(t){this.offset+=8,this.ops.push(new r(18,t))},n.prototype.writeFloat=function(t){this.offset+=4,this.ops.push(new r(19,t))},n.prototype.writeFloatBE=function(t){this.offset+=4,this.ops.push(new r(20,t))},n.prototype.writeDouble=function(t){this.offset+=8,this.ops.push(new r(21,t))},n.prototype.writeDoubleBE=function(t){this.offset+=8,this.ops.push(new r(22,t))},n.prototype.writeVarint=function(t){this.offset+=o.sizeVarint(t),this.ops.push(new r(23,t))},n.prototype.writeVarintN=function(t){this.offset+=o.sizeVarintN(t),this.ops.push(new r(24,t))},n.prototype.writeVarint2=function(t){this.offset+=o.sizeVarint2(t),this.ops.push(new r(25,t))},n.prototype.writeVarint2N=function(t){this.offset+=o.sizeVarint2N(t),this.ops.push(new r(26,t))},n.prototype.writeBytes=function(t){0!==t.length&&(this.offset+=t.length,this.ops.push(new r(27,t)))},n.prototype.writeVarBytes=function(t){this.offset+=o.sizeVarint(t.length),this.ops.push(new r(23,t.length)),0!==t.length&&(this.offset+=t.length,this.ops.push(new r(27,t)))},n.prototype.copy=function(t,e,i){s(i>=e),t=t.slice(e,i),this.writeBytes(t)},n.prototype.writeString=function(t,e){0!==t.length&&(this.offset+=Buffer.byteLength(t,e),this.ops.push(new r(28,t,e)))},n.prototype.writeHash=function(t){if("string"!=typeof t)return s(32===t.length),void this.writeBytes(t);s(64===t.length),this.writeString(t,"hex")},n.prototype.writeVarString=function(t,e){if(0===t.length)return void this.ops.push(new r(23,0));const i=Buffer.byteLength(t,e);this.offset+=o.sizeVarint(i),this.offset+=i,this.ops.push(new r(23,i)),this.ops.push(new r(28,t,e))},n.prototype.writeNullString=function(t,e){this.writeString(t,e),this.writeU8(0)},n.prototype.writeChecksum=function(){this.offset+=4,this.ops.push(new r(29))},n.prototype.fill=function(t,e){s(e>=0),0!==e&&(this.offset+=e,this.ops.push(new r(30,t,null,e)))},t.exports=n},function(t,e){t.exports=function(t){return t.webpackPolyfill||(t.deprecate=function(){},t.paths=[],t.children||(t.children=[]),Object.defineProperty(t,"loaded",{enumerable:!0,get:function(){return t.l}}),Object.defineProperty(t,"id",{enumerable:!0,get:function(){return t.i}}),t.webpackPolyfill=1),t}},function(t,e){t.exports=require("buffer")},function(t,e,i){"use strict";const n=i(5);e.createTree=function(t){const e=t;let i=t.length,r=!1,s=0;if(0===i)return e.push(Buffer.alloc(32)),[e,r];for(;i>1;){for(let t=0;t<i;t+=2){const o=Math.min(t+1,i-1),a=e[s+t],h=e[s+o];o===t+1&&o+1===i&&a.equals(h)&&(r=!0);const c=n.root256(a,h);e.push(c)}s+=i,i+=1,i>>>=1}return[e,r]},e.createRoot=function(t){const[i,n]=e.createTree(t);return[i[i.length-1],n]},e.createBranch=function(t,i){let n=i.length;const[r]=e.createTree(i),s=[];let o=0;for(;n>1;){const e=Math.min(1^t,n-1);s.push(r[o+e]),t>>>=1,o+=n,n+=1,n>>>=1}return s},e.deriveRoot=function(t,e,i){let r=t;for(const t of e)r=1&i?n.root256(t,r):n.root256(r,t),i>>>=1;return r}},function(t,e,i){"use strict";function n(t,e){if(t instanceof n)return t;this._importDER(t,e)||(c(t.r&&t.s,"Signature without r or s"),this.r=new a(t.r,16),this.s=new a(t.s,16),void 0===t.recoveryParam?this.recoveryParam=null:this.recoveryParam=t.recoveryParam)}function r(t,e){var i=t[e.place++];if(!(128&i))return i;for(var n=15&i,r=0,s=0,o=e.place;s<n;s++,o++)r<<=8,r|=t[o];return e.place=o,r}function s(t){for(var e=0,i=t.length-1;!t[e]&&!(128&t[e+1])&&e<i;)e++;return 0===e?t:t.slice(e)}function o(t,e){if(e<128)t.push(e);else{var i=1+(Math.log(e)/Math.LN2>>>3);for(t.push(128|i);--i;)t.push(e>>>(i<<3)&255);t.push(e)}}var a=i(17),h=i(9).utils,c=h.assert;t.exports=n,n.prototype._importDER=function(t,e){t=h.toArray(t,e);var i=new function(){this.place=0};if(48!==t[i.place++])return!1;if(r(t,i)+i.place!==t.length)return!1;if(2!==t[i.place++])return!1;var n=r(t,i),s=t.slice(i.place,n+i.place);if(i.place+=n,2!==t[i.place++])return!1;var o=r(t,i);if(t.length!==o+i.place)return!1;var c=t.slice(i.place,o+i.place);return 0===s[0]&&128&s[1]&&(s=s.slice(1)),0===c[0]&&128&c[1]&&(c=c.slice(1)),this.r=new a(s),this.s=new a(c),this.recoveryParam=null,!0},n.prototype.toDER=function(t){var e=this.r.toArray(),i=this.s.toArray();for(128&e[0]&&(e=[0].concat(e)),128&i[0]&&(i=[0].concat(i)),e=s(e),i=s(i);!(i[0]||128&i[1]);)i=i.slice(1);var n=[2];o(n,e.length),(n=n.concat(e)).push(2),o(n,i.length);var r=n.concat(i),a=[48];return o(a,r.length),a=a.concat(r),h.encode(a,t)}},function(t,e,i){"use strict";function n(t,e){const i=t.length-t.length%4;let n,a=e;for(let e=0;e<i;e+=4)a=s(r(a=o(a^=n=r(n=o(n=r(n=t[e+3]<<24|t[e+2]<<16|t[e+1]<<8|t[e],3432918353),15),461845907),13),5),3864292196);switch(n=0,3&t.length){case 3:n^=t[i+2]<<16;case 2:n^=t[i+1]<<8;case 1:a^=n=r(n=o(n=r(n^=t[i+0],3432918353),15),461845907)}return a^=t.length,a^=a>>>16,a=r(a,2246822507),a^=a>>>13,a=r(a,3266489909),(a^=a>>>16)<0&&(a+=4294967296),a}function r(t,e){const i=65535&t,n=65535&e;let r=i*n,s=(t>>>16)*n+(e>>>16)*i&65535,o=(s+=r>>>16)<<16|(r&=65535);return o<0&&(o+=4294967296),o}function s(t,e){let i=t+e&4294967295;return i<0&&(i+=4294967296),i}function o(t,e){return t<<e|t>>>32-e}const a=i(18).binding;a&&(n=a.murmur3),(e=n).murmur3=n,e.mul32=r,e.sum32=s,e.rotl32=o,t.exports=e},function(t,e,i){"use strict";function n(){if(!(this instanceof n))return new n;this.version=1,this.prevBlock=c.NULL_HASH,this.merkleRoot=c.NULL_HASH,this.time=0,this.bits=0,this.nonce=0,this.mutable=!1,this._hash=null,this._hhash=null}const r=i(0),s=i(1),o=(i(5),i(2)),a=i(4),h=i(36),c=i(3),u=i(7),f=i(44),l=i(58);n.prototype.parseOptions=function(t){return r(t,"Block data is required."),r(s.isU32(t.version)),r("string"==typeof t.prevBlock),r("string"==typeof t.merkleRoot),r(s.isU32(t.time)),r(s.isU32(t.bits)),r(s.isU32(t.nonce)),this.version=t.version,this.prevBlock=t.prevBlock,this.merkleRoot=t.merkleRoot,this.time=t.time,this.bits=t.bits,this.nonce=t.nonce,null!=t.mutable&&(this.mutable=Boolean(t.mutable)),this},n.prototype.parseJSON=function(t){return r(t,"Block data is required."),r(s.isU32(t.version)),r("string"==typeof t.prevBlock),r("string"==typeof t.merkleRoot),r(s.isU32(t.time)),r(s.isU32(t.bits)),r(s.isU32(t.nonce)),this.version=t.version,this.prevBlock=s.revHex(t.prevBlock),this.merkleRoot=s.revHex(t.merkleRoot),this.time=t.time,this.bits=t.bits,this.nonce=t.nonce,this},n.prototype.isMemory=function(){return!1},n.prototype._refresh=function(){this._hash=null,this._hhash=null},n.prototype.refresh=function(){return this._refresh()},n.prototype.powHash=function(){const t=this.toHead();return f.derive(t,t,1024,1,1,32)},n.prototype.hash=function(t){let e=this._hash;if(e||(e=l.digest(this.toHead()),this.mutable||(this._hash=e)),"hex"===t){let t=this._hhash;t||(t=e.toString("hex"),this.mutable||(this._hhash=t)),e=t}return e},n.prototype.toHead=function(){return this.writeHead(new a(80)).render()},n.prototype.fromHead=function(t){return this.readHead(new o(t))},n.prototype.writeHead=function(t){return t.writeU32(this.version),t.writeHash(this.prevBlock),t.writeHash(this.merkleRoot),t.writeU32(this.time),t.writeU32(this.bits),t.writeU32(this.nonce),t},n.prototype.readHead=function(t){return this.version=t.readU32(),this.prevBlock=t.readHash("hex"),this.merkleRoot=t.readHash("hex"),this.time=t.readU32(),this.bits=t.readU32(),this.nonce=t.readU32(),this},n.prototype.verify=function(){return!!this.verifyPOW()&&!!this.verifyBody()},n.prototype.verifyPOW=function(){return u.verifyPOW(this.hash(),this.bits)},n.prototype.verifyBody=function(){throw new Error("Abstract method.")},n.prototype.rhash=function(){return s.revHex(this.hash("hex"))},n.prototype.toInv=function(){return new h(h.types.BLOCK,this.hash("hex"))},t.exports=n},function(t,e,i){"use strict";const n=i(24),r=i(16);e.derive=function(t,e,i,r,s){return n.pbkdf2Sync(t,e,i,r,s)},e.deriveAsync=function(t,e,i,s,o){return new Promise((a,h)=>{n.pbkdf2(t,e,i,s,o,r.wrap(a,h))})}},function(t,e,i){"use strict";function n(t){if(!(this instanceof n))return new n(t);l.call(this),this.txs=[],this.hashes=[],this.flags=d,this.totalTX=0,this._tree=null,t&&this.fromOptions(t)}function r(t,e,i,n){this.root=t?t.toString("hex"):c.NULL_HASH,this.matches=e||[],this.indexes=i||[],this.map=n||new Map}const s=i(0),o=i(1),a=i(2),h=i(4),c=i(3),u=i(5),f=i(7),l=i(69),p=i(37),d=Buffer.from([0]);Object.setPrototypeOf(n.prototype,l.prototype),n.prototype.fromOptions=function(t){if(this.parseOptions(t),s(t,"MerkleBlock data is required."),s(Array.isArray(t.hashes)),s(Buffer.isBuffer(t.flags)),s(o.isU32(t.totalTX)),t.hashes)for(let e of t.hashes)"string"==typeof e&&(e=Buffer.from(e,"hex")),s(Buffer.isBuffer(e)),this.hashes.push(e);return t.flags&&(s(Buffer.isBuffer(t.flags)),this.flags=t.flags),null!=t.totalTX&&(s(o.isU32(t.totalTX)),this.totalTX=t.totalTX),this},n.fromOptions=function(t){return(new n).fromOptions(t)},n.prototype.refresh=function(t){if(this._refresh(),this._tree=null,t)for(const t of this.txs)t.refresh()},n.prototype.hasTX=function(t){return-1!==this.indexOf(t)},n.prototype.indexOf=function(t){const e=this.getTree().map.get(t);return null==e?-1:e},n.prototype.verifyBody=function(){const[t]=this.checkBody();return t},n.prototype.checkBody=function(){return this.getTree().root!==this.merkleRoot?[!1,"bad-txnmrklroot",100]:[!0,"valid",0]},n.prototype.getTree=function(){if(!this._tree)try{this._tree=this.extractTree()}catch(t){this._tree=new r}return this._tree},n.prototype.extractTree=function(){const t=[],e=[],i=new Map,n=this.hashes,s=this.flags,o=this.totalTX;let a=0,h=0,l=!1,p=0;const d=t=>o+(1<<t)-1>>>t,m=(r,o)=>{if(a>=8*s.length)return l=!0,c.ZERO_HASH;const f=s[a/8|0]>>>a%8&1;if(a++,0===r||!f){if(h>=n.length)return l=!0,c.ZERO_HASH;const s=n[h++];if(0===r&&f){const n=s.toString("hex");t.push(s),e.push(o),i.set(n,o)}return s}const p=m(r-1,2*o);let g;return 2*o+1<d(r-1)?(g=m(r-1,2*o+1)).equals(p)&&(l=!0):g=p,u.root256(p,g)};if(0===o)throw new Error("Zero transactions.");if(o>f.MAX_BLOCK_SIZE/60)throw new Error("Too many transactions.");if(n.length>o)throw new Error("Too many hashes.");if(8*s.length<n.length)throw new Error("Flags too small.");for(;d(p)>1;)p++;const g=m(p,0);if(l)throw new Error("Mutated merkle tree.");if(((a+7)/8|0)!==s.length)throw new Error("Too many flag bits.");if(h!==n.length)throw new Error("Incorrect number of hashes.");return new r(g,t,e,i)},n.prototype.getCoinbaseHeight=function(){return-1},n.prototype.inspect=function(){return this.format()},n.prototype.format=function(t,e){return{hash:this.rhash(),height:null!=e?e:-1,date:o.date(this.time),version:o.hex32(this.version),prevBlock:o.revHex(this.prevBlock),merkleRoot:o.revHex(this.merkleRoot),time:this.time,bits:this.bits,nonce:this.nonce,totalTX:this.totalTX,hashes:this.hashes.map(t=>t.toString("hex")),flags:this.flags,map:this.getTree().map,txs:this.txs.length}},n.prototype.getSize=function(){let t=0;return t+=80,t+=4,t+=c.sizeVarint(this.hashes.length),t+=32*this.hashes.length,t+=c.sizeVarint(this.flags.length),t+=this.flags.length},n.prototype.toWriter=function(t){this.writeHead(t),t.writeU32(this.totalTX),t.writeVarint(this.hashes.length);for(const e of this.hashes)t.writeHash(e);return t.writeVarBytes(this.flags),t},n.prototype.toRaw=function(){const t=this.getSize();return this.toWriter(new h(t)).render()},n.prototype.fromReader=function(t){this.readHead(t),this.totalTX=t.readU32();const e=t.readVarint();for(let i=0;i<e;i++)this.hashes.push(t.readHash());return this.flags=t.readVarBytes(),this},n.prototype.fromRaw=function(t){return this.fromReader(new a(t))},n.fromReader=function(t){return(new n).fromReader(t)},n.fromRaw=function(t,e){return"string"==typeof t&&(t=Buffer.from(t,e)),(new n).fromRaw(t)},n.prototype.toJSON=function(){return this.getJSON()},n.prototype.getJSON=function(t,e,i){return{hash:this.rhash(),height:i,version:this.version,prevBlock:o.revHex(this.prevBlock),merkleRoot:o.revHex(this.merkleRoot),time:this.time,bits:this.bits,nonce:this.nonce,totalTX:this.totalTX,hashes:this.hashes.map(t=>o.revHex(t.toString("hex"))),flags:this.flags.toString("hex")}},n.prototype.fromJSON=function(t){s(t,"MerkleBlock data is required."),s(Array.isArray(t.hashes)),s("string"==typeof t.flags),s(o.isU32(t.totalTX)),this.parseJSON(t);for(let e of t.hashes)e=o.revHex(e),this.hashes.push(Buffer.from(e,"hex"));return this.flags=Buffer.from(t.flags,"hex"),this.totalTX=t.totalTX,this},n.fromJSON=function(t){return(new n).fromJSON(t)},n.fromBlock=function(t,e){const i=[];for(const n of t.txs)i.push(n.isWatched(e)?1:0);return n.fromMatches(t,i)},n.fromHashes=function(t,e){const i=new Set;for(let t of e)Buffer.isBuffer(t)&&(t=t.toString("hex")),i.add(t);const r=[];for(const e of t.txs){const t=e.hash("hex");r.push(i.has(t)?1:0)}return n.fromMatches(t,r)},n.fromMatches=function(t,e){const i=[],r=[],s=[],o=[],a=t.txs.length;let h=0;const c=t=>a+(1<<t)-1>>>t,f=(t,e,i)=>{if(0===t)return i[e];const n=f(t-1,2*e,i);let r;return r=2*e+1<c(t-1)?f(t-1,2*e+1,i):n,u.root256(n,r)},l=(t,e,i,n)=>{let r=0;for(let i=e<<t;i<e+1<<t&&i<a;i++)r|=n[i];s.push(r),0!==t&&r?(l(t-1,2*e,i,n),2*e+1<c(t-1)&&l(t-1,2*e+1,i,n)):o.push(f(t,e,i))};for(let n=0;n<t.txs.length;n++){const s=t.txs[n];e[n]&&i.push(s),r.push(s.hash())}for(;c(h)>1;)h++;l(h,0,r,e);const p=Buffer.allocUnsafe((s.length+7)/8|0);p.fill(0);for(let t=0;t<s.length;t++)p[t/8|0]|=s[t]<<t%8;const d=new n;return d._hash=t._hash,d._hhash=t._hhash,d.version=t.version,d.prevBlock=t.prevBlock,d.merkleRoot=t.merkleRoot,d.time=t.time,d.bits=t.bits,d.nonce=t.nonce,d.totalTX=a,d.hashes=o,d.flags=p,d.txs=i,d},n.isMerkleBlock=function(t){return t instanceof n},n.prototype.toHeaders=function(){return p.fromBlock(this)},t.exports=n},function(t,e,i){"use strict";const n=i(18).binding;let r=0;t.exports=function(t){let e=r;for(let i=0;i<t.length;i++)t[i]=255&e,e+=i;r=e>>>0},n&&(e.cleanse=n.cleanse)},function(t,e){t.exports=require("url")},function(t,e,i){"use strict";function n(t){if(!(this instanceof n))return new n(t);this.data=[],t&&this.init(t)}function r(t,e){if(!(this instanceof r))return new r(t,e);Error.call(this),this.type="ValidationError",this.message=`${function(t){return Array.isArray(t)&&(t=t[0]),"number"==typeof t?`Param #${t}`:t}(t)} must be a ${e}.`,Error.captureStackTrace&&Error.captureStackTrace(this,r)}const s=i(0),o=i(1);n.prototype.init=function(t){s(t&&"object"==typeof t),Array.isArray(t)||(t=[t]),this.data=t},n.prototype.has=function(t){s("string"==typeof t||"number"==typeof t,"Key must be a string or number.");for(const e of this.data){if(null!=e[t])return!0}return!1},n.prototype.get=function(t,e){if(void 0===e&&(e=null),Array.isArray(t)){const i=t;for(const t of i){const e=this.get(t);if(null!==e)return e}return e}s("string"==typeof t||"number"==typeof t,"Key must be a string or number.");for(const e of this.data){if(!e||"object"!=typeof e)throw new r("data","object");const i=e[t];if(null!=i)return i}return e},n.prototype.typeOf=function(t){const e=this.get(t);return null==e?"null":typeof e},n.prototype.str=function(t,e){const i=this.get(t);if(void 0===e&&(e=null),null===i)return e;if("string"!=typeof i)throw new r(t,"number");return i},n.prototype.int=function(t,e){let i=this.get(t);if(void 0===e&&(e=null),null===i)return e;if("string"!=typeof i){if("number"!=typeof i)throw new r(t,"int");if(!Number.isSafeInteger(i))throw new r(t,"int");return i}if(!/^\-?\d+$/.test(i))throw new r(t,"int");if(i=parseInt(i,10),!Number.isSafeInteger(i))throw new r(t,"int");return i},n.prototype.uint=function(t,e){const i=this.int(t);if(void 0===e&&(e=null),null===i)return e;if(i<0)throw new r(t,"uint");return i},n.prototype.float=function(t,e){let i=this.get(t);if(void 0===e&&(e=null),null===i)return e;if("string"!=typeof i){if("number"!=typeof i)throw new r(t,"float");if(!isFinite(i))throw new r(t,"float");return i}if(!/^\-?\d*(?:\.\d*)?$/.test(i))throw new r(t,"float");if(!/\d/.test(i))throw new r(t,"float");if(i=parseFloat(i),!isFinite(i))throw new r(t,"float");return i},n.prototype.ufloat=function(t,e){const i=this.float(t);if(void 0===e&&(e=null),null===i)return e;if(i<0)throw new r(t,"positive float");return i},n.prototype.fixed=function(t,e,i){const n=this.float(t);if(void 0===i&&(i=null),null===n)return i;try{return o.fromFloat(n,e||0)}catch(e){throw new r(t,"fixed number")}},n.prototype.ufixed=function(t,e,i){const n=this.fixed(t,e);if(void 0===i&&(i=null),null===n)return i;if(n<0)throw new r(t,"positive fixed number");return n},n.prototype.i8=function(t,e){const i=this.int(t);if(void 0===e&&(e=null),null===i)return e;if(i<-128||i>127)throw new r(t,"i8");return i},n.prototype.i16=function(t,e){const i=this.int(t);if(void 0===e&&(e=null),null===i)return e;if(i<-32768||i>32767)throw new r(t,"i16");return i},n.prototype.i32=function(t,e){const i=this.int(t);if(void 0===e&&(e=null),null===i)return e;if((0|i)!==i)throw new r(t,"int32");return i},n.prototype.i64=function(t,e){return this.int(t,e)},n.prototype.u8=function(t,e){const i=this.uint(t);if(void 0===e&&(e=null),null===i)return e;if((255&i)!==i)throw new r(t,"uint8");return i},n.prototype.u16=function(t,e){const i=this.uint(t);if(void 0===e&&(e=null),null===i)return e;if((65535&i)!==i)throw new r(t,"uint16");return i},n.prototype.u32=function(t,e){const i=this.uint(t);if(void 0===e&&(e=null),null===i)return e;if(i>>>0!==i)throw new r(t,"uint32");return i},n.prototype.u64=function(t,e){return this.uint(t,e)},n.prototype.hash=function(t,e){const i=this.get(t);if(void 0===e&&(e=null),null===i)return e;if("string"!=typeof i){if(!Buffer.isBuffer(i))throw new r(t,"hash");if(32!==i.length)throw new r(t,"hash");return i.toString("hex")}if(64!==i.length)throw new r(t,"hex string");if(!/^[0-9a-f]+$/i.test(i))throw new r(t,"hex string");let n="";for(let t=0;t<i.length;t+=2)n=i.slice(t,t+2)+n;return n},n.prototype.numhash=function(t,e){return"string"===this.typeOf(t)?this.hash(t,e):this.uint(t,e)},n.prototype.bool=function(t,e){const i=this.get(t);if(void 0===e&&(e=null),null===i)return e;if("number"==typeof i){if(1===i)return!0;if(0===i)return!1}if("string"!=typeof i){if("boolean"!=typeof i)throw new r(t,"boolean");return i}if("true"===i||"1"===i)return!0;if("false"===i||"0"===i)return!1;throw new r(t,"boolean")},n.prototype.buf=function(t,e,i){const n=this.get(t);if(i||(i="hex"),void 0===e&&(e=null),null===n)return e;if("string"!=typeof n){if(!Buffer.isBuffer(n))throw new r(t,"buffer");return n}const s=Buffer.from(n,i);if(s.length!==Buffer.byteLength(n,i))throw new r(t,`${i} string`);return s},n.prototype.array=function(t,e){const i=this.get(t);if(void 0===e&&(e=null),null===i)return e;if("string"!=typeof i){if(!Array.isArray(i))throw new r(t,"list/array");return i}const n=i.trim().split(/\s*,\s*/),s=[];for(const t of n)0!==t.length&&s.push(t);return s},n.prototype.obj=function(t,e){const i=this.get(t);if(void 0===e&&(e=null),null===i)return e;if("object"!=typeof i)throw new r(t,"object");return i},n.prototype.func=function(t,e){const i=this.get(t);if(void 0===e&&(e=null),null===i)return e;if("function"!=typeof i)throw new r(t,"function");return i},Object.setPrototypeOf(r.prototype,Error.prototype),t.exports=n},function(t,e){t.exports=require("http")},function(t,e,i){function n(t){if(t)return function(t){for(var e in n.prototype)t[e]=n.prototype[e];return t}(t)}t.exports=n,n.prototype.on=n.prototype.addEventListener=function(t,e){return this._callbacks=this._callbacks||{},(this._callbacks["$"+t]=this._callbacks["$"+t]||[]).push(e),this},n.prototype.once=function(t,e){function i(){this.off(t,i),e.apply(this,arguments)}return i.fn=e,this.on(t,i),this},n.prototype.off=n.prototype.removeListener=n.prototype.removeAllListeners=n.prototype.removeEventListener=function(t,e){if(this._callbacks=this._callbacks||{},0==arguments.length)return this._callbacks={},this;var i=this._callbacks["$"+t];if(!i)return this;if(1==arguments.length)return delete this._callbacks["$"+t],this;for(var n,r=0;r<i.length;r++)if((n=i[r])===e||n.fn===e){i.splice(r,1);break}return this},n.prototype.emit=function(t){this._callbacks=this._callbacks||{};var e=[].slice.call(arguments,1),i=this._callbacks["$"+t];if(i)for(var n=0,r=(i=i.slice(0)).length;n<r;++n)i[n].apply(this,e);return this},n.prototype.listeners=function(t){return this._callbacks=this._callbacks||{},this._callbacks["$"+t]||[]},n.prototype.hasListeners=function(t){return!!this.listeners(t).length}},function(t,e,i){t.exports=i(284)},function(t,e,i){function n(t,e,i){return Buffer(t,e,i)}var r=i(65);Buffer.from&&Buffer.alloc&&Buffer.allocUnsafe&&Buffer.allocUnsafeSlow?t.exports=r:(Object.keys(r).forEach(function(t){e[t]=r[t]}),e.Buffer=n),Object.keys(Buffer).forEach(function(t){n[t]=Buffer[t]}),n.from=function(t,e,i){if("number"==typeof t)throw new TypeError("Argument must not be a number");return Buffer(t,e,i)},n.alloc=function(t,e,i){if("number"!=typeof t)throw new TypeError("Argument must be a number");var n=Buffer(t);return void 0!==e?"string"==typeof i?n.fill(e,i):n.fill(e):n.fill(0),n},n.allocUnsafe=function(t){if("number"!=typeof t)throw new TypeError("Argument must be a number");return Buffer(t)},n.allocUnsafeSlow=function(t){if("number"!=typeof t)throw new TypeError("Argument must be a number");return r.SlowBuffer(t)}},function(t,e,i){"use strict";function n(t){if(!(this instanceof n))return new n(t);this.host="0.0.0.0",this.port=0,this.services=0,this.time=0,this.hostname="0.0.0.0:0",this.raw=h.ZERO_IP,t&&this.fromOptions(t)}const r=i(0),s=i(60),o=i(6),a=i(1),h=i(46),c=i(4),u=i(2);n.DEFAULT_SERVICES=0|s.services.NETWORK|s.services.WITNESS|s.services.BLOOM,n.prototype.fromOptions=function(t){return r("string"==typeof t.host),r("number"==typeof t.port),this.raw=h.toBuffer(t.host),this.host=h.toString(this.raw),this.port=t.port,t.services&&(r("number"==typeof t.services),this.services=t.services),t.time&&(r("number"==typeof t.time),this.time=t.time),this.hostname=h.toHostname(this.host,this.port),this},n.fromOptions=function(t){return(new n).fromOptions(t)},n.prototype.hasServices=function(t){return(this.services&t)===t},n.isIPv4=function(){return h.isIPv4(this.raw)},n.isIPv6=function(){return h.isIPv6(this.raw)},n.prototype.isNull=function(){return h.isNull(this.raw)},n.prototype.isLocal=function(){return h.isLocal(this.raw)},n.prototype.isValid=function(){return h.isValid(this.raw)},n.prototype.isRoutable=function(){return h.isRoutable(this.raw)},n.prototype.isOnion=function(){return h.isOnion(this.raw)},n.prototype.equal=function(t){return 0===this.compare(t)},n.prototype.compare=function(t){const e=this.raw.compare(t.raw);return 0!==e?e:this.port-t.port},n.prototype.getReachability=function(t){return h.getReachability(this.raw,t.raw)},n.prototype.setNull=function(){this.raw=h.ZERO_IP,this.host="0.0.0.0",this.hostname=h.toHostname(this.host,this.port)},n.prototype.setHost=function(t){this.raw=h.toBuffer(t),this.host=h.toString(this.raw),this.hostname=h.toHostname(this.host,this.port)},n.prototype.setPort=function(t){r(t>=0&&t<=65535),this.port=t,this.hostname=h.toHostname(this.host,t)},n.prototype.fromHost=function(t,e,i){return i=o.get(i),r(e>=0&&e<=65535),this.raw=h.toBuffer(t),this.host=h.toString(this.raw),this.port=e,this.services=n.DEFAULT_SERVICES,this.time=i.now(),this.hostname=h.toHostname(this.host,this.port),this},n.fromHost=function(t,e,i){return(new n).fromHost(t,e,i)},n.prototype.fromHostname=function(t,e){e=o.get(e);const i=h.fromHostname(t,e.port);return this.fromHost(i.host,i.port,e)},n.fromHostname=function(t,e){return(new n).fromHostname(t,e)},n.prototype.fromSocket=function(t,e){const i=t.remoteAddress,n=t.remotePort;return r("string"==typeof i),r("number"==typeof n),this.fromHost(h.normalize(i),n,e)},n.fromSocket=function(t,e){return(new n).fromSocket(t,e)},n.prototype.fromReader=function(t,e){return this.time=e?t.readU32():0,this.services=t.readU32(),t.readU32(),this.raw=t.readBytes(16),this.host=h.toString(this.raw),this.port=t.readU16BE(),this.hostname=h.toHostname(this.host,this.port),this},n.prototype.fromRaw=function(t,e){return this.fromReader(new u(t),e)},n.fromReader=function(t,e){return(new n).fromReader(t,e)},n.fromRaw=function(t,e){return(new n).fromRaw(t,e)},n.prototype.toWriter=function(t,e){return e&&t.writeU32(this.time),t.writeU32(this.services),t.writeU32(0),t.writeBytes(this.raw),t.writeU16BE(this.port),t},n.prototype.getSize=function(t){return 26+(t?4:0)},n.prototype.toRaw=function(t){const e=this.getSize(t);return this.toWriter(new c(e),t).render()},n.prototype.toJSON=function(){return{host:this.host,port:this.port,services:this.services,time:this.time}},n.prototype.fromJSON=function(t){return r(a.isU16(t.port)),r(a.isU32(t.services)),r(a.isU32(t.time)),this.raw=h.toBuffer(t.host),this.host=t.host,this.port=t.port,this.services=t.services,this.time=t.time,this.hostname=h.toHostname(this.host,this.port),this},n.fromJSON=function(t){return(new n).fromJSON(t)},n.prototype.inspect=function(){return"<NetAddress:"+` hostname=${this.hostname}`+` services=${this.services.toString(2)}`+` date=${a.date(this.time)}`+">"},t.exports=n},function(t,e,i){"use strict";function n(t){if(!(this instanceof n))return new n(t);this.keyType=n.types.HD,this.id=null,this.wid=-1,this.name=null,this.account=0,this.branch=-1,this.index=-1,this.encrypted=!1,this.data=null,this.type=h.types.PUBKEYHASH,this.version=-1,this.hash=null,t&&this.fromOptions(t)}const r=i(0),s=i(2),o=i(4),a=i(3),h=i(11);n.types={HD:0,KEY:1,ADDRESS:2},n.prototype.fromOptions=function(t){return this.keyType=t.keyType,this.id=t.id,this.wid=t.wid,this.name=t.name,this.account=t.account,this.branch=t.branch,this.index=t.index,this.encrypted=t.encrypted,this.data=t.data,this.type=t.type,this.version=t.version,this.hash=t.hash,this},n.fromOptions=function(t){return(new n).fromOptions(t)},n.prototype.clone=function(){const t=new n;return t.keyType=this.keyType,t.id=this.id,t.wid=this.wid,t.name=this.name,t.account=this.account,t.branch=this.branch,t.index=this.index,t.encrypted=this.encrypted,t.data=this.data,t.type=this.type,t.version=this.version,t.hash=this.hash,t},n.prototype.fromRaw=function(t){const e=new s(t);switch(this.account=e.readU32(),this.keyType=e.readU8(),this.keyType){case n.types.HD:this.branch=e.readU32(),this.index=e.readU32();break;case n.types.KEY:this.encrypted=1===e.readU8(),this.data=e.readVarBytes();break;case n.types.ADDRESS:break;default:r(!1)}return this.version=e.readI8(),this.type=e.readU8(),129!==this.type&&130!==this.type||(this.type=4),this},n.fromRaw=function(t){return(new n).fromRaw(t)},n.prototype.getSize=function(){let t=0;switch(t+=5,this.keyType){case n.types.HD:t+=8;break;case n.types.KEY:t+=1,t+=a.sizeVarBytes(this.data)}return t+=2},n.prototype.toRaw=function(){const t=this.getSize(),e=new o(t);switch(e.writeU32(this.account),e.writeU8(this.keyType),this.keyType){case n.types.HD:r(!this.data),r(-1!==this.index),e.writeU32(this.branch),e.writeU32(this.index);break;case n.types.KEY:r(this.data),r(-1===this.index),e.writeU8(this.encrypted?1:0),e.writeVarBytes(this.data);break;case n.types.ADDRESS:r(!this.data),r(-1===this.index);break;default:r(!1)}return e.writeI8(this.version),e.writeU8(this.type),e.render()},n.prototype.fromAddress=function(t,e){return this.keyType=n.types.ADDRESS,this.id=t.id,this.wid=t.wid,this.name=t.name,this.account=t.accountIndex,this.version=e.version,this.type=e.type,this.hash=e.getHash("hex"),this},n.fromAddress=function(t,e){return(new n).fromAddress(t,e)},n.prototype.toPath=function(){return this.keyType!==n.types.HD?null:`m/${this.account}'/${this.branch}/${this.index}`},n.prototype.toAddress=function(t){return h.fromHash(this.hash,this.type,this.version,t)},n.prototype.toJSON=function(){return{name:this.name,account:this.account,change:1===this.branch,derivation:this.toPath()}},n.prototype.inspect=function(){return`<Path: ${this.id}(${this.wid})/${this.name}:${this.toPath()}>`},t.exports=n},function(t,e,i){"use strict";function n(t,e){if(!(this instanceof n))return new n(t,e);s.call(this,t,e)}const r=i(0),s=i(2),o=0,a=1,h=2,c=3,u=4,f=5;Object.setPrototypeOf(n.prototype,s.prototype),n.prototype.readVarint=function(){const{size:t,value:e}=function(t,e){let i=0,n=128,s=0;for(;128&n;){if(e>=t.length){i=0;break}switch(n=t[e++],s){case 0:case 1:case 2:case 3:i+=(127&n)<<7*s;break;case 4:i+=(127&n)*(1<<7*s);break;default:i+=(127&n)*Math.pow(2,7*s)}r(++s<7,"Number exceeds 2^53-1.")}return new function(t,e){this.size=t,this.value=e}(s,i)}(this.data,this.offset);return this.offset+=t,e},n.prototype.readFieldValue=function(t,e){const i=this.readField(t,e);return i?(r(null!=i.value),i.value):-1},n.prototype.readFieldU64=function(t,e){const i=this.readField(t,e);return i?(r(i.type===o||i.type===a),i.value):-1},n.prototype.readFieldU32=function(t,e){const i=this.readField(t,e);return i?(r(i.type===o||i.type===f),i.value):-1},n.prototype.readFieldBytes=function(t,e){const i=this.readField(t,e);return i?(r(i.data),i.data):null},n.prototype.readFieldString=function(t,e,i){const n=this.readField(t,e);return n?(r(n.data),n.data.toString(i||"utf8")):null},n.prototype.nextTag=function(){if(0===this.left())return-1;const t=this.readField();return this.seek(-t.size),t.tag},n.prototype.readField=function(t,e){const i=this.offset,n=new function(t){this.tag=t>>>3,this.type=7&t,this.size=0,this.value=0,this.data=null,this.group=null}(this.readVarint());if(null!=t&&n.tag!==t)return r(e,"Non-optional field not present."),this.offset=i,null;switch(n.type){case o:n.value=this.readVarint();break;case a:n.value=this.readU64();break;case h:n.data=this.readVarBytes();break;case c:for(n.group=[];;){const t=this.readField();if(t.type===u)break;n.group.push(t)}break;case u:r(!1,"Unexpected end group.");break;case f:n.value=this.readU32();break;default:r(!1,"Bad wire type.")}return n.size=this.offset-i,n},t.exports=n},function(t,e,i){"use strict";function n(){if(!(this instanceof n))return new n;o.call(this)}function r(t){s(Number.isSafeInteger(t),"Number exceeds 2^53-1.");let e=0,i=0;do{s(i<7);let n=127&t;t-=t%128,0!==(t/=128)&&(n|=128),e*=256,e+=n,i++}while(t>0);return e}const s=i(0),o=i(63),a=0,h=2;Object.setPrototypeOf(n.prototype,o.prototype),n.prototype.writeVarint=function(t){const e=function(t){s(Number.isSafeInteger(t),"Number exceeds 2^53-1.");let e=0;do{t-=t%128,t/=128,e++}while(t>0);return e}(t);switch(e){case 6:{const e=r(t);this.writeU32BE(e/65536|0),this.writeU16BE(65535&e);break}case 5:{const e=r(t);this.writeU32BE(e/256|0),this.writeU8(255&e);break}case 4:{const e=r(t);this.writeU32BE(e);break}case 3:{const e=r(t);this.writeU16BE(e>>8),this.writeU8(255&e);break}case 2:{const e=r(t);this.writeU16BE(e);break}case 1:{const e=r(t);this.writeU8(e);break}default:{const i=Buffer.allocUnsafe(e);!function(t,e,i){s(Number.isSafeInteger(e),"Number exceeds 2^53-1.");do{s(i<t.length);let n=127&e;e-=e%128,0!=(e/=128)&&(n|=128),t[i]=n,i++}while(e>0)}(i,t,0),this.writeBytes(i);break}}},n.prototype.writeFieldVarint=function(t,e){const i=t<<3|a;this.writeVarint(i),this.writeVarint(e)},n.prototype.writeFieldU64=function(t,e){s(Number.isSafeInteger(e)),this.writeFieldVarint(t,e)},n.prototype.writeFieldU32=function(t,e){s(e<=4294967295),this.writeFieldVarint(t,e)},n.prototype.writeFieldBytes=function(t,e){const i=t<<3|h;this.writeVarint(i),this.writeVarint(e.length),this.writeBytes(e)},n.prototype.writeFieldString=function(t,e,i){"string"==typeof e&&(e=Buffer.from(e,i||"utf8")),this.writeFieldBytes(t,e)},t.exports=n},function(t,e,i){"use strict";const n=i(26),r=e;r.types=["mainnet","testnet","regtest","simnet"];const s={};s.type="mainnet",s.seeds=["mainnet.wmcc.network","mainnet.worldmobilecoin.net","mainnet.worldmobilecoin.info","mainnet.worldmobilecoin.network","mainnet.worldmobilecoin.online","mainnet.worldmobilecoin.me","mainnet.worldmobilecoin.site","mainnet.worldmobilecoin.xyz"],s.magic=3360220505,s.port=8880,s.checkpointMap={},s.lastCheckpoint=0,s.halvingInterval=42e6,s.genesis={version:1,hash:"7212511001f38a7b3b8ac819cc49024d1a2206b1b0f23fdeb485277b850f0000",prevBlock:"0000000000000000000000000000000000000000000000000000000000000000",merkleRoot:"49337a633ec2a4e8333243d82742c153a1772c9ac0646d444a330379500b75fe",time:1513728e3,bits:504365040,nonce:812349,height:0},s.genesisBlock="01000000000000000000000000000000000000000000000000000000000000000000000049337a633ec2a4e8333243d82742c153a1772c9ac0646d444a330379500b75fe00a8395af0ff0f1e3d650c0001010000000001010000000000000000000000000000000000000000000000000000000000000000ffffffff30512067656e6573697320626c6f636b206d696e656420627920776d63635f636f7265044f3aac96080000000000000000ffffffff030080c6a47e8d03001976a9148efc12b15df7ae341786bb2cdeb6f5a59ed2497688ac0080c6a47e8d03001976a914456c9dc895ca8bc6e6bae8ca8f2a8a29018ca57d88ac0000000000000000266a24aa21a9ede2f61c3f71d1defd3fa999dfa36953755c690689799962b48bebd836974e8cf90120000000000000000000000000000000000000000000000000000000000000000000000000",s.pow={limit:new n("00000fffffffffffffffffffffffffffffffffffffffffffffffffffffffffff","hex"),bits:504365040,chainwork:new n("0000000000000000000000000000000000000000000000000000000000100010","hex"),targetTimespan:604800,targetSpacing:300,retargetInterval:2016,targetReset:!1,noRetargeting:!1},s.block={bip34height:0,bip34hash:"7212511001f38a7b3b8ac819cc49024d1a2206b1b0f23fdeb485277b850f0000",bip65height:0,bip65hash:"7212511001f38a7b3b8ac819cc49024d1a2206b1b0f23fdeb485277b850f0000",bip66height:0,bip66hash:"7212511001f38a7b3b8ac819cc49024d1a2206b1b0f23fdeb485277b850f0000",pruneAfterHeight:1e3,keepBlocks:288,maxTipAge:86400,slowHeight:65e4},s.bip30={},s.activationThreshold=3831,s.minerWindow=4032,s.deployments={csv:{name:"csv",bit:0,startTime:1509494400,timeout:1541030400,threshold:-1,window:-1,required:!1,force:!0},segwit:{name:"segwit",bit:1,startTime:1509494400,timeout:1541030400,threshold:-1,window:-1,required:!0,force:!1},segsignal:{name:"segsignal",bit:4,startTime:1509494400,timeout:1541030400,threshold:269,window:336,required:!1,force:!1},testdummy:{name:"testdummy",bit:28,startTime:1509494400,timeout:1541030400,threshold:-1,window:-1,required:!1,force:!0}},s.deploys=[s.deployments.csv,s.deployments.segwit,s.deployments.segsignal,s.deployments.testdummy],s.keyPrefix={privkey:66,xpubkey:76067358,xprivkey:76066276,xpubkey58:"xpub",xprivkey58:"xprv",coinType:0},s.addressPrefix={pubkeyhash:73,scripthash:75,witnesspubkeyhash:6,witnessscripthash:10,bech32:"wc"},s.requireStandard=!0,s.rpcPort=7880,s.minRelay=1e3,s.feeRate=1e5,s.maxFeeRate=4e5,s.selfConnect=!1,s.requestMempool=!1;const o={};o.type="testnet",o.seeds=["testnet.wmcc.network","testnet.worldmobilecoin.net"],o.magic=1550390695,o.port=18880,o.checkpointMap={},o.lastCheckpoint=0,o.halvingInterval=42e6,o.genesis={version:1,hash:"43497fd7f826957108f4a30fd9cec3aeba79972084e90ead01ea330900000000",prevBlock:"0000000000000000000000000000000000000000000000000000000000000000",merkleRoot:"3ba3edfd7a7b12b27ac72c3e67768f617fc81bc3888a51323a9fb8aa4b1e5e4a",time:1296688602,bits:486604799,nonce:414098458,height:0},o.genesisBlock="0100000000000000000000000000000000000000000000000000000000000000000000003ba3edfd7a7b12b27ac72c3e67768f617fc81bc3888a51323a9fb8aa4b1e5e4adae5494dffff001d1aa4ae180101000000010000000000000000000000000000000000000000000000000000000000000000ffffffff4d04ffff001d0104455468652054696d65732030332f4a616e2f32303039204368616e63656c6c6f72206f6e206272696e6b206f66207365636f6e64206261696c6f757420666f722062616e6b73ffffffff0100f2052a01000000434104678afdb0fe5548271967f1a67130b7105cd6a828e03909a67962e0ea1f61deb649f6bc3f4cef38c4f35504e51ec112de5c384df7ba0b8d578a4c702b6bf11d5fac00000000",o.pow={limit:new n("00000000ffffffffffffffffffffffffffffffffffffffffffffffffffffffff","hex"),bits:486604799,chainwork:new n("0000000000000000000000000000000000000000000000286d17360c5492b2c4","hex"),targetTimespan:604800,targetSpacing:300,retargetInterval:2016,targetReset:!0,noRetargeting:!1},o.block={bip34height:1,bip34hash:"f88ecd9912d00d3f5c2a8e0f50417d3e415c75b3abe584346da9b32300000000",bip65height:1,bip65hash:"b61e864fbec41dfaf09da05d1d76dc068b0dd82ee7982ff255667f0000000000",bip66height:1,bip66hash:"82a14b9e5ea81d4832b8e2cd3c2a6092b5a3853285a8995ec4c8042100000000",pruneAfterHeight:1e3,keepBlocks:1e4,maxTipAge:86400,slowHeight:95e4},o.bip30={},o.activationThreshold=1512,o.minerWindow=2016,o.deployments={csv:{name:"csv",bit:0,startTime:1456790400,timeout:1493596800,threshold:-1,window:-1,required:!1,force:!0},segwit:{name:"segwit",bit:1,startTime:1462060800,timeout:1493596800,threshold:-1,window:-1,required:!0,force:!1},segsignal:{name:"segsignal",bit:4,startTime:4294967295,timeout:4294967295,threshold:269,window:336,required:!1,force:!1},testdummy:{name:"testdummy",bit:28,startTime:1199145601,timeout:1230767999,threshold:-1,window:-1,required:!1,force:!0}},o.deploys=[o.deployments.csv,o.deployments.segwit,o.deployments.segsignal,o.deployments.testdummy],o.keyPrefix={privkey:71,xpubkey:70617039,xprivkey:70615956,xpubkey58:"tpub",xprivkey58:"tprv",coinType:1},o.addressPrefix={pubkeyhash:78,scripthash:80,witnesspubkeyhash:3,witnessscripthash:40,bech32:"tb"},o.requireStandard=!1,o.rpcPort=17880,o.minRelay=1e3,o.feeRate=2e4,o.maxFeeRate=6e4,o.selfConnect=!1,o.requestMempool=!1;const a={};a.type="regtest",a.seeds=["127.0.0.1"],a.magic=618697555,a.port=28880,a.checkpointMap={},a.lastCheckpoint=0,a.halvingInterval=150,a.genesis={version:1,hash:"06226e46111a0b59caaf126043eb5bbf28c34f3a5e332a1fc7b2b73cf188910f",prevBlock:"0000000000000000000000000000000000000000000000000000000000000000",merkleRoot:"3ba3edfd7a7b12b27ac72c3e67768f617fc81bc3888a51323a9fb8aa4b1e5e4a",time:1296688602,bits:545259519,nonce:2,height:0},a.genesisBlock="0100000000000000000000000000000000000000000000000000000000000000000000003ba3edfd7a7b12b27ac72c3e67768f617fc81bc3888a51323a9fb8aa4b1e5e4adae5494dffff7f20020000000101000000010000000000000000000000000000000000000000000000000000000000000000ffffffff4d04ffff001d0104455468652054696d65732030332f4a616e2f32303039204368616e63656c6c6f72206f6e206272696e6b206f66207365636f6e64206261696c6f757420666f722062616e6b73ffffffff0100f2052a01000000434104678afdb0fe5548271967f1a67130b7105cd6a828e03909a67962e0ea1f61deb649f6bc3f4cef38c4f35504e51ec112de5c384df7ba0b8d578a4c702b6bf11d5fac00000000",a.pow={limit:new n("7fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff","hex"),bits:545259519,chainwork:new n("0000000000000000000000000000000000000000000000000000000000000002","hex"),targetTimespan:604800,targetSpacing:300,retargetInterval:2016,targetReset:!0,noRetargeting:!0},a.block={bip34height:4294967295,bip34hash:null,bip65height:1351,bip65hash:null,bip66height:1251,bip66hash:null,pruneAfterHeight:1e3,keepBlocks:1e4,maxTipAge:4294967295,slowHeight:0},a.bip30={},a.activationThreshold=108,a.minerWindow=144,a.deployments={csv:{name:"csv",bit:0,startTime:0,timeout:4294967295,threshold:-1,window:-1,required:!1,force:!0},segwit:{name:"segwit",bit:1,startTime:0,timeout:4294967295,threshold:-1,window:-1,required:!0,force:!1},segsignal:{name:"segsignal",bit:4,startTime:4294967295,timeout:4294967295,threshold:269,window:336,required:!1,force:!1},testdummy:{name:"testdummy",bit:28,startTime:0,timeout:4294967295,threshold:-1,window:-1,required:!1,force:!0}},a.deploys=[a.deployments.csv,a.deployments.segwit,a.deployments.segsignal,a.deployments.testdummy],a.keyPrefix={privkey:90,xpubkey:3937729029,xprivkey:3937666247,xpubkey58:"rpub",xprivkey58:"rprv",coinType:1},a.addressPrefix={pubkeyhash:60,scripthash:38,witnesspubkeyhash:122,witnessscripthash:20,bech32:"rb"},a.requireStandard=!1,a.rpcPort=27880,a.minRelay=1e3,a.feeRate=2e4,a.maxFeeRate=6e4,a.selfConnect=!0,a.requestMempool=!0;const h={};h.type="simnet",h.seeds=["127.0.0.1"],h.magic=3442631030,h.port=38880,h.checkpointMap={},h.lastCheckpoint=0,h.halvingInterval=21e4,h.genesis={version:1,hash:"f67ad7695d9b662a72ff3d8edbbb2de0bfa67b13974bb9910d116d5cbd863e68",prevBlock:"0000000000000000000000000000000000000000000000000000000000000000",merkleRoot:"3ba3edfd7a7b12b27ac72c3e67768f617fc81bc3888a51323a9fb8aa4b1e5e4a",time:1401292357,bits:545259519,nonce:2,height:0},h.genesisBlock="0100000000000000000000000000000000000000000000000000000000000000000000003ba3edfd7a7b12b27ac72c3e67768f617fc81bc3888a51323a9fb8aa4b1e5e4a45068653ffff7f20020000000101000000010000000000000000000000000000000000000000000000000000000000000000ffffffff4d04ffff001d0104455468652054696d65732030332f4a616e2f32303039204368616e63656c6c6f72206f6e206272696e6b206f66207365636f6e64206261696c6f757420666f722062616e6b73ffffffff0100f2052a01000000434104678afdb0fe5548271967f1a67130b7105cd6a828e03909a67962e0ea1f61deb649f6bc3f4cef38c4f35504e51ec112de5c384df7ba0b8d578a4c702b6bf11d5fac00000000",h.pow={limit:new n("7fffff0000000000000000000000000000000000000000000000000000000000","hex"),bits:545259519,chainwork:new n("0000000000000000000000000000000000000000000000000000000000000002","hex"),targetTimespan:604800,targetSpacing:300,retargetInterval:2016,targetReset:!0,noRetargeting:!1},h.block={bip34height:0,bip34hash:"f67ad7695d9b662a72ff3d8edbbb2de0bfa67b13974bb9910d116d5cbd863e68",bip65height:0,bip65hash:"f67ad7695d9b662a72ff3d8edbbb2de0bfa67b13974bb9910d116d5cbd863e68",bip66height:0,bip66hash:"f67ad7695d9b662a72ff3d8edbbb2de0bfa67b13974bb9910d116d5cbd863e68",pruneAfterHeight:1e3,keepBlocks:1e4,maxTipAge:4294967295,slowHeight:0},h.bip30={},h.activationThreshold=75,h.minerWindow=100,h.deployments={csv:{name:"csv",bit:0,startTime:0,timeout:4294967295,threshold:-1,window:-1,required:!1,force:!0},segwit:{name:"segwit",bit:1,startTime:0,timeout:4294967295,threshold:-1,window:-1,required:!0,force:!1},segsignal:{name:"segsignal",bit:4,startTime:4294967295,timeout:4294967295,threshold:269,window:336,required:!1,force:!1},testdummy:{name:"testdummy",bit:28,startTime:1199145601,timeout:1230767999,threshold:-1,window:-1,required:!1,force:!0}},h.deploys=[h.deployments.csv,h.deployments.segwit,h.deployments.segsignal,h.deployments.testdummy],h.keyPrefix={privkey:100,xpubkey:69254458,xprivkey:69253376,xpubkey58:"spub",xprivkey58:"sprv",coinType:115},h.addressPrefix={pubkeyhash:63,scripthash:123,witnesspubkeyhash:25,witnessscripthash:40,bech32:"sc"},h.requireStandard=!1,h.rpcPort=37880,h.minRelay=1e3,h.feeRate=2e4,h.maxFeeRate=6e4,h.selfConnect=!1,h.requestMempool=!1,r.mainnet=s,r.testnet=o,r.regtest=a,r.simnet=h},function(t,e,i){"use strict";function n(t){if(!(this instanceof n))return new n(t);s.call(this),null==t&&(t=200),this.samples=[],this.known=new Map,this.limit=t,this.offset=0,this.checked=!1}function r(t,e){return t-e}const s=i(10),o=i(1);Object.setPrototypeOf(n.prototype,s.prototype),n.prototype.add=function(t,e){if(this.samples.length>=this.limit)return;if(this.known.has(t))return;const i=e-o.now();if(this.known.set(t,i),o.binaryInsert(this.samples,i,r),this.emit("sample",i,this.samples.length),this.samples.length>=5&&this.samples.length%2==1){let t=this.samples[this.samples.length>>>1];if(Math.abs(t)>=4200){if(!this.checked){let t=!1;for(const e of this.samples)if(0!==e&&Math.abs(e)<300){t=!0;break}t||(this.checked=!0,this.emit("mismatch"))}t=0}this.offset=t,this.emit("offset",this.offset)}},n.prototype.now=function(){return o.now()+this.offset},n.prototype.adjust=function(t){return t+this.offset},n.prototype.local=function(t){return t-this.offset},n.prototype.ms=function(){return o.ms()+1e3*this.offset},t.exports=n},function(t,e,i){"use strict";function n(t,e){if(!(this instanceof n))return new n(t,e);r(s.isU8(t)),r(t>=0&&t<=16),r(Buffer.isBuffer(e)),r(e.length>=2&&e.length<=40),this.version=t,this.data=e}const r=i(0),s=i(1),o=i(27),a=o.types;n.prototype.getType=function(){return 0===this.version?20===this.data.length?a.WITNESSPUBKEYHASH:32===this.data.length?a.WITNESSSCRIPTHASH:a.WITNESSMALFORMED:1===this.version?32===this.data.length?a.WITNESSMASTHASH:a.WITNESSMALFORMED:a.NONSTANDARD},n.prototype.isUnknown=function(){const t=this.getType();return t===a.WITNESSMALFORMED||t===a.NONSTANDARD},n.prototype.isMalformed=function(){return this.getType()===a.WITNESSMALFORMED},n.prototype.inspect=function(){const t=this.data.toString("hex"),e=o.typesByVal[this.getType()].toLowerCase();return`<Program: version=${this.version} data=${t} type=${e}>`},t.exports=n},function(t,e,i){"use strict";function n(t){return 1===t.length?"0"+t:t}function r(t){for(var e="",i=0;i<t.length;i++)e+=n(t[i].toString(16));return e}var s=e;s.toArray=function(t,e){if(Array.isArray(t))return t.slice();if(!t)return[];var i=[];if("string"!=typeof t){for(var n=0;n<t.length;n++)i[n]=0|t[n];return i}if("hex"===e)for((t=t.replace(/[^a-z0-9]+/gi,"")).length%2!=0&&(t="0"+t),n=0;n<t.length;n+=2)i.push(parseInt(t[n]+t[n+1],16));else for(n=0;n<t.length;n++){var r=t.charCodeAt(n),s=r>>8,o=255&r;s?i.push(s,o):i.push(o)}return i},s.zero2=n,s.toHex=r,s.encode=function(t,e){return"hex"===e?r(t):t}},function(t,e,i){"use strict";function n(t,e,i){return t&e^~t&i}function r(t,e,i){return t&e^t&i^e&i}function s(t,e,i){return t^e^i}var o=i(14).rotr32;e.ft_1=function(t,e,i,o){return 0===t?n(e,i,o):1===t||3===t?s(e,i,o):2===t?r(e,i,o):void 0},e.ch32=n,e.maj32=r,e.p32=s,e.s0_256=function(t){return o(t,2)^o(t,13)^o(t,22)},e.s1_256=function(t){return o(t,6)^o(t,11)^o(t,25)},e.g0_256=function(t){return o(t,7)^o(t,18)^t>>>3},e.g1_256=function(t){return o(t,17)^o(t,19)^t>>>10}},function(t,e,i){"use strict";function n(){if(!(this instanceof n))return new n;y.call(this),this.h=[1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225],this.k=w,this.W=new Array(64)}var r=i(14),s=i(31),o=i(87),a=i(22),h=r.sum32,c=r.sum32_4,u=r.sum32_5,f=o.ch32,l=o.maj32,p=o.s0_256,d=o.s1_256,m=o.g0_256,g=o.g1_256,y=s.BlockHash,w=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298];r.inherits(n,y),t.exports=n,n.blockSize=512,n.outSize=256,n.hmacStrength=192,n.padLength=64,n.prototype._update=function(t,e){for(var i=this.W,n=0;n<16;n++)i[n]=t[e+n];for(;n<i.length;n++)i[n]=c(g(i[n-2]),i[n-7],m(i[n-15]),i[n-16]);var r=this.h[0],s=this.h[1],o=this.h[2],y=this.h[3],w=this.h[4],b=this.h[5],v=this.h[6],k=this.h[7];for(a(this.k.length===i.length),n=0;n<i.length;n++){var S=u(k,d(w),f(w,b,v),this.k[n],i[n]),E=h(p(r),l(r,s,o));k=v,v=b,b=w,w=h(y,S),y=o,o=s,s=r,r=h(S,E)}this.h[0]=h(this.h[0],r),this.h[1]=h(this.h[1],s),this.h[2]=h(this.h[2],o),this.h[3]=h(this.h[3],y),this.h[4]=h(this.h[4],w),this.h[5]=h(this.h[5],b),this.h[6]=h(this.h[6],v),this.h[7]=h(this.h[7],k)},n.prototype._digest=function(t){return"hex"===t?r.toHex32(this.h,"big"):r.split32(this.h,"big")}},function(t,e,i){"use strict";function n(){if(!(this instanceof n))return new n;w.call(this),this.h=[1779033703,4089235720,3144134277,2227873595,1013904242,4271175723,2773480762,1595750129,1359893119,2917565137,2600822924,725511199,528734635,4215389547,1541459225,327033209],this.k=b,this.W=new Array(160)}var r=i(14),s=i(31),o=i(22),a=r.rotr64_hi,h=r.rotr64_lo,c=r.shr64_hi,u=r.shr64_lo,f=r.sum64,l=r.sum64_hi,p=r.sum64_lo,d=r.sum64_4_hi,m=r.sum64_4_lo,g=r.sum64_5_hi,y=r.sum64_5_lo,w=s.BlockHash,b=[1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591];r.inherits(n,w),t.exports=n,n.blockSize=1024,n.outSize=512,n.hmacStrength=192,n.padLength=128,n.prototype._prepareBlock=function(t,e){for(var i=this.W,n=0;n<32;n++)i[n]=t[e+n];for(;n<i.length;n+=2){var r=function(t,e){var i=a(t,e,19)^a(e,t,29)^c(t,e,6);return i<0&&(i+=4294967296),i}(i[n-4],i[n-3]),s=function(t,e){var i=h(t,e,19)^h(e,t,29)^u(t,e,6);return i<0&&(i+=4294967296),i}(i[n-4],i[n-3]),o=i[n-14],f=i[n-13],l=function(t,e){var i=a(t,e,1)^a(t,e,8)^c(t,e,7);return i<0&&(i+=4294967296),i}(i[n-30],i[n-29]),p=function(t,e){var i=h(t,e,1)^h(t,e,8)^u(t,e,7);return i<0&&(i+=4294967296),i}(i[n-30],i[n-29]),g=i[n-32],y=i[n-31];i[n]=d(r,s,o,f,l,p,g,y),i[n+1]=m(r,s,o,f,l,p,g,y)}},n.prototype._update=function(t,e){this._prepareBlock(t,e);var i=this.W,n=this.h[0],r=this.h[1],s=this.h[2],c=this.h[3],u=this.h[4],d=this.h[5],m=this.h[6],w=this.h[7],b=this.h[8],v=this.h[9],k=this.h[10],S=this.h[11],E=this.h[12],R=this.h[13],x=this.h[14],_=this.h[15];o(this.k.length===i.length);for(var I=0;I<i.length;I+=2){var A=x,O=_,B=function(t,e){var i=a(t,e,14)^a(t,e,18)^a(e,t,9);return i<0&&(i+=4294967296),i}(b,v),P=function(t,e){var i=h(t,e,14)^h(t,e,18)^h(e,t,9);return i<0&&(i+=4294967296),i}(b,v),M=function(t,e,i,n,r){var s=t&i^~t&r;return s<0&&(s+=4294967296),s}(b,0,k,0,E),N=function(t,e,i,n,r,s){var o=e&n^~e&s;return o<0&&(o+=4294967296),o}(0,v,0,S,0,R),T=this.k[I],C=this.k[I+1],U=i[I],H=i[I+1],L=g(A,O,B,P,M,N,T,C,U,H),z=y(A,O,B,P,M,N,T,C,U,H);A=function(t,e){var i=a(t,e,28)^a(e,t,2)^a(e,t,7);return i<0&&(i+=4294967296),i}(n,r),O=function(t,e){var i=h(t,e,28)^h(e,t,2)^h(e,t,7);return i<0&&(i+=4294967296),i}(n,r),B=function(t,e,i,n,r){var s=t&i^t&r^i&r;return s<0&&(s+=4294967296),s}(n,0,s,0,u),P=function(t,e,i,n,r,s){var o=e&n^e&s^n&s;return o<0&&(o+=4294967296),o}(0,r,0,c,0,d);var D=l(A,O,B,P),F=p(A,O,B,P);x=E,_=R,E=k,R=S,k=b,S=v,b=l(m,w,L,z),v=p(w,w,L,z),m=u,w=d,u=s,d=c,s=n,c=r,n=l(L,z,D,F),r=p(L,z,D,F)}f(this.h,0,n,r),f(this.h,2,s,c),f(this.h,4,u,d),f(this.h,6,m,w),f(this.h,8,b,v),f(this.h,10,k,S),f(this.h,12,E,R),f(this.h,14,x,_)},n.prototype._digest=function(t){return"hex"===t?r.toHex32(this.h,"big"):r.split32(this.h,"big")}},function(t,e,i){"use strict";function n(t,e){if(!(this instanceof n))return new n(t,e);this.value=t||0,this.data=e||null}const r=i(0),s=i(32),o=i(1),a=i(27),h=i(2),c=i(4),u=a.opcodes,f=[];let l=null;n.prototype.isMinimal=function(){if(!this.data)return!0;if(1===this.data.length){if(129===this.data[0])return!1;if(this.data[0]>=1&&this.data[0]<=16)return!1}return this.data.length<=75?this.value===this.data.length:this.data.length<=255?this.value===u.OP_PUSHDATA1:this.data.length<=65535?this.value===u.OP_PUSHDATA2:(r(this.value===u.OP_PUSHDATA4),!0)},n.prototype.isDisabled=function(){switch(this.value){case u.OP_CAT:case u.OP_SUBSTR:case u.OP_LEFT:case u.OP_RIGHT:case u.OP_INVERT:case u.OP_AND:case u.OP_OR:case u.OP_XOR:case u.OP_2MUL:case u.OP_2DIV:case u.OP_MUL:case u.OP_DIV:case u.OP_MOD:case u.OP_LSHIFT:case u.OP_RSHIFT:return!0}return!1},n.prototype.isBranch=function(){return this.value>=u.OP_IF&&this.value<=u.OP_ENDIF},n.prototype.equals=function(t){return r(n.isOpcode(t)),this.value===t.value&&(this.data?(r(t.data),this.data.equals(t.data)):(r(!t.data),!0))},n.prototype.toOp=function(){return this.value},n.prototype.toData=function(){return this.data},n.prototype.toLength=function(){return this.data?this.data.length:-1},n.prototype.toPush=function(){return this.value===u.OP_0?a.small[1]:this.value===u.OP_1NEGATE?a.small[0]:this.value>=u.OP_1&&this.value<=u.OP_16?a.small[this.value-80+1]:this.toData()},n.prototype.toString=function(t){const e=this.toPush();return e?e.toString(t||"utf8"):null},n.prototype.toSmall=function(){return this.value===u.OP_0?0:this.value>=u.OP_1&&this.value<=u.OP_16?this.value-80:-1},n.prototype.toNum=function(t,e){return this.value===u.OP_0?s.fromInt(0):this.value===u.OP_1NEGATE?s.fromInt(-1):this.value>=u.OP_1&&this.value<=u.OP_16?s.fromInt(this.value-80):this.data?s.decode(this.data,t,e):null},n.prototype.toInt=function(t,e){const i=this.toNum(t,e);return i?i.getInt():-1},n.prototype.toBool=function(){const t=this.toSmall();return-1!==t&&1===t},n.prototype.toSymbol=function(){if(-1===this.value)return"OP_INVALIDOPCODE";const t=a.opcodesByVal[this.value];return t||`0x${o.hex8(this.value)}`},n.prototype.getSize=function(){if(!this.data)return 1;switch(this.value){case u.OP_PUSHDATA1:return 2+this.data.length;case u.OP_PUSHDATA2:return 3+this.data.length;case u.OP_PUSHDATA4:return 5+this.data.length;default:return 1+this.data.length}},n.prototype.toWriter=function(t){if(-1===this.value)throw new Error("Cannot reserialize a parse error.");if(!this.data)return t.writeU8(this.value),t;switch(this.value){case u.OP_PUSHDATA1:t.writeU8(this.value),t.writeU8(this.data.length),t.writeBytes(this.data);break;case u.OP_PUSHDATA2:t.writeU8(this.value),t.writeU16(this.data.length),t.writeBytes(this.data);break;case u.OP_PUSHDATA4:t.writeU8(this.value),t.writeU32(this.data.length),t.writeBytes(this.data);break;default:r(this.value===this.data.length),t.writeU8(this.value),t.writeBytes(this.data)}return t},n.prototype.toRaw=function(){const t=this.getSize();return this.toWriter(new c(t)).render()},n.prototype.toFormat=function(){if(-1===this.value)return"0x01";if(this.data){if(this.data.length<=4){const t=this.toNum();if(this.equals(n.fromNum(t)))return t.toString(10)}const t=a.opcodesByVal[this.value],e=this.data.toString("hex");if(!t){return`0x${o.hex8(this.value)} 0x${e}`}let i=this.data.length.toString(16);for(;i.length%2!=0;)i="0"+i;return`${t} 0x${i} 0x${e}`}const t=a.opcodesByVal[this.value];if(t)return t;return`0x${o.hex8(this.value)}`},n.prototype.toASM=function(t){return-1===this.value?"[error]":this.data?a.toASM(this.data,t):a.opcodesByVal[this.value]||"OP_UNKNOWN"},n.fromOp=function(t){r("number"==typeof t);const e=f[t];return r(e,"Bad opcode."),e},n.fromData=function(t){if(r(Buffer.isBuffer(t)),1===t.length){if(129===t[0])return n.fromOp(u.OP_1NEGATE);if(t[0]>=1&&t[0]<=16)return n.fromOp(t[0]+80)}return n.fromPush(t)},n.fromPush=function(t){if(r(Buffer.isBuffer(t)),0===t.length)return n.fromOp(u.OP_0);if(t.length<=75)return new n(t.length,t);if(t.length<=255)return new n(u.OP_PUSHDATA1,t);if(t.length<=65535)return new n(u.OP_PUSHDATA2,t);if(t.length<=4294967295)return new n(u.OP_PUSHDATA4,t);throw new Error("Pushdata size too large.")},n.fromString=function(t,e){r("string"==typeof t);const i=Buffer.from(t,e||"utf8");return n.fromData(i)},n.fromSmall=function(t){return r(o.isU8(t)&&t>=0&&t<=16),n.fromOp(0===t?0:t+80)},n.fromNum=function(t){return r(s.isScriptNum(t)),n.fromData(t.encode())},n.fromInt=function(t){return r(o.isInt(t)),0===t?n.fromOp(u.OP_0):-1===t?n.fromOp(u.OP_1NEGATE):t>=1&&t<=16?n.fromOp(t+80):n.fromNum(s.fromNumber(t))},n.fromBool=function(t){return r("boolean"==typeof t),n.fromSmall(t?1:0)},n.fromSymbol=function(t){r("string"==typeof t),r(t.length>0),o.isUpperCase(t)||(t=t.toUpperCase()),o.startsWith(t,"OP_")||(t=`OP_${t}`);const e=a.opcodes[t];if(null!=e)return n.fromOp(e);r(o.startsWith(t,"OP_0X"),"Unknown opcode."),r(7===t.length,"Unknown opcode.");const i=parseInt(t.substring(5),16);return r(o.isU8(i),"Unknown opcode."),n.fromOp(i)},n.fromReader=function(t){const e=t.readU8(),i=f[e];if(i)return i;switch(e){case u.OP_PUSHDATA1:{if(t.left()<1)return l;const i=t.readU8();if(t.left()<i)return t.seek(t.left()),l;return new n(e,t.readBytes(i))}case u.OP_PUSHDATA2:{if(t.left()<2)return t.seek(t.left()),l;const i=t.readU16();if(t.left()<i)return t.seek(t.left()),l;return new n(e,t.readBytes(i))}case u.OP_PUSHDATA4:{if(t.left()<4)return t.seek(t.left()),l;const i=t.readU32();if(t.left()<i)return t.seek(t.left()),l;return new n(e,t.readBytes(i))}default:if(t.left()<e)return t.seek(t.left()),l;return new n(e,t.readBytes(e))}},n.fromRaw=function(t){return n.fromReader(new h(t))},n.isOpcode=function(t){return t instanceof n},l=Object.freeze(new n(-1));for(let t=0;t<=255;t++){if(t>=1&&t<=78){f.push(null);continue}const e=new n(t);f.push(Object.freeze(e))}t.exports=n},function(t,e,i){"use strict";function n(){if(!(this instanceof n))return new n;this.items=[]}const r=i(0),s=i(2),o=i(4),a=i(50);n.prototype.push=function(t){return this.items.push(t)},n.prototype.getSize=function(){let t=0;t+=4;for(const e of this.items)t+=e.getSize();return t},n.prototype.toRaw=function(){const t=this.getSize(),e=new o(t);e.writeU32(this.items.length);for(const t of this.items)t.toWriter(e);return e.render()},n.prototype.fromRaw=function(t){const e=new s(t),i=e.readU32();for(let t=0;t<i;t++)this.items.push(a.fromReader(e));return this},n.fromRaw=function(t){return(new n).fromRaw(t)},n.prototype.isEmpty=function(){return 0===this.items.length},n.prototype.commit=function(){const t=this.toRaw();return this.items.length=0,t},n.prototype.apply=function(t,e){const i=this.items.pop();r(i),t.addEntry(e,i)},t.exports=n},function(t,e,i){"use strict";function n(t){const e=n.getBackend(t),i=e.backend,r=e.location;return new s(i,r,t)}const r=i(0),s=i(196),o=i(197);n.getName=function(t){let e,i;switch(t||(t="memory"),t){case"ldb":case"leveldb":case"leveldown":e="leveldown",i="ldb";break;case"rdb":case"rocksdb":case"rocksdown":e="rocksdown",i="rdb";break;case"mdb":case"lmdb":e="lmdb",i="mdb";break;case"mem":case"memory":case"rbt":e="memory",i="mem";break;default:e=t,i="db"}return[e,i]},n.getBackend=function(t){const[e,i]=n.getName(t.db),s=o.get(e);let a=t.location;return"string"!=typeof a&&(r("memory"===e,"Location required."),a="memory"),{backend:s,location:`${a}.${i}`}},t.exports=n},function(t,e,i){"use strict";e.lockFlags={VERIFY_SEQUENCE:1,MEDIAN_TIME_PAST:2},e.lockFlags.MANDATORY_LOCKTIME_FLAGS=0,e.lockFlags.STANDARD_LOCKTIME_FLAGS=0|e.lockFlags.VERIFY_SEQUENCE|e.lockFlags.MEDIAN_TIME_PAST,e.thresholdStates={DEFINED:0,STARTED:1,LOCKED_IN:2,ACTIVE:3,FAILED:4},e.flags={VERIFY_NONE:0,VERIFY_POW:1,VERIFY_BODY:2},e.flags.DEFAULT_FLAGS=0|e.flags.VERIFY_POW|e.flags.VERIFY_BODY},function(t,e,i){"use strict";function n(){if(!(this instanceof n))return new n;this.head=null,this.tail=null,this.size=0}function r(t){this.next=null,this.prev=null,this.value=t}const s=i(0);n.prototype.reset=function(){let t,e;for(t=this.head;t;t=e)e=t.next,t.prev=null,t.next=null;s(!t),this.head=null,this.tail=null,this.size=0},n.prototype.shift=function(){const t=this.head;return t?(this.remove(t),t):null},n.prototype.unshift=function(t){return this.insert(null,t)},n.prototype.push=function(t){return this.insert(this.tail,t)},n.prototype.pop=function(){const t=this.tail;return t?(this.remove(t),t):null},n.prototype.insert=function(t,e){return!e.prev&&!e.next&&e!==this.head&&(s(!e.prev),s(!e.next),null==t?(this.head?(this.head.prev=e,e.next=this.head,this.head=e):(this.head=e,this.tail=e),this.size++,!0):(e.next=t.next,e.prev=t,t.next=e,t===this.tail&&(this.tail=e),this.size++,!0))},n.prototype.remove=function(t){return!(!t.prev&&!t.next&&t!==this.head)&&(t.prev&&(t.prev.next=t.next),t.next&&(t.next.prev=t.prev),t===this.head&&(this.head=t.next),t===this.tail&&(this.tail=t.prev||this.head),this.head||s(!this.tail),this.tail||s(!this.head),t.prev=null,t.next=null,this.size--,!0)},n.prototype.replace=function(t,e){t.prev&&(t.prev.next=e),t.next&&(t.next.prev=e),e.prev=t.prev,e.next=t.next,t.next=null,t.prev=null,this.head===t&&(this.head=e),this.tail===t&&(this.tail=e)},n.prototype.slice=function(t){const e=[];let i,n;for(null==t&&(t=-1),i=this.head;i&&(n=i.next,i.prev=null,i.next=null,this.size--,e.push(i),e.length!==t);i=n);return n?(this.head=n,n.prev=null):(this.head=null,this.tail=null),e},n.prototype.toArray=function(){const t=[];for(let e=this.head;e;e=e.next)t.push(e);return t},(e=n).List=n,e.ListItem=r,e.Item=r,t.exports=e},function(t,e,i){"use strict";function n(t){if(!(this instanceof n))return new n(t);this.uri="http://localhost:80/",this.host="localhost",this.path="/",this.port=80,this.ssl=!1,this.method="GET",this.strictSSL=!0,this.pool=!1,this.agent=m,this.type=null,this.expect=null,this.query=null,this.body=null,this.auth=null,this.limit=10<<20,this.maxRedirects=5,this.timeout=5e3,this.buffer=!1,this.headers=null,a(),t&&this.fromOptions(t)}function r(t){if(!(this instanceof r))return new r(t);h.call(this),this.options=new n(t),this.request=null,this.response=null,this.statusCode=0,this.headers=null,this.type="bin",this.redirects=0,this.timeout=null,this.finished=!1,this.onResponse=this._onResponse.bind(this),this.onData=this._onData.bind(this),this.onEnd=this._onEnd.bind(this),this.total=0,this.decoder=null,this.body=null,this.buffer=null}function s(t){return"string"==typeof t&&(t={uri:t}),t.buffer=!0,new Promise((e,i)=>{const n=new r(t);n.on("error",t=>i(t)),n.on("end",()=>e(n)),n.start(),n.end()})}function o(t){switch(t){case"json":return"application/json; charset=utf-8";case"form":return"application/x-www-form-urlencoded; charset=utf-8";case"html":return"text/html; charset=utf-8";case"xml":return"application/xml; charset=utf-8";case"js":return"application/javascript; charset=utf-8";case"css":return"text/css; charset=utf-8";case"txt":return"text/plain; charset=utf-8";case"bin":return"application/octet-stream";default:throw new Error(`Unknown type: ${t}.`)}}function a(t){u||(u=i(73)),f||(f=i(272)),l||(l=i(75)),t&&!p&&(p=i(111)),d||(d=i(167).StringDecoder)}const h=i(271).Stream,c=i(0);let u,f,l,p,d;const m="Mozilla/5.0 (Macintosh; Intel Mac OS X 10_10_1) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/41.0.2227.1 Safari/537.36";n.prototype.setURI=function(t){if(c("string"==typeof t),/:\/\//.test(t)||(t=(this.ssl?"https://":"http://")+t),t=u.parse(t),c("http:"===t.protocol||"https:"===t.protocol),this.uri=t,this.ssl="https:"===t.protocol,t.search&&(this.query=f.parse(t.search)),this.host=t.hostname,this.path=t.pathname,this.port=t.port||(this.ssl?443:80),t.auth){const e=t.auth.split(":");this.auth={username:e[0]||"",password:e[1]||""}}},n.prototype.fromOptions=function(t){"string"==typeof t&&(t={uri:t}),null!=t.ssl&&(c("boolean"==typeof t.ssl),this.ssl=t.ssl),null!=t.uri&&this.setURI(t.uri),null!=t.url&&this.setURI(t.url),null!=t.method&&(c("string"==typeof t.method),this.method=t.method.toUpperCase()),null!=t.strictSSL&&(c("boolean"==typeof t.strictSSL),this.strictSSL=t.strictSSL),null!=t.pool&&(c("boolean"==typeof t.pool),this.pool=t.pool),null!=t.agent&&(c("string"==typeof t.agent),this.agent=t.agent),null!=t.auth&&(c("object"==typeof t.auth),c("string"==typeof t.auth.username),c("string"==typeof t.auth.password),this.auth=t.auth),null!=t.query&&("string"==typeof t.query?this.query=f.stringify(t.query):(c("object"==typeof t.query),this.query=t.query)),null!=t.json&&(c("object"==typeof t.json),this.body=Buffer.from(JSON.stringify(t.json),"utf8"),this.type="json"),null!=t.form&&(c("object"==typeof t.form),this.body=Buffer.from(f.stringify(t.form),"utf8"),this.type="form"),null!=t.type&&(c("string"==typeof t.type),c(o(t.type)),this.type=t.type),null!=t.expect&&(c("string"==typeof t.expect),c(o(t.expect)),this.expect=t.expect),null!=t.body&&("string"==typeof t.body?this.body=Buffer.from(t.body,"utf8"):(c(Buffer.isBuffer(t.body)),this.body=t.body)),null!=t.timeout&&(c("number"==typeof t.timeout),this.timeout=t.timeout),null!=t.limit&&(c("number"==typeof t.limit),this.limit=t.limit),null!=t.maxRedirects&&(c("number"==typeof t.maxRedirects),this.maxRedirects=t.maxRedirects),null!=t.buffer&&(c("boolean"==typeof t.buffer),this.buffer=t.buffer),null!=t.headers&&(c("object"==typeof t.headers),this.headers=t.headers)},n.prototype.isExpected=function(t){return!this.expect||this.expect===t},n.prototype.isOverflow=function(t){if(!t)return!1;if(!this.buffer)return!1;const e=parseInt(t,10);return!isFinite(e)||e>this.limit},n.prototype.getBackend=function(){return a(this.ssl),this.ssl?p:l},n.prototype.getHeaders=function(){if(this.headers)return this.headers;const t=Object.create(null);if(t["User-Agent"]=this.agent,this.type&&(t["Content-Type"]=o(this.type)),this.body&&(t["Content-Length"]=this.body.length.toString(10)),this.auth){const e=`${this.auth.username}:${this.auth.password}`,i=Buffer.from(e,"utf8");t.Authorization=`Basic ${i.toString("base64")}`}return t},n.prototype.toHTTP=function(){let t="";return this.query&&(t="?"+f.stringify(this.query)),{method:this.method,host:this.host,port:this.port,path:this.path+t,headers:this.getHeaders(),agent:!!this.pool&&null,rejectUnauthorized:this.strictSSL}},Object.setPrototypeOf(r.prototype,h.prototype),r.prototype.startTimeout=function(){this.options.timeout&&(this.timeout=setTimeout(()=>{this.finish(new Error("Request timed out."))},this.options.timeout))},r.prototype.stopTimeout=function(){null!=this.timeout&&(clearTimeout(this.timeout),this.timeout=null)},r.prototype.cleanup=function(){this.stopTimeout(),this.request&&(this.request.removeListener("response",this.onResponse),this.request.removeListener("error",this.onEnd),this.request.addListener("error",()=>{})),this.response&&(this.response.removeListener("data",this.onData),this.response.removeListener("error",this.onEnd),this.response.removeListener("end",this.onEnd),this.response.addListener("error",()=>{}))},r.prototype.close=function(){if(this.request)try{this.request.abort()}catch(t){}if(this.response)try{this.response.destroy()}catch(t){}this.cleanup(),this.request=null,this.response=null},r.prototype.destroy=function(){this.close()},r.prototype.start=function(){const t=this.options.getBackend(),e=this.options.toHTTP();this.startTimeout(),this.request=t.request(e),this.response=null,this.options.body&&this.request.write(this.options.body),this.request.on("response",this.onResponse),this.request.on("error",this.onEnd)},r.prototype.write=function(t){return this.request.write(t)},r.prototype.end=function(){return this.request.end()},r.prototype.finish=function(t){if(!this.finished){if(this.finished=!0,t)return this.destroy(),void this.emit("error",t);if(this.cleanup(),this.options.buffer)switch(c(null!=this.buffer),this.type){case"bin":this.body=Buffer.concat(this.buffer),this.buffer=null;break;case"json":{const t=this.buffer.trim();if(this.buffer=null,0===t.length)break;let e;try{e=JSON.parse(t)}catch(t){return void this.emit("error",t)}if(!e||"object"!=typeof e)return void this.emit("error",new Error("JSON body is a non-object."));this.body=e;break}case"form":{const t=this.buffer;this.buffer=null;try{this.body=f.parse(t)}catch(t){return void this.emit("error",t)}break}default:this.body=this.buffer,this.buffer=null}this.emit("end"),this.emit("close")}},r.prototype._onResponse=function(t){const e=t.headers.location;if(e)return++this.redirects>this.options.maxRedirects?void this.finish(new Error("Too many redirects.")):(this.close(),this.options.setURI(e),this.start(),void this.end());const i=function(t){switch(t=t||"",t=t.split(";")[0],t=t.toLowerCase(),t=t.trim()){case"text/x-json":case"application/json":return"json";case"application/x-www-form-urlencoded":return"form";case"text/html":case"application/xhtml+xml":return"html";case"text/xml":case"application/xml":return"xml";case"text/javascript":case"application/javascript":return"js";case"text/css":return"css";case"text/plain":return"txt";case"application/octet-stream":default:return"bin"}}(t.headers["content-type"]);if(!this.options.isExpected(i))return void this.finish(new Error("Wrong content-type for response."));const n=t.headers["content-length"];this.options.isOverflow(n)?this.finish(new Error("Response exceeded limit.")):(this.response=t,this.statusCode=t.statusCode,this.headers=t.headers,this.type=i,this.response.on("data",this.onData),this.response.on("error",this.onEnd),this.response.on("end",this.onEnd),this.emit("headers",t.headers),this.emit("type",this.type),this.emit("response",t),this.options.buffer&&("bin"!==this.type?(this.decoder=new d("utf8"),this.buffer=""):this.buffer=[]))},r.prototype._onData=function(t){if(this.total+=t.length,this.emit("data",t),this.options.buffer){if(this.options.limit&&this.total>this.options.limit)return void this.finish(new Error("Response exceeded limit."));if(this.decoder)return void(this.buffer+=this.decoder.write(t));this.buffer.push(t)}},r.prototype._onEnd=function(t){this.finish(t)},s.stream=function(t){const e=new r(t);return e.start(),e},t.exports=s},function(t,e,i){"use strict";e.version="v1.0.0-beta.1",e.url="https://github.com/park-alter/wmcc-core"},function(t,e,i){"use strict";const n=i(0),r=(i(44),i(58));t.exports=function(t,e,i,s){let o=i;for(t.writeUInt32LE(o,76,!0);o<=s;){if(function(t,e){n(t.length===e.length);for(let i=t.length-1;i>=0;i--){if(t[i]<e[i])return-1;if(t[i]>e[i])return 1}return 0}(function(t){return r.digest(t)}(t),e)<=0)return o;o++,t.writeUInt32LE(o,76,!0)}return-1}},function(t,e,i){"use strict";function n(t){if(!(this instanceof n))return new n(t);d.call(this),this.keyNonce=null,this.ids=[],this.ptx=[],this.available=[],this.idMap=new Map,this.count=0,this.sipKey=null,this.totalTX=0,this.now=0,t&&this.fromOptions(t)}function r(t){if(!(this instanceof r))return new r(t);this.hash=u.NULL_HASH,this.indexes=[],t&&this.fromOptions(t)}function s(t){if(!(this instanceof s))return new s(t);this.hash=u.NULL_HASH,this.txs=[],t&&this.fromOptions(t)}const o=i(0),a=i(1),h=i(2),c=i(4),u=i(3),f=i(7),l=i(5),p=i(165).siphash256,d=i(69),m=i(15),g=i(37),y=i(51);Object.setPrototypeOf(n.prototype,d.prototype),n.prototype.fromOptions=function(t){return this.parseOptions(t),o(Buffer.isBuffer(t.keyNonce)),o(Array.isArray(t.ids)),o(Array.isArray(t.ptx)),this.keyNonce=t.keyNonce,this.ids=t.ids,this.ptx=t.ptx,t.available&&(this.available=t.available),t.idMap&&(this.idMap=t.idMap),t.count&&(this.count=t.count),null!=t.totalTX&&(this.totalTX=t.totalTX),this.sipKey=this.getKey(),this},n.fromOptions=function(t){return(new n).fromOptions(t)},n.prototype.verifyBody=function(){return!0},n.prototype.fromRaw=function(t){const e=new h(t);this.readHead(e),this.keyNonce=e.readBytes(8),this.sipKey=this.getKey();const i=e.readVarint();this.totalTX+=i;for(let t=0;t<i;t++){const t=e.readU32(),i=e.readU16();this.ids.push(4294967296*i+t)}const n=e.readVarint();this.totalTX+=n;for(let t=0;t<n;t++){const t=e.readVarint();o(t<=65535),o(t<this.totalTX);const i=m.fromReader(e);this.ptx.push([t,i])}return this},n.fromRaw=function(t,e){return"string"==typeof t&&(t=Buffer.from(t,e)),(new n).fromRaw(t)},n.prototype.toRaw=function(){return this.frameRaw(!0)},n.prototype.toNormal=function(){return this.frameRaw(!1)},n.prototype.toWriter=function(t){return this.writeRaw(t,!0)},n.prototype.toNormalWriter=function(t){return this.writeRaw(t,!1)},n.prototype.frameRaw=function(t){const e=this.getSize(t);return this.writeRaw(new c(e),t).render()},n.prototype.getSize=function(t){let e=0;e+=80,e+=8,e+=u.sizeVarint(this.ids.length),e+=6*this.ids.length,e+=u.sizeVarint(this.ptx.length);for(const[i,n]of this.ptx)e+=u.sizeVarint(i),e+=t?n.getSize():n.getBaseSize();return e},n.prototype.writeRaw=function(t,e){this.writeHead(t),t.writeBytes(this.keyNonce),t.writeVarint(this.ids.length);for(const e of this.ids){const i=e%4294967296,n=(e-i)/4294967296;o(n<=65535),t.writeU32(i),t.writeU16(n)}t.writeVarint(this.ptx.length);for(const[i,n]of this.ptx)t.writeVarint(i),e?n.toWriter(t):n.toNormalWriter(t);return t},n.prototype.toRequest=function(){return r.fromCompact(this)},n.prototype.fillMempool=function(t,e){if(this.count===this.totalTX)return!0;const i=new Set;for(const{tx:n}of e.map.values()){let e=n.hash();t&&(e=n.witnessHash());const r=this.sid(e),s=this.idMap.get(r);if(null!=s)if(i.has(s))this.available[s]=null,this.count--;else if(this.available[s]=n,i.add(s),this.count++,this.count===this.totalTX)return!0}return!1},n.prototype.fillMissing=function(t){let e=0;for(let i=0;i<this.available.length;i++)if(!this.available[i]){if(e>=t.txs.length)return!1;this.available[i]=t.txs[e++]}return e===t.txs.length},n.prototype.sid=function(t){"string"==typeof t&&(t=Buffer.from(t,"hex"));const[e,i]=p(t,this.sipKey);return 4294967296*(65535&e)+(i>>>0)},n.prototype.hasIndex=function(t){return null!=this.available[t]},n.prototype.getKey=function(){const t=Buffer.concat([this.toHead(),this.keyNonce]);return l.sha256(t).slice(0,16)},n.prototype.init=function(){if(0===this.totalTX)throw new Error("Empty vectors.");if(this.totalTX>f.MAX_BLOCK_SIZE/10)throw new Error("Compact block too big.");if(this.totalTX>(f.MAX_BLOCK_SIZE-81)/60)throw new Error("Compact block too big.");for(let t=0;t<this.totalTX;t++)this.available.push(null);let t=-1,e=0;for(let e=0;e<this.ptx.length;e++){const[i,n]=this.ptx[e];o((t+=i+1)<=65535),o(t<=this.ids.length+e),this.available[t]=n,this.count++}for(let t=0;t<this.ids.length;t++){const i=this.ids[t];for(;this.available[t+e];)e++;if(this.idMap.has(i))return!1;this.idMap.set(i,t+e)}return!0},n.prototype.toBlock=function(){const t=new y;t.version=this.version,t.prevBlock=this.prevBlock,t.merkleRoot=this.merkleRoot,t.time=this.time,t.bits=this.bits,t.nonce=this.nonce,t._hash=this._hash,t._hhash=this._hhash;for(const e of this.available)o(e,"Compact block is not full."),t.txs.push(e);return t},n.prototype.fromBlock=function(t,e,i){this.version=t.version,this.prevBlock=t.prevBlock,this.merkleRoot=t.merkleRoot,this.time=t.time,this.bits=t.bits,this.nonce=t.nonce,this.totalTX=t.txs.length,this._hash=t._hash,this._hhash=t._hhash,i||(i=a.nonce()),this.keyNonce=i,this.sipKey=this.getKey();for(let i=1;i<t.txs.length;i++){const n=t.txs[i];let r=n.hash();e&&(r=n.witnessHash());const s=this.sid(r);this.ids.push(s)}return this.ptx.push([0,t.txs[0]]),this},n.fromBlock=function(t,e,i){return(new n).fromBlock(t,e,i)},n.prototype.toHeaders=function(){return g.fromBlock(this)},r.prototype.fromOptions=function(t){return this.hash=t.hash,t.indexes&&(this.indexes=t.indexes),this},r.fromOptions=function(t){return(new r).fromOptions(t)},r.prototype.fromCompact=function(t){this.hash=t.hash("hex");for(let e=0;e<t.available.length;e++)t.available[e]||this.indexes.push(e);return this},r.fromCompact=function(t){return(new r).fromCompact(t)},r.prototype.fromReader=function(t){this.hash=t.readHash("hex");const e=t.readVarint();for(let i=0;i<e;i++){const e=t.readVarint();o(e<=65535),this.indexes.push(e)}let i=0;for(let t=0;t<e;t++){let e=this.indexes[t];o((e+=i)<=65535),this.indexes[t]=e,i=e+1}return this},r.prototype.fromRaw=function(t){return this.fromReader(new h(t))},r.fromReader=function(t){return(new r).fromReader(t)},r.fromRaw=function(t){return(new r).fromRaw(t)},r.prototype.getSize=function(){let t=0;t+=32,t+=u.sizeVarint(this.indexes.length);for(let e=0;e<this.indexes.length;e++){let i=this.indexes[e];e>0&&(i-=this.indexes[e-1]+1),t+=u.sizeVarint(i)}return t},r.prototype.toWriter=function(t){t.writeHash(this.hash),t.writeVarint(this.indexes.length);for(let e=0;e<this.indexes.length;e++){let i=this.indexes[e];e>0&&(i-=this.indexes[e-1]+1),t.writeVarint(i)}return t},r.prototype.toRaw=function(){const t=this.getSize();return this.toWriter(new c(t)).render()},s.prototype.fromOptions=function(t){return this.hash=t.hash,t.txs&&(this.txs=t.txs),this},s.fromOptions=function(t){return(new s).fromOptions(t)},s.prototype.fromReader=function(t){this.hash=t.readHash("hex");const e=t.readVarint();for(let i=0;i<e;i++)this.txs.push(m.fromReader(t));return this},s.prototype.fromRaw=function(t){return this.fromReader(new h(t))},s.fromReader=function(t){return(new s).fromReader(t)},s.fromRaw=function(t){return(new s).fromRaw(t)},s.prototype.fromBlock=function(t,e){this.hash=e.hash;for(const i of e.indexes){if(i>=t.txs.length)break;this.txs.push(t.txs[i])}return this},s.fromBlock=function(t,e){return(new s).fromBlock(t,e)},s.prototype.toRaw=function(){return this.frameRaw(!0)},s.prototype.toNormal=function(){return this.frameRaw(!1)},s.prototype.toWriter=function(t){return this.writeRaw(t,!0)},s.prototype.toNormalWriter=function(t){return this.writeRaw(t,!1)},s.prototype.getSize=function(t){let e=0;e+=32,e+=u.sizeVarint(this.txs.length);for(const i of this.txs)e+=t?i.getSize():i.getBaseSize();return e},s.prototype.writeRaw=function(t,e){t.writeHash(this.hash),t.writeVarint(this.txs.length);for(const i of this.txs)e?i.toWriter(t):i.toNormalWriter(t);return t},s.prototype.frameRaw=function(t){const e=this.getSize(t);return this.writeRaw(new c(e),t).render()},e.CompactBlock=n,e.TXRequest=r,e.TXResponse=s},function(t,e,i){"use strict";function n(t){const e=setTimeout(()=>{t(new Error("DNS request timed out.")),t=null},5e3);return function(i,n){t&&(clearTimeout(e),t(i,n))}}const r=i(304),s=i(183),o={family:4,hints:r.ADDRCONFIG|r.V4MAPPED,all:!0};e.resolve=function(t,e){return e?s.resolve(e,t):new Promise((e,i)=>{r.resolve(t,"A",n((t,n)=>{t?i(t):0!==n.length?e(n):i(new Error("No DNS results."))}))})},e.lookup=function(t,e){return e?s.resolve(e,t):new Promise((e,i)=>{r.lookup(t,o,n((t,n)=>{if(t)return void i(t);if(0===n.length)return void i(new Error("No DNS results."));const r=[];for(const t of n)r.push(t.address);e(r)}))})}},function(t,e,i){"use strict";function n(t){const e=t>>>25;return(33554431&t)<<5^996825010&-(e>>0&1)^642813549&-(e>>1&1)^513874426&-(e>>2&1)^1027748829&-(e>>3&1)^705979059&-(e>>4&1)}function r(t,e){let i,r=1;for(i=0;i<t.length;i++){const e=t.charCodeAt(i);if(e>>5==0)throw new Error("Invalid bech32 character.");r=n(r)^e>>5}if(i+7+e.length>90)throw new Error("Invalid bech32 data length.");r=n(r);let s="";for(let e=0;e<t.length;e++){const i=t.charCodeAt(e);r=n(r)^31&i,s+=t[e]}s+="1";for(let t=0;t<e.length;t++){const i=e[t];if(i>>5!=0)throw new Error("Invalid bech32 value.");r=n(r)^i,s+=f[i]}for(let t=0;t<6;t++)r=n(r);r^=1;for(let t=0;t<6;t++)s+=f[r>>>5*(5-t)&31];return s}function s(t){let e=0;if(t.length<8||t.length>90)throw new Error("Invalid bech32 string length.");for(;e<t.length&&"1"!==t[t.length-1-e];)e++;const i=t.length-(1+e);if(i<1||e<6)throw new Error("Invalid bech32 data length.");e-=6;const r=Buffer.allocUnsafe(e);let s=1,o=!1,a=!1,h="";for(let e=0;e<i;e++){let i=t.charCodeAt(e);if(i<33||i>126)throw new Error("Invalid bech32 character.");i>=97&&i<=122?o=!0:i>=65&&i<=90&&(a=!0,i=i-65+97),h+=String.fromCharCode(i),s=n(s)^i>>5}s=n(s);let c;for(c=0;c<i;c++)s=n(s)^31&t.charCodeAt(c);for(c++;c<t.length;){const e=t.charCodeAt(c),h=128&e?-1:l[e];if(e>=97&&e<=122?o=!0:e>=65&&e<=90&&(a=!0),-1===h)throw new Error("Invalid bech32 character.");s=n(s)^h,c+6<t.length&&(r[c-(1+i)]=h),c++}if(o&&a)throw new Error("Invalid bech32 casing.");if(1!==s)throw new Error("Invalid bech32 checksum.");return[h,r.slice(0,e)]}function o(t,e,i,n,r,s){const o=(1<<n)-1;let a=0,h=0,c=0;-1!==r&&(e[c++]=r);for(let r=s;r<t.length;r++){const s=t[r];if(s>>i!=0)throw new Error("Invalid bech32 bits.");for(a=a<<i|s,h+=i;h>=n;)h-=n,e[c++]=a>>>h&o}if(-1!==r)h>0&&(e[c++]=a<<n-h&o);else if(h>=i||a<<n-h&o)throw new Error("Invalid bech32 bits.");return e.slice(0,c)}function a(t,e,i){const n=u;if(e<0||e>16)throw new Error("Invalid bech32 version.");if(i.length<2||i.length>40)throw new Error("Invalid bech32 data length.");return r(t,o(i,n,8,5,e,0))}function h(t){const[e,i]=s(t);if(0===i.length||i.length>65)throw new Error("Invalid bech32 data length.");if(i[0]>16)throw new Error("Invalid bech32 version.");const n=i[0],r=o(i,i,5,8,-1,1);if(r.length<2||r.length>40)throw new Error("Invalid bech32 data length.");return new function(t,e,i){this.hrp=t,this.version=e,this.hash=i}(e,n,r)}const c=i(18).binding,u=Buffer.allocUnsafe(65),f="qpzry9x8gf2tvdw0s3jn54khce6mua7l",l=[-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,15,-1,10,17,21,20,26,30,7,5,-1,-1,-1,-1,-1,-1,-1,29,-1,24,13,25,9,8,23,-1,18,22,31,27,19,-1,1,0,3,16,11,28,12,14,6,4,2,-1,-1,-1,-1,-1,-1,29,-1,24,13,25,9,8,23,-1,18,22,31,27,19,-1,1,0,3,16,11,28,12,14,6,4,2,-1,-1,-1,-1,-1];c&&(a=c.toBech32),c&&(h=c.fromBech32),e.deserialize=s,e.serialize=r,e.convert=o,e.encode=a,e.decode=h},function(t,e,i){"use strict";const n=i(0),r=e;r.parse=function(t){const e=[];let i,r="";for(;t.length;){let s;if(s=/^-----BEGIN ([^\-]+)-----/.exec(t))t=t.substring(s[0].length),i=s[1];else if(s=/^-----END ([^\-]+)-----/.exec(t)){t=t.substring(s[0].length),n(i===s[1],"Tag mismatch.");const o=i.split(" ")[0].toLowerCase(),a=Buffer.from(r,"base64");e.push({tag:i,type:o,data:a}),r="",i=null}else if(s=/^[a-zA-Z0-9\+=\/]+/.exec(t))t=t.substring(s[0].length),r+=s[0];else{if(!(s=/^\s+/.exec(t)))throw new Error("PEM parse error.");t=t.substring(s[0].length)}}return n(0!==e.length,"PEM parse error."),n(!i,"Un-ended tag."),n(0===r.length,"Trailing data."),e},r.decode=function(t){const e=r.parse(t),i=e[0],n=e[1];let s=null;n&&-1!==n.tag.indexOf("PARAMETERS")&&(s=n.data);let o=null;switch(i.type){case"dsa":o="dsa";break;case"rsa":o="rsa";break;case"ec":o="ecdsa"}return{type:i.type,alg:o,data:i.data,params:s}},r.encode=function(t,e,i){let n="";i&&(e+=" "+i),e=e.toUpperCase(),t=t.toString("base64");for(let e=0;e<t.length;e+=64)n+=t.slice(e,e+64)+"\n";return""+`-----BEGIN ${e}-----\n`+n+`-----END ${e}-----\n`}},function(t,e,i){"use strict";function n(){if(!(this instanceof n))return new n;this.outputs=new Map}const r=i(0),s=i(50);n.prototype.add=function(t,e){return r(t>>>0===t),r(e),this.outputs.set(t,e),e},n.prototype.addOutput=function(t,e){return this.add(t,s.fromOutput(e))},n.prototype.addIndex=function(t,e,i){return this.add(e,s.fromTX(t,e,i))},n.prototype.addCoin=function(t){return this.add(t.index,s.fromCoin(t))},n.prototype.has=function(t){return this.outputs.has(t)},n.prototype.isUnspent=function(t){const e=this.outputs.get(t);return!(!e||e.spent)},n.prototype.get=function(t){return this.outputs.get(t)||null},n.prototype.getOutput=function(t){const e=this.outputs.get(t);return e?e.output:null},n.prototype.getCoin=function(t){const e=this.outputs.get(t.index);return e?e.toCoin(t):null},n.prototype.spend=function(t){const e=this.get(t);return!e||e.spent?null:(e.spent=!0,e)},n.prototype.remove=function(t){const e=this.get(t);return e?(this.outputs.delete(t),e):null},n.prototype.isEmpty=function(){return 0===this.outputs.size},n.prototype.fromTX=function(t,e){r("number"==typeof e);for(let i=0;i<t.outputs.length;i++){if(t.outputs[i].script.isUnspendable())continue;const n=s.fromTX(t,i,e);this.outputs.set(i,n)}return this},n.fromTX=function(t,e){return(new n).fromTX(t,e)},t.exports=n},function(t,e,i){"use strict";function n(t,e){const i=t.getPubkeyhash(!0);if(i)return e.writeU8(0),e.writeBytes(i),e;const n=t.getScripthash();if(n)return e.writeU8(1),e.writeBytes(n),e;const r=t.getPubkey(!0);if(r&&s(r)){const t=function(t){let e;switch(t[0]){case 2:case 3:e=t;break;case 4:(e=a.publicKeyConvert(t,!0))[0]=4|1&t[64];break;default:throw new Error("Bad point format.")}return o(33===e.length),e}(r);return e.writeBytes(t),e}return e.writeVarint(t.raw.length+u),e.writeBytes(t.raw),e}function r(t,e){switch(e.readU8()){case 0:{const i=e.readBytes(20,!0);t.fromPubkeyhash(i);break}case 1:{const i=e.readBytes(20,!0);t.fromScripthash(i);break}case 2:case 3:case 4:case 5:{e.offset-=1;const i=function(t){const e=t[0];switch(o(33===t.length),e){case 2:case 3:return t;case 4:t[0]=2;break;case 5:t[0]=3;break;default:throw new Error("Bad point format.")}const i=a.publicKeyConvert(t,!1);return t[0]=e,i}(e.readBytes(33,!0));t.fromPubkey(i);break}default:{e.offset-=1;const i=e.readVarint()-u;if(i>c.MAX_SCRIPT_SIZE)t.fromNulldata(f),e.seek(i);else{const n=e.readBytes(i);t.fromRaw(n)}break}}return t}function s(t){if(0===t.length)return!1;switch(t[0]){case 2:case 3:return 33===t.length;case 4:return 65===t.length&&a.publicKeyVerify(t);default:return!1}}const o=i(0),a=i(12),h=i(3),c=i(7),u=6,f=Buffer.alloc(0);e.pack=function(t,e){return e.writeVarint(t.value),n(t.script,e),e},e.unpack=function(t,e){return t.value=e.readVarint(),r(t.script,e),t},e.size=function(t){let e=0;return e+=h.sizeVarint(t.value),e+=function(t){if(t.isPubkeyhash(!0))return 21;if(t.isScripthash())return 21;const e=t.getPubkey(!0);if(e&&s(e))return 33;let i=0;return i+=h.sizeVarint(t.raw.length+u),i+=t.raw.length}(t.script)}},function(t,e,i){"use strict";function n(t){if(!(this instanceof n))return new n(t);this.hash=c.NULL_HASH,this.version=1,this.prevBlock=c.NULL_HASH,this.merkleRoot=c.NULL_HASH,this.time=0,this.bits=0,this.nonce=0,this.height=0,this.chainwork=d,t&&this.fromOptions(t)}const r=i(0),s=i(26),o=i(7),a=i(1),h=(i(5),i(58)),c=i(3),u=i(2),f=i(4),l=i(37),p=i(36),d=new s(0);n.MAX_CHAINWORK=new s(1).ushln(256),n.prototype.fromOptions=function(t){return r(t,"Block data is required."),r("string"==typeof t.hash),r(a.isU32(t.version)),r("string"==typeof t.prevBlock),r("string"==typeof t.merkleRoot),r(a.isU32(t.time)),r(a.isU32(t.bits)),r(a.isU32(t.nonce)),r(a.isU32(t.height)),r(!t.chainwork||s.isBN(t.chainwork)),this.hash=t.hash,this.version=t.version,this.prevBlock=t.prevBlock,this.merkleRoot=t.merkleRoot,this.time=t.time,this.bits=t.bits,this.nonce=t.nonce,this.height=t.height,this.chainwork=t.chainwork||d,this},n.fromOptions=function(t,e){return(new n).fromOptions(t,e)},n.prototype.getProof=function(){const t=o.fromCompact(this.bits);return t.isNeg()||0===t.cmpn(0)?new s(0):n.MAX_CHAINWORK.div(t.iaddn(1))},n.prototype.getChainwork=function(t){const e=this.getProof();return t?e.iadd(t.chainwork):e},n.prototype.isGenesis=function(){return this.prevBlock===c.NULL_HASH},n.prototype.hasUnknown=function(t){return(this.version&o.VERSION_TOP_MASK)>>>0===o.VERSION_TOP_BITS&&0!=(this.version&t.unknownBits)},n.prototype.hasBit=function(t){return o.hasBit(this.version,t)},n.prototype.rhash=function(){return a.revHex(this.hash)},n.prototype.fromBlock=function(t,e){return this.hash=t.hash("hex"),this.version=t.version,this.prevBlock=t.prevBlock,this.merkleRoot=t.merkleRoot,this.time=t.time,this.bits=t.bits,this.nonce=t.nonce,this.height=e?e.height+1:0,this.chainwork=this.getChainwork(e),this},n.fromBlock=function(t,e){return(new n).fromBlock(t,e)},n.prototype.toRaw=function(){const t=new f(116);return t.writeU32(this.version),t.writeHash(this.prevBlock),t.writeHash(this.merkleRoot),t.writeU32(this.time),t.writeU32(this.bits),t.writeU32(this.nonce),t.writeU32(this.height),t.writeBytes(this.chainwork.toArrayLike(Buffer,"le",32)),t.render()},n.prototype.fromRaw=function(t){const e=new u(t,!0),i=h.digest(e.readBytes(80));return e.seek(-80),this.hash=i.toString("hex"),this.version=e.readU32(),this.prevBlock=e.readHash("hex"),this.merkleRoot=e.readHash("hex"),this.time=e.readU32(),this.bits=e.readU32(),this.nonce=e.readU32(),this.height=e.readU32(),this.chainwork=new s(e.readBytes(32),"le"),this},n.fromRaw=function(t){return(new n).fromRaw(t)},n.prototype.toJSON=function(){return{hash:a.revHex(this.hash),version:this.version,prevBlock:a.revHex(this.prevBlock),merkleRoot:a.revHex(this.merkleRoot),time:this.time,bits:this.bits,nonce:this.nonce,height:this.height,chainwork:this.chainwork.toString("hex",64)}},n.prototype.fromJSON=function(t){return r(t,"Block data is required."),r("string"==typeof t.hash),r(a.isU32(t.version)),r("string"==typeof t.prevBlock),r("string"==typeof t.merkleRoot),r(a.isU32(t.time)),r(a.isU32(t.bits)),r(a.isU32(t.nonce)),r("string"==typeof t.chainwork),this.hash=a.revHex(t.hash),this.version=t.version,this.prevBlock=a.revHex(t.prevBlock),this.merkleRoot=a.revHex(t.merkleRoot),this.time=t.time,this.bits=t.bits,this.nonce=t.nonce,this.height=t.height,this.chainwork=new s(t.chainwork,"hex"),this},n.fromJSON=function(t){return(new n).fromJSON(t)},n.prototype.toHeaders=function(){return l.fromEntry(this)},n.prototype.toInv=function(){return new p(p.types.BLOCK,this.hash)},n.prototype.inspect=function(){const t=this.toJSON();return t.version=a.hex32(t.version),t},n.isChainEntry=function(t){return t instanceof n},t.exports=n},function(t,e,i){"use strict";function n(t){if(!(this instanceof n))return new n(t);c.call(this),this.options=new r(t),this.network=this.options.network,this.logger=this.options.logger.context("chain"),this.workers=this.options.workers,this.db=new l(this.options),this.locker=new g(!0),this.invalid=new y(100),this.state=new s,this.tip=new w,this.height=-1,this.synced=!1,this.orphanMap=new Map,this.orphanPrev=new Map}function r(t){if(!(this instanceof r))return new r(t);this.network=u.primary,this.logger=f.global,this.workers=null,this.prefix=null,this.location=null,this.db="memory",this.maxFiles=64,this.cacheSize=32<<20,this.compression=!0,this.bufferKeys=l.layout.binary,this.spv=!1,this.bip91=!1,this.bip148=!1,this.prune=!1,this.indexTX=!0,this.indexAddress=!0,this.forceFlags=!1,this.coinCache=0,this.entryCache=5e3,this.maxOrphans=20,this.checkpoints=!0,t&&this.fromOptions(t)}function s(){if(!(this instanceof s))return new s;this.flags=v.flags.MANDATORY_VERIFY_FLAGS,this.flags&=~v.flags.VERIFY_P2SH,this.lockFlags=p.lockFlags.MANDATORY_LOCKTIME_FLAGS,this.bip34=!1,this.bip91=!1,this.bip148=!1}function o(t,e){return t-e}const a=i(0),h=i(33),c=i(30),u=i(6),f=i(34),l=i(160),p=i(93),d=i(7),m=i(1),g=i(23),y=i(57),w=i(104),b=i(29),v=i(8),{VerifyError:k}=i(107),S=i(16),E=p.thresholdStates;Object.setPrototypeOf(n.prototype,c.prototype),n.MEDIAN_TIMESPAN=11,n.prototype._open=async function(){this.logger.info("Chain is loading."),this.options.checkpoints&&this.logger.info("Checkpoints are enabled."),this.options.coinCache&&this.logger.info("Coin cache is enabled."),this.options.bip91&&this.logger.warning("BIP91 enabled. Segsignal will be enforced."),this.options.bip148&&this.logger.warning("BIP148 enabled. UASF will be enforced."),await this.db.open();const t=await this.db.getTip();a(t),this.tip=t,this.height=t.height,this.logger.info("Chain Height: %d",t.height),this.logger.memory();const e=await this.getDeploymentState();this.setDeploymentState(e),this.logger.memory(),this.emit("tip",t),this.maybeSync()},n.prototype._close=function(){return this.db.close()},n.prototype.verifyContext=async function(t,e,i){const n=await this.verify(t,e,i);if(this.options.spv){return[new b,n]}if(this.isHistorical(e)){return[await this.updateInputs(t,e),n]}n.hasBIP34()||await this.verifyDuplicates(t,e);return[await this.verifyInputs(t,e,n),n]},n.prototype.verifyBlock=async function(t){const e=await this.locker.lock();try{return await this._verifyBlock(t)}finally{e()}},n.prototype._verifyBlock=async function(t){const e=p.flags.DEFAULT_FLAGS&~p.flags.VERIFY_POW;return await this.verifyContext(t,this.tip,e)},n.prototype.isMainHash=function(t){return this.db.isMainHash(t)},n.prototype.isMainChain=function(t){return this.db.isMainChain(t)},n.prototype.getAncestor=function(t,e){return this.db.getAncestor(t,e)},n.prototype.getPrevious=function(t){return this.db.getPrevious(t)},n.prototype.getPrevCache=function(t){return this.db.getPrevCache(t)},n.prototype.getNext=function(t){return this.db.getNext(t)},n.prototype.getNextEntry=function(t){return this.db.getNextEntry(t)},n.prototype.getMedianTime=async function(t,e){let i=n.MEDIAN_TIMESPAN;const r=[];null!=e&&(r.push(e),i-=1);let s=t;for(let t=0;t<i&&s;t++){r.push(s.time);const t=this.getPrevCache(s);s=t||await this.getPrevious(s)}return r.sort(o),r[r.length>>>1]},n.prototype.isHistorical=function(t){return!!(this.options.checkpoints&&t.height+1<=this.network.lastCheckpoint)},n.prototype.verify=async function(t,e,i){if(a("number"==typeof i),t.prevBlock!==e.hash)throw new k(t,"invalid","bad-prevblk",0);const n=t.hash("hex");if(!this.verifyCheckpoint(e,n))throw new k(t,"checkpoint","checkpoint mismatch",100);if(this.isHistorical(e)){if(this.options.spv)return this.state;if(!t.hasWitness()&&!t.getCommitmentHash())return new s;i&=~p.flags.VERIFY_BODY}if(i&p.flags.VERIFY_BODY){const[e,i,n]=t.checkBody();if(!e)throw new k(t,"invalid",i,n,!0)}const r=await this.getTarget(t.time,e);if(t.bits!==r)throw new k(t,"invalid","bad-diffbits",100);if(this.options.spv)return this.state;const o=await this.getMedianTime(e);if(t.time<=o)throw new k(t,"invalid","time-too-old",0);if(t.time>this.network.now()+7200)throw new k(t,"invalid","time-too-new",0,!0);const h=e.height+1;if(t.version<2&&h>=this.network.block.bip34height)throw new k(t,"obsolete","bad-version",0);if(t.version<3&&h>=this.network.block.bip66height)throw new k(t,"obsolete","bad-version",0);if(t.version<4&&h>=this.network.block.bip65height)throw new k(t,"obsolete","bad-version",0);const c=await this.getDeployments(t.time,e);if(c.hasBIP91()||c.hasBIP148()){const{segwit:e}=this.network.deployments;if(!d.hasBit(t.version,e.bit))throw new k(t,"invalid","bad-no-segwit",0)}const u=c.hasMTP()?o:t.time;for(const e of t.txs)if(!e.isFinal(h,u))throw new k(t,"invalid","bad-txns-nonfinal",10);if(c.hasBIP34()&&t.getCoinbaseHeight()!==h)throw new k(t,"invalid","bad-cb-height",100);let f=null;if(c.hasWitness()&&(f=t.getCommitmentHash())){if(!t.getWitnessNonce())throw new k(t,"invalid","bad-witness-nonce-size",100,!0);if(!f.equals(t.createCommitmentHash()))throw new k(t,"invalid","bad-witness-merkle-match",100,!0)}if(!f&&t.hasWitness())throw new k(t,"invalid","unexpected-witness",100,!0);if(t.getWeight()>d.MAX_BLOCK_WEIGHT)throw new k(t,"invalid","bad-blk-weight",100);return c},n.prototype.getDeployments=async function(t,e){const i=this.network.deployments,n=e.height+1,r=new s;t>=d.BIP16_TIME&&(r.flags|=v.flags.VERIFY_P2SH),n>=this.network.block.bip34height&&(r.bip34=!0),n>=this.network.block.bip66height&&(r.flags|=v.flags.VERIFY_DERSIG),n>=this.network.block.bip65height&&(r.flags|=v.flags.VERIFY_CHECKLOCKTIMEVERIFY),await this.isActive(e,i.csv)&&(r.flags|=v.flags.VERIFY_CHECKSEQUENCEVERIFY,r.lockFlags|=p.lockFlags.VERIFY_SEQUENCE,r.lockFlags|=p.lockFlags.MEDIAN_TIME_PAST);const o=await this.getState(e,i.segwit);return o===E.ACTIVE&&(r.flags|=v.flags.VERIFY_WITNESS,r.flags|=v.flags.VERIFY_NULLDUMMY),this.options.bip91&&o===E.STARTED&&await this.isActive(e,i.segsignal)&&(r.bip91=!0),this.options.bip148&&this.network===u.mainnet&&(r.bip148=!0),r},n.prototype.setDeploymentState=function(t){this.options.checkpoints&&this.height<this.network.lastCheckpoint?this.state=t:(!this.state.hasP2SH()&&t.hasP2SH()&&this.logger.warning("P2SH has been activated."),!this.state.hasBIP34()&&t.hasBIP34()&&this.logger.warning("BIP34 has been activated."),!this.state.hasBIP66()&&t.hasBIP66()&&this.logger.warning("BIP66 has been activated."),!this.state.hasCLTV()&&t.hasCLTV()&&this.logger.warning("BIP65 has been activated."),!this.state.hasCSV()&&t.hasCSV()&&this.logger.warning("CSV has been activated."),!this.state.hasWitness()&&t.hasWitness()&&this.logger.warning("Segwit has been activated."),!this.state.hasBIP91()&&t.hasBIP91()&&this.logger.warning("BIP91 has been activated."),!this.state.hasBIP148()&&t.hasBIP148()&&this.logger.warning("BIP148 has been activated."),this.state=t)},n.prototype.verifyDuplicates=async function(t,e){for(const i of t.txs){if(!await this.hasCoins(i))continue;const n=e.height+1,r=this.network.bip30[n];if(!r||t.hash("hex")!==r)throw new k(t,"invalid","bad-txns-BIP30",100)}},n.prototype.updateInputs=async function(t,e){const i=new b,n=e.height+1,r=t.txs[0];i.addTX(r,n);for(let e=1;e<t.txs.length;e++){const r=t.txs[e];a(await i.spendInputs(this.db,r),"BUG: Spent inputs in historical data!"),i.addTX(r,n)}return i},n.prototype.verifyInputs=async function(t,e,i){const n=new b,r=e.height+1,s=this.network.halvingInterval,o=(await this.getBlock(e.hash)).getCoinreserve(),a=t.getCoinreserve();let h=0,c=0,u=!1,f=null;for(let s=0;s<t.txs.length;s++){const l=t.txs[s];if(s>0&&!await n.spendInputs(this.db,l))throw new k(t,"invalid","bad-txns-inputs-missingorspent",100);if(s>0){const e=this.findCoinreserve(l,a);if(e){if(f||!u)throw new k(t,"invalid","bad-txns-coinreserve-duplicate",100);f=e}}else u=!this.isCoinreserveEquals(a,o,r);if(s>0&&l.version>=2){if(!await this.verifyLocks(e,l,n,i.lockFlags))throw new k(t,"invalid","bad-txns-nonfinal",100)}if((h+=l.getSigopsCost(n,i.flags))>d.MAX_BLOCK_SIGOPS_COST)throw new k(t,"invalid","bad-blk-sigops",100);if(s>0){const[e,i,s]=l.checkInputs(n,r);if(-1===e)throw new k(t,"invalid",i,s);if((c+=e)>d.getMaxMoney(r))throw new k(t,"invalid","bad-cb-amount",100)}n.addTX(l,r)}if(u||(f=[a]),!f)throw new k(t,"invalid","bad-txns-coinreserve-missing",100);if(!this.isCoinreserveEquals(f[0],o,r))throw new k(t,"invalid","bad-txns-coinreserve-mismatch",100);if(f.length>1)throw new k(t,"invalid","bad-txns-coinreserve-toomany",100);if(c+=d.getTotalReward(r,s),t.getClaimed()>c)throw new k(t,"invalid","bad-cb-amount",100);const l=[];for(let e=1;e<t.txs.length;e++){const r=t.txs[e];l.push(r.verifyAsync(n,i.flags,this.workers))}if(!await S.every(l))throw new k(t,"invalid","mandatory-script-verify-flag-failed",100);return n},n.prototype.findCoinreserve=function(t,e){for(let i of t.outputs){const n=i.getAddress();if(n===e)return function(t,e){return t.filter(t=>!t.equals(e))}(t,n)}return!1},n.prototype.isCoinreserveEquals=function(t,e,i){if(1===i){if(t.script.equals(e.script))return!0}else if(t.equals(e))return!0;return!1},n.prototype.findFork=async function(t,e){for(;t.hash!==e.hash;){for(;e.height>t.height;)if(!(e=await this.getPrevious(e)))throw new Error("No previous entry for new tip.");if(t.hash===e.hash)return t;if(!(t=await this.getPrevious(t)))throw new Error("No previous entry for old tip.")}return t},n.prototype.reorganize=async function(t){const e=this.tip,i=await this.findFork(e,t);a(i,"No free space or data corruption.");const n=[];let r=e;for(;r.hash!==i.hash;)n.push(r),r=await this.getPrevious(r),a(r);const s=[];for(r=t;r.hash!==i.hash;)s.push(r),r=await this.getPrevious(r),a(r);for(let t=0;t<n.length;t++){const e=n[t];await this.disconnect(e)}for(let t=s.length-1;t>=1;t--){const e=s[t];await this.reconnect(e)}this.logger.warning("Chain reorganization: old=%s(%d) new=%s(%d)",e.rhash(),e.height,t.rhash(),t.height),await this.fire("reorganize",e,t)},n.prototype.reorganizeSPV=async function(t){const e=this.tip,i=await this.findFork(e,t);a(i,"No free space or data corruption.");const n=[];let r=e;for(;r.hash!==i.hash;)n.push(r),r=await this.getPrevious(r),a(r);await this._reset(i.hash,!0);for(const t of n){const e=t.toHeaders(),i=new b;await this.fire("disconnect",t,e,i)}this.logger.warning("SPV reorganization: old=%s(%d) new=%s(%d)",e.rhash(),e.height,t.rhash(),t.height),this.logger.warning("Chain replay from height %d necessary.",i.height),await this.fire("reorganize",e,t)},n.prototype.disconnect=async function(t){let e=await this.getBlock(t.hash);if(!e){if(!this.options.spv)throw new Error("Block not found.");e=t.toHeaders()}const i=await this.getPrevious(t),n=await this.db.disconnect(t,e);a(i),this.tip=i,this.height=i.height,this.emit("tip",i),await this.fire("disconnect",t,e,n)},n.prototype.reconnect=async function(t){const e=p.flags.VERIFY_NONE;let i=await this.getBlock(t.hash);if(!i){if(!this.options.spv)throw new Error("Block not found.");i=t.toHeaders()}const n=await this.getPrevious(t);a(n);let r,s;try{[r,s]=await this.verifyContext(i,n,e)}catch(e){throw"VerifyError"===e.type&&(e.malleated||this.setInvalid(t.hash),this.logger.warning("Tried to reconnect invalid block: %s (%d).",t.rhash(),t.height)),e}await this.db.reconnect(t,i,r),this.tip=t,this.height=t.height,this.setDeploymentState(s),this.emit("tip",t),this.emit("reconnect",t,i),await this.fire("connect",t,i,r)},n.prototype.setBestChain=async function(t,e,i,n){if(t.prevBlock!==this.tip.hash){if(this.logger.warning("WARNING: Reorganizing chain."),this.options.spv)return void await this.reorganizeSPV(t);await this.reorganize(t)}t.hasUnknown(this.network)&&this.logger.warning("Unknown version bits in block %d: %s.",t.height,m.hex32(t.version));let r,s;try{[r,s]=await this.verifyContext(e,i,n)}catch(e){throw"VerifyError"===e.type&&(e.malleated||this.setInvalid(t.hash),this.logger.warning("Tried to connect invalid block: %s (%d).",t.rhash(),t.height)),e}await this.db.save(t,e,r),this.tip=t,this.height=t.height,this.setDeploymentState(s),this.emit("tip",t),this.emit("block",e,t),await this.fire("connect",t,e,r)},n.prototype.saveAlternate=async function(t,e,i,n){try{await this.verify(e,i,n)}catch(e){throw"VerifyError"===e.type&&(e.malleated||this.setInvalid(t.hash),this.logger.warning("Invalid block on alternate chain: %s (%d).",t.rhash(),t.height)),e}t.hasUnknown(this.network)&&this.logger.warning("Unknown version bits in block %d: %s.",t.height,m.hex32(t.version)),await this.db.save(t,e),this.logger.warning("Heads up: Competing chain at height %d: tip-height=%d competitor-height=%d tip-hash=%s competitor-hash=%s tip-chainwork=%s competitor-chainwork=%s chainwork-diff=%s",t.height,this.tip.height,t.height,this.tip.rhash(),t.rhash(),this.tip.chainwork.toString(),t.chainwork.toString(),this.tip.chainwork.sub(t.chainwork).toString()),this.emit("competitor",e,t)},n.prototype.reset=async function(t){const e=await this.locker.lock();try{return await this._reset(t,!1)}finally{e()}},n.prototype._reset=async function(t,e){const i=await this.db.reset(t);this.tip=i,this.height=i.height,this.synced=!1;const n=await this.getDeploymentState();this.setDeploymentState(n),this.emit("tip",i),e||await this.fire("reset",i),this.purgeOrphans(),this.maybeSync()},n.prototype.replay=async function(t){const e=await this.locker.lock();try{return await this._replay(t,!0)}finally{e()}},n.prototype._replay=async function(t,e){const i=await this.getEntry(t);if(!i)throw new Error("Block not found.");if(!await this.isMainChain(i))throw new Error("Cannot reset on alternate chain.");i.isGenesis()?await this._reset(i.hash,e):await this._reset(i.prevBlock,e)},n.prototype.invalidate=async function(t){const e=await this.locker.lock();try{return await this._invalidate(t)}finally{e()}},n.prototype._invalidate=async function(t){await this._replay(t,!1),this.setInvalid(t)},n.prototype.prune=async function(){const t=await this.locker.lock();try{return await this.db.prune()}finally{t()}},n.prototype.scan=async function(t,e,i){const n=await this.locker.lock();try{return await this.db.scan(t,e,i)}finally{n()}},n.prototype.add=async function(t,e,i){const n=t.hash("hex"),r=await this.locker.lock(n);try{return await this._add(t,e,i)}finally{r()}},n.prototype._add=async function(t,e,i){const n=t.hash("hex");if(null==e&&(e=p.flags.DEFAULT_FLAGS),null==i&&(i=-1),n===this.network.genesis.hash)throw this.logger.debug("Saw genesis block: %s.",t.rhash()),new k(t,"duplicate","duplicate",0);if(this.hasPending(n))throw this.logger.debug("Already have pending block: %s.",t.rhash()),new k(t,"duplicate","duplicate",0);if(this.hasOrphan(n))throw this.logger.debug("Already have orphan block: %s.",t.rhash()),new k(t,"duplicate","duplicate",0);if(this.hasInvalid(t))throw this.logger.debug("Invalid ancestors for block: %s.",t.rhash()),new k(t,"duplicate","duplicate",100);if(e&p.flags.VERIFY_POW&&!t.verifyPOW())throw new k(t,"invalid","high-hash",50);if(await this.hasEntry(n))throw this.logger.debug("Already have block: %s.",t.rhash()),new k(t,"duplicate","duplicate",0);const r=await this.getEntry(t.prevBlock);if(!r)return this.storeOrphan(t,e,i),null;const s=await this.connect(r,t,e);return this.hasNextOrphan(n)&&await this.handleOrphans(s),s},n.prototype.connect=async function(t,e,i){const n=m.hrtime();if(a(e.prevBlock===t.hash),e.isMemory())try{e=e.toBlock()}catch(t){throw this.logger.error(t),new k(e,"malformed","error parsing message",10,!0)}const r=w.fromBlock(e,t);return r.chainwork.lte(this.tip.chainwork)?await this.saveAlternate(r,e,t,i):await this.setBestChain(r,e,t,i),this.logStatus(n,e,r),this.maybeSync(),r},n.prototype.handleOrphans=async function(t){let e=this.resolveOrphan(t.hash);for(;e;){const{block:i,flags:n,id:r}=e;try{t=await this.connect(t,i,n)}catch(t){if("VerifyError"===t.type){this.logger.warning("Could not resolve orphan block %s: %s.",i.rhash(),t.message),this.emit("bad orphan",t,r);break}throw t}this.logger.debug("Orphan block was resolved: %s (%d).",i.rhash(),t.height),this.emit("resolved",i,t),e=this.resolveOrphan(t.hash)}},n.prototype.isSlow=function(){return!this.options.spv&&(!!this.synced||(1===this.height||this.height%20==0||this.height>=this.network.block.slowHeight))},n.prototype.logStatus=function(t,e,i){if(!this.isSlow())return;this.logger.memory();const n=m.hrtime(t);this.logger.info("Block %s (%d) added to chain (size=%d txs=%d time=%d).",i.rhash(),i.height,e.getSize(),e.txs.length,n),this.db.coinCache.capacity>0&&this.logger.debug("Coin Cache: size=%dmb, items=%d.",m.mb(this.db.coinCache.size),this.db.coinCache.items)},n.prototype.verifyCheckpoint=function(t,e){if(!this.options.checkpoints)return!0;const i=t.height+1,n=this.network.checkpointMap[i];return!n||(e===n?(this.logger.debug("Hit checkpoint block %s (%d).",m.revHex(e),i),this.emit("checkpoint",e,i),!0):(this.logger.warning("Checkpoint mismatch at height %d: expected=%s received=%s",i,m.revHex(n),m.revHex(e)),this.purgeOrphans(),!1))},n.prototype.storeOrphan=function(t,e,i){const n=t.getCoinbaseHeight(),r=this.orphanPrev.get(t.prevBlock);r&&(a(r.block.hash("hex")!==t.hash("hex")),a(r.block.prevBlock===t.prevBlock),this.logger.warning("Removing forked orphan block: %s (%d).",r.block.rhash(),n),this.removeOrphan(r)),this.limitOrphans(),this.addOrphan(new function(t,e,i){this.block=t,this.flags=e,this.id=i,this.time=m.now()}(t,e,i)),this.logger.debug("Storing orphan block: %s (%d).",t.rhash(),n),this.emit("orphan",t)},n.prototype.addOrphan=function(t){const e=t.block,i=e.hash("hex");return a(!this.orphanMap.has(i)),a(!this.orphanPrev.has(e.prevBlock)),a(this.orphanMap.size>=0),this.orphanMap.set(i,t),this.orphanPrev.set(e.prevBlock,t),t},n.prototype.removeOrphan=function(t){const e=t.block,i=e.hash("hex");return a(this.orphanMap.has(i)),a(this.orphanPrev.has(e.prevBlock)),a(this.orphanMap.size>0),this.orphanMap.delete(i),this.orphanPrev.delete(e.prevBlock),t},n.prototype.hasNextOrphan=function(t){return this.orphanPrev.has(t)},n.prototype.resolveOrphan=function(t){const e=this.orphanPrev.get(t);return e?this.removeOrphan(e):null},n.prototype.purgeOrphans=function(){const t=this.orphanMap.size;0!==t&&(this.orphanMap.clear(),this.orphanPrev.clear(),this.logger.debug("Purged %d orphans.",t))},n.prototype.limitOrphans=function(){const t=m.now();let e=null;for(const i of this.orphanMap.values())t<i.time+3600?(!e||i.time<e.time)&&(e=i):this.removeOrphan(i);this.orphanMap.size<this.options.maxOrphans||e&&this.removeOrphan(e)},n.prototype.hasInvalid=function(t){const e=t.hash("hex");return!!this.invalid.has(e)||!!this.invalid.has(t.prevBlock)&&(this.setInvalid(e),!0)},n.prototype.setInvalid=function(t){this.invalid.set(t,!0)},n.prototype.removeInvalid=function(t){this.invalid.remove(t)},n.prototype.has=async function(t){return!!this.hasOrphan(t)||(!!this.locker.has(t)||(!!this.invalid.has(t)||await this.hasEntry(t)))},n.prototype.getEntry=function(t){return this.db.getEntry(t)},n.prototype.getEntryByHeight=function(t){return this.db.getEntryByHeight(t)},n.prototype.getEntryByHash=function(t){return this.db.getEntryByHash(t)},n.prototype.getHash=function(t){return this.db.getHash(t)},n.prototype.getHeight=function(t){return this.db.getHeight(t)},n.prototype.hasEntry=function(t){return this.db.hasEntry(t)},n.prototype.getNextHash=function(t){return this.db.getNextHash(t)},n.prototype.hasCoins=function(t){return this.db.hasCoins(t)},n.prototype.getTips=function(){return this.db.getTips()},n.prototype.readCoin=function(t){return this.db.readCoin(t)},n.prototype.getCoin=function(t,e){return this.db.getCoin(t,e)},n.prototype.getBlock=function(t){return this.db.getBlock(t)},n.prototype.getRawBlock=function(t){return this.db.getRawBlock(t)},n.prototype.getBlockView=function(t){return this.db.getBlockView(t)},n.prototype.getMeta=function(t){return this.db.getMeta(t)},n.prototype.getTX=function(t){return this.db.getTX(t)},n.prototype.hasTX=function(t){return this.db.hasTX(t)},n.prototype.getCoinsByAddress=function(t){return this.db.getCoinsByAddress(t)},n.prototype.getHashesByAddress=function(t){return this.db.getHashesByAddress(t)},n.prototype.getTXByAddress=function(t){return this.db.getTXByAddress(t)},n.prototype.getMetaByAddress=function(t){return this.db.getMetaByAddress(t)},n.prototype.getOrphan=function(t){return this.orphanMap.get(t)||null},n.prototype.hasOrphan=function(t){return this.orphanMap.has(t)},n.prototype.hasPending=function(t){return this.locker.hasPending(t)},n.prototype.getCoinView=function(t){return this.db.getCoinView(t)},n.prototype.getSpentView=async function(t){const e=await this.locker.lock();try{return await this.db.getSpentView(t)}finally{e()}},n.prototype.isFull=function(){return this.synced},n.prototype.maybeSync=function(){this.synced||this.options.checkpoints&&this.height<this.network.lastCheckpoint||this.tip.time<m.now()-this.network.block.maxTipAge||this.hasChainwork()&&(this.synced=!0,this.emit("full"))},n.prototype.hasChainwork=function(){return this.tip.chainwork.gte(this.network.pow.chainwork)},n.prototype.getProgress=function(){const t=this.network.genesis.time,e=this.tip.time-t,i=m.now()-t-2400;return Math.min(1,e/i)},n.prototype.getLocator=async function(t){const e=await this.locker.lock();try{return await this._getLocator(t)}finally{e()}},n.prototype._getLocator=async function(t){null==t&&(t=this.tip.hash),a("string"==typeof t);let e=await this.getEntry(t);const i=[];e||(e=this.tip,i.push(t));let n=e.hash,r=e.height,s=1,o=await this.isMainChain(e);for(i.push(n);r>0;){if((r-=s)<0&&(r=0),i.length>10&&(s*=2),o)n=await this.getHash(r),a(n);else{const t=await this.getAncestor(e,r);a(t),o=await this.isMainChain(t),n=t.hash}i.push(n)}return i},n.prototype.getOrphanRoot=function(t){let e=null;for(a(t);;){const i=this.orphanMap.get(t);if(!i)break;e=t,t=i.block.prevBlock}return e},n.prototype.getProofTime=function(t,e){const i=this.network.pow;let n,r;return t.chainwork.cmp(e.chainwork)>0?(r=t.chainwork.sub(e.chainwork),n=1):(r=e.chainwork.sub(t.chainwork),n=-1),r=r.imuln(i.targetSpacing),(r=r.div(this.tip.getProof())).bitLength()>53?n*Number.MAX_SAFE_INTEGER:n*r.toNumber()},n.prototype.getCurrentTarget=async function(){return await this.getTarget(this.network.now(),this.tip)},n.prototype.getTarget=async function(t,e){const i=this.network.pow;if(!e)return a(t===this.network.genesis.time),i.bits;if((e.height+1)%i.retargetInterval!=0){if(i.targetReset){if(t>e.time+2*i.targetSpacing)return i.bits;for(;0!==e.height&&e.height%i.retargetInterval!=0&&e.bits===i.bits;){const t=this.getPrevCache(e);e=t||await this.getPrevious(e),a(e)}}return e.bits}const n=e.height-(i.retargetInterval-1);a(n>=0);const r=await this.getAncestor(e,n);return a(r),this.retarget(e,r)},n.prototype.retarget=function(t,e){const i=this.network.pow,n=i.targetTimespan;if(i.noRetargeting)return t.bits;const r=d.fromCompact(t.bits);let s=t.time-e.time;return s<n/4|0&&(s=n/4|0),s>4*n&&(s=4*n),r.imuln(s),r.idivn(n),r.cmp(i.limit)>0?i.bits:d.toCompact(r)},n.prototype.findLocator=async function(t){for(const e of t)if(await this.isMainHash(e))return e;return this.network.genesis.hash},n.prototype.isActive=async function(t,e){return await this.getState(t,e)===E.ACTIVE},n.prototype.getState=async function(t,e){const i=e.bit;let n=this.network.minerWindow,r=this.network.activationThreshold;if(-1!==e.threshold&&(r=e.threshold),-1!==e.window&&(n=e.window),(t.height+1)%n!=0){const e=t.height-(t.height+1)%n;if(!(t=await this.getAncestor(t,e)))return E.DEFINED;a(t.height===e),a((t.height+1)%n==0)}let s=t,o=E.DEFINED;const h=[];for(;s;){const t=this.db.stateCache.get(i,s);if(-1!==t){o=t;break}if(await this.getMedianTime(s)<e.startTime){o=E.DEFINED,this.db.stateCache.set(i,s,o);break}h.push(s);const r=s.height-n;s=await this.getAncestor(s,r)}for(;h.length;){const t=h.pop();switch(o){case E.DEFINED:{const i=await this.getMedianTime(t);if(i>=e.timeout){o=E.FAILED;break}if(i>=e.startTime){o=E.STARTED;break}break}case E.STARTED:{if(await this.getMedianTime(t)>=e.timeout){o=E.FAILED;break}let s=t,h=0;for(let t=0;t<n;t++){if(s.hasBit(i)&&h++,h>=r){o=E.LOCKED_IN;break}s=await this.getPrevious(s),a(s)}break}case E.LOCKED_IN:o=E.ACTIVE;break;case E.FAILED:case E.ACTIVE:break;default:a(!1,"Bad state.")}this.db.stateCache.set(i,t,o)}return o},n.prototype.computeBlockVersion=async function(t){let e=0;for(const i of this.network.deploys){const n=await this.getState(t,i);n!==E.LOCKED_IN&&n!==E.STARTED||(e|=1<<i.bit)}return e|=d.VERSION_TOP_BITS,e>>>=0},n.prototype.getDeploymentState=async function(){const t=await this.getPrevious(this.tip);return t?this.options.spv?this.state:await this.getDeployments(this.tip.time,t):(a(this.tip.isGenesis()),this.state)},n.prototype.verifyFinal=async function(t,e,i){const n=t.height+1;if(e.locktime<d.LOCKTIME_THRESHOLD)return e.isFinal(n,-1);if(i&p.lockFlags.MEDIAN_TIME_PAST){const i=await this.getMedianTime(t);return e.isFinal(n,i)}return e.isFinal(n,this.network.now())},n.prototype.getLocks=async function(t,e,i,n){const r=d.SEQUENCE_GRANULARITY,s=d.SEQUENCE_DISABLE_FLAG,o=d.SEQUENCE_TYPE_FLAG,h=d.SEQUENCE_MASK;if(!(n&p.lockFlags.VERIFY_SEQUENCE))return[-1,-1];if(e.isCoinbase()||e.version<2)return[-1,-1];let c=-1,u=-1;for(const{prevout:n,sequence:f}of e.inputs){if(f&s)continue;let e=i.getHeight(n);if(-1===e&&(e=this.height+1),!(f&o)){e+=(f&h)-1,c=Math.max(c,e);continue}e=Math.max(e-1,0);const l=await this.getAncestor(t,e);a(l,"Database is corrupt.");let p=await this.getMedianTime(l);p+=((f&h)<<r)-1,u=Math.max(u,p)}return[c,u]},n.prototype.verifyLocks=async function(t,e,i,n){const[r,s]=await this.getLocks(t,e,i,n);if(r>=t.height+1)return!1;if(-1===s)return!0;return!(s>=await this.getMedianTime(t))},r.prototype.fromOptions=function(t){return null!=t.network&&(this.network=u.get(t.network)),null!=t.logger&&(a("object"==typeof t.logger),this.logger=t.logger),null!=t.workers&&(a("object"==typeof t.workers),this.workers=t.workers),null!=t.spv&&(a("boolean"==typeof t.spv),this.spv=t.spv),null!=t.prefix&&(a("string"==typeof t.prefix),this.prefix=t.prefix,this.location=this.spv?h.join(this.prefix,"spvchain"):h.join(this.prefix,"chain")),null!=t.location&&(a("string"==typeof t.location),this.location=t.location),null!=t.db&&(a("string"==typeof t.db),this.db=t.db),null!=t.maxFiles&&(a(m.isU32(t.maxFiles)),this.maxFiles=t.maxFiles),null!=t.cacheSize&&(a(m.isU64(t.cacheSize)),this.cacheSize=t.cacheSize),null!=t.compression&&(a("boolean"==typeof t.compression),this.compression=t.compression),null!=t.prune&&(a("boolean"==typeof t.prune),this.prune=t.prune),null!=t.indexTX&&(a("boolean"==typeof t.indexTX),this.indexTX=t.indexTX),null!=t.indexAddress&&(a("boolean"==typeof t.indexAddress),this.indexAddress=t.indexAddress),null!=t.forceFlags&&(a("boolean"==typeof t.forceFlags),this.forceFlags=t.forceFlags),null!=t.bip91&&(a("boolean"==typeof t.bip91),this.bip91=t.bip91),null!=t.bip148&&(a("boolean"==typeof t.bip148),this.bip148=t.bip148),null!=t.coinCache&&(a(m.isU64(t.coinCache)),this.coinCache=t.coinCache),null!=t.entryCache&&(a(m.isU32(t.entryCache)),this.entryCache=t.entryCache),null!=t.maxOrphans&&(a(m.isU32(t.maxOrphans)),this.maxOrphans=t.maxOrphans),null!=t.checkpoints&&(a("boolean"==typeof t.checkpoints),this.checkpoints=t.checkpoints),this},r.fromOptions=function(t){return(new r).fromOptions(t)},s.prototype.hasP2SH=function(){return 0!=(this.flags&v.flags.VERIFY_P2SH)},s.prototype.hasBIP34=function(){return this.bip34},s.prototype.hasBIP66=function(){return 0!=(this.flags&v.flags.VERIFY_DERSIG)},s.prototype.hasCLTV=function(){return 0!=(this.flags&v.flags.VERIFY_CHECKLOCKTIMEVERIFY)},s.prototype.hasMTP=function(){return 0!=(this.lockFlags&p.lockFlags.MEDIAN_TIME_PAST)},s.prototype.hasCSV=function(){return 0!=(this.flags&v.flags.VERIFY_CHECKSEQUENCEVERIFY)},s.prototype.hasWitness=function(){return!0},s.prototype.hasBIP91=function(){return this.bip91},s.prototype.hasBIP148=function(){return this.bip148},t.exports=n},function(t,e){t.exports=require("fs")},function(t,e,i){"use strict";function n(t,e,i,s,o){Error.call(this),r("string"==typeof e),r("string"==typeof i),r(s>=0),this.type="VerifyError",this.message="",this.code=e,this.reason=i,this.score=s,this.hash=t.hash("hex"),this.malleated=o||!1,this.message=`Verification failure: ${i}`+` (code=${e} score=${s} hash=${t.rhash()})`,Error.captureStackTrace&&Error.captureStackTrace(this,n)}const r=i(0);Object.setPrototypeOf(n.prototype,Error.prototype),e.VerifyError=n},function(t,e,i){"use strict";const n=i(24),r=i(18).binding;e.encipher=function(t,e,i){const r=n.createCipheriv("aes-256-cbc",e,i);return Buffer.concat([r.update(t),r.final()])},e.decipher=function(t,e,i){const r=n.createDecipheriv("aes-256-cbc",e,i);try{return Buffer.concat([r.update(t),r.final()])}catch(t){throw new Error("Bad key for decryption.")}},r&&(e.encipher=r.encipher,e.decipher=r.decipher)},function(t,e,i){"use strict";const n=i(0),r=i(110),s=i(206),o=i(269),a=i(209),h=i(207),c=e;c.fromBase58=function(t,e){return o.isBase58(t)?o.fromBase58(t,e):a.fromBase58(t,e)},c.generate=function(t){return o.generate(t)},c.fromSeed=function(t,e){return o.fromSeed(t,e)},c.fromMnemonic=function(t,e){return o.fromMnemonic(t,e)},c.fromJSON=function(t,e){return t.xprivkey?o.fromJSON(t,e):a.fromJSON(t,e)},c.fromRaw=function(t,e){return o.isRaw(t,e)?o.fromRaw(t,e):a.fromRaw(t,e)},c.from=function(t,e){if(n(t,"Options required."),c.isHD(t))return t;if(c.isBase58(t,e))return c.fromBase58(t,e);if(c.isRaw(t,e))return c.fromRaw(t,e);if(t&&"object"==typeof t)return c.fromMnemonic(t,e);throw new Error("Cannot create HD key from bad options.")},c.isBase58=function(t,e){return o.isBase58(t,e)||a.isBase58(t,e)},c.isRaw=function(t,e){return o.isRaw(t,e)||a.isRaw(t,e)},c.isHD=function(t){return o.isHDPrivateKey(t)||a.isHDPublicKey(t)},c.isPrivate=function(t){return o.isHDPrivateKey(t)},c.isPublic=function(t){return a.isHDPublicKey(t)},c.common=r,c.HD=c,c.Mnemonic=s,c.PrivateKey=o,c.PublicKey=a,c.wordlist=h},function(t,e,i){"use strict";const n=i(0),r=i(57),s=e;s.HARDENED=2147483648,s.MIN_ENTROPY=128,s.MAX_ENTROPY=512,s.cache=new r(500),s.parsePath=function(t,e){n("string"==typeof t),n("boolean"==typeof e),n(t.length>=1),n(t.length<=3062);const i=t.split("/"),r=i[0];if("m"!==r&&"M"!==r&&"m'"!==r&&"M'"!==r)throw new Error("Invalid path root.");const o=[];for(let t=1;t<i.length;t++){let n=i[t];const r="'"===n[n.length-1];if(r&&(n=n.slice(0,-1)),n.length>10)throw new Error("Path index too large.");if(!/^\d+$/.test(n))throw new Error("Path index is non-numeric.");let a=parseInt(n,10);if(a>>>0!==a)throw new Error("Path index out of range.");if(r&&(a|=s.HARDENED,a>>>=0),!e&&a&s.HARDENED)throw new Error("Path index cannot be hardened.");o.push(a)}return o},s.isMaster=function(t){return 0===t.depth&&0===t.childIndex&&0===t.parentFingerPrint},s.isAccount=function(t,e){if(null!=e){const i=(s.HARDENED|e)>>>0;if(t.childIndex!==i)return!1}return 3===t.depth&&0!=(t.childIndex&s.HARDENED)}},function(t,e){t.exports=require("https")},function(t,e){e.encode=function(t){var e="";for(var i in t)t.hasOwnProperty(i)&&(e.length&&(e+="&"),e+=encodeURIComponent(i)+"="+encodeURIComponent(t[i]));return e},e.decode=function(t){for(var e={},i=t.split("&"),n=0,r=i.length;n<r;n++){var s=i[n].split("=");e[decodeURIComponent(s[0])]=decodeURIComponent(s[1])}return e}},function(t,e){t.exports=function(t,e){var i=function(){};i.prototype=e.prototype,t.prototype=new i,t.prototype.constructor=t}},function(t,e,i){"use strict";const n=i(78),r=i(293),s=i(172),o=n.Buffer,a=[8,9,10,11,12,13,14,15],h=o.from([0,0,255,255]),c=o.from([0]),u=15,f=8;t.exports=class{constructor(t,e,i){this._options=t||{},this._isServer=!!e,this._inflate=null,this._deflate=null,this.params=null,this._maxPayload=i||0,this.threshold=void 0===this._options.threshold?1024:this._options.threshold}static get extensionName(){return"permessage-deflate"}offer(){const t={};return this._options.serverNoContextTakeover&&(t.server_no_context_takeover=!0),this._options.clientNoContextTakeover&&(t.client_no_context_takeover=!0),this._options.serverMaxWindowBits&&(t.server_max_window_bits=this._options.serverMaxWindowBits),this._options.clientMaxWindowBits?t.client_max_window_bits=this._options.clientMaxWindowBits:null==this._options.clientMaxWindowBits&&(t.client_max_window_bits=!0),t}accept(t){t=this.normalizeParams(t);var e;return e=this._isServer?this.acceptAsServer(t):this.acceptAsClient(t),this.params=e,e}cleanup(){this._inflate&&(this._inflate.writeInProgress?this._inflate.pendingClose=!0:(this._inflate.close(),this._inflate=null)),this._deflate&&(this._deflate.writeInProgress?this._deflate.pendingClose=!0:(this._deflate.close(),this._deflate=null))}acceptAsServer(t){const e={};if(!t.some(t=>{if(!(!1===this._options.serverNoContextTakeover&&t.server_no_context_takeover||!1===this._options.serverMaxWindowBits&&t.server_max_window_bits||"number"==typeof this._options.serverMaxWindowBits&&"number"==typeof t.server_max_window_bits&&this._options.serverMaxWindowBits>t.server_max_window_bits||"number"==typeof this._options.clientMaxWindowBits&&!t.client_max_window_bits))return(this._options.serverNoContextTakeover||t.server_no_context_takeover)&&(e.server_no_context_takeover=!0),this._options.clientNoContextTakeover&&(e.client_no_context_takeover=!0),!1!==this._options.clientNoContextTakeover&&t.client_no_context_takeover&&(e.client_no_context_takeover=!0),"number"==typeof this._options.serverMaxWindowBits?e.server_max_window_bits=this._options.serverMaxWindowBits:"number"==typeof t.server_max_window_bits&&(e.server_max_window_bits=t.server_max_window_bits),"number"==typeof this._options.clientMaxWindowBits?e.client_max_window_bits=this._options.clientMaxWindowBits:!1!==this._options.clientMaxWindowBits&&"number"==typeof t.client_max_window_bits&&(e.client_max_window_bits=t.client_max_window_bits),!0}))throw new Error("Doesn't support the offered configuration");return e}acceptAsClient(t){const e=t[0];if(null!=this._options.clientNoContextTakeover&&!1===this._options.clientNoContextTakeover&&e.client_no_context_takeover)throw new Error('Invalid value for "client_no_context_takeover"');if(null!=this._options.clientMaxWindowBits){if(!1===this._options.clientMaxWindowBits&&e.client_max_window_bits)throw new Error('Invalid value for "client_max_window_bits"');if("number"==typeof this._options.clientMaxWindowBits&&(!e.client_max_window_bits||e.client_max_window_bits>this._options.clientMaxWindowBits))throw new Error('Invalid value for "client_max_window_bits"')}return e}normalizeParams(t){return t.map(t=>(Object.keys(t).forEach(e=>{var i=t[e];if(i.length>1)throw new Error(`Multiple extension parameters for ${e}`);switch(i=i[0],e){case"server_no_context_takeover":case"client_no_context_takeover":if(!0!==i)throw new Error(`invalid extension parameter value for ${e} (${i})`);t[e]=!0;break;case"server_max_window_bits":case"client_max_window_bits":if("string"==typeof i&&(i=parseInt(i,10),!~a.indexOf(i)))throw new Error(`invalid extension parameter value for ${e} (${i})`);if(!this._isServer&&!0===i)throw new Error(`Missing extension parameter value for ${e}`);t[e]=i;break;default:throw new Error(`Not defined extension parameter (${e})`)}}),t))}decompress(t,e,i){const n=this._isServer?"client":"server";if(!this._inflate){const t=this.params[`${n}_max_window_bits`];this._inflate=r.createInflateRaw({windowBits:"number"==typeof t?t:u})}this._inflate.writeInProgress=!0;var o=0;const a=[];var c;const f=t=>{if(o+=t.length,this._maxPayload<1||o<=this._maxPayload)return a.push(t);(c=new Error("max payload size exceeded")).closeCode=1009,this._inflate.reset()},l=t=>{p(),i(t)},p=()=>{this._inflate&&(this._inflate.removeListener("error",l),this._inflate.removeListener("data",f),this._inflate.writeInProgress=!1,(e&&this.params[`${n}_no_context_takeover`]||this._inflate.pendingClose)&&(this._inflate.close(),this._inflate=null))};this._inflate.on("error",l).on("data",f),this._inflate.write(t),e&&this._inflate.write(h),this._inflate.flush(()=>{p(),c?i(c):i(null,s.concat(a,o))})}compress(t,e,i){if(!t||0===t.length)return void process.nextTick(i,null,c);const n=this._isServer?"server":"client";if(!this._deflate){const t=this.params[`${n}_max_window_bits`];this._deflate=r.createDeflateRaw({flush:r.Z_SYNC_FLUSH,windowBits:"number"==typeof t?t:u,memLevel:this._options.memLevel||f})}this._deflate.writeInProgress=!0;var o=0;const a=[],h=t=>{o+=t.length,a.push(t)},l=t=>{p(),i(t)},p=()=>{this._deflate&&(this._deflate.removeListener("error",l),this._deflate.removeListener("data",h),this._deflate.writeInProgress=!1,(e&&this.params[`${n}_no_context_takeover`]||this._deflate.pendingClose)&&(this._deflate.close(),this._deflate=null))};this._deflate.on("error",l).on("data",h),this._deflate.write(t),this._deflate.flush(r.Z_SYNC_FLUSH,()=>{p();var t=s.concat(a,o);e&&(t=t.slice(0,t.length-4)),i(null,t)})}}},function(t,e,i){"use strict";function n(t){if(!(this instanceof n))return new n(t);U.call(this),f(t,"RPC requires a Node."),this.node=t,this.network=t.network,this.workers=t.workers,this.chain=t.chain,this.mempool=t.mempool,this.pool=t.pool,this.fees=t.fees,this.miner=t.miner,this.logger=t.logger.context("rpc"),this.mining=!1,this.procLimit=0,this.attempt=null,this.lastActivity=0,this.boundChain=!1,this.nonce1=0,this.nonce2=0,this.merkleMap=new Map,this.pollers=[],this.init()}function r(t){for(let e=0;e<t.length;e+=4){const i=t.readUInt32LE(e,!0);t.writeUInt32BE(i,e,!0)}return t}function s(t,e,i){return{id:t,version:e,reject:{status:i}}}function o(t,e){try{return k.fromString(t,e)}catch(t){throw new L(z.INVALID_ADDRESS_OR_KEY,"Invalid address.")}}function a(t,e){try{return x.fromSecret(t,e)}catch(t){throw new L(z.INVALID_ADDRESS_OR_KEY,"Invalid key.")}}function h(t,e){try{return M.fromHostname(t,e.port)}catch(t){throw new L(z.CLIENT_INVALID_IP_OR_SUBNET,"Invalid IP address or subnet.")}}function c(t,e){try{return b.fromHostname(t,e)}catch(t){throw new L(z.CLIENT_INVALID_IP_OR_SUBNET,"Invalid IP address or subnet.")}}function u(t){let e=t>>>24&255,i=65535/(16777215&t);for(;e<29;)i*=256,e++;for(;e>29;)i/=256,e--;return i}const f=i(0),l=i(1),p=i(16),d=i(5),m=i(52),g=i(93),y=i(12),w=i(20),b=i(79),v=i(8),k=i(11),S=i(51),E=i(37),R=i(41),x=i(47),_=i(71),I=i(48),A=i(6),O=i(21),B=i(13),P=i(15),M=i(46),N=i(3),T=i(7),C=i(74),U=i(174),H=i(96),L=U.RPCError,z=U.errors,D=U.MAGIC_STRING;Object.setPrototypeOf(n.prototype,U.prototype),n.prototype.init=function(){this.add("stop",this.stop),this.add("help",this.help),this.add("getblockchaininfo",this.getBlockchainInfo),this.add("getbestblockhash",this.getBestBlockHash),this.add("getblockcount",this.getBlockCount),this.add("getblock",this.getBlock),this.add("getblockbyheight",this.getBlockByHeight),this.add("getblockhash",this.getBlockHash),this.add("getblockheader",this.getBlockHeader),this.add("getchaintips",this.getChainTips),this.add("getdifficulty",this.getDifficulty),this.add("getmempoolancestors",this.getMempoolAncestors),this.add("getmempooldescendants",this.getMempoolDescendants),this.add("getmempoolentry",this.getMempoolEntry),this.add("getmempoolinfo",this.getMempoolInfo),this.add("getrawmempool",this.getRawMempool),this.add("gettxout",this.getTXOut),this.add("gettxoutsetinfo",this.getTXOutSetInfo),this.add("pruneblockchain",this.pruneBlockchain),this.add("verifychain",this.verifyChain),this.add("invalidateblock",this.invalidateBlock),this.add("reconsiderblock",this.reconsiderBlock),this.add("getnetworkhashps",this.getNetworkHashPS),this.add("getmininginfo",this.getMiningInfo),this.add("prioritisetransaction",this.prioritiseTransaction),this.add("getwork",this.getWork),this.add("getworklp",this.getWorkLongpoll),this.add("getblocktemplate",this.getBlockTemplate),this.add("submitblock",this.submitBlock),this.add("verifyblock",this.verifyBlock),this.add("setgenerate",this.setGenerate),this.add("getgenerate",this.getGenerate),this.add("generate",this.generate),this.add("generatetoaddress",this.generateToAddress),this.add("estimatefee",this.estimateFee),this.add("estimatepriority",this.estimatePriority),this.add("estimatesmartfee",this.estimateSmartFee),this.add("estimatesmartpriority",this.estimateSmartPriority),this.add("getinfo",this.getInfo),this.add("validateaddress",this.validateAddress),this.add("createmultisig",this.createMultisig),this.add("createwitnessaddress",this.createWitnessAddress),this.add("verifymessage",this.verifyMessage),this.add("signmessagewithprivkey",this.signMessageWithPrivkey),this.add("setmocktime",this.setMockTime),this.add("getconnectioncount",this.getConnectionCount),this.add("ping",this.ping),this.add("getpeerinfo",this.getPeerInfo),this.add("addnode",this.addNode),this.add("disconnectnode",this.disconnectNode),this.add("getaddednodeinfo",this.getAddedNodeInfo),this.add("getnettotals",this.getNetTotals),this.add("getnetworkinfo",this.getNetworkInfo),this.add("setban",this.setBan),this.add("listbanned",this.listBanned),this.add("clearbanned",this.clearBanned),this.add("getrawtransaction",this.getRawTransaction),this.add("createrawtransaction",this.createRawTransaction),this.add("decoderawtransaction",this.decodeRawTransaction),this.add("decodescript",this.decodeScript),this.add("sendrawtransaction",this.sendRawTransaction),this.add("signrawtransaction",this.signRawTransaction),this.add("gettxoutproof",this.getTXOutProof),this.add("verifytxoutproof",this.verifyTXOutProof),this.add("getmemoryinfo",this.getMemoryInfo),this.add("setloglevel",this.setLogLevel)},n.prototype.getInfo=async function(t,e){if(e||0!==t.length)throw new L(z.MISC_ERROR,"getinfo");return{version:H.version,protocolversion:this.pool.options.version,walletversion:0,balance:0,blocks:this.chain.height,timeoffset:this.network.time.offset,connections:this.pool.peers.size(),proxy:"",difficulty:u(this.chain.tip.bits),testnet:this.network!==A.mainnet,keypoololdest:0,keypoolsize:0,unlocked_until:0,paytxfee:w.wmcc(this.network.feeRate,!0),relayfee:w.wmcc(this.network.minRelay,!0),errors:""}},n.prototype.help=async function(t,e){if(0===t.length)return"Select a command.";const i={method:t[0],params:[]};return await this.execute(i,!0)},n.prototype.stop=async function(t,e){if(e||0!==t.length)throw new L(z.MISC_ERROR,"stop");return this.node.close().catch(t=>{setImmediate(()=>{throw t})}),"Stopping."},n.prototype.getNetworkInfo=async function(t,e){if(e||0!==t.length)throw new L(z.MISC_ERROR,"getnetworkinfo");const i=this.pool.hosts,n=[];for(const t of i.local.values())n.push({address:t.addr.host,port:t.addr.port,score:t.score});return{version:H.version,subversion:this.pool.options.agent,protocolversion:this.pool.options.version,localservices:l.hex32(this.pool.options.services),localrelay:!this.pool.options.noRelay,timeoffset:this.network.time.offset,networkactive:this.pool.connected,connections:this.pool.peers.size(),networks:[],relayfee:w.wmcc(this.network.minRelay,!0),incrementalfee:0,localaddresses:n,warnings:""}},n.prototype.addNode=async function(t,e){if(e||2!==t.length)throw new L(z.MISC_ERROR,'addnode "node" "add|remove|onetry"');const i=new C([t]),n=i.str(0,"");switch(i.str(1,"")){case"add":this.pool.hosts.addNode(n);case"onetry":{const t=c(n,this.network);if(!this.pool.peers.get(t.hostname)){const e=this.pool.createOutbound(t);this.pool.peers.add(e)}break}case"remove":this.pool.hosts.removeNode(n)}return null},n.prototype.disconnectNode=async function(t,e){if(e||1!==t.length)throw new L(z.MISC_ERROR,'disconnectnode "node"');const i=h(new C([t]).str(0,""),this.network),n=this.pool.peers.get(i.hostname);return n&&n.destroy(),null},n.prototype.getAddedNodeInfo=async function(t,e){if(e||t.length>1)throw new L(z.MISC_ERROR,'getaddednodeinfo ( "node" )');const i=this.pool.hosts,n=new C([t]).str(0,"");let r;1===t.length&&(r=h(n,this.network));const s=[];for(const t of i.nodes){if(r){if(t.host!==r.host)continue;if(t.port!==r.port)continue}const e=this.pool.peers.get(t.hostname);e&&e.connected?s.push({addednode:t.hostname,connected:e.connected,addresses:[{address:e.hostname(),connected:e.outbound?"outbound":"inbound"}]}):s.push({addednode:t.hostname,connected:!1,addresses:[]})}if(r&&0===s.length)throw new L(z.CLIENT_NODE_NOT_ADDED,"Node has not been added.");return s},n.prototype.getConnectionCount=async function(t,e){if(e||0!==t.length)throw new L(z.MISC_ERROR,"getconnectioncount");return this.pool.peers.size()},n.prototype.getNetTotals=async function(t,e){let i=0,n=0;if(e||t.length>0)throw new L(z.MISC_ERROR,"getnettotals");for(let t=this.pool.peers.head();t;t=t.next)i+=t.socket.bytesWritten,n+=t.socket.bytesRead;return{totalbytesrecv:n,totalbytessent:i,timemillis:l.ms()}},n.prototype.getPeerInfo=async function(t,e){if(e||0!==t.length)throw new L(z.MISC_ERROR,"getpeerinfo");const i=[];for(let t=this.pool.peers.head();t;t=t.next){let e=this.network.time.known.get(t.hostname());const n=[];null==e&&(e=0);for(const e in t.blockMap.keys()){const t=l.revHex(e);n.push(t)}i.push({id:t.id,addr:t.hostname(),addrlocal:t.local.isNull()?void 0:t.local.hostname,services:l.hex32(t.services),relaytxes:!t.noRelay,lastsend:t.lastSend/1e3|0,lastrecv:t.lastRecv/1e3|0,bytessent:t.socket.bytesWritten,bytesrecv:t.socket.bytesRead,conntime:0!==t.time?(l.ms()-t.time)/1e3|0:0,timeoffset:e,pingtime:-1!==t.lastPong?(t.lastPong-t.lastPing)/1e3:-1,minping:-1!==t.minPing?t.minPing/1e3:-1,version:t.version,subver:t.agent,inbound:!t.outbound,startingheight:t.height,besthash:t.bestHash?l.revHex(t.bestHash):null,bestheight:t.bestHeight,banscore:t.banScore,inflight:n,whitelisted:!1})}return i},n.prototype.ping=async function(t,e){if(e||0!==t.length)throw new L(z.MISC_ERROR,"ping");for(let t=this.pool.peers.head();t;t=t.next)t.sendPing();return null},n.prototype.setBan=async function(t,e){const i=new C([t]),n=i.str(0,""),r=i.str(1,"");if(e||t.length<2||"add"!==r&&"remove"!==r)throw new L(z.MISC_ERROR,'setban "ip(/netmask)" "add|remove" (bantime) (absolute)');const s=c(n,this.network);switch(r){case"add":this.pool.ban(s);break;case"remove":this.pool.unban(s)}return null},n.prototype.listBanned=async function(t,e){if(e||0!==t.length)throw new L(z.MISC_ERROR,"listbanned");const i=[];for(const[t,e]of this.pool.hosts.banned)i.push({address:t,banned_until:e+this.pool.options.banTime,ban_created:e,ban_reason:""});return i},n.prototype.clearBanned=async function(t,e){if(e||0!==t.length)throw new L(z.MISC_ERROR,"clearbanned");return this.pool.hosts.clearBanned(),null},n.prototype.getBlockchainInfo=async function(t,e){if(e||0!==t.length)throw new L(z.MISC_ERROR,"getblockchaininfo");return{chain:"testnet"!==this.network.type?this.network.type:"test",blocks:this.chain.height,headers:this.chain.height,bestblockhash:this.chain.tip.rhash(),difficulty:u(this.chain.tip.bits),mediantime:await this.chain.getMedianTime(this.chain.tip),verificationprogress:this.chain.getProgress(),chainwork:this.chain.tip.chainwork.toString("hex",64),pruned:this.chain.options.prune,softforks:this.getSoftforks(),bip9_softforks:await this.getBIP9Softforks(),pruneheight:this.chain.options.prune?Math.max(0,this.chain.height-this.network.block.keepBlocks):null}},n.prototype.getBestBlockHash=async function(t,e){if(e||0!==t.length)throw new L(z.MISC_ERROR,"getbestblockhash");return this.chain.tip.rhash()},n.prototype.getBlockCount=async function(t,e){if(e||0!==t.length)throw new L(z.MISC_ERROR,"getblockcount");return this.chain.tip.height},n.prototype.getBlock=async function(t,e){if(e||t.length<1||t.length>3)throw new L(z.MISC_ERROR,'getblock "hash" ( verbose )');const i=new C([t]),n=i.hash(0),r=i.bool(1,!0),s=i.bool(2,!1);if(!n)throw new L(z.TYPE_ERROR,"Invalid block hash.");const o=await this.chain.getEntry(n);if(!o)throw new L(z.MISC_ERROR,"Block not found");const a=await this.chain.getBlock(o.hash);if(!a){if(this.chain.options.spv)throw new L(z.MISC_ERROR,"Block not available (spv mode)");if(this.chain.options.prune)throw new L(z.MISC_ERROR,"Block not available (pruned data)");throw new L(z.MISC_ERROR,"Can't read block from disk")}return r?await this.blockToJSON(o,a,s):a.toRaw().toString("hex")},n.prototype.getBlockByHeight=async function(t,e){if(e||t.length<1||t.length>3)throw new L(z.MISC_ERROR,'getblockbyheight "height" ( verbose )');const i=new C([t]),n=i.u32(0,-1),r=i.bool(1,!0),s=i.bool(2,!1);if(-1===n)throw new L(z.TYPE_ERROR,"Invalid block height.");const o=await this.chain.getEntry(n);if(!o)throw new L(z.MISC_ERROR,"Block not found");const a=await this.chain.getBlock(o.hash);if(!a){if(this.chain.options.spv)throw new L(z.MISC_ERROR,"Block not available (spv mode)");if(this.chain.options.prune)throw new L(z.MISC_ERROR,"Block not available (pruned data)");throw new L(z.DATABASE_ERROR,"Can't read block from disk")}return r?await this.blockToJSON(o,a,s):a.toRaw().toString("hex")},n.prototype.getBlockHash=async function(t,e){if(e||1!==t.length)throw new L(z.MISC_ERROR,"getblockhash index");const i=new C([t]).u32(0);if(null==i||i>this.chain.height)throw new L(z.INVALID_PARAMETER,"Block height out of range.");const n=await this.chain.getHash(i);if(!n)throw new L(z.MISC_ERROR,"Not found.");return l.revHex(n)},n.prototype.getBlockHeader=async function(t,e){if(e||t.length<1||t.length>2)throw new L(z.MISC_ERROR,'getblockheader "hash" ( verbose )');const i=new C([t]),n=i.hash(0),r=i.bool(1,!0);if(!n)throw new L(z.MISC_ERROR,"Invalid block hash.");const s=await this.chain.getEntry(n);if(!s)throw new L(z.MISC_ERROR,"Block not found");return r?await this.headerToJSON(s):s.toRaw().toString("hex",0,80)},n.prototype.getChainTips=async function(t,e){if(e||0!==t.length)throw new L(z.MISC_ERROR,"getchaintips");const i=await this.chain.getTips(),n=[];for(const t of i){const e=await this.chain.getEntry(t);f(e);const i=await this.findFork(e),r=await this.chain.isMainChain(e);n.push({height:e.height,hash:e.rhash(),branchlen:e.height-i.height,status:r?"active":"valid-headers"})}return n},n.prototype.getDifficulty=async function(t,e){if(e||0!==t.length)throw new L(z.MISC_ERROR,"getdifficulty");return u(this.chain.tip.bits)},n.prototype.getMempoolInfo=async function(t,e){if(e||0!==t.length)throw new L(z.MISC_ERROR,"getmempoolinfo");if(!this.mempool)throw new L(z.MISC_ERROR,"No mempool available.");return{size:this.mempool.map.size,bytes:this.mempool.getSize(),usage:this.mempool.getSize(),maxmempool:this.mempool.options.maxSize,mempoolminfee:w.wmcc(this.mempool.options.minRelay,!0)}},n.prototype.getMempoolAncestors=async function(t,e){if(e||t.length<1||t.length>2)throw new L(z.MISC_ERROR,"getmempoolancestors txid (verbose)");const i=new C([t]),n=i.hash(0),r=i.bool(1,!1);if(!this.mempool)throw new L(z.MISC_ERROR,"No mempool available.");if(!n)throw new L(z.TYPE_ERROR,"Invalid TXID.");const s=this.mempool.getEntry(n);if(!s)throw new L(z.MISC_ERROR,"Transaction not in mempool.");const o=this.mempool.getAncestors(s),a=[];if(r)for(const t of o)a.push(this.entryToJSON(t));else for(const t of o)a.push(t.txid());return a},n.prototype.getMempoolDescendants=async function(t,e){if(e||t.length<1||t.length>2)throw new L(z.MISC_ERROR,"getmempooldescendants txid (verbose)");const i=new C([t]),n=i.hash(0),r=i.bool(1,!1);if(!this.mempool)throw new L(z.MISC_ERROR,"No mempool available.");if(!n)throw new L(z.TYPE_ERROR,"Invalid TXID.");const s=this.mempool.getEntry(n);if(!s)throw new L(z.MISC_ERROR,"Transaction not in mempool.");const o=this.mempool.getDescendants(s),a=[];if(r)for(const t of o)a.push(this.entryToJSON(t));else for(const t of o)a.push(t.txid());return a},n.prototype.getMempoolEntry=async function(t,e){if(e||1!==t.length)throw new L(z.MISC_ERROR,"getmempoolentry txid");const i=new C([t]).hash(0);if(!this.mempool)throw new L(z.MISC_ERROR,"No mempool available.");if(!i)throw new L(z.TYPE_ERROR,"Invalid TXID.");const n=this.mempool.getEntry(i);if(!n)throw new L(z.MISC_ERROR,"Transaction not in mempool.");return this.entryToJSON(n)},n.prototype.getRawMempool=async function(t,e){if(e||t.length>1)throw new L(z.MISC_ERROR,"getrawmempool ( verbose )");const i=new C([t]).bool(0,!1);if(!this.mempool)throw new L(z.MISC_ERROR,"No mempool available.");if(i){const t={};for(const e of this.mempool.map.values())t[e.txid()]=this.entryToJSON(e);return t}return this.mempool.getSnapshot().map(l.revHex)},n.prototype.getTXOut=async function(t,e){if(e||t.length<2||t.length>3)throw new L(z.MISC_ERROR,'gettxout "txid" n ( includemempool )');const i=new C([t]),n=i.hash(0),r=i.u32(1),s=i.bool(2,!0);if(this.chain.options.spv)throw new L(z.MISC_ERROR,"Cannot get coins in SPV mode.");if(this.chain.options.prune)throw new L(z.MISC_ERROR,"Cannot get coins when pruned.");if(!n||null==r)throw new L(z.TYPE_ERROR,"Invalid outpoint.");let o;if(s){if(!this.mempool)throw new L(z.MISC_ERROR,"No mempool available.");o=this.mempool.getCoin(n,r)}return o||(o=await this.chain.getCoin(n,r)),o?{bestblock:this.chain.tip.rhash(),confirmations:o.getDepth(this.chain.height),value:w.wmcc(o.value,!0),scriptPubKey:this.scriptToJSON(o.script,!0),version:o.version,coinbase:o.coinbase}:null},n.prototype.getTXOutProof=async function(t,e){if(e||1!==t.length&&2!==t.length)throw new L(z.MISC_ERROR,'gettxoutproof ["txid",...] ( blockhash )');const i=new C([t]),n=i.array(0),r=i.hash(1);if(this.chain.options.spv)throw new L(z.MISC_ERROR,"Cannot get coins in SPV mode.");if(this.chain.options.prune)throw new L(z.MISC_ERROR,"Cannot get coins when pruned.");if(!n||0===n.length)throw new L(z.INVALID_PARAMETER,"Invalid TXIDs.");const s=new C([n]),o=new Set,a=[];let h=null;for(let t=0;t<n.length;t++){const e=s.hash(t);if(!e)throw new L(z.TYPE_ERROR,"Invalid TXID.");if(o.has(e))throw new L(z.INVALID_PARAMETER,"Duplicate txid.");o.add(e),a.push(e),h=e}let c=null;if(r)c=await this.chain.getBlock(r);else if(this.chain.options.indexTX){const t=await this.chain.getMeta(h);t&&(c=await this.chain.getBlock(t.block))}else{const t=await this.chain.getCoin(h,0);t&&(c=await this.chain.getBlock(t.height))}if(!c)throw new L(z.MISC_ERROR,"Block not found.");for(const t of a)if(!c.hasTX(t))throw new L(z.VERIFY_ERROR,"Block does not contain all txids.");return(c=_.fromHashes(c,a)).toRaw().toString("hex")},n.prototype.verifyTXOutProof=async function(t,e){if(e||1!==t.length)throw new L(z.MISC_ERROR,'verifytxoutproof "proof"');const i=new C([t]).buf(0);if(!i)throw new L(z.TYPE_ERROR,"Invalid hex string.");const n=_.fromRaw(i);if(!n.verify())return[];if(!await this.chain.getEntry(n.hash("hex")))throw new L(z.MISC_ERROR,"Block not found in chain.");const r=n.getTree(),s=[];for(const t of r.matches)s.push(l.revHex(t));return s},n.prototype.getTXOutSetInfo=async function(t,e){if(e||0!==t.length)throw new L(z.MISC_ERROR,"gettxoutsetinfo");if(this.chain.options.spv)throw new L(z.MISC_ERROR,"Chainstate not available (SPV mode).");return{height:this.chain.height,bestblock:this.chain.tip.rhash(),transactions:this.chain.db.state.tx,txouts:this.chain.db.state.coin,bytes_serialized:0,hash_serialized:0,total_amount:w.wmcc(this.chain.db.state.value,!0)}},n.prototype.pruneBlockchain=async function(t,e){if(e||0!==t.length)throw new L(z.MISC_ERROR,"pruneblockchain");if(this.chain.options.spv)throw new L(z.MISC_ERROR,"Cannot prune chain in SPV mode.");if(this.chain.options.prune)throw new L(z.MISC_ERROR,"Chain is already pruned.");if(this.chain.height<this.network.block.pruneAfterHeight)throw new L(z.MISC_ERROR,"Chain is too short for pruning.");try{await this.chain.prune()}catch(t){throw new L(z.DATABASE_ERROR,t.message)}},n.prototype.verifyChain=async function(t,e){if(e||t.length>2)throw new L(z.MISC_ERROR,"verifychain ( checklevel numblocks )");const i=new C([t]),n=i.u32(0),r=i.u32(1);if(null==n||null==r)throw new L(z.TYPE_ERROR,"Missing parameters.");if(this.chain.options.spv)throw new L(z.MISC_ERROR,"Cannot verify chain in SPV mode.");if(this.chain.options.prune)throw new L(z.MISC_ERROR,"Cannot verify chain when pruned.");return null},n.prototype.submitWork=async function(t){const e=await this.locker.lock();try{return await this._submitWork(t)}finally{e()}},n.prototype._submitWork=async function(t){const e=this.attempt;if(!e)return!1;if(128!==t.length)throw new L(z.INVALID_PARAMETER,"Invalid work size.");const i=t.slice(0,80);r(i);const n=E.fromHead(i);if(n.prevBlock!==e.prevBlock||n.bits!==e.bits)return!1;if(!n.verify())return!1;const s=this.merkleMap.get(n.merkleRoot);if(!s)return!1;const[o,a]=s,h=n.nonce,c=n.time,u=e.getProof(o,a,c,h);if(!u.verify(e.target))return!1;const f=e.commit(u);let l;try{l=await this.chain.add(f)}catch(t){if("VerifyError"===t.type)return this.logger.warning("RPC block rejected: %s (%s).",f.rhash(),t.reason),!1;throw t}return!!l||(this.logger.warning("RPC block rejected: %s (bad-prevblk).",f.rhash()),!1)},n.prototype.createWork=async function(t){const e=await this.locker.lock();try{return await this._createWork(t)}finally{e()}},n.prototype._createWork=async function(){const t=await this.updateWork(),e=this.nonce1,i=this.nonce2,n=t.time,s=Buffer.allocUnsafe(128);s.fill(0);const o=t.getRoot(e,i);return t.getHeader(o,n,0).copy(s,0),s[80]=128,s.writeUInt32BE(640,s.length-4,!0),r(s),{data:s.toString("hex"),target:t.target.toString("hex"),height:t.height}},n.prototype.getWorkLongpoll=async function(t,e){return await this.longpoll(),await this.createWork()},n.prototype.getWork=async function(t,e){if(t.length>1)throw new L(z.MISC_ERROR,'getwork ( "data" )');if(1===t.length){const e=new C([t]).buf(0);if(!e)throw new L(z.TYPE_ERROR,"Invalid work data.");return await this.submitWork(e)}return await this.createWork()},n.prototype.submitBlock=async function(t,e){if(e||t.length<1||t.length>2)throw new L(z.MISC_ERROR,'submitblock "hexdata" ( "jsonparametersobject" )');const i=new C([t]).buf(0),n=S.fromRaw(i);return await this.addBlock(n)},n.prototype.getBlockTemplate=async function(t,e){if(e||t.length>1)throw new L(z.MISC_ERROR,'getblocktemplate ( "jsonrequestobject" )');const i=new C([t]).obj(0,{}),n=new C([i]),r=n.str("mode","template");if("template"!==r&&"proposal"!==r)throw new L(z.INVALID_PARAMETER,"Invalid mode.");if("proposal"===r){const t=n.buf("data");if(!t)throw new L(z.TYPE_ERROR,"Missing data parameter.");const e=S.fromRaw(t);if(e.prevBlock!==this.chain.tip.hash)return"inconclusive-not-best-prevblk";try{await this.chain.verifyBlock(e)}catch(t){if("VerifyError"===t.type)return t.reason;throw t}return null}let s=n.u32("maxversion",-1),o=n.array("rules");o&&(s=-1);const a=n.array("capabilities");let h=!1;if(a){let t=!1,e=!1;for(const i of a){if("string"!=typeof i)throw new L(z.TYPE_ERROR,"Invalid capability.");switch(i){case"coinbasetxn":t=!0;break;case"coinbasevalue":e=!0}}if(e=!0,t&&!e){if(0===this.miner.addresses.length)throw new L(z.MISC_ERROR,"No addresses available for coinbase.");h=!0}}if(!this.network.selfConnect){if(0===this.pool.peers.size())throw new L(z.CLIENT_NOT_CONNECTED,"WMCoin is not connected!");if(!this.chain.synced)throw new L(z.CLIENT_IN_INITIAL_DOWNLOAD,"WMCoin is downloading blocks...")}const c=n.str("longpollid");return c&&await this.handleLongpoll(c),o||(o=[]),await this.createTemplate(s,h,o)},n.prototype.createTemplate=async function(t,e,i){const n=await this.locker.lock();try{return await this._createTemplate(t,e,i)}finally{n()}},n.prototype._createTemplate=async function(t,e,i){const n=await this.getTemplate(),r=n.witness?1:T.WITNESS_SCALE_FACTOR,s=["time","transactions","prevblock"];t>=2&&s.push("version/force"),e&&(s.push("coinbase"),s.push("coinbase/append"),s.push("generation"));const o=new Map;for(let t=0;t<n.items.length;t++){const e=n.items[t];o.set(e.hash,t+1)}const a=[];for(let t=0;t<n.items.length;t++){const e=n.items[t],i=e.tx,s=[];for(let e=0;e<i.inputs.length;e++){const n=i.inputs[e],r=o.get(n.prevout.hash);null!=r&&(-1===s.indexOf(r)&&(f(r<t+1),s.push(r)))}a.push({data:i.toRaw().toString("hex"),txid:i.txid(),hash:i.wtxid(),depends:s,fee:e.fee,sigops:e.sigops/r|0,weight:i.getWeight()})}this.chain.options.bip91&&(i.push("segwit"),i.push("segsignal")),this.chain.options.bip148&&i.push("segwit");let h=n.version;const c={},u=[];for(const t of this.network.deploys){const e=await this.chain.getState(this.chain.tip,t);let n=t.name;switch(e){case g.thresholdStates.DEFINED:case g.thresholdStates.FAILED:break;case g.thresholdStates.LOCKED_IN:h|=1<<t.bit;case g.thresholdStates.STARTED:t.force||(-1===i.indexOf(n)&&(h&=~(1<<t.bit)),t.required&&(n="!"+n)),c[n]=t.bit;break;case g.thresholdStates.ACTIVE:if(!t.force&&t.required){if(-1===i.indexOf(n))throw new L(z.INVALID_PARAMETER,`Client must support ${n}.`);n="!"+n}u.push(n);break;default:f(!1,"Bad state.")}}const p={capabilities:["proposal"],mutable:s,version:h>>>=0,rules:u,vbavailable:c,vbrequired:0,height:n.height,previousblockhash:l.revHex(n.prevBlock),target:l.revHex(n.target.toString("hex")),bits:l.hex32(n.bits),noncerange:"00000000ffffffff",curtime:n.time,mintime:n.mtp+1,maxtime:n.time+7200,expires:n.time+7200,sigoplimit:T.MAX_BLOCK_SIGOPS_COST/r|0,sizelimit:T.MAX_BLOCK_SIZE,weightlimit:void 0,longpollid:this.chain.tip.rhash()+l.pad32(this.totalTX()),submitold:!1,coinbaseaux:{flags:n.coinbaseFlags.toString("hex")},coinbasevalue:void 0,coinbasetxn:void 0,default_witness_commitment:void 0,transactions:a};if(n.witness&&(p.sizelimit=T.MAX_RAW_BLOCK_SIZE,p.weightlimit=T.MAX_BLOCK_WEIGHT),e){const t=n.toCoinbase(),e=t.inputs[0];if(e.script.pop(),e.script.compile(),n.witness){const i=t.outputs.pop();f(i.script.isCommitment()),e.witness.clear()}t.refresh(),p.coinbasetxn={data:t.toRaw().toString("hex"),txid:t.txid(),hash:t.wtxid(),depends:[],fee:0,sigops:t.getSigopsCost()/r|0,weight:t.getWeight()}}else p.coinbasevalue=n.getReward();return-1!==i.indexOf("segwit")&&(p.default_witness_commitment=n.getWitnessScript().toJSON()),p},n.prototype.getMiningInfo=async function(t,e){if(e||0!==t.length)throw new L(z.MISC_ERROR,"getmininginfo");const i=this.attempt;let n=0,r=0,s=0,o=0;if(i){r=i.weight,s=i.items.length+1,o=i.getDifficulty(),n=1e3;for(const t of i.items)n+=t.tx.getBaseSize()}return{blocks:this.chain.height,currentblocksize:n,currentblockweight:r,currentblocktx:s,difficulty:o,errors:"",genproclimit:this.procLimit,networkhashps:await this.getHashRate(120),pooledtx:this.totalTX(),testnet:this.network!==A.mainnet,chain:"testnet"!==this.network.type?this.network.type:"test",generate:this.mining}},n.prototype.getNetworkHashPS=async function(t,e){if(e||t.length>2)throw new L(z.MISC_ERROR,"getnetworkhashps ( blocks height )");const i=new C([t]),n=i.u32(0,120),r=i.u32(1);return await this.getHashRate(n,r)},n.prototype.prioritiseTransaction=async function(t,e){if(e||3!==t.length)throw new L(z.MISC_ERROR,"prioritisetransaction <txid> <priority delta> <fee delta>");const i=new C([t]),n=i.hash(0),r=i.i64(1),s=i.i64(2);if(!this.mempool)throw new L(z.MISC_ERROR,"No mempool available.");if(!n)throw new L(z.TYPE_ERROR,"Invalid TXID");if(null==r||null==s)throw new L(z.TYPE_ERROR,"Invalid fee or priority.");const o=this.mempool.getEntry(n);if(!o)throw new L(z.MISC_ERROR,"Transaction not in mempool.");return this.mempool.prioritise(o,r,s),!0},n.prototype.verifyBlock=async function(t,e){if(e||1!==t.length)throw new L(z.MISC_ERROR,'verifyblock "block-hex"');const i=new C([t]).buf(0);if(!i)throw new L(z.TYPE_ERROR,"Invalid block hex.");if(this.chain.options.spv)throw new L(z.MISC_ERROR,"Cannot verify block in SPV mode.");const n=S.fromRaw(i);try{await this.chain.verifyBlock(n)}catch(t){if("VerifyError"===t.type)return t.reason;throw t}return null},n.prototype.getGenerate=async function(t,e){if(e||0!==t.length)throw new L(z.MISC_ERROR,"getgenerate");return this.mining},n.prototype.setGenerate=async function(t,e){if(e||t.length<1||t.length>2)throw new L(z.MISC_ERROR,"setgenerate mine ( proclimit )");const i=new C([t]),n=i.bool(0,!1),r=i.u32(1,0);if(n&&0===this.miner.addresses.length)throw new L(z.MISC_ERROR,"No addresses available for coinbase.");return this.mining=n,this.procLimit=r,n?(this.miner.cpu.start(),!0):(await this.miner.cpu.stop(),!1)},n.prototype.generate=async function(t,e){if(e||t.length<1||t.length>2)throw new L(z.MISC_ERROR,"generate numblocks ( maxtries )");const i=new C([t]),n=i.u32(0,1),r=i.u32(1);if(0===this.miner.addresses.length)throw new L(z.MISC_ERROR,"No addresses available for coinbase.");return await this.mineBlocks(n,null,r)},n.prototype.generateToAddress=async function(t,e){if(e||t.length<2||t.length>3)throw new L(z.MISC_ERROR,"generatetoaddress numblocks address ( maxtries )");const i=new C([t]),n=i.u32(0,1),r=i.str(1,""),s=i.u32(2),a=o(r,this.network);return await this.mineBlocks(n,a,s)},n.prototype.createRawTransaction=async function(t,e){if(e||t.length<2||t.length>3)throw new L(z.MISC_ERROR,'createrawtransaction [{"txid":"id","vout":n},...] {"address":amount,"data":"hex",...} ( locktime )');const i=new C([t]),n=i.array(0),r=i.obj(1),s=i.u32(2);if(!n||!r)throw new L(z.TYPE_ERROR,"Invalid parameters (inputs and sendTo).");const a=new I;null!=s&&(a.locktime=s);for(const t of a.inputs){const e=new C([t]),i=e.hash("txid"),n=e.u32("vout");let r=e.u32("sequence",4294967295);if(a.locktime&&r--,!i||null==n)throw new L(z.TYPE_ERROR,"Invalid outpoint.");const s=new R;s.prevout.hash=i,s.prevout.index=n,s.sequence=r,a.inputs.push(s)}const h=new C([r]),c=new Set;for(const t of Object.keys(r)){if("data"===t){const e=h.buf(t);if(!e)throw new L(z.TYPE_ERROR,"Invalid nulldata..");const i=new B;i.value=0,i.script.fromNulldata(e),a.outputs.push(i);continue}const e=o(t,this.network),i=e.toString(this.network);if(c.has(i))throw new L(z.INVALID_PARAMETER,"Duplicate address");c.add(i);const n=h.ufixed(t,8);if(null==n)throw new L(z.TYPE_ERROR,"Invalid output value.");const r=new B;r.value=n,r.script.fromAddress(e),a.outputs.push(r)}return a.toRaw().toString("hex")},n.prototype.decodeRawTransaction=async function(t,e){if(e||1!==t.length)throw new L(z.MISC_ERROR,'decoderawtransaction "hexstring"');const i=new C([t]).buf(0);if(!i)throw new L(z.TYPE_ERROR,"Invalid hex string.");const n=P.fromRaw(i);return this.txToJSON(n)},n.prototype.decodeScript=async function(t,e){if(e||1!==t.length)throw new L(z.MISC_ERROR,'decodescript "hex"');const i=new C([t]).buf(0);let n=new v;i&&(n=v.fromRaw(i));const r=k.fromScripthash(n.hash160()),s=this.scriptToJSON(n);return s.p2sh=r.toString(this.network),s},n.prototype.getRawTransaction=async function(t,e){if(e||t.length<1||t.length>2)throw new L(z.MISC_ERROR,'getrawtransaction "txid" ( verbose )');const i=new C([t]),n=i.hash(0),r=i.bool(1,!1);if(!n)throw new L(z.TYPE_ERROR,"Invalid TXID.");const s=await this.node.getMeta(n);if(!s)throw new L(z.MISC_ERROR,"Transaction not found.");const o=s.tx;if(!r)return o.toRaw().toString("hex");let a;s.block&&(a=await this.chain.getEntry(s.block));const h=this.txToJSON(o,a);return h.time=s.mtime,h.hex=o.toRaw().toString("hex"),h},n.prototype.sendRawTransaction=async function(t,e){if(e||t.length<1||t.length>2)throw new L(z.MISC_ERROR,'sendrawtransaction "hexstring" ( allowhighfees )');const i=new C([t]).buf(0);if(!i)throw new L(z.TYPE_ERROR,"Invalid hex string.");const n=P.fromRaw(i);return this.node.relay(n),n.txid()},n.prototype.signRawTransaction=async function(t,e){if(e||t.length<1||t.length>4)throw new L(z.MISC_ERROR,'signrawtransaction "hexstring" ( [{"txid":"id","vout":n,"scriptPubKey":"hex",redeemScript":"hex"},...] ["privatekey1",...] sighashtype )');const i=new C([t]),n=i.buf(0),r=i.array(1),s=i.array(2),o=i.str(3);if(!n)throw new L(z.TYPE_ERROR,"Invalid hex string.");if(!this.mempool)throw new L(z.MISC_ERROR,"No mempool available.");const h=I.fromRaw(n);h.view=await this.mempool.getSpentView(h);const c=new Map,u=[];if(s){const t=new C([s]);for(let e=0;e<s.length;e++){const i=a(t.str(e,""),this.network);c.set(i.getPublicKey("hex"),i),u.push(i)}}if(r)for(const t of r){const e=new C([t]),i=e.hash("txid"),n=e.u32("index"),r=e.buf("scriptPubKey"),s=e.ufixed("amount",8),o=e.buf("redeemScript");if(!i||null==n||!r||null==s)throw new L(z.INVALID_PARAMETER,"Invalid UTXO.");const a=new O(i,n),f=v.fromRaw(r),l=B.fromScript(f,s);if(h.view.addOutput(a,l),0===u.length||!o)continue;if(!f.isScripthash()&&!f.isWitnessScripthash())continue;if(!o)throw new L(z.INVALID_PARAMETER,"P2SH requires redeem script.");const p=v.fromRaw(o);for(const t of p.code){if(!t.data)continue;const e=c.get(t.data.toString("hex"));if(e){e.script=p,e.witness=f.isWitnessScripthash(),e.refresh();break}}}let f=v.hashType.ALL;if(o){const t=o.split("|");if(t.length<1||t.length>2)throw new L(z.INVALID_PARAMETER,"Invalid sighash type.");if(null==(f=v.hashType[t[0]]))throw new L(z.INVALID_PARAMETER,"Invalid sighash type.");if(2===t.length){if("ANYONECANPAY"!==t[1])throw new L(z.INVALID_PARAMETER,"Invalid sighash type.");f|=v.hashType.ANYONECANPAY}}return await h.signAsync(u,f,this.workers),{hex:h.toRaw().toString("hex"),complete:h.isSigned()}},n.prototype.createMultisig=async function(t,e){if(e||t.length<2||t.length>2)throw new L(z.MISC_ERROR,'createmultisig nrequired ["key",...]');const i=new C([t]),n=i.array(1,[]),r=i.u32(0,0),s=n.length;if(r<1||s<r||s>16)throw new L(z.INVALID_PARAMETER,"Invalid m and n values.");const o=new C([n]);for(let t=0;t<n.length;t++){const e=o.buf(t);if(!e)throw new L(z.TYPE_ERROR,"Invalid key.");if(!y.publicKeyVerify(e))throw new L(z.INVALID_ADDRESS_OR_KEY,"Invalid key.");n[t]=e}const a=v.fromMultisig(r,s,n);if(a.getSize()>T.MAX_SCRIPT_PUSH)throw new L(z.VERIFY_ERROR,"Redeem script exceeds size limit.");return{address:a.getAddress().toString(this.network),redeemScript:a.toJSON()}},n.prototype.createWitnessAddress=async function(t,e){if(e||1!==t.length)throw new L(z.MISC_ERROR,'createwitnessaddress "script"');const i=new C([t]).buf(0);if(!i)throw new L(z.TYPE_ERROR,"Invalid script hex.");const n=v.fromRaw(i).forWitness();return{address:n.getAddress().toString(this.network),witnessScript:n.toJSON()}},n.prototype.validateAddress=async function(t,e){if(e||1!==t.length)throw new L(z.MISC_ERROR,'validateaddress "wmccaddress"');const i=new C([t]).str(0,"");let n;try{n=k.fromString(i,this.network)}catch(t){return{isvalid:!1}}const r=v.fromAddress(n);return{isvalid:!0,address:n.toString(this.network),scriptPubKey:r.toJSON(),ismine:!1,iswatchonly:!1}},n.prototype.verifyMessage=async function(t,e){if(e||3!==t.length)throw new L(z.MISC_ERROR,'verifymessage "wmccaddress" "signature" "message"');const i=new C([t]),n=i.str(0,""),r=i.buf(1,null,"base64"),s=i.str(2);if(!r||!s)throw new L(z.TYPE_ERROR,"Invalid parameters.");const a=o(n,this.network),h=Buffer.from(D+s,"utf8"),c=d.hash256(h),u=y.recover(c,r,0,!0);return!!u&&m(d.hash160(u),a.hash)},n.prototype.signMessageWithPrivkey=async function(t,e){if(e||2!==t.length)throw new L(z.MISC_ERROR,'signmessagewithprivkey "privkey" "message"');const i=new C([t]),n=i.str(0,""),r=i.str(1,""),s=a(n,this.network),o=Buffer.from(D+r,"utf8"),h=d.hash256(o);return s.sign(h).toString("base64")},n.prototype.estimateFee=async function(t,e){if(e||1!==t.length)throw new L(z.MISC_ERROR,"estimatefee nblocks");const i=new C([t]).u32(0,1);if(!this.fees)throw new L(z.MISC_ERROR,"Fee estimation not available.");const n=this.fees.estimateFee(i,!1);return 0===n?-1:w.wmcc(n,!0)},n.prototype.estimatePriority=async function(t,e){if(e||1!==t.length)throw new L(z.MISC_ERROR,"estimatepriority nblocks");const i=new C([t]).u32(0,1);if(!this.fees)throw new L(z.MISC_ERROR,"Priority estimation not available.");return this.fees.estimatePriority(i,!1)},n.prototype.estimateSmartFee=async function(t,e){if(e||1!==t.length)throw new L(z.MISC_ERROR,"estimatesmartfee nblocks");const i=new C([t]).u32(0,1);if(!this.fees)throw new L(z.MISC_ERROR,"Fee estimation not available.");let n=this.fees.estimateFee(i,!0);return n=0===n?-1:w.wmcc(n,!0),{fee:n,blocks:i}},n.prototype.estimateSmartPriority=async function(t,e){if(e||1!==t.length)throw new L(z.MISC_ERROR,"estimatesmartpriority nblocks");const i=new C([t]).u32(0,1);if(!this.fees)throw new L(z.MISC_ERROR,"Priority estimation not available.");return{priority:this.fees.estimatePriority(i,!0),blocks:i}},n.prototype.invalidateBlock=async function(t,e){if(e||1!==t.length)throw new L(z.MISC_ERROR,'invalidateblock "hash"');const i=new C([t]).hash(0);if(!i)throw new L(z.TYPE_ERROR,"Invalid block hash.");return await this.chain.invalidate(i),null},n.prototype.reconsiderBlock=async function(t,e){if(e||1!==t.length)throw new L(z.MISC_ERROR,'reconsiderblock "hash"');const i=new C([t]).hash(0);if(!i)throw new L(z.TYPE_ERROR,"Invalid block hash.");return this.chain.removeInvalid(i),null},n.prototype.setMockTime=async function(t,e){if(e||1!==t.length)throw new L(z.MISC_ERROR,"setmocktime timestamp");const i=new C([t]).u32(0);if(null==i)throw new L(z.TYPE_ERROR,"Invalid timestamp.");this.network.time.offset=0;const n=this.network.now()-i;return this.network.time.offset=-n,null},n.prototype.getMemoryInfo=async function(t,e){if(e||0!==t.length)throw new L(z.MISC_ERROR,"getmemoryinfo");return l.memoryUsage()},n.prototype.setLogLevel=async function(t,e){if(e||1!==t.length)throw new L(z.MISC_ERROR,'setloglevel "level"');const i=new C([t]).str(0,"");return this.logger.setLevel(i),null},n.prototype.handleLongpoll=async function(t){if(74!==t.length)throw new L(z.INVALID_PARAMETER,"Invalid longpoll ID.");const e=t.slice(0,64),i=parseInt(t.slice(64,74),10);if(!l.isHex(e)||!l.isU32(i))throw new L(z.INVALID_PARAMETER,"Invalid longpoll ID.");const n=l.revHex(e);this.chain.tip.hash===n&&await this.longpoll()},n.prototype.longpoll=function(){return new Promise((t,e)=>{this.pollers.push(p.job(t,e))})},n.prototype.refreshBlock=function(){const t=this.pollers;this.attempt=null,this.lastActivity=0,this.merkleMap.clear(),this.nonce1=0,this.nonce2=0,this.pollers=[];for(const e of t)e.resolve()},n.prototype.bindChain=function(){this.boundChain||(this.boundChain=!0,this.node.on("connect",()=>{this.attempt&&this.refreshBlock()}),this.mempool&&this.node.on("tx",()=>{this.attempt&&l.now()-this.lastActivity>10&&this.refreshBlock()}))},n.prototype.getTemplate=async function(){this.bindChain();let t=this.attempt;return t?this.miner.updateTime(t):(t=await this.miner.createBlock(),this.attempt=t,this.lastActivity=l.now()),t},n.prototype.updateWork=async function(){this.bindChain();let t=this.attempt;if(t){if(t.address.isNull())throw new L(z.MISC_ERROR,"No addresses available for coinbase.");this.miner.updateTime(t),4294967296==++this.nonce2&&(this.nonce2=0,this.nonce1++);const e=this.nonce1,i=this.nonce2,n=t.getRoot(e,i).toString("hex");return this.merkleMap.set(n,[e,i]),t}if(0===this.miner.addresses.length)throw new L(z.MISC_ERROR,"No addresses available for coinbase.");t=await this.miner.createBlock();const e=this.nonce1,i=this.nonce2,n=t.getRoot(e,i).toString("hex");return this.attempt=t,this.lastActivity=l.now(),this.merkleMap.set(n,[e,i]),t},n.prototype.addBlock=async function(t){const e=await this.locker.lock(),i=await this.chain.locker.lock();try{return await this._addBlock(t)}finally{i(),e()}},n.prototype._addBlock=async function(t){this.logger.info("Handling submitted block: %s.",t.rhash());const e=await this.chain.getEntry(t.prevBlock);if(e){if((await this.chain.getDeployments(t.time,e)).hasWitness()&&t.getCommitmentHash()){const e=t.txs[0],i=e.inputs[0];e.hasWitness()||(this.logger.warning("Submitted block had no witness nonce."),this.logger.debug(e),i.witness.push(N.ZERO_HASH),i.witness.compile(),e.refresh(),t.refresh())}}let i;try{i=await this.chain._add(t)}catch(e){if("VerifyError"===e.type)return this.logger.warning("RPC block rejected: %s (%s).",t.rhash(),e.reason),`rejected: ${e.reason}`;throw e}return i?null:(this.logger.warning("RPC block rejected: %s (bad-prevblk).",t.rhash()),"rejected: bad-prevblk")},n.prototype.totalTX=function(){return this.mempool?this.mempool.map.size:0},n.prototype.getSoftforks=function(){return[s("bip34",2,this.chain.state.hasBIP34()),s("bip66",3,this.chain.state.hasBIP66()),s("bip65",4,this.chain.state.hasCLTV())]},n.prototype.getBIP9Softforks=async function(){const t=this.chain.tip,e={};for(const i of this.network.deploys){let n;switch(await this.chain.getState(t,i)){case g.thresholdStates.DEFINED:n="defined";break;case g.thresholdStates.STARTED:n="started";break;case g.thresholdStates.LOCKED_IN:n="locked_in";break;case g.thresholdStates.ACTIVE:n="active";break;case g.thresholdStates.FAILED:n="failed";break;default:f(!1,"Bad state.")}e[i.name]={status:n,bit:i.bit,startTime:i.startTime,timeout:i.timeout}}return e},n.prototype.getHashRate=async function(t,e){let i=this.chain.tip;if(null!=e&&(i=await this.chain.getEntry(e)),!i)return 0;f("number"==typeof t),f(t>=0),0===t&&(t=i.height%this.network.pow.retargetInterval+1),t>i.height&&(t=i.height);let n=i.time,r=n,s=i;for(let e=0;e<t;e++){if(!(s=await this.chain.getPrevious(s)))throw new L(z.DATABASE_ERROR,"Not found.");n=Math.min(s.time,n),r=Math.max(s.time,r)}const o=r-n;if(0===o)return 0;const a=i.chainwork.sub(s.chainwork);return Number(a.toString())/o},n.prototype.mineBlocks=async function(t,e,i){const n=await this.locker.lock();try{return await this._mineBlocks(t,e,i)}finally{n()}},n.prototype._mineBlocks=async function(t,e,i){const n=[];for(let i=0;i<t;i++){const t=await this.miner.mineBlock(null,e),i=await this.chain.add(t);f(i),n.push(i.rhash())}return n},n.prototype.findFork=async function(t){for(;t;){if(await this.chain.isMainChain(t))return t;t=await this.chain.getPrevious(t)}throw new Error("Fork not found.")},n.prototype.txToJSON=function(t,e){let i=-1,n=0,r=null,s=0,o=!1;e&&(i=e.height,n=e.time,r=e.rhash(),s=this.chain.height-i+1);const a=[];for(const e of t.inputs){const i={coinbase:void 0,txid:void 0,scriptSig:void 0,txinwitness:void 0,sequence:e.sequence};t.isCoinbase()?(i.coinbase=e.script.toJSON(),o=!0):(i.txid=e.prevout.txid(),i.vout=e.prevout.index,i.scriptSig={asm:e.script.toASM(),hex:e.script.toJSON()}),e.witness.items.length>0&&(i.txinwitness=e.witness.items.map(t=>t.toString("hex"))),a.push(i)}const h=[];for(let e=0;e<t.outputs.length;e++){const i=t.outputs[e];h.push({value:w.wmcc(i.value,!0),n:e,scriptPubKey:this.scriptToJSON(i.script,!0)})}return{txid:t.txid(),hash:t.wtxid(),size:t.getSize(),vsize:t.getVirtualSize(),version:t.version,locktime:t.locktime,vin:a,vout:h,coinbase:o,blockhash:r,confirmations:s,time:n,blocktime:n,hex:void 0}},n.prototype.scriptToJSON=function(t,e){const i=t.getType(),n={asm:t.toASM(),hex:void 0,type:v.typesByVal[i],reqSigs:1,addresses:[],p2sh:void 0};e&&(n.hex=t.toJSON());const[r]=t.getMultisig();-1!==r&&(n.reqSigs=r);const s=t.getAddress();if(s){const t=s.toString(this.network);n.addresses.push(t)}return n},n.prototype.headerToJSON=async function(t){const e=await this.chain.getMedianTime(t),i=await this.chain.getNextHash(t.hash);return{hash:t.rhash(),confirmations:this.chain.height-t.height+1,height:t.height,version:t.version,versionHex:l.hex32(t.version),merkleroot:l.revHex(t.merkleRoot),time:t.time,mediantime:e,bits:t.bits,difficulty:u(t.bits),chainwork:t.chainwork.toString("hex",64),previousblockhash:t.prevBlock!==N.NULL_HASH?l.revHex(t.prevBlock):null,nextblockhash:i?l.revHex(i):null}},n.prototype.blockToJSON=async function(t,e,i){const n=await this.chain.getMedianTime(t),r=await this.chain.getNextHash(t.hash),s=[];for(const n of e.txs)if(i){const e=this.txToJSON(n,t);s.push(e)}else s.push(n.txid());return{hash:t.rhash(),confirmations:this.chain.height-t.height+1,strippedsize:e.getBaseSize(),size:e.getSize(),weight:e.getWeight(),height:t.height,version:t.version,nonce:e.nonce,versionHex:l.hex32(t.version),merkleroot:l.revHex(t.merkleRoot),coinbase:e.txs[0].inputs[0].script.toJSON(),tx:s,time:t.time,mediantime:n,bits:t.bits,difficulty:u(t.bits),chainwork:t.chainwork.toString("hex",64),previousblockhash:t.prevBlock!==N.NULL_HASH?l.revHex(t.prevBlock):null,nextblockhash:r?l.revHex(r):null}},n.prototype.entryToJSON=function(t){return{size:t.size,fee:w.wmcc(t.deltaFee,!0),modifiedfee:0,time:t.time,height:t.height,startingpriority:t.priority,currentpriority:t.getPriority(this.chain.height),descendantcount:this.mempool.countDescendants(t),descendantsize:t.descSize,descendantfees:t.descFee,ancestorcount:this.mempool.countAncestors(t),ancestorsize:0,ancestorfees:0,depends:this.mempool.getDepends(t.tx).map(l.revHex)}},t.exports=n},function(t,e){t.exports=require("os")},function(t,e,i){"use strict";function n(t,e){if(!(this instanceof n))return new n(t,e);this.logger=w.global,this.type=t,this.decay=0,this.maxConfirms=0,this.buckets=new Float64Array(0),this.bucketMap=new o,this.confAvg=[],this.curBlockConf=[],this.unconfTX=[],this.oldUnconfTX=new Int32Array(0),this.curBlockTX=new Int32Array(0),this.txAvg=new Float64Array(0),this.curBlockVal=new Float64Array(0),this.avg=new Float64Array(0),e&&(f("object"==typeof e),this.logger=e.context("fees"))}function r(t){if(!(this instanceof r))return new r(t);this.logger=w.global,this.minTrackedFee=b,this.minTrackedPri=k,this.feeStats=new n("FeeRate"),this.priStats=new n("Priority"),this.feeUnlikely=0,this.feeLikely=v,this.priUnlikely=0,this.priLikely=S,this.map=new Map,this.bestHeight=0,d.MIN_RELAY>=b&&(this.minTrackedFee=d.MIN_RELAY),d.FREE_THRESHOLD>=k&&(this.minTrackedPri=d.FREE_THRESHOLD),t&&(f("object"==typeof t),this.logger=t.context("fees"),this.feeStats.logger=this.logger,this.priStats.logger=this.logger)}function s(){this.blockHeight=-1,this.bucketIndex=-1}function o(){if(!(this instanceof o))return new o;this.buckets=[]}function a(t,e){return t[0]-e}function h(t){return y.sizeVarint(t.length)+8*t.length}function c(t,e){t.writeVarint(e.length);for(let i=0;i<e.length;i++)t.writeDouble(e[i])}function u(t){const e=new Float64Array(t.readVarint());for(let i=0;i<e.length;i++)e[i]=t.readDouble();return e}const f=i(0),l=i(1),p=i(7),d=i(19),m=i(2),g=i(4),y=i(3),w=i(34),b=10,v=p.getMaxMoney(),k=10,S=1e9*p.getMaxMoney();n.prototype.init=function(t,e,i){this.maxConfirms=e,this.decay=i,this.buckets=new Float64Array(t.length),this.bucketMap=new o;for(let e=0;e<t.length;e++)this.buckets[e]=t[e],this.bucketMap.insert(t[e],e);this.confAvg=new Array(e),this.curBlockConf=new Array(e),this.unconfTX=new Array(e);for(let i=0;i<e;i++)this.confAvg[i]=new Float64Array(t.length),this.curBlockConf[i]=new Int32Array(t.length),this.unconfTX[i]=new Int32Array(t.length);this.oldUnconfTX=new Int32Array(t.length),this.curBlockTX=new Int32Array(t.length),this.txAvg=new Float64Array(t.length),this.curBlockVal=new Float64Array(t.length),this.avg=new Float64Array(t.length)},n.prototype.clearCurrent=function(t){for(let e=0;e<this.buckets.length;e++){this.oldUnconfTX[e]=this.unconfTX[t%this.unconfTX.length][e],this.unconfTX[t%this.unconfTX.length][e]=0;for(let t=0;t<this.curBlockConf.length;t++)this.curBlockConf[t][e]=0;this.curBlockTX[e]=0,this.curBlockVal[e]=0}},n.prototype.record=function(t,e){if(t<1)return;const i=this.bucketMap.search(e);for(let e=t;e<=this.curBlockConf.length;e++)this.curBlockConf[e-1][i]++;this.curBlockTX[i]++,this.curBlockVal[i]+=e},n.prototype.updateAverages=function(){for(let t=0;t<this.buckets.length;t++){for(let e=0;e<this.confAvg.length;e++)this.confAvg[e][t]=this.confAvg[e][t]*this.decay+this.curBlockConf[e][t];this.avg[t]=this.avg[t]*this.decay+this.curBlockVal[t],this.txAvg[t]=this.txAvg[t]*this.decay+this.curBlockTX[t]}},n.prototype.estimateMedian=function(t,e,i,n,r){const s=this.buckets.length-1,o=n?s:0,a=n?-1:1,h=this.unconfTX.length;let c=0,u=0,f=0,l=o,p=o,d=o,m=o,g=!1,y=-1,w=0;for(let y=o;y>=0&&y<=s;y+=a){p=y,c+=this.confAvg[t-1][y],u+=this.txAvg[y];for(let e=t;e<this.maxConfirms;e++)f+=this.unconfTX[Math.max(r-e,0)%h][y];if(f+=this.oldUnconfTX[y],u>=e/(1-this.decay)){const t=c/(u+f);if(n&&t<i)break;if(!n&&t>i)break;g=!0,c=0,u=0,f=0,d=l,m=p,l=y+a}}const b=d<m?d:m,v=d>m?d:m;for(let t=b;t<=v;t++)w+=this.txAvg[t];if(g&&0!==w){w/=2;for(let t=b;t<=v;t++){if(!(this.txAvg[t]<w)){y=this.avg[t]/this.txAvg[t];break}w-=this.txAvg[t]}}return y},n.prototype.addTX=function(t,e){const i=this.bucketMap.search(e),n=t%this.unconfTX.length;return this.unconfTX[n][i]++,this.logger.spam("Adding tx to %s.",this.type),i},n.prototype.removeTX=function(t,e,i){let n=e-t;if(0===e&&(n=0),n<0)this.logger.debug("Blocks ago is negative for mempool tx.");else if(n>=this.unconfTX.length)this.oldUnconfTX[i]>0?this.oldUnconfTX[i]--:this.logger.debug("Mempool tx removed >25 blocks (bucket=%d).",i);else{const e=t%this.unconfTX.length;this.unconfTX[e][i]>0?this.unconfTX[e][i]--:this.logger.debug("Mempool tx removed (block=%d, bucket=%d).",e,i)}},n.prototype.getSize=function(){let t=0;t+=8,t+=h(this.buckets),t+=h(this.avg),t+=h(this.txAvg),t+=y.sizeVarint(this.maxConfirms);for(let e=0;e<this.maxConfirms;e++)t+=h(this.confAvg[e]);return t},n.prototype.toRaw=function(){const t=this.getSize(),e=new g(t);e.writeDouble(this.decay),c(e,this.buckets),c(e,this.avg),c(e,this.txAvg),e.writeVarint(this.maxConfirms);for(let t=0;t<this.maxConfirms;t++)c(e,this.confAvg[t]);return e.render()},n.prototype.fromRaw=function(t){const e=new m(t),i=e.readDouble(),n=u(e),r=u(e),s=u(e),o=e.readVarint(),a=new Array(o);for(let t=0;t<o;t++)a[t]=u(e);if(i<=0||i>=1)throw new Error("Decay must be between 0 and 1 (non-inclusive).");if(n.length<=1||n.length>1e3)throw new Error("Must have between 2 and 1000 fee/pri buckets.");if(r.length!==n.length)throw new Error("Mismatch in fee/pri average bucket count.");if(s.length!==n.length)throw new Error("Mismatch in tx count bucket count.");if(o<=0||o>1008)throw new Error("Must maintain estimates for between 1 and 1008 confirms.");for(let t=0;t<o;t++)if(a[t].length!==n.length)throw new Error("Mismatch in fee/pri conf average bucket count.");return this.init(n,o,i),this.avg=r,this.txAvg=s,this.confAvg=a,this},n.fromRaw=function(t,e,i){return new n(e,i).fromRaw(t)},r.VERSION=0,r.prototype.init=function(){const t=this.minTrackedFee,e=this.minTrackedPri,i=[];for(let e=t;e<=1e6;e*=1.1)i.push(e);i.push(v);const n=[];for(let t=e;t<=1e16;t*=2)n.push(t);n.push(S),this.feeStats.init(i,15,.998),this.priStats.init(n,15,.998)},r.prototype.reset=function(){this.feeUnlikely=0,this.feeLikely=v,this.priUnlikely=0,this.priLikely=S,this.map.clear(),this.bestHeight=0,this.init()},r.prototype.removeTX=function(t){const e=this.map.get(t);e?(this.feeStats.removeTX(e.blockHeight,this.bestHeight,e.bucketIndex),this.map.delete(t)):this.logger.spam("Mempool tx %s not found.",l.revHex(t))},r.prototype.isFeePoint=function(t,e){return e<this.minTrackedPri&&t>=this.minTrackedFee||e<this.priUnlikely&&t>this.feeLikely},r.prototype.isPriPoint=function(t,e){return t<this.minTrackedFee&&e>=this.minTrackedPri||t<this.feeUnlikely&&e>this.priLikely},r.prototype.processTX=function(t,e){const i=t.height,n=t.hash("hex");if(this.map.has(n))return void this.logger.debug("Mempool tx %s already tracked.",t.txid());if(i<this.bestHeight)return;if(!e)return;if(t.dependencies)return;const r=t.getFee(),o=t.getRate(),a=t.getPriority(i);if(this.logger.spam("Processing mempool tx %s.",t.txid()),0===r||this.isPriPoint(o,a)){const t=new s;t.blockHeight=i,t.bucketIndex=this.priStats.addTX(i,a),this.map.set(n,t)}else if(this.isFeePoint(o,a)){const t=new s;t.blockHeight=i,t.bucketIndex=this.feeStats.addTX(i,o),this.map.set(n,t)}else this.logger.spam("Not adding tx %s.",t.txid())},r.prototype.processBlockTX=function(t,e){if(e.dependencies)return;const i=t-e.height;if(i<=0)return void this.logger.debug("Block tx %s had negative blocks to confirm (%d, %d).",e.txid(),t,e.height);const n=e.getFee(),r=e.getRate(),s=e.getPriority(t);0===n||this.isPriPoint(r,s)?this.priStats.record(i,s):this.isFeePoint(r,s)&&this.feeStats.record(i,r)},r.prototype.processBlock=function(t,e,i){if(!(t<=this.bestHeight)&&(this.bestHeight=t,0!==e.length&&i)){this.logger.debug("Recalculating dynamic cutoffs."),this.feeLikely=this.feeStats.estimateMedian(2,1,.95,!0,t),-1===this.feeLikely&&(this.feeLikely=v),this.feeUnlikely=this.feeStats.estimateMedian(10,1,.5,!1,t),-1===this.feeUnlikely&&(this.feeUnlikely=0),this.priLikely=this.priStats.estimateMedian(2,.2,.95,!0,t),-1===this.priLikely&&(this.priLikely=S),this.priUnlikely=this.priStats.estimateMedian(10,.2,.5,!1,t),-1===this.priUnlikely&&(this.priUnlikely=0),this.feeStats.clearCurrent(t),this.priStats.clearCurrent(t);for(const i of e)this.processBlockTX(t,i);this.feeStats.updateAverages(),this.priStats.updateAverages(),this.logger.debug("Done updating estimates for %d confirmed entries. New mempool map size %d.",e.length,this.map.size),this.logger.debug("New fee rate: %d.",this.estimateFee())}},r.prototype.estimateFee=function(t,e){if(t||(t=1),null==e&&(e=!0),f(l.isU32(t),"Target must be a number."),f(t<=this.feeStats.maxConfirms,"Too many confirmations for estimate."),!e){const e=this.feeStats.estimateMedian(t,1,.95,!0,this.bestHeight);return e<0?0:Math.floor(e)}let i=-1;for(;i<0&&t<=this.feeStats.maxConfirms;)i=this.feeStats.estimateMedian(t++,1,.95,!0,this.bestHeight);return t-=1,i<0?0:Math.floor(i)},r.prototype.estimatePriority=function(t,e){if(t||(t=1),null==e&&(e=!0),f(l.isU32(t),"Target must be a number."),f(t<=this.priStats.maxConfirms,"Too many confirmations for estimate."),!e){const e=this.priStats.estimateMedian(t,.2,.95,!0,this.bestHeight);return Math.floor(e)}let i=-1;for(;i<0&&t<=this.priStats.maxConfirms;)i=this.priStats.estimateMedian(t++,.2,.95,!0,this.bestHeight);return t-=1,i<0?0:Math.floor(i)},r.prototype.getSize=function(){let t=0;return t+=5,t+=y.sizeVarlen(this.feeStats.getSize())},r.prototype.toRaw=function(){const t=this.getSize(),e=new g(t);return e.writeU8(r.VERSION),e.writeU32(this.bestHeight),e.writeVarBytes(this.feeStats.toRaw()),e.render()},r.prototype.fromRaw=function(t){const e=new m(t);if(e.readU8()!==r.VERSION)throw new Error("Bad serialization version for estimator.");return this.bestHeight=e.readU32(),this.feeStats.fromRaw(e.readVarBytes()),this},r.fromRaw=function(t,e){return new r(e).fromRaw(t)},r.prototype.inject=function(t){return this.bestHeight=t.bestHeight,this.feeStats=t.feeStats,this},o.prototype.insert=function(t,e){const i=l.binarySearch(this.buckets,t,a,!0);this.buckets.splice(i,0,[t,e])},o.prototype.search=function(t){const e=l.binarySearch(this.buckets,t,a,!0);return f(0!==this.buckets.length,"Cannot search."),this.buckets[e][1]},(e=r).PolicyEstimator=r,e.ConfirmStats=n,t.exports=e},function(t,e,i){"use strict";function n(t,e){if(!(this instanceof n))return new n(t,e);this.entries=0,this.generation=1,this.n=0,this.limit=0,this.size=0,this.items=0,this.tweak=0,this.filter=u,null!=t&&this.fromRate(t,e)}function r(t,e){return new function(t,e){this.hi=t,this.lo=e}(t.readUInt32LE(e+4,!0),t.readUInt32LE(e,!0))}function s(t,e,i){t.writeUInt32LE(e.hi,i+4,!0),t.writeUInt32LE(e.lo,i,!0)}const o=i(0),a=i(68),h=a.sum32,c=a.mul32,u=Buffer.alloc(0);n.prototype.fromRate=function(t,e){o("number"==typeof t,"`items` must be a number."),o(t>0,"`items` must be greater than zero."),o(Number.isSafeInteger(t),"`items` must be an integer."),o("number"==typeof e,"`rate` must be a number."),o(e>=0&&e<=1,"`rate` must be between 0.0 and 1.0.");const i=Math.log(e),n=Math.max(1,Math.min(Math.round(i/Math.log(.5)),50)),r=(t+1)/2|0;let s=-1*n*(3*r)/Math.log(1-Math.exp(i/n));t=(((s=Math.ceil(s))+63)/64|0)<<1,t>>>=0,t=Math.max(1,t);const a=4294967296*Math.random()>>>0,h=Buffer.allocUnsafe(8*t);return h.fill(0),this.n=n,this.limit=r,this.size=s,this.items=t,this.tweak=a,this.filter=h,this},n.fromRate=function(t,e){return(new n).fromRate(t,e)},n.prototype.hash=function(t,e){return a(t,h(c(e,4221880213),this.tweak))},n.prototype.reset=function(){0!==this.entries&&(this.entries=0,this.generation=1,this.filter.fill(0))},n.prototype.add=function(t,e){if("string"==typeof t&&(t=Buffer.from(t,e)),this.entries===this.limit){this.entries=0,this.generation+=1,4===this.generation&&(this.generation=1);const t=4294967295*(1&this.generation),e=4294967295*(this.generation>>>1);for(let i=0;i<this.items;i+=2){const n=8*i,o=8*(i+1),a=r(this.filter,n),h=r(this.filter,o),c=a.hi^t|h.hi^e,u=a.lo^t|h.lo^e;a.hi&=c,a.lo&=u,h.hi&=c,h.lo&=u,s(this.filter,a,n),s(this.filter,h,o)}}this.entries+=1;for(let e=0;e<this.n;e++){const i=this.hash(t,e),n=63&i,r=(i>>>6)%this.items,s=8*(-2&r),o=8*(1|r),a=n%8,h=(n-a)/8;this.filter[s+h]&=~(1<<a),this.filter[s+h]|=(1&this.generation)<<a,this.filter[o+h]&=~(1<<a),this.filter[o+h]|=this.generation>>>1<<a}},n.prototype.test=function(t,e){if(0===this.entries)return!1;"string"==typeof t&&(t=Buffer.from(t,e));for(let e=0;e<this.n;e++){const i=this.hash(t,e),n=63&i,r=(i>>>6)%this.items,s=8*(-2&r),o=8*(1|r),a=n%8,h=(n-a)/8;if(0==(this.filter[s+h]>>>a&1|this.filter[o+h]>>>a&1))return!1}return!0},n.prototype.added=function(t,e){return"string"==typeof t&&(t=Buffer.from(t,e)),!this.test(t)&&(this.add(t),!0)},t.exports=n},function(t,e,i){"use strict";function n(t,e,i,o,h){if(!(this instanceof n))return new n(t,e,i,o,h);a.call(this),s(t,"BIP150 requires BIP151."),s("string"==typeof e,"Hostname required."),s("boolean"==typeof i,"Outbound flag required."),s(o instanceof r,"Auth DB required."),s(Buffer.isBuffer(h),"Identity key required."),this.bip151=t,this.input=t.input,this.output=t.output,this.hostname=e,this.outbound=i,this.db=o,this.privateKey=h,this.publicKey=p.publicKeyCreate(h,!0),this.peerIdentity=null,this.challengeReceived=!1,this.replyReceived=!1,this.proposeReceived=!1,this.challengeSent=!1,this.auth=!1,this.completed=!1,this.job=null,this.timeout=null,this.onAuth=null,this._init()}function r(t){if(!(this instanceof r))return new r(t);this.logger=v.global,this.resolve=w.lookup,this.prefix=null,this.dnsKnown=[],this.known=new Map,this.authorized=[],this._init(t)}const s=i(0),o=i(33),a=i(10),h=i(16),c=i(5),u=i(28),f=i(52),l=i(61),p=i(12),d=i(4),m=i(25),g=i(3),y=i(46),w=i(99),b=i(59),v=i(34);Object.setPrototypeOf(n.prototype,a.prototype),n.prototype._init=function(){this.outbound&&(this.peerIdentity=this.db.getKnown(this.hostname))},n.prototype.isAuthed=function(){return this.outbound?this.challengeSent&&this.challengeReceived:this.challengeReceived&&this.replyReceived},n.prototype.challenge=function(t){const e=this.outbound?"r":"i";if(s(this.bip151.handshake,"No BIP151 handshake before challenge."),s(!this.challengeReceived,"Peer challenged twice."),this.challengeReceived=!0,t.equals(g.ZERO_HASH))throw new Error("Auth failure.");const i=this.hash(this.input.sid,e,this.publicKey);if(!f(t,i))return g.ZERO_SIG64;this.isAuthed()&&(this.auth=!0,this.emit("auth"));const n=p.sign(i,this.privateKey);return p.fromDER(n)},n.prototype.reply=function(t){const e=this.outbound?"i":"r";if(s(this.challengeSent,"Unsolicited reply."),s(!this.replyReceived,"Peer replied twice."),this.replyReceived=!0,t.equals(g.ZERO_SIG64))throw new Error("Auth failure.");if(!this.peerIdentity)return u.randomBytes(32);const i=p.toDER(t),n=this.hash(this.output.sid,e,this.peerIdentity);return p.verify(n,i,this.peerIdentity)?this.isAuthed()?(this.auth=!0,this.emit("auth"),null):(s(this.outbound,"No challenge received before reply on inbound."),this.hash(this.input.sid,"p",this.publicKey)):u.randomBytes(32)},n.prototype.propose=function(t){s(!this.outbound,"Outbound peer tried to propose."),s(!this.challengeSent,"Unsolicited propose."),s(!this.proposeReceived,"Peer proposed twice."),this.proposeReceived=!0;const e=this.findAuthorized(t);return e?(this.peerIdentity=e,this.db.addKnown(this.hostname,this.peerIdentity),this.challengeSent=!0,this.hash(this.output.sid,"r",this.peerIdentity)):g.ZERO_HASH},n.prototype.toChallenge=function(){s(this.bip151.handshake,"No BIP151 handshake before challenge."),s(this.outbound,"Cannot challenge an inbound connection."),s(this.peerIdentity,"Cannot challenge without a peer identity.");const t=this.hash(this.output.sid,"i",this.peerIdentity);return s(!this.challengeSent,"Cannot initiate challenge twice."),this.challengeSent=!0,new l.AuthChallengePacket(t)},n.prototype.rekey=function(t,e,i,n){const r=Buffer.allocUnsafe(130);return t.copy(r,0),e.copy(r,32),i.copy(r,64),n.copy(r,97),c.hash256(r)},n.prototype.rekeyInput=function(){const t=this.input,e=this.peerIdentity,i=this.publicKey,n=this.rekey(t.sid,t.k1,e,i),r=this.rekey(t.sid,t.k2,e,i);t.rekey(n,r)},n.prototype.rekeyOutput=function(){const t=this.output,e=this.publicKey,i=this.peerIdentity,n=this.rekey(t.sid,t.k1,e,i),r=this.rekey(t.sid,t.k2,e,i);t.rekey(n,r)},n.prototype.hash=function(t,e,i){const n=Buffer.allocUnsafe(66);return t.copy(n,0),n[32]=e.charCodeAt(0),i.copy(n,33),c.hash256(n)},n.prototype.findAuthorized=function(t){for(const e of this.db.authorized){const i=this.hash(this.output.sid,"p",e);if(f(i,t))return e}return null},n.prototype.destroy=function(){this.job&&this.reject(new Error("BIP150 stream was destroyed."))},n.prototype.cleanup=function(){const t=this.job;return s(!this.completed,"Already completed."),s(t,"No completion job."),this.completed=!0,this.job=null,null!=this.timeout&&(clearTimeout(this.timeout),this.timeout=null),this.onAuth&&(this.removeListener("auth",this.onAuth),this.onAuth=null),t},n.prototype.resolve=function(t){this.cleanup().resolve(t)},n.prototype.reject=function(t){this.cleanup().reject(t)},n.prototype.wait=function(t){return new Promise((e,i)=>{this._wait(t,e,i)})},n.prototype._wait=function(t,e,i){s(!this.auth,"Cannot wait for init after handshake."),this.job=h.job(e,i),!this.outbound||this.peerIdentity?(this.timeout=setTimeout(()=>{this.reject(new Error("BIP150 handshake timed out."))},t),this.onAuth=this.resolve.bind(this),this.once("auth",this.onAuth)):this.reject(new Error(`No identity for ${this.hostname}.`))},n.prototype.getAddress=function(){return s(this.peerIdentity,"Cannot serialize address."),n.address(this.peerIdentity)},n.address=function(t){const e=new d(27);return e.writeU8(15),e.writeU16BE(65281),e.writeBytes(c.hash160(t)),e.writeChecksum(),m.encode(e.render())},r.prototype._init=function(t){t&&(null!=t.logger&&(s("object"==typeof t.logger),this.logger=t.logger.context("authdb")),null!=t.resolve&&(s("function"==typeof t.resolve),this.resolve=t.resolve),null!=t.knownPeers&&(s("object"==typeof t.knownPeers),this.setKnown(t.knownPeers)),null!=t.authPeers&&(s(Array.isArray(t.authPeers)),this.setAuthorized(t.authPeers)),null!=t.prefix&&(s("string"==typeof t.prefix),this.prefix=t.prefix))},r.prototype.open=async function(){await this.readKnown(),await this.readAuth(),await this.lookup()},r.prototype.close=async function(){},r.prototype.addKnown=function(t,e){s("string"==typeof t,"Known host must be a string."),s(Buffer.isBuffer(e)&&33===e.length,"Invalid public key for known peer.");const i=y.fromHostname(t);i.type!==y.types.DNS?this.known.set(t,e):this.dnsKnown.push([i,e])},r.prototype.addAuthorized=function(t){s(Buffer.isBuffer(t)&&33===t.length,"Invalid public key for authorized peer."),this.authorized.push(t)},r.prototype.setKnown=function(t){this.known.clear();for(const e of Object.keys(t)){const i=t[e];this.addKnown(e,i)}},r.prototype.setAuthorized=function(t){this.authorized.length=0;for(const e of t)this.addAuthorized(e)},r.prototype.getKnown=function(t){const e=this.known.get(t);if(e)return e;const i=y.fromHostname(t);return this.known.get(i.host)},r.prototype.lookup=async function(){const t=[];for(const[e,i]of this.dnsKnown)t.push(this.populate(e,i));await Promise.all(t)},r.prototype.populate=async function(t,e){s(t.type===y.types.DNS,"Resolved host passed."),this.logger.info("Resolving authorized hosts from: %s.",t.host);let i;try{i=await this.resolve(t.host)}catch(t){return void this.logger.error(t)}for(let n of i)0!==t.port&&(n=y.toHostname(n,t.port)),this.known.set(n,e)},r.prototype.readKnown=async function(){if(b.unsupported)return;if(!this.prefix)return;const t=o.join(this.prefix,"known-peers");let e;try{e=await b.readFile(t,"utf8")}catch(t){if("ENOENT"===t.code)return;throw t}this.parseKnown(e)},r.prototype.parseKnown=function(t){s("string"==typeof t),65279===t.charCodeAt(0)&&(t=t.substring(1)),t=(t=t.replace(/\r\n/g,"\n")).replace(/\r/g,"\n");let e=0;for(const i of t.split("\n")){const t=i.trim();if(e+=1,0===t.length)continue;if("#"===t[0])continue;const n=t.split(/\s+/);if(n.length<2)throw new Error(`No key present on line ${e}: "${t}".`);const r=n[0].split(",");let s,o;r.length>=2?(s=r[0],o=r[1]):(s=null,o=r[0]);const a=Buffer.from(n[1],"hex");if(33!==a.length)throw new Error(`Invalid key on line ${e}: "${n[1]}".`);s&&s.length>0&&this.addKnown(s,a),0!==o.length&&this.addKnown(o,a)}},r.prototype.readAuth=async function(){if(b.unsupported)return;if(!this.prefix)return;const t=o.join(this.prefix,"authorized-peers");let e;try{e=await b.readFile(t,"utf8")}catch(t){if("ENOENT"===t.code)return;throw t}this.parseAuth(e)},r.prototype.parseAuth=function(t){s("string"==typeof t),65279===t.charCodeAt(0)&&(t=t.substring(1)),t=(t=t.replace(/\r\n/g,"\n")).replace(/\r/g,"\n");let e=0;for(const i of t.split("\n")){const t=i.trim();if(e+=1,0===t.length)continue;if("#"===t[0])continue;const n=Buffer.from(t,"hex");if(33!==n.length)throw new Error(`Invalid key on line ${e}: "${t}".`);this.addAuthorized(n)}},(e=n).BIP150=n,e.AuthDB=r,t.exports=e},function(t,e,i){"use strict";function n(t){if(!(this instanceof n))return new n(t);this.cipher=r.ciphers.CHACHAPOLY,this.privateKey=d.generatePrivateKey(),this.publicKey=null,this.k1=null,this.k2=null,this.sid=null,null!=t&&(s(t===r.ciphers.CHACHAPOLY,"Unknown cipher type."),this.cipher=t),this.chacha=new u,this.aead=new l,this.tag=null,this.seq=0,this.iv=Buffer.allocUnsafe(8),this.iv.fill(0),this.processed=0,this.lastRekey=0}function r(t){if(!(this instanceof r))return new r(t);o.call(this),this.input=new n(t),this.output=new n(t),this.initReceived=!1,this.ackReceived=!1,this.initSent=!1,this.ackSent=!1,this.completed=!1,this.handshake=!1,this.pending=[],this.total=0,this.waiting=4,this.hasSize=!1,this.timeout=null,this.job=null,this.onShake=null,this.bip150=null}const s=i(0),o=i(10),a=i(1),h=i(16),c=i(5),u=i(163),f=i(164),l=i(202),p=i(203),d=i(12),m=i(61),g=i(4),y=i(2),w=i(3),b=m.EncinitPacket,v=m.EncackPacket,k=Buffer.from("wmccecdh","ascii"),S=Buffer.from("WMCCK1","ascii"),E=Buffer.from("WMCCK2","ascii"),R=Buffer.from("WMCCSessionID","ascii");n.prototype.init=function(t){s(Buffer.isBuffer(t)),this.publicKey=t;const e=d.ecdh(this.publicKey,this.privateKey),i=g.pool(33);i.writeBytes(e),i.writeU8(this.cipher);const n=i.render(),r=p.extract(n,k,"sha256");this.k1=p.expand(r,S,32,"sha256"),this.k2=p.expand(r,E,32,"sha256"),this.sid=p.expand(r,R,32,"sha256"),this.seq=0,this.update(),this.chacha.init(this.k1,this.iv),this.aead.init(this.k2,this.iv),this.lastRekey=a.now()},n.prototype.shouldRekey=function(t){const e=a.now();return this.processed+=t.length,(e>=this.lastRekey+10||this.processed>=1073741824)&&(this.lastRekey=e,this.processed=0,!0)},n.prototype.rekey=function(t,e){s(this.sid,"Cannot rekey before initialization."),t?(this.k1=t,this.k2=e):(this.k1=c.root256(this.sid,this.k1),this.k2=c.root256(this.sid,this.k2)),s(this.k1),s(this.k2),this.chacha.init(this.k1,this.iv),this.aead.init(this.k2,this.iv)},n.prototype.sequence=function(){4294967296==++this.seq&&(this.seq=0),this.update(),this.chacha.init(null,this.iv),this.aead.init(null,this.iv)},n.prototype.update=function(){return this.iv.writeUInt32LE(this.seq,0,!0),this.iv},n.prototype.getPublicKey=function(){return d.publicKeyCreate(this.privateKey,!0)},n.prototype.encryptSize=function(t){return this.chacha.encrypt(t.slice(0,4))},n.prototype.decryptSize=function(t){return this.chacha.encrypt(t),t.readUInt32LE(0,!0)},n.prototype.encrypt=function(t){return this.aead.encrypt(t)},n.prototype.decrypt=function(t){return this.aead.chacha20.encrypt(t)},n.prototype.auth=function(t){return this.aead.auth(t)},n.prototype.finish=function(){return this.tag=this.aead.finish(),this.tag},n.prototype.verify=function(t){return f.verify(this.tag,t)},Object.setPrototypeOf(r.prototype,o.prototype),r.ciphers={CHACHAPOLY:0},r.MAX_MESSAGE=12e6,r.prototype.error=function(){const t=a.fmt.apply(a,arguments);this.emit("error",new Error(t))},r.prototype.isReady=function(){return this.initSent&&this.ackReceived&&this.initReceived&&this.ackSent},r.prototype.toEncinit=function(){return s(!this.initSent,"Cannot init twice."),this.initSent=!0,new b(this.input.getPublicKey(),this.input.cipher)},r.prototype.toEncack=function(){return s(this.output.sid,"Cannot ack before init."),s(!this.ackSent,"Cannot ack twice."),this.ackSent=!0,this.isReady()&&(s(!this.completed,"No encack after timeout."),this.handshake=!0,this.emit("handshake")),new v(this.output.getPublicKey())},r.prototype.toRekey=function(){return s(this.handshake,"Cannot rekey before handshake."),new v(w.ZERO_KEY)},r.prototype.encinit=function(t,e){s(e===this.output.cipher,"Cipher mismatch."),s(!this.initReceived,"Already initialized."),s(!this.completed,"No encinit after timeout."),this.initReceived=!0,this.output.init(t)},r.prototype.encack=function(t){if(s(this.initSent,"Unsolicited ACK."),t.equals(w.ZERO_KEY))return s(this.handshake,"No initialization before rekey."),this.bip150&&this.bip150.auth?void this.bip150.rekeyInput():void this.input.rekey();s(!this.ackReceived,"Already ACKed."),s(!this.completed,"No encack after timeout."),this.ackReceived=!0,this.input.init(t),this.isReady()&&(this.handshake=!0,this.emit("handshake"))},r.prototype.cleanup=function(){const t=this.job;return s(!this.completed,"Already completed."),s(t,"No completion job."),this.completed=!0,this.job=null,null!=this.timeout&&(clearTimeout(this.timeout),this.timeout=null),this.onShake&&(this.removeListener("handshake",this.onShake),this.onShake=null),t},r.prototype.resolve=function(t){this.cleanup().resolve(t)},r.prototype.reject=function(t){this.cleanup().reject(t)},r.prototype.wait=function(t){return new Promise((e,i)=>{this._wait(t,e,i)})},r.prototype._wait=function(t,e,i){s(!this.handshake,"Cannot wait for init after handshake."),this.job=h.job(e,i),this.timeout=setTimeout(()=>{this.reject(new Error("BIP151 handshake timed out."))},t),this.onShake=this.resolve.bind(this),this.once("handshake",this.onShake)},r.prototype.destroy=function(){this.job&&this.reject(new Error("BIP151 stream was destroyed."))},r.prototype.maybeRekey=function(t){this.output.shouldRekey(t)&&(this.emit("rekey"),this.bip150&&this.bip150.auth?this.bip150.rekeyOutput():this.output.rekey())},r.prototype.packetSize=function(t,e){let i=0;return i+=4,i+=w.sizeVarString(t,"ascii"),i+=4,i+=e.length,i+=16},r.prototype.packet=function(t,e){const i=this.packetSize(t,e),n=new g(i),r=i-20;n.writeU32(r),n.writeVarString(t,"ascii"),n.writeU32(e.length),n.writeBytes(e),n.seek(16);const s=n.render(),o=s.slice(4,4+r);return this.maybeRekey(s),this.output.encryptSize(s),this.output.encrypt(o),this.output.finish().copy(s,4+r),this.output.sequence(),s},r.prototype.feed=function(t){for(this.total+=t.length,this.pending.push(t);this.total>=this.waiting;){const t=this.read(this.waiting);this.parse(t)}},r.prototype.read=function(t){if(s(this.total>=t,"Reading too much."),0===t)return Buffer.alloc(0);const e=this.pending[0];if(e.length>t){const i=e.slice(0,t);return this.pending[0]=e.slice(t),this.total-=i.length,i}if(e.length===t){const t=this.pending.shift();return this.total-=t.length,t}const i=Buffer.allocUnsafe(t);let n=0;for(;n<i.length;){const t=this.pending[0],e=t.copy(i,n);e===t.length?this.pending.shift():this.pending[0]=t.slice(e),n+=e}return s.strictEqual(n,i.length),this.total-=i.length,i},r.prototype.parse=function(t){if(!this.hasSize){const e=this.input.decryptSize(t);return s(4===this.waiting),s(4===t.length),e<6||e>r.MAX_MESSAGE?void this.error("Bad packet size: %d.",a.mb(e)):(this.hasSize=!0,void(this.waiting=e+16))}const e=t.slice(0,this.waiting-16),i=t.slice(this.waiting-16,this.waiting);if(this.hasSize=!1,this.waiting=4,this.input.auth(e),this.input.finish(),!this.input.verify(i))return this.input.sequence(),void this.error("Bad tag: %s.",i.toString("hex"));this.input.decrypt(e),this.input.sequence();const n=new y(e);for(;n.left();){let t,e;try{t=n.readVarString("ascii"),e=n.readBytes(n.readU32())}catch(t){return void this.emit("error",t)}this.emit("packet",t,e)}},t.exports=r},function(t,e,i){"use strict";const n=i(10),r=i(168),s=i(183),o=e;o.createSocket=function(t,e,i){return i?s.connect(i,t,e):r.connect(t,e)},o.createServer=function(){const t=new r.Server,e=new n;return e.listen=function(e,i){return new Promise((n,r)=>{t.once("error",r),t.listen(e,i,()=>{t.removeListener("error",r),n()})})},e.close=function(){return new Promise((e,i)=>{t.close(function(t,e){return function(i,n){i?e(i):t(n)}}(e,i))})},e.address=function(){return t.address()},Object.defineProperty(e,"maxConnections",{get:()=>t.maxConnections,set:e=>(t.maxConnections=e,t.maxConnections)}),t.on("listening",()=>{e.emit("listening")}),t.on("connection",t=>{e.emit("connection",t)}),t.on("error",t=>{e.emit("error",t)}),e}},function(t,e,i){"use strict";function n(t){if(!(this instanceof n))return new n(t);f.call(this),this.options=new r(t),this.network=this.options.network,this.logger=this.options.logger.context("net"),this.chain=this.options.chain,this.mempool=this.options.mempool,this.server=this.options.createServer(),this.nonces=this.options.nonces,this.locker=new R(!0),this.connected=!1,this.disconnecting=!1,this.syncing=!1,this.spvFilter=null,this.txFilter=null,this.blockMap=new Set,this.txMap=new Set,this.compactBlocks=new Set,this.invMap=new Map,this.pendingFilter=null,this.pendingRefill=null,this.checkpoints=!1,this.headerChain=new A,this.headerNext=null,this.headerTip=null,this.peers=new s,this.authdb=new w.AuthDB(this.options),this.hosts=new P(this.options),this.id=0,this.options.spv&&(this.spvFilter=k.fromRate(2e4,.001,k.flags.ALL)),this.options.mempool||(this.txFilter=new S(5e4,1e-6)),this._init()}function r(t){if(!(this instanceof r))return new r(t);this.network=x.primary,this.logger=null,this.chain=null,this.mempool=null,this.nonces=new a,this.prefix=null,this.checkpoints=!0,this.spv=!1,this.bip37=!1,this.listen=!1,this.compact=!0,this.noRelay=!1,this.host="0.0.0.0",this.port=this.network.port,this.publicHost="0.0.0.0",this.publicPort=this.network.port,this.maxOutbound=32,this.maxInbound=128,this.createSocket=this._createSocket.bind(this),this.createServer=O.createServer,this.resolve=this._resolve.bind(this),this.proxy=null,this.onion=!1,this.upnp=!1,this.selfish=!1,this.version=m.PROTOCOL_VERSION,this.agent=m.USER_AGENT,this.bip151=!1,this.bip150=!1,this.authPeers=[],this.knownPeers={},this.identityKey=E.generatePrivateKey(),this.banScore=m.BAN_SCORE,this.banTime=m.BAN_TIME,this.feeRate=-1,this.seeds=this.network.seeds,this.nodes=[],this.invTimeout=6e4,this.blockMode=0,this.services=m.LOCAL_SERVICES,this.requiredServices=m.REQUIRED_SERVICES,this.persistent=!1,this.fromOptions(t)}function s(){this.map=new Map,this.ids=new Map,this.list=new A,this.load=null,this.inbound=0,this.outbound=0}function o(t,e){if(!(this instanceof o))return new o(t,e);c(!e.mutable,"Cannot broadcast mutable item.");const i=e.toInv();this.pool=t,this.hash=i.hash,this.type=i.type,this.msg=e,this.jobs=[]}function a(){this.map=new Map,this.hosts=new Map}function h(t,e){this.hash=t,this.height=e,this.prev=null,this.next=null}const c=i(0),u=i(10),f=i(30),l=i(1),p=i(46),d=i(16),m=i(60),g=i(93),y=i(11),w=i(119),b=i(120),v=i(98),k=i(42),S=i(118),E=i(12),R=i(23),x=i(6),_=i(184),I=i(235),A=i(94),O=i(121),B=i(99),P=i(237),M=i(239),N=i(36),T=i(61),C=m.services,U=N.types,H=T.types,L=P.scores;Object.setPrototypeOf(n.prototype,f.prototype),n.DISCOVERY_INTERVAL=12e4,n.prototype._init=function(){this.server.on("error",t=>{this.emit("error",t)}),this.server.on("connection",t=>{this.handleSocket(t),this.emit("connection",t)}),this.server.on("listening",()=>{const t=this.server.address();this.logger.info("Pool server listening on %s (port=%d).",t.address,t.port),this.emit("listening",t)}),this.chain.on("block",(t,e)=>{this.emit("block",t,e)}),this.chain.on("reset",()=>{this.checkpoints&&this.resetChain(),this.forceSync()}),this.chain.on("full",()=>{this.sync(),this.emit("full"),this.logger.info("Chain is fully synced (height=%d).",this.chain.height)}),this.chain.on("bad orphan",(t,e)=>{this.handleBadOrphan("block",t,e)}),this.mempool&&(this.mempool.on("tx",t=>{this.emit("tx",t)}),this.mempool.on("bad orphan",(t,e)=>{this.handleBadOrphan("tx",t,e)})),this.options.selfish||this.options.spv||(this.mempool&&this.mempool.on("tx",t=>{this.announceTX(t)}),this.chain.on("block",t=>{this.chain.synced&&this.announceBlock(t)}))},n.prototype._open=async function(){if(this.mempool?await this.mempool.open():await this.chain.open(),this.logger.info("Pool loaded (maxpeers=%d).",this.options.maxOutbound),this.options.bip150){const t=E.publicKeyCreate(this.options.identityKey,!0);this.logger.info("Identity public key: %s.",t.toString("hex")),this.logger.info("Identity address: %s.",w.address(t))}this.resetChain()},n.prototype.resetChain=function(){if(!this.options.checkpoints)return;this.checkpoints=!1,this.headerTip=null,this.headerChain.reset(),this.headerNext=null;const t=this.chain.tip;t.height<this.network.lastCheckpoint&&(this.checkpoints=!0,this.headerTip=this.getNextTip(t.height),this.headerChain.push(new h(t.hash,t.height)),this.logger.info("Initialized header chain to height %d (checkpoint=%s).",t.height,l.revHex(this.headerTip.hash)))},n.prototype._close=async function(){await this.disconnect()},n.prototype.connect=async function(){const t=await this.locker.lock();try{return await this._connect()}finally{t()}},n.prototype._connect=async function(){c(this.loaded,"Pool is not loaded."),this.connected||(await this.hosts.open(),await this.authdb.open(),await this.discoverGateway(),await this.discoverExternal(),await this.discoverSeeds(),this.fillOutbound(),await this.listen(),this.startTimer(),this.connected=!0)},n.prototype.disconnect=async function(){const t=await this.locker.lock();try{return await this._disconnect()}finally{t()}},n.prototype._disconnect=async function(){if(c(this.loaded,"Pool is not loaded."),this.connected){this.disconnecting=!0;for(const t of this.invMap.values())t.resolve();this.peers.destroy(),this.blockMap.clear(),this.txMap.clear(),null!=this.pendingFilter&&(clearTimeout(this.pendingFilter),this.pendingFilter=null),null!=this.pendingRefill&&(clearTimeout(this.pendingRefill),this.pendingRefill=null),this.checkpoints=!1,this.headerTip=null,this.headerChain.reset(),this.headerNext=null,this.stopTimer(),await this.authdb.close(),await this.hosts.close(),await this.unlisten(),this.disconnecting=!1,this.syncing=!1,this.connected=!1}},n.prototype.listen=async function(){c(this.server),c(!this.connected,"Already listening."),this.options.listen&&(this.server.maxConnections=this.options.maxInbound,await this.server.listen(this.options.port,this.options.host))},n.prototype.unlisten=async function(){c(this.server),c(this.connected,"Not listening."),this.options.listen&&await this.server.close()},n.prototype.startTimer=function(){c(null==this.timer,"Timer already started."),this.timer=d.setInterval(this.discover,n.DISCOVERY_INTERVAL,this)},n.prototype.stopTimer=function(){c(null!=this.timer,"Timer already stopped."),d.clearInterval(this.timer),this.timer=null},n.prototype.discover=async function(){await this.discoverGateway(),await this.discoverSeeds(!0)},n.prototype.discoverGateway=async function(){const t=this.options.publicPort,e=this.options.port;if(!this.options.listen)return!1;if(!this.options.upnp)return!1;let i;try{this.logger.debug("Discovering internet gateway (upnp)."),i=await M.discover()}catch(t){return this.logger.debug("Could not discover internet gateway (upnp)."),this.logger.debug(t),!1}let n;try{n=await i.getExternalIP()}catch(t){return this.logger.debug("Could not find external IP (upnp)."),this.logger.debug(t),!1}this.hosts.addLocal(n,t,L.UPNP)&&this.logger.info("External IP found (upnp): %s.",n),this.logger.debug("Adding port mapping %d->%d.",t,e);try{await i.addPortMapping(n,t,e)}catch(t){return this.logger.debug("Could not add port mapping (upnp)."),this.logger.debug(t),!1}return!0},n.prototype.discoverSeeds=async function(t){if(0===this.hosts.dnsSeeds.length)return;const e=Math.min(2,this.options.maxOutbound),i=this.hosts.size();let n=0;for(let t=this.peers.head();t&&!(t.outbound&&t.connected&&++n>e);t=t.next);(0===i||t&&n<e)&&(this.logger.warning("Could not find enough peers."),this.logger.warning("Hitting DNS seeds..."),await this.hosts.discoverSeeds(),this.logger.info("Resolved %d hosts from DNS seeds.",this.hosts.size()-i),this.refill())},n.prototype.discoverExternal=async function(){const t=this.options.publicPort;if(!this.options.listen)return;if(this.options.proxy)return;if(this.hosts.local.size>0)return;let e;try{e=await I.getIPv4()}catch(t){this.logger.debug("Could not find external IPv4 (http)."),this.logger.debug(t)}e&&this.hosts.addLocal(e,t,L.HTTP)&&this.logger.info("External IPv4 found (http): %s.",e);let i;try{i=await I.getIPv6()}catch(t){this.logger.debug("Could not find external IPv6 (http)."),this.logger.debug(t)}i&&this.hosts.addLocal(i,t,L.HTTP)&&this.logger.info("External IPv6 found (http): %s.",i)},n.prototype.handleSocket=function(t){if(!t.remoteAddress)return this.logger.debug("Ignoring disconnected peer."),void t.destroy();const e=p.normalize(t.remoteAddress);if(this.peers.inbound>=this.options.maxInbound)return this.logger.debug("Ignoring peer: too many inbound (%s).",e),void t.destroy();if(this.hosts.isBanned(e))return this.logger.debug("Ignoring banned peer (%s).",e),void t.destroy();const i=p.toHostname(e,t.remotePort);c(!this.peers.map[i],"Port collision."),this.addInbound(t)},n.prototype.addLoader=function(){if(!this.loaded)return;c(!this.peers.load);for(let t=this.peers.head();t;t=t.next)if(t.outbound)return this.logger.info("Repurposing peer for loader (%s).",t.hostname()),void this.setLoader(t);const t=this.getHost();if(!t)return;const e=this.createOutbound(t);this.logger.info("Adding loader peer (%s).",e.hostname()),this.peers.add(e),this.setLoader(e)},n.prototype.setLoader=function(t){this.loaded&&(c(t.outbound),c(!this.peers.load),c(!t.loader),t.loader=!0,this.peers.load=t,this.sendSync(t),this.emit("loader",t))},n.prototype.startSync=function(){this.loaded&&(c(this.connected,"Pool is not connected!"),this.syncing=!0,this.resync(!1))},n.prototype.forceSync=function(){this.loaded&&(c(this.connected,"Pool is not connected!"),this.resync(!0))},n.prototype.sync=function(t){this.resync(!1)},n.prototype.stopSync=function(){if(this.syncing){this.syncing=!1;for(let t=this.peers.head();t;t=t.next)t.outbound&&t.syncing&&(t.syncing=!1,t.merkleBlock=null,t.merkleTime=-1,t.merkleMatches=0,t.merkleMap=null,t.blockTime=-1,t.blockMap.clear(),t.compactBlocks.clear());this.blockMap.clear(),this.compactBlocks.clear()}},n.prototype.resync=async function(t){if(!this.syncing)return;let e;try{e=await this.chain.getLocator()}catch(t){return void this.emit("error",t)}for(let i=this.peers.head();i;i=i.next)i.outbound&&(!t&&i.syncing||this.sendLocator(e,i))},n.prototype.isSyncable=function(t){return!!this.syncing&&(!t.destroyed&&(!!t.handshake&&(!!(t.services&C.NETWORK)&&(!(this.options.hasWitness()&&!t.hasWitness())&&!(!t.loader&&!this.chain.synced)))))},n.prototype.sendSync=async function(t){if(t.syncing)return!1;if(!this.isSyncable(t))return!1;t.syncing=!0,t.blockTime=l.ms();let e;try{e=await this.chain.getLocator()}catch(e){return t.syncing=!1,t.blockTime=-1,this.emit("error",e),!1}return this.sendLocator(e,t)},n.prototype.sendLocator=function(t,e){return!!this.isSyncable(e)&&(this.network.requestMempool&&e.loader&&this.chain.synced&&e.sendMempool(),e.syncing=!0,e.blockTime=l.ms(),this.checkpoints?(e.sendGetHeaders(t,this.headerTip.hash),!0):(e.sendGetBlocks(t),!0))},n.prototype.sendMempool=function(){for(let t=this.peers.head();t;t=t.next)t.sendMempool()},n.prototype.sendGetAddr=function(){for(let t=this.peers.head();t;t=t.next)t.sendGetAddr()},n.prototype.resolveHeaders=function(t){const e=[];for(let t=this.headerNext;t&&(this.headerNext=t.next,e.push(t.hash),5e4!==e.length);t=t.next);this.getBlock(t,e)},n.prototype.resolveHeight=function(t,e){let i=0;for(let n=this.peers.head();n;n=n.next)n.bestHash===t&&n.bestHeight!==e&&(n.bestHeight=e,i++);i>0&&this.logger.debug("Resolved height for %d peers.",i)},n.prototype.getNextTip=function(t){for(const e of this.network.checkpoints)if(e.height>t)return new h(e.hash,e.height);throw new Error("Next checkpoint not found.")},n.prototype.announceList=function(t){const e=[],i=[];for(const t of this.invMap.values())switch(t.type){case U.BLOCK:e.push(t.msg);break;case U.TX:i.push(t.msg);break;default:c(!1,"Bad item type.")}e.length>0&&t.announceBlock(e),i.length>0&&t.announceTX(i)},n.prototype.getBroadcasted=function(t,e){const i=e.isTX()?U.TX:U.BLOCK,n=this.invMap.get(e.hash);return n?i!==n.type?(this.logger.debug("Peer requested item with the wrong type (%s).",t.hostname()),null):(this.logger.debug("Peer requested %s %s as a %s packet (%s).",e.isTX()?"tx":"block",e.rhash(),e.hasWitness()?"witness":"normal",t.hostname()),n.handleAck(t),n.msg):null},n.prototype.getItem=async function(t,e){const i=this.getBroadcasted(t,e);return i||(this.options.selfish?null:e.isTX()?this.mempool?this.mempool.getTX(e.hash):null:this.chain.options.spv?null:this.chain.options.prune?null:await this.chain.getBlock(e.hash))},n.prototype.sendBlock=async function(t,e,i){const n=this.getBroadcasted(t,e);if(n)return t.send(new T.BlockPacket(n,i)),!0;if(this.options.selfish||this.chain.options.spv||this.chain.options.prune)return!1;if(i||!this.options.hasWitness()){const i=await this.chain.getRawBlock(e.hash);return!!i&&(t.sendRaw("block",i),!0)}const r=await this.chain.getBlock(e.hash);return!!r&&(t.send(new T.BlockPacket(r,i)),!0)},n.prototype.createOutbound=function(t){const e=b.ciphers.CHACHAPOLY,i=this.options.identityKey,n=_.fromOutbound(this.options,t);return this.hosts.markAttempt(t.hostname),this.options.bip151&&n.setCipher(e),this.options.bip150&&n.setAuth(this.authdb,i),this.bindPeer(n),this.logger.debug("Connecting to %s.",n.hostname()),n.tryOpen(),n},n.prototype.createInbound=function(t){const e=b.ciphers.CHACHAPOLY,i=this.options.identityKey,n=_.fromInbound(this.options,t);return this.options.bip151&&n.setCipher(e),this.options.bip150&&n.setAuth(this.authdb,i),this.bindPeer(n),n.tryOpen(),n},n.prototype.uid=function(){const t=Number.MAX_SAFE_INTEGER;this.id>=t-this.peers.size()-1&&(this.id=0);do{this.id+=1}while(this.peers.find(this.id));return this.id},n.prototype.bindPeer=function(t){t.id=this.uid(),t.onPacket=(e=>this.handlePacket(t,e)),t.on("error",t=>{this.logger.debug(t)}),t.once("connect",()=>{this.handleConnect(t)}),t.once("open",()=>{this.handleOpen(t)}),t.once("close",e=>{this.handleClose(t,e)}),t.once("ban",()=>{this.handleBan(t)})},n.prototype.handlePacket=async function(t,e){switch(e.type){case H.VERSION:await this.handleVersion(t,e);break;case H.VERACK:await this.handleVerack(t,e);break;case H.PING:await this.handlePing(t,e);break;case H.PONG:await this.handlePong(t,e);break;case H.GETADDR:await this.handleGetAddr(t,e);break;case H.ADDR:await this.handleAddr(t,e);break;case H.INV:await this.handleInv(t,e);break;case H.GETDATA:await this.handleGetData(t,e);break;case H.NOTFOUND:await this.handleNotFound(t,e);break;case H.GETBLOCKS:await this.handleGetBlocks(t,e);break;case H.GETHEADERS:await this.handleGetHeaders(t,e);break;case H.HEADERS:await this.handleHeaders(t,e);break;case H.SENDHEADERS:await this.handleSendHeaders(t,e);break;case H.BLOCK:await this.handleBlock(t,e);break;case H.TX:await this.handleTX(t,e);break;case H.REJECT:await this.handleReject(t,e);break;case H.MEMPOOL:await this.handleMempool(t,e);break;case H.FILTERLOAD:await this.handleFilterLoad(t,e);break;case H.FILTERADD:await this.handleFilterAdd(t,e);break;case H.FILTERCLEAR:await this.handleFilterClear(t,e);break;case H.MERKLEBLOCK:await this.handleMerkleBlock(t,e);break;case H.FEEFILTER:await this.handleFeeFilter(t,e);break;case H.SENDCMPCT:await this.handleSendCmpct(t,e);break;case H.CMPCTBLOCK:await this.handleCmpctBlock(t,e);break;case H.GETBLOCKTXN:await this.handleGetBlockTxn(t,e);break;case H.BLOCKTXN:await this.handleBlockTxn(t,e);break;case H.ENCINIT:await this.handleEncinit(t,e);break;case H.ENCACK:await this.handleEncack(t,e);break;case H.AUTHCHALLENGE:await this.handleAuthChallenge(t,e);break;case H.AUTHREPLY:await this.handleAuthReply(t,e);break;case H.AUTHPROPOSE:await this.handleAuthPropose(t,e);break;case H.UNKNOWN:await this.handleUnknown(t,e);break;default:c(!1,"Bad packet type.")}this.emit("packet",e,t)},n.prototype.handleConnect=async function(t){this.logger.info("Connected to %s.",t.hostname()),t.outbound&&this.hosts.markSuccess(t.hostname()),this.emit("peer connect",t)},n.prototype.handleOpen=async function(t){if(!this.options.selfish&&this.options.listen){const e=this.hosts.getLocal(t.address);e&&t.send(new T.AddrPacket([e]))}this.options.compact&&t.sendCompact(this.options.blockMode),this.hosts.isFull()||t.sendGetAddr(),this.spvFilter&&t.sendFilterLoad(this.spvFilter),this.announceList(t),-1!==this.options.feeRate&&t.sendFeeRate(this.options.feeRate),t.outbound&&this.sendSync(t),t.outbound&&(this.hosts.markAck(t.hostname(),t.services),t.loader||this.peers.load&&!this.peers.load.handshake&&(c(this.peers.load.loader),this.peers.load.loader=!1,this.peers.load=null),this.peers.load||this.setLoader(t)),this.emit("peer open",t)},n.prototype.handleClose=async function(t,e){const i=t.outbound,n=t.loader,r=t.blockMap.size;this.removePeer(t),n&&(this.logger.info("Removed loader peer (%s).",t.hostname()),this.checkpoints&&this.resetChain()),this.nonces.remove(t.hostname()),this.emit("peer close",t,e),this.loaded&&(this.disconnecting||(this.chain.synced&&r>0&&(this.logger.warning("Peer disconnected with requested blocks."),this.logger.warning("Resending sync..."),this.forceSync()),i&&this.refill()))},n.prototype.handleBan=async function(t){this.ban(t.address),this.emit("ban",t)},n.prototype.handleVersion=async function(t,e){this.logger.info("Received version (%s): version=%d height=%d services=%s agent=%s",t.hostname(),e.version,e.height,e.services.toString(2),e.agent),this.network.time.add(t.hostname(),e.time),this.nonces.remove(t.hostname()),!t.outbound&&e.remote.isRoutable()&&this.hosts.markLocal(e.remote)},n.prototype.handleVerack=async function(t,e){},n.prototype.handlePing=async function(t,e){},n.prototype.handlePong=async function(t,e){},n.prototype.handleGetAddr=async function(t,e){if(this.options.selfish)return;if(t.sentAddr)return void this.logger.debug("Ignoring repeated getaddr (%s).",t.hostname());t.sentAddr=!0;const i=this.hosts.toArray(),n=[];for(const e of i)if(t.addrFilter.added(e.hostname,"ascii")&&(n.push(e),1e3===n.length))break;0!==n.length&&(this.logger.debug("Sending %d addrs to peer (%s)",n.length,t.hostname()),t.send(new T.AddrPacket(n)))},n.prototype.handleAddr=async function(t,e){const i=e.items,n=this.network.now(),r=this.options.getRequiredServices();for(const e of i)t.addrFilter.add(e.hostname,"ascii"),e.isRoutable()&&e.hasServices(r)&&((e.time<=1e8||e.time>n+600)&&(e.time=n-432e3),0!==e.port&&this.hosts.add(e,t.address));this.logger.info("Received %d addrs (hosts=%d, peers=%d) (%s).",i.length,this.hosts.size(),this.peers.size(),t.hostname()),this.fillOutbound()},n.prototype.handleInv=async function(t,e){const i=await this.locker.lock();try{return await this._handleInv(t,e)}finally{i()}},n.prototype._handleInv=async function(t,e){const i=e.items;if(i.length>5e4)return void t.increaseBan(100);const n=[],r=[];let s=-1;for(const e of i){switch(e.type){case U.BLOCK:n.push(e.hash);break;case U.TX:r.push(e.hash);break;default:s=e.type;continue}t.invFilter.add(e.hash,"hex")}this.logger.spam("Received inv packet with %d items: blocks=%d txs=%d (%s).",i.length,n.length,r.length,t.hostname()),-1!==s&&this.logger.warning("Peer sent an unknown inv type: %d (%s).",s,t.hostname()),n.length>0&&await this.handleBlockInv(t,n),r.length>0&&await this.handleTXInv(t,r)},n.prototype.handleBlockInv=async function(t,e){if(c(e.length>0),!this.syncing)return;if(!t.loader||this.chain.synced){const i=e[e.length-1];t.bestHash=i}if(!this.chain.synced&&!t.loader)return;if(this.options.hasWitness()&&!t.hasWitness())return;if(this.checkpoints)return;this.logger.debug("Received %s block hashes from peer (%s).",e.length,t.hostname());const i=[];let n=null;for(let r=0;r<e.length;r++){const s=e[r];this.chain.hasOrphan(s)?(this.logger.debug("Received known orphan hash (%s).",t.hostname()),await this.resolveOrphan(t,s)):await this.hasBlock(s)?(n=s,r===e.length-1&&(this.logger.debug("Received existing hash (%s).",t.hostname()),await this.getBlocks(t,s))):i.push(s)}if(n&&this.chain.synced){const e=await this.chain.getHeight(n);-1!==e&&(t.bestHeight=e)}this.getBlock(t,i)},n.prototype.handleTXInv=async function(t,e){c(e.length>0),this.syncing&&!this.chain.synced||this.ensureTX(t,e)},n.prototype.handleGetData=async function(t,e){const i=e.items;if(i.length>5e4)return this.logger.warning("Peer sent inv with >50k items (%s).",t.hostname()),t.increaseBan(100),void t.destroy();const n=[];let r=0,s=0,o=0,a=-1;for(const e of i)if(e.isTX()){const i=await this.getItem(t,e);if(!i){n.push(e);continue}if(i.isCoinbase()){n.push(e),this.logger.warning("Failsafe: tried to relay a coinbase.");continue}t.send(new T.TXPacket(i,e.hasWitness())),r++}else{switch(e.type){case U.BLOCK:case U.WITNESS_BLOCK:if(!await this.sendBlock(t,e,e.hasWitness())){n.push(e);continue}s++;break;case U.FILTERED_BLOCK:case U.WITNESS_FILTERED_BLOCK:{if(!this.options.bip37)return this.logger.debug("Peer requested a merkleblock without bip37 enabled (%s).",t.hostname()),void t.destroy();if(!t.spvFilter){n.push(e);continue}const i=await this.getItem(t,e);if(!i){n.push(e);continue}const o=i.toMerkle(t.spvFilter);t.send(new T.MerkleBlockPacket(o));for(const i of o.txs)t.send(new T.TXPacket(i,e.hasWitness())),r++;s++;break}case U.CMPCT_BLOCK:{if(await this.chain.getHeight(e.hash)<this.chain.tip.height-10){if(!await this.sendBlock(t,e,t.compactWitness)){n.push(e);continue}s++;break}const i=await this.getItem(t,e);if(!i){n.push(e);continue}t.sendCompactBlock(i),s++,o++;break}default:a=e.type,n.push(e);continue}e.hash===t.hashContinue&&(t.sendInv([new N(U.BLOCK,this.chain.tip.hash)]),t.hashContinue=null),await t.drain()}n.length>0&&t.send(new T.NotFoundPacket(n)),r>0&&this.logger.debug("Served %d txs with getdata (notfound=%d) (%s).",r,n.length,t.hostname()),s>0&&this.logger.debug("Served %d blocks with getdata (notfound=%d, cmpct=%d) (%s).",s,n.length,o,t.hostname()),-1!==a&&this.logger.warning("Peer sent an unknown getdata type: %s (%d).",a,t.hostname())},n.prototype.handleNotFound=async function(t,e){const i=e.items;for(const e of i)if(!this.resolveItem(t,e))return this.logger.warning("Peer sent notfound for unrequested item: %s (%s).",e.hash,t.hostname()),void t.destroy()},n.prototype.handleGetBlocks=async function(t,e){if(!this.chain.synced)return;if(this.options.selfish)return;if(this.chain.options.spv)return;if(this.chain.options.prune)return;let i=await this.chain.findLocator(e.locator);i&&(i=await this.chain.getNextHash(i));const n=[];for(;i&&(n.push(new N(U.BLOCK,i)),i!==e.stop);){if(500===n.length){t.hashContinue=i;break}i=await this.chain.getNextHash(i)}t.sendInv(n)},n.prototype.handleGetHeaders=async function(t,e){if(!this.chain.synced)return;if(this.options.selfish)return;if(this.chain.options.spv)return;if(this.chain.options.prune)return;let i;e.locator.length>0?(i=await this.chain.findLocator(e.locator))&&(i=await this.chain.getNextHash(i)):i=e.stop;let n;i&&(n=await this.chain.getEntry(i));const r=[];for(;n&&(r.push(n.toHeaders()),n.hash!==e.stop)&&2e3!==r.length;)n=await this.chain.getNext(n);t.sendHeaders(r)},n.prototype.handleHeaders=async function(t,e){const i=await this.locker.lock();try{return await this._handleHeaders(t,e)}finally{i()}},n.prototype._handleHeaders=async function(t,e){const i=e.items;if(!this.checkpoints)return;if(!this.syncing)return;if(!t.loader)return;if(0===i.length)return;if(i.length>2e3)return void t.increaseBan(100);c(this.headerChain.size>0);let n=!1,r=null;for(const e of i){const i=this.headerChain.tail,s=e.hash("hex"),o=i.height+1;if(!e.verify())return this.logger.warning("Peer sent an invalid header (%s).",t.hostname()),t.increaseBan(100),void t.destroy();if(e.prevBlock!==i.hash)return this.logger.warning("Peer sent a bad header chain (%s).",t.hostname()),void t.destroy();if((r=new h(s,o)).height===this.headerTip.height){if(r.hash!==this.headerTip.hash)return this.logger.warning("Peer sent an invalid checkpoint (%s).",t.hostname()),void t.destroy();n=!0}this.headerNext||(this.headerNext=r),this.headerChain.push(r)}if(this.logger.debug("Received %s headers from peer (%s).",i.length,t.hostname()),t.blockTime=l.ms(),n)return this.headerChain.shift(),void this.resolveHeaders(t);t.sendGetHeaders([r.hash],this.headerTip.hash)},n.prototype.handleSendHeaders=async function(t,e){},n.prototype.handleBlock=async function(t,e){const i=g.flags.DEFAULT_FLAGS;this.options.spv?this.logger.warning("Peer sent unsolicited block (%s).",t.hostname()):await this.addBlock(t,e.block,i)},n.prototype.addBlock=async function(t,e,i){const n=e.hash("hex"),r=await this.locker.lock(n);try{return await this._addBlock(t,e,i)}finally{r()}},n.prototype._addBlock=async function(t,e,i){if(!this.syncing)return;const n=e.hash("hex");if(!this.resolveBlock(t,n))return this.logger.warning("Received unrequested block: %s (%s).",e.rhash(),t.hostname()),void t.destroy();t.blockTime=l.ms();let r;try{r=await this.chain.add(e,i,t.id)}catch(e){if("VerifyError"===e.type)return t.reject("block",e),void this.logger.warning(e);throw e}if(!r){if(this.checkpoints)return void this.logger.warning("Peer sent orphan block with getheaders (%s).",t.hostname());const i=e.getCoinbaseHeight();return-1!==i&&(t.bestHash=n,t.bestHeight=i,this.resolveHeight(n,i)),this.logger.debug("Peer sent an orphan block. Resolving."),void await this.resolveOrphan(t,n)}this.chain.synced&&(t.bestHash=r.hash,t.bestHeight=r.height,this.resolveHeight(r.hash,r.height)),this.logStatus(e),await this.resolveChain(t,n)},n.prototype.resolveChain=async function(t,e){if(!this.checkpoints)return;if(!t.loader)return;if(t.destroyed)throw new Error("Peer was destroyed (header chain resolution).");const i=this.headerChain.head;return c(i),e!==i.hash?(this.logger.warning("Header hash mismatch %s != %s (%s).",l.revHex(e),l.revHex(i.hash),t.hostname()),void t.destroy()):i.height<this.network.lastCheckpoint?i.height===this.headerTip.height?(this.logger.info("Received checkpoint %s (%d).",l.revHex(i.hash),i.height),this.headerTip=this.getNextTip(i.height),void t.sendGetHeaders([e],this.headerTip.hash)):(this.headerChain.shift(),void this.resolveHeaders(t)):(this.logger.info("Switching to getblocks (%s).",t.hostname()),void await this.switchSync(t,e))},n.prototype.switchSync=async function(t,e){c(this.checkpoints),this.checkpoints=!1,this.headerTip=null,this.headerChain.reset(),this.headerNext=null,await this.getBlocks(t,e)},n.prototype.handleBadOrphan=function(t,e,i){const n=this.peers.find(i);n?(this.logger.debug("Punishing peer for sending a bad orphan (%s).",n.hostname()),n.reject(t,e)):this.logger.warning("Could not find offending peer for orphan: %s (%d).",l.revHex(e.hash),i)},n.prototype.logStatus=function(t){this.chain.height%20==0&&this.logger.debug("Status: time=%s height=%d progress=%s orphans=%d active=%d target=%s peers=%d",l.date(t.time),this.chain.height,(100*this.chain.getProgress()).toFixed(2)+"%",this.chain.orphanMap.size,this.blockMap.size,t.bits,this.peers.size()),this.chain.height%2e3==0&&this.logger.info("Received 2000 more blocks (height=%d, hash=%s).",this.chain.height,t.rhash())},n.prototype.handleTX=async function(t,e){const i=e.tx.hash("hex"),n=await this.locker.lock(i);try{return await this._handleTX(t,e)}finally{n()}},n.prototype._handleTX=async function(t,e){const i=e.tx,n=i.hash("hex"),r=g.flags.VERIFY_NONE,s=t.merkleBlock;if(s&&(c(t.merkleMatches>0),c(t.merkleMap),s.hasTX(n)))return t.merkleMap.has(n)?(this.logger.warning("Peer sent duplicate merkle tx: %s (%s).",i.txid(),t.hostname()),void t.increaseBan(100)):(t.merkleMap.add(n),s.txs.push(i),void(0==--t.merkleMatches&&(t.merkleBlock=null,t.merkleTime=-1,t.merkleMatches=0,t.merkleMap=null,await this._addBlock(t,s,r))));if(!this.resolveTX(t,n))return this.logger.warning("Peer sent unrequested tx: %s (%s).",i.txid(),t.hostname()),void t.destroy();if(!this.mempool)return void this.emit("tx",i);let o;try{o=await this.mempool.addTX(i,t.id)}catch(e){if("VerifyError"===e.type)return t.reject("tx",e),void this.logger.info(e);throw e}o&&o.length>0&&(this.logger.debug("Requesting %d missing transactions (%s).",o.length,t.hostname()),this.ensureTX(t,o))},n.prototype.handleReject=async function(t,e){if(this.logger.warning("Received reject (%s): msg=%s code=%s reason=%s hash=%s.",t.hostname(),e.message,e.getCode(),e.reason,e.rhash()),!e.hash)return;const i=this.invMap.get(e.hash);i&&i.handleReject(t)},n.prototype.handleMempool=async function(t,e){if(!this.mempool)return;if(!this.chain.synced)return;if(this.options.selfish)return;if(!this.options.bip37)return this.logger.debug("Peer requested mempool without bip37 enabled (%s).",t.hostname()),void t.destroy();const i=[];for(const t of this.mempool.map.keys())i.push(new N(U.TX,t));this.logger.debug("Sending mempool snapshot (%s).",t.hostname()),t.queueInv(i)},n.prototype.handleFilterLoad=async function(t,e){},n.prototype.handleFilterAdd=async function(t,e){},n.prototype.handleFilterClear=async function(t,e){},n.prototype.handleMerkleBlock=async function(t,e){const i=e.block.hash("hex"),n=await this.locker.lock(i);try{return await this._handleMerkleBlock(t,e)}finally{n()}},n.prototype._handleMerkleBlock=async function(t,e){if(!this.syncing)return;if(!this.options.spv)return this.logger.warning("Peer sent unsolicited merkleblock (%s).",t.hostname()),void t.increaseBan(100);const i=e.block,n=i.hash("hex");if(!t.blockMap.has(n))return this.logger.warning("Peer sent an unrequested merkleblock (%s).",t.hostname()),void t.destroy();if(t.merkleBlock)return this.logger.warning("Peer sent a merkleblock prematurely (%s).",t.hostname()),void t.increaseBan(100);if(!i.verify())return this.logger.warning("Peer sent an invalid merkleblock (%s).",t.hostname()),void t.increaseBan(100);const r=i.getTree();if(0!==r.matches.length)t.merkleBlock=i,t.merkleTime=l.ms(),t.merkleMatches=r.matches.length,t.merkleMap=new Set;else{const e=g.flags.VERIFY_NONE;await this._addBlock(t,i,e)}},n.prototype.handleFeeFilter=async function(t,e){},n.prototype.handleSendCmpct=async function(t,e){},n.prototype.handleCmpctBlock=async function(t,e){const i=e.block,n=i.hash("hex"),r=t.compactWitness;if(!this.syncing)return;if(!this.options.compact)return this.logger.info("Peer sent unsolicited cmpctblock (%s).",t.hostname()),void this.destroy();if(!t.hasCompactSupport()||!t.hasCompact())return this.logger.info("Peer sent unsolicited cmpctblock (%s).",t.hostname()),void this.destroy();if(t.compactBlocks.has(n))return void this.logger.debug("Peer sent us a duplicate compact block (%s).",t.hostname());if(this.compactBlocks.has(n))return void this.logger.debug("Already waiting for compact block %s (%s).",n,t.hostname());if(!t.blockMap.has(n)){if(1!==this.options.blockMode)return this.logger.warning("Peer sent us an unrequested compact block (%s).",t.hostname()),void t.destroy();t.blockMap.set(n,l.ms()),c(!this.blockMap.has(n)),this.blockMap.add(n)}if(!this.mempool)return void this.logger.warning("Requesting compact blocks without a mempool!");if(!i.verify())return this.logger.debug("Peer sent an invalid compact block (%s).",t.hostname()),void t.increaseBan(100);let s;try{s=i.init()}catch(e){return this.logger.debug("Peer sent an invalid compact block (%s).",t.hostname()),void t.increaseBan(100)}if(!s)return this.logger.warning("Siphash collision for %s. Requesting full block (%s).",i.rhash(),t.hostname()),t.getFullBlock(n),void t.increaseBan(10);if(i.fillMempool(r,this.mempool)){this.logger.debug("Received full compact block %s (%s).",i.rhash(),t.hostname());const e=g.flags.VERIFY_BODY;await this.addBlock(t,i.toBlock(),e)}else{if(1===this.options.blockMode&&t.compactBlocks.size>=15)return this.logger.warning("Compact block DoS attempt (%s).",t.hostname()),void t.destroy();i.now=l.ms(),c(!t.compactBlocks.has(n)),t.compactBlocks.set(n,i),this.compactBlocks.add(n),this.logger.debug("Received non-full compact block %s tx=%d/%d (%s).",i.rhash(),i.count,i.totalTX,t.hostname()),t.send(new T.GetBlockTxnPacket(i.toRequest()))}},n.prototype.handleGetBlockTxn=async function(t,e){const i=e.request;if(this.chain.options.spv)return;if(this.chain.options.prune)return;if(this.options.selfish)return;const n=new N(U.BLOCK,i.hash),r=await this.getItem(t,n);if(!r)return this.logger.debug("Peer sent getblocktxn for non-existent block (%s).",t.hostname()),void t.increaseBan(100);if(await this.chain.getHeight(i.hash)<this.chain.tip.height-15)return void this.logger.debug("Peer sent a getblocktxn for a block > 15 deep (%s)",t.hostname());this.logger.debug("Sending blocktxn for %s to peer (%s).",r.rhash(),t.hostname());const s=v.TXResponse.fromBlock(r,i);t.send(new T.BlockTxnPacket(s,t.compactWitness))},n.prototype.handleBlockTxn=async function(t,e){const i=e.response,n=t.compactBlocks.get(i.hash),r=g.flags.VERIFY_BODY;if(n){if(t.compactBlocks.delete(i.hash),c(this.compactBlocks.has(i.hash)),this.compactBlocks.delete(i.hash),!n.fillMissing(i))return this.logger.warning("Peer sent non-full blocktxn for %s. Requesting full block (%s).",n.rhash(),t.hostname()),t.getFullBlock(i.hash),void t.increaseBan(10);this.logger.debug("Filled compact block %s (%s).",n.rhash(),t.hostname()),await this.addBlock(t,n.toBlock(),r)}else this.logger.debug("Peer sent unsolicited blocktxn (%s).",t.hostname())},n.prototype.handleEncinit=async function(t,e){},n.prototype.handleEncack=async function(t,e){},n.prototype.handleAuthChallenge=async function(t,e){},n.prototype.handleAuthReply=async function(t,e){},n.prototype.handleAuthPropose=async function(t,e){},n.prototype.handleUnknown=async function(t,e){this.logger.warning("Unknown packet: %s (%s).",e.cmd,t.hostname())},n.prototype.addInbound=function(t){if(!this.loaded)return void t.destroy();const e=this.createInbound(t);this.logger.info("Added inbound peer (%s).",e.hostname()),this.peers.add(e)},n.prototype.getHost=function(){for(const t of this.hosts.nodes)if(!this.peers.has(t.hostname))return t;const t=this.options.getRequiredServices(),e=this.network.now();for(let i=0;i<100;i++){const n=this.hosts.getHost();if(!n)break;const r=n.addr;if(!this.peers.has(r.hostname)&&(r.isValid()&&r.hasServices(t)&&(this.options.onion||!r.isOnion())&&!(i<30&&e-n.lastAttempt<600||i<50&&r.port!==this.network.port||i<95&&this.hosts.isBanned(r.host))))return n.addr}return null},n.prototype.addOutbound=function(){if(!this.loaded)return;if(this.peers.outbound>=this.options.maxOutbound)return;if(!this.peers.load)return;const t=this.getHost();if(!t)return;const e=this.createOutbound(t);this.peers.add(e),this.emit("peer",e)},n.prototype.fillOutbound=function(){const t=this.options.maxOutbound-this.peers.outbound;if(this.peers.load||this.addLoader(),!(t<=0)){this.logger.debug("Refilling peers (%d/%d).",this.peers.outbound,this.options.maxOutbound);for(let e=0;e<t;e++)this.addOutbound()}},n.prototype.refill=function(){null==this.pendingRefill&&(this.pendingRefill=setTimeout(()=>{this.pendingRefill=null,this.fillOutbound()},3e3))},n.prototype.removePeer=function(t){this.peers.remove(t);for(const e of t.blockMap.keys())this.resolveBlock(t,e);for(const e of t.txMap.keys())this.resolveTX(t,e);for(const e of t.compactBlocks.keys())c(this.compactBlocks.has(e)),this.compactBlocks.delete(e);t.compactBlocks.clear()},n.prototype.ban=function(t){const e=this.peers.get(t.hostname);this.logger.debug("Banning peer (%s).",t.hostname),this.hosts.ban(t.host),this.hosts.remove(t.hostname),e&&e.destroy()},n.prototype.unban=function(t){this.hosts.unban(t.host)},n.prototype.setFilter=function(t){this.options.spv&&(this.spvFilter=t,this.queueFilterLoad())},n.prototype.watch=function(t,e){this.options.spv&&(this.spvFilter.add(t,e),this.queueFilterLoad())},n.prototype.unwatch=function(){this.options.spv&&(this.spvFilter.reset(),this.queueFilterLoad())},n.prototype.queueFilterLoad=function(){this.options.spv&&null==this.pendingFilter&&(this.pendingFilter=setTimeout(()=>{this.pendingFilter=null,this.sendFilterLoad()},100))},n.prototype.sendFilterLoad=function(){if(this.options.spv){c(this.spvFilter);for(let t=this.peers.head();t;t=t.next)t.sendFilterLoad(this.spvFilter)}},n.prototype.watchAddress=function(t){const e=y.getHash(t);this.watch(e)},n.prototype.watchOutpoint=function(t){this.watch(t.toRaw())},n.prototype.resolveOrphan=async function(t,e){const i=await this.chain.getLocator(),n=this.chain.getOrphanRoot(e);c(n),t.sendGetBlocks(i,n)},n.prototype.getHeaders=async function(t,e,i){const n=await this.chain.getLocator(e);t.sendGetHeaders(n,i)},n.prototype.getBlocks=async function(t,e,i){const n=await this.chain.getLocator(e);t.sendGetBlocks(n,i)},n.prototype.getBlock=function(t,e){if(!this.loaded)return;if(!t.handshake)throw new Error("Peer handshake not complete (getdata).");if(t.destroyed)throw new Error("Peer is destroyed (getdata).");let i=l.ms();const n=[];for(const r of e)this.blockMap.has(r)||(this.blockMap.add(r),t.blockMap.set(r,i),this.chain.synced&&(i+=100),n.push(r));0!==n.length&&(this.logger.debug("Requesting %d/%d blocks from peer with getdata (%s).",n.length,this.blockMap.size,t.hostname()),t.getBlock(n))},n.prototype.getTX=function(t,e){if(!this.loaded)return;if(!t.handshake)throw new Error("Peer handshake not complete (getdata).");if(t.destroyed)throw new Error("Peer is destroyed (getdata).");let i=l.ms();const n=[];for(const r of e)this.txMap.has(r)||(this.txMap.add(r),t.txMap.set(r,i),i+=50,n.push(r));0!==n.length&&(this.logger.debug("Requesting %d/%d txs from peer with getdata (%s).",n.length,this.txMap.size,t.hostname()),t.getTX(n))},n.prototype.hasBlock=async function(t){return!!this.locker.has(t)||!!await this.chain.has(t)},n.prototype.hasTX=function(t){if(this.locker.has(t))return!0;if(this.mempool){if(this.mempool.has(t))return!0;if(this.mempool.hasReject(t))return this.logger.spam("Saw known reject of %s.",l.revHex(t)),!0}else if(!this.txFilter.added(t,"hex"))return!0;return!1},n.prototype.ensureTX=function(t,e){const i=[];for(const t of e)this.hasTX(t)||i.push(t);this.getTX(t,i)},n.prototype.resolveTX=function(t,e){return!!t.txMap.has(e)&&(t.txMap.delete(e),c(this.txMap.has(e)),this.txMap.delete(e),!0)},n.prototype.resolveBlock=function(t,e){return!!t.blockMap.has(e)&&(t.blockMap.delete(e),c(this.blockMap.has(e)),this.blockMap.delete(e),!0)},n.prototype.resolveItem=function(t,e){return e.isBlock()?this.resolveBlock(t,e.hash):!!e.isTX()&&this.resolveTX(t,e.hash)},n.prototype.broadcast=function(t){const e=t.hash("hex");let i=this.invMap.get(e);return i?(i.refresh(),i.announce()):((i=new o(this,t)).start(),i.announce()),new Promise((t,e)=>{i.addJob(t,e)})},n.prototype.announceBlock=function(t){for(let e=this.peers.head();e;e=e.next)e.announceBlock(t)},n.prototype.announceTX=function(t){for(let e=this.peers.head();e;e=e.next)e.announceTX(t)},r.prototype.fromOptions=function(t){if(c(t,"Pool requires options."),c(t.chain&&"object"==typeof t.chain,"Pool options require a blockchain."),this.chain=t.chain,this.network=t.chain.network,this.logger=t.chain.logger,this.port=this.network.port,this.seeds=this.network.seeds,this.port=this.network.port,this.publicPort=this.network.port,null!=t.logger&&(c("object"==typeof t.logger),this.logger=t.logger),null!=t.mempool&&(c("object"==typeof t.mempool),this.mempool=t.mempool),null!=t.prefix&&(c("string"==typeof t.prefix),this.prefix=t.prefix),null!=t.checkpoints?(c("boolean"==typeof t.checkpoints),c(t.checkpoints===this.chain.options.checkpoints),this.checkpoints=t.checkpoints):this.checkpoints=this.chain.options.checkpoints,null!=t.spv?(c("boolean"==typeof t.spv),c(t.spv===this.chain.options.spv),this.spv=t.spv):this.spv=this.chain.options.spv,null!=t.bip37&&(c("boolean"==typeof t.bip37),this.bip37=t.bip37),null!=t.listen&&(c("boolean"==typeof t.listen),this.listen=t.listen),null!=t.compact&&(c("boolean"==typeof t.compact),this.compact=t.compact),null!=t.noRelay&&(c("boolean"==typeof t.noRelay),this.noRelay=t.noRelay),null!=t.host){c("string"==typeof t.host);const e=p.toBuffer(t.host);this.host=p.toString(e),p.isRoutable(e)&&(this.publicHost=this.host)}return null!=t.port&&(c(l.isU16(t.port)),this.port=t.port,this.publicPort=t.port),null!=t.publicHost&&(c("string"==typeof t.publicHost),this.publicHost=p.normalize(t.publicHost)),null!=t.publicPort&&(c(l.isU16(t.publicPort)),this.publicPort=t.publicPort),null!=t.maxOutbound&&(c("number"==typeof t.maxOutbound),c(t.maxOutbound>0),this.maxOutbound=t.maxOutbound),null!=t.maxInbound&&(c("number"==typeof t.maxInbound),this.maxInbound=t.maxInbound),t.createSocket&&(c("function"==typeof t.createSocket),this.createSocket=t.createSocket),t.createServer&&(c("function"==typeof t.createServer),this.createServer=t.createServer),t.resolve&&(c("function"==typeof t.resolve),this.resolve=t.resolve),t.proxy&&(c("string"==typeof t.proxy),this.proxy=t.proxy),null!=t.onion&&(c("boolean"==typeof t.onion),this.onion=t.onion),null!=t.upnp&&(c("boolean"==typeof t.upnp),this.upnp=t.upnp),t.selfish&&(c("boolean"==typeof t.selfish),this.selfish=t.selfish),t.version&&(c("number"==typeof t.version),this.version=t.version),t.agent&&(c("string"==typeof t.agent),c(t.agent.length<=255),this.agent=t.agent),null!=t.bip151&&(c("boolean"==typeof t.bip151),this.bip151=t.bip151),null!=t.bip150&&(c("boolean"==typeof t.bip150),c(!t.bip150||this.bip151,"Cannot enable bip150 without bip151."),t.knownPeers&&(c("object"==typeof t.knownPeers),c(!Array.isArray(t.knownPeers)),this.knownPeers=t.knownPeers),t.authPeers&&(c(Array.isArray(t.authPeers)),this.authPeers=t.authPeers),t.identityKey&&(c(Buffer.isBuffer(t.identityKey),"Identity key must be a buffer."),c(E.privateKeyVerify(t.identityKey),"Invalid identity key."),this.identityKey=t.identityKey)),null!=t.banScore&&(c("number"==typeof this.options.banScore),this.banScore=this.options.banScore),null!=t.banTime&&(c("number"==typeof this.options.banTime),this.banTime=this.options.banTime),null!=t.feeRate&&(c("number"==typeof this.options.feeRate),this.feeRate=this.options.feeRate),t.seeds&&(c(Array.isArray(t.seeds)),this.seeds=t.seeds),t.nodes&&(c(Array.isArray(t.nodes)),this.nodes=t.nodes),null!=t.only&&(c(Array.isArray(t.only)),t.only.length>0&&(this.nodes=t.only,this.maxOutbound=t.only.length)),null!=t.invTimeout&&(c("number"==typeof t.invTimeout),this.invTimeout=t.invTimeout),null!=t.blockMode&&(c("number"==typeof t.blockMode),this.blockMode=t.blockMode),null!=t.persistent&&(c("boolean"==typeof t.persistent),this.persistent=t.persistent),this.spv&&(this.requiredServices|=m.services.BLOOM,this.services&=~m.services.NETWORK,this.noRelay=!0,this.checkpoints=!0,this.compact=!1,this.bip37=!1,this.listen=!1),this.selfish&&(this.services&=~m.services.NETWORK,this.bip37=!1),this.bip37&&(this.services|=m.services.BLOOM),this.proxy&&(this.listen=!1),null!=t.services&&(c(l.isU32(t.services)),this.services=t.services),null!=t.requiredServices&&(c(l.isU32(t.requiredServices)),this.requiredServices=t.requiredServices),this},r.fromOptions=function(t){return(new r).fromOptions(t)},r.prototype.getHeight=function(){return this.chain.height},r.prototype.isFull=function(){return this.chain.synced},r.prototype.getRequiredServices=function(){let t=this.requiredServices;return this.hasWitness()&&(t|=m.services.WITNESS),t},r.prototype.hasWitness=function(){return this.chain.state.hasWitness()},r.prototype.createNonce=function(t){return this.nonces.alloc(t)},r.prototype.hasNonce=function(t){return this.nonces.has(t)},r.prototype.getRate=function(t){if(!this.mempool)return-1;const e=this.mempool.getEntry(t);return e?e.getRate():-1},r.prototype._createSocket=function(t,e){return O.createSocket(t,e,this.proxy)},r.prototype._resolve=function(t){return this.onion?B.lookup(t,this.proxy):B.lookup(t)},s.prototype.head=function(){return this.list.head},s.prototype.tail=function(){return this.list.tail},s.prototype.size=function(){return this.list.size},s.prototype.add=function(t){c(this.list.push(t)),c(!this.map.has(t.hostname())),this.map.set(t.hostname(),t),c(!this.ids.has(t.id)),this.ids.set(t.id,t),t.outbound?this.outbound++:this.inbound++},s.prototype.remove=function(t){c(this.list.remove(t)),c(this.ids.has(t.id)),this.ids.delete(t.id),c(this.map.has(t.hostname())),this.map.delete(t.hostname()),t===this.load&&(c(t.loader),t.loader=!1,this.load=null),t.outbound?this.outbound--:this.inbound--},s.prototype.get=function(t){return this.map.get(t)},s.prototype.has=function(t){return this.map.has(t)},s.prototype.find=function(t){return this.ids.get(t)},s.prototype.destroy=function(){let t;for(let e=this.list.head;e;e=t)t=e.next,e.destroy()},Object.setPrototypeOf(o.prototype,u.prototype),o.prototype.addJob=function(t,e){this.jobs.push(d.job(t,e))},o.prototype.start=function(){return c(!this.timeout,"Already started."),c(!this.pool.invMap.has(this.hash),"Already started."),this.pool.invMap.set(this.hash,this),this.refresh(),this},o.prototype.refresh=function(){null!=this.timeout&&(clearTimeout(this.timeout),this.timeout=null),this.timeout=setTimeout(()=>{this.emit("timeout"),this.reject(new Error("Timed out."))},this.pool.options.invTimeout)},o.prototype.announce=function(){switch(this.type){case U.TX:this.pool.announceTX(this.msg);break;case U.BLOCK:this.pool.announceBlock(this.msg);break;default:c(!1,"Bad type.")}},o.prototype.cleanup=function(){c(null!=this.timeout,"Already finished."),c(this.pool.invMap.has(this.hash),"Already finished."),clearTimeout(this.timeout),this.timeout=null,this.pool.invMap.delete(this.hash)},o.prototype.reject=function(t){this.cleanup();for(const e of this.jobs)e.reject(t);this.jobs.length=0},o.prototype.resolve=function(){this.cleanup();for(const t of this.jobs)t.resolve(!1);this.jobs.length=0},o.prototype.handleAck=function(t){setTimeout(()=>{this.emit("ack",t);for(const t of this.jobs)t.resolve(!0);this.jobs.length=0},1e3)},o.prototype.handleReject=function(t){this.emit("reject",t);for(const t of this.jobs)t.resolve(!1);this.jobs.length=0},o.prototype.inspect=function(){return`<BroadcastItem: type=${this.type===U.TX?"tx":"block"} hash=${l.revHex(this.hash)}>`},a.prototype.alloc=function(t){for(;;){const e=l.nonce(),i=e.toString("hex");if(!this.map.has(i))return this.map.set(i,t),c(!this.hosts.has(t)),this.hosts.set(t,i),e}},a.prototype.has=function(t){const e=t.toString("hex");return this.map.has(e)},a.prototype.remove=function(t){const e=this.hosts.get(t);return!!e&&(this.hosts.delete(t),c(this.map.has(e)),this.map.delete(e),!0)},t.exports=n},function(t,e,i){"use strict";function n(t){if(!(this instanceof n))return new n(t);c("string"==typeof t),c(t.length>0),this.module=t,this.network="mainnet",this.prefix=u.join(d,`.${t}`),this.options=Object.create(null),this.data=Object.create(null),this.env=Object.create(null),this.args=Object.create(null),this.argv=[],this.pass=[],this.query=Object.create(null),this.hash=Object.create(null)}function r(t){return Array.isArray(t)&&(t=t[0]),"number"==typeof t?`Argument #${t}`:t}function s(t){try{t=(t=decodeURIComponent(t)).replace(/\+/g," ")}catch(t){}return t=t.replace(/\0/g,"")}function o(t){return/^[a-z0-9]+$/.test(t)}function a(t){return/^[a-zA-Z0-9]+$/.test(t)}function h(t){return!!a(t)&&!/[A-Z]/.test(t)}const c=i(0),u=i(33),f=i(116),l=i(59),p=i(1),d=f.homedir?f.homedir():"/";n.alias={seed:"seeds",node:"nodes",n:"network"},n.default={},n.prototype.inject=function(t){for(const e of Object.keys(t)){const i=t[e];switch(e){case"hash":case"query":case"env":case"argv":case"config":continue}this.set(e,i)}},n.prototype.load=function(t){t.hash&&this.parseHash(t.hash),t.query&&this.parseQuery(t.query),t.env&&this.parseEnv(t.env),t.argv&&this.parseArg(t.argv),this.network=this.getNetwork(),this.prefix=this.getPrefix()},n.prototype.open=function(t){if(l.unsupported)return;const e=this.getFile(t);let i;try{i=l.readFileSync(e,"utf8")}catch(t){if("ENOENT"===t.code)return;throw t}this.parseConfig(i),this.network=this.getNetwork(),this.prefix=this.getPrefix()},n.prototype.set=function(t,e){c("string"==typeof t,"Key must be a string."),null!=e&&(t=(t=t.replace(/-/g,"")).toLowerCase(),this.options[t]=e)},n.prototype.has=function(t){return"number"==typeof t?(c(t>=0,"Index must be positive."),!(t>=this.argv.length)):(c("string"==typeof t,"Key must be a string."),t=t.replace(/-/g,""),t=t.toLowerCase(),null!=this.hash[t]||(null!=this.query[t]||(null!=this.args[t]||(null!=this.env[t]||(null!=this.data[t]||null!=this.options[t])))))},n.prototype.get=function(t,e){if(void 0===e&&(e=null),Array.isArray(t)){const i=t;for(const t of i){const e=this.get(t);if(null!==e)return e}return e}return"number"==typeof t?(c(t>=0,"Index must be positive."),t>=this.argv.length?e:null!=this.argv[t]?this.argv[t]:e):(c("string"==typeof t,"Key must be a string."),t=t.replace(/-/g,""),t=t.toLowerCase(),null!=this.hash[t]?this.hash[t]:null!=this.query[t]?this.query[t]:null!=this.args[t]?this.args[t]:null!=this.env[t]?this.env[t]:null!=this.data[t]?this.data[t]:null!=this.options[t]?this.options[t]:e)},n.prototype.typeOf=function(t){const e=this.get(t);return null===e?"null":typeof e},n.prototype.str=function(t,e){const i=this.get(t);if(void 0===e&&(e=null),null===i)return e;if("string"!=typeof i)throw new Error(`${r(t)} must be a string.`);return i},n.prototype.int=function(t,e){let i=this.get(t);if(void 0===e&&(e=null),null===i)return e;if("string"!=typeof i){if("number"!=typeof i)throw new Error(`${r(t)} must be an int.`);if(!Number.isSafeInteger(i))throw new Error(`${r(t)} must be an int.`);return i}if(!/^\-?\d+$/.test(i))throw new Error(`${r(t)} must be an int.`);if(i=parseInt(i,10),!Number.isSafeInteger(i))throw new Error(`${r(t)} must be an int.`);return i},n.prototype.uint=function(t,e){const i=this.int(t);if(void 0===e&&(e=null),null===i)return e;if(i<0)throw new Error(`${r(t)} must be a uint.`);return i},n.prototype.float=function(t,e){let i=this.get(t);if(void 0===e&&(e=null),null===i)return e;if("string"!=typeof i){if("number"!=typeof i)throw new Error(`${r(t)} must be a float.`);if(!isFinite(i))throw new Error(`${r(t)} must be a float.`);return i}if(!/^\-?\d*(?:\.\d*)?$/.test(i))throw new Error(`${r(t)} must be a float.`);if(!/\d/.test(i))throw new Error(`${r(t)} must be a float.`);if(i=parseFloat(i),!isFinite(i))throw new Error(`${r(t)} must be a float.`);return i},n.prototype.ufloat=function(t,e){const i=this.float(t);if(void 0===e&&(e=null),null===i)return e;if(i<0)throw new Error(`${r(t)} must be a positive float.`);return i},n.prototype.fixed=function(t,e,i){const n=this.float(t);if(void 0===i&&(i=null),null===n)return i;try{return p.fromFloat(n,e||0)}catch(e){throw new Error(`${r(t)} must be a fixed number.`)}},n.prototype.ufixed=function(t,e,i){const n=this.fixed(t,e);if(void 0===i&&(i=null),null===n)return i;if(n<0)throw new Error(`${r(t)} must be a positive fixed number.`);return n},n.prototype.bool=function(t,e){const i=this.get(t);if(void 0===e&&(e=null),null===i)return e;if("number"==typeof i){if(1===i)return!0;if(0===i)return!1}if("string"!=typeof i){if("boolean"!=typeof i)throw new Error(`${r(t)} must be a boolean.`);return i}if("true"===i||"1"===i)return!0;if("false"===i||"0"===i)return!1;throw new Error(`${r(t)} must be a boolean.`)},n.prototype.buf=function(t,e,i){const n=this.get(t);if(i||(i="hex"),void 0===e&&(e=null),null===n)return e;if("string"!=typeof n){if(!Buffer.isBuffer(n))throw new Error(`${r(t)} must be a buffer.`);return n}const s=Buffer.from(n,i);if(s.length!==Buffer.byteLength(n,i))throw new Error(`${r(t)} must be a ${i} string.`);return s},n.prototype.array=function(t,e){const i=this.get(t);if(void 0===e&&(e=null),null===i)return e;if("string"!=typeof i){if(!Array.isArray(i))throw new Error(`${r(t)} must be an array.`);return i}const n=i.trim().split(/\s*,\s*/),s=[];for(const t of n)0!==t.length&&s.push(t);return s},n.prototype.obj=function(t,e){const i=this.get(t);if(void 0===e&&(e=null),null===i)return e;if("object"!=typeof i)throw new Error(`${r(t)} must be an object.`);return i},n.prototype.func=function(t,e){const i=this.get(t);if(void 0===e&&(e=null),null===i)return e;if("function"!=typeof i)throw new Error(`${r(t)} must be a function.`);return i},n.prototype.path=function(t,e){let i=this.str(t);if(void 0===e&&(e=null),null===i)return e;switch(i[0]){case"~":i=u.join(d,i.substring(1));break;case"@":i=u.join(this.prefix,i.substring(1))}return u.normalize(i)},n.prototype.mb=function(t,e){const i=this.uint(t);return void 0===e&&(e=null),null===i?e:1024*i*1024},n.prototype.getNetwork=function(){let t=this.str("network");return t||(t="mainnet"),c(o(t),"Bad network."),t},n.prototype.getPrefix=function(){let t=this.str("prefix");if(t)return"~"===t[0]&&(t=u.join(d,t.substring(1))),t;t=u.join(d,`.${this.module}`);const e=this.str("network");return e&&(c(o(e),"Bad network."),"mainnet"!==e&&(t=u.join(t,e))),u.normalize(t)},n.prototype.getFile=function(t){const e=this.str("config");return e||u.join(this.prefix,t)},n.prototype.ensure=function(){return l.unsupported?Promise.resolve():l.mkdirp(this.prefix)},n.prototype.location=function(t){return u.join(this.prefix,t)},n.prototype.parseConfig=function(t){c("string"==typeof t,"Config must be text."),65279===t.charCodeAt(0)&&(t=t.substring(1)),t=(t=(t=t.replace(/\r\n/g,"\n")).replace(/\r/g,"\n")).replace(/\\\n/g,"");let e=!0,i=!1,r=0;for(const s of t.split("\n")){const t=s.trim();if(r+=1,0===t.length)continue;if("#"===t[0])continue;const o=t.indexOf("="),a=t.indexOf(":");let c=-1;if(-1!==a&&(a<o||-1===o)){if(i&&!e)throw new Error(`Expected '=' on line ${r}: "${t}".`);c=a,i=!0,e=!0}else{if(-1===o){const i=e?":":"=";throw new Error(`Expected '${i}' on line ${r}: "${t}".`)}if(i&&e)throw new Error(`Expected ':' on line ${r}: "${t}".`);c=o,i=!0,e=!1}let u=t.substring(0,c).trim();if(u=u.replace(/\-/g,""),!h(u))throw new Error(`Invalid option on line ${r}: ${u}.`);const f=t.substring(c+1).trim();if(0===f.length)continue;const l=n.alias[u];l&&(u=l),this.data[u]=f}},n.prototype.parseArg=function(t){t&&"object"==typeof t||(t=process.argv),c(Array.isArray(t));let e=null,i=!1;for(let r=2;r<t.length;r++){const s=t[r];if(c("string"==typeof s),"--"===s){i=!0;continue}if(i){this.pass.push(s);continue}if(0===s.length){e=null;continue}if(0===s.indexOf("--")){const t=s.indexOf("=");let i=null,r=null,o=!1;if(-1!==t?(i=s.substring(2,t),r=s.substring(t+1),e=null,o=!1):(i=s.substring(2),r="true",e=null,o=!0),i=i.replace(/\-/g,""),!h(i))throw new Error(`Invalid argument: --${i}.`);if(0===r.length)continue;if(i.length>1){const t=n.alias[i];t&&(i=t)}this.args[i]=r,o&&(e=i);continue}if("-"===s[0]){e=null;for(let t=1;t<s.length;t++){let i=s[t];if((i<"a"||i>"z")&&(i<"A"||i>"Z")&&(i<"0"||i>"9")&&"?"!==i)throw new Error(`Invalid argument: -${i}.`);const r=n.alias[i];r&&(i=r),this.args[i]="true",e=i}continue}const o=s;0!==o.length?e?(this.args[e]=o,e=null):this.argv.push(o):e=null}},n.prototype.parseEnv=function(t){let e=this.module;e=(e=e.toUpperCase()).replace(/-/g,"_"),e+="_",t&&"object"==typeof t||(t=process.env),c(t&&"object"==typeof t);for(let i of Object.keys(t)){const r=t[i];if(c("string"==typeof r),p.startsWith(i,e)&&(i=i.substring(e.length),i=i.replace(/_/g,""),function(t){return!!a(t)&&!/[a-z]/.test(t)}(i)&&0!==r.length)){if((i=i.toLowerCase()).length>1){const t=n.alias[i];t&&(i=t)}this.env[i]=r}}},n.prototype.parseQuery=function(t){if("string"!=typeof t){if(!global.location)return{};if("string"!=typeof(t=global.location.search))return{}}return this.parseForm(t,this.query)},n.prototype.parseHash=function(t){if("string"!=typeof t){if(!global.location)return{};if("string"!=typeof(t=global.location.hash))return{}}return this.parseForm(t,this.hash)},n.prototype.parseForm=function(t,e){if(c("string"==typeof t),0===t.length)return;let i="?";e===this.hash&&(i="#"),t[0]===i&&(t=t.substring(1));for(const i of t.split("&")){const t=i.indexOf("=");let r,o;if(-1!==t?(r=i.substring(0,t),o=i.substring(t+1)):(r=i,o="true"),r=s(r),r=r.replace(/\-/g,""),!h(r))continue;if(0===(o=s(o)).length)continue;const a=n.alias[r];a&&(r=a),e[r]=o}},t.exports=n},function(t,e,i){"use strict";function n(t){if(!(this instanceof n))return new n(t);a.call(this),this.enabled=!1,this.size=Math.max(2,h.cpus().length),this.timeout=12e4,this.file="wmcc-worker.js",this.children=new Map,this.uid=0,this.set(t)}function r(t){if(!(this instanceof r))return new r(t);a.call(this),this.id=-1,this.framer=new m,this.parser=new d,this.pending=new Map,this.child=new l(t),this.init()}function s(t,e,i,n){this.worker=t,this.id=e,this.job=u.job(i,n),this.timer=null}const o=i(0),a=i(10),h=i(116),c=i(1),u=i(16),f=i(6),l=i(310),p=i(125),d=i(126),m=i(127),g=i(53);Object.setPrototypeOf(n.prototype,a.prototype),n.prototype.set=function(t){t&&(null!=t.enabled&&(o("boolean"==typeof t.enabled),this.enabled=t.enabled),null!=t.size&&(o(c.isU32(t.size)),o(t.size>0),this.size=t.size),null!=t.timeout&&(o(c.isInt(t.timeout)),o(t.timeout>=-1),this.timeout=t.timeout),null!=t.file&&(o("string"==typeof t.file),this.file=t.file))},n.prototype.open=async function(){},n.prototype.close=async function(){this.destroy()},n.prototype.spawn=function(t){const e=new r(this.file);return e.id=t,e.on("error",t=>{this.emit("error",t,e)}),e.on("exit",i=>{this.emit("exit",i,e),this.children.get(t)===e&&this.children.delete(t)}),e.on("event",t=>{this.emit("event",t,e),this.emit(...t)}),e.on("log",t=>{this.emit("log",t,e)}),this.emit("spawn",e),e},n.prototype.alloc=function(){const t=this.uid++%this.size;return this.children.has(t)||this.children.set(t,this.spawn(t)),this.children.get(t)},n.prototype.sendEvent=function(){let t=!0;for(const e of this.children.values())e.sendEvent.apply(e,arguments)||(t=!1);return t},n.prototype.destroy=function(){for(const t of this.children.values())t.destroy()},n.prototype.execute=function(t,e){if(!this.enabled||!l.hasSupport())return new Promise((e,i)=>{setImmediate(()=>{let n;try{n=p.handle(t)}catch(t){return void i(t)}e(n)})});e||(e=this.timeout);return this.alloc().execute(t,e)},n.prototype.check=async function(t,e,i){const n=new g.CheckPacket(t,e,i),r=await this.execute(n,-1);if(r.error)throw r.error;return null},n.prototype.sign=async function(t,e,i){let n=e;Array.isArray(n)||(n=[n]);const r=new g.SignPacket(t,n,i),s=await this.execute(r,-1);return s.inject(t),s.total},n.prototype.checkInput=async function(t,e,i,n){const r=new g.CheckInputPacket(t,e,i,n),s=await this.execute(r,-1);if(s.error)throw s.error;return null},n.prototype.signInput=async function(t,e,i,n,r){const s=new g.SignInputPacket(t,e,i,n,r),o=await this.execute(s,-1);return o.inject(t),o.value},n.prototype.ecVerify=async function(t,e,i){const n=new g.ECVerifyPacket(t,e,i);return(await this.execute(n,-1)).value},n.prototype.ecSign=async function(t,e){const i=new g.ECSignPacket(t,e);return(await this.execute(i,-1)).sig},n.prototype.mine=async function(t,e,i,n){const r=new g.MinePacket(t,e,i,n);return(await this.execute(r,-1)).nonce},n.prototype.scrypt=async function(t,e,i,n,r,s){const o=new g.ScryptPacket(t,e,i,n,r,s);return(await this.execute(o,-1)).key},Object.setPrototypeOf(r.prototype,a.prototype),r.prototype.init=function(){this.child.on("data",t=>{this.parser.feed(t)}),this.child.on("exit",(t,e)=>{this.emit("exit",t,e)}),this.child.on("error",t=>{this.emit("error",t)}),this.parser.on("error",t=>{this.emit("error",t)}),this.parser.on("packet",t=>{this.emit("packet",t)}),this.listen()},r.prototype.listen=function(){this.on("exit",(t,e)=>{this.killJobs()}),this.on("error",t=>{this.killJobs()}),this.on("packet",t=>{try{this.handlePacket(t)}catch(t){this.emit("error",t)}}),this.sendEnv({WMCC_WORKER_NETWORK:f.type,WMCC_WORKER_ISTTY:process.stdout&&process.stdout.isTTY?"1":"0"})},r.prototype.handlePacket=function(t){switch(t.cmd){case g.types.EVENT:this.emit("event",t.items),this.emit(...t.items);break;case g.types.LOG:this.emit("log",t.text);break;case g.types.ERROR:this.emit("error",t.error);break;case g.types.ERRORRESULT:this.rejectJob(t.id,t.error);break;default:this.resolveJob(t.id,t)}},r.prototype.write=function(t){return this.child.write(t)},r.prototype.send=function(t){return this.write(this.framer.packet(t))},r.prototype.sendEnv=function(t){return this.send(new g.EnvPacket(t))},r.prototype.sendEvent=function(...t){return this.send(new g.EventPacket(t))},r.prototype.destroy=function(){return this.child.destroy()},r.prototype.execute=function(t,e){return new Promise((i,n)=>{this._execute(t,e,i,n)})},r.prototype._execute=function(t,e,i,n){const r=new s(this,t.id,i,n);o(!this.pending.has(t.id),"ID overflow."),this.pending.set(t.id,r),r.start(e),this.send(t)},r.prototype.resolveJob=function(t,e){const i=this.pending.get(t);if(!i)throw new Error(`Job ${t} is not in progress.`);i.resolve(e)},r.prototype.rejectJob=function(t,e){const i=this.pending.get(t);if(!i)throw new Error(`Job ${t} is not in progress.`);i.reject(e)},r.prototype.killJobs=function(){for(const t of this.pending.values())t.destroy()},s.prototype.start=function(t){!t||t<=0||(this.timer=setTimeout(()=>{this.reject(new Error("Worker timed out."))},t))},s.prototype.destroy=function(){this.reject(new Error("Job was destroyed."))},s.prototype.cleanup=function(){const t=this.job;return o(t,"Already finished."),this.job=null,null!=this.timer&&(clearTimeout(this.timer),this.timer=null),o(this.worker.pending.has(this.id)),this.worker.pending.delete(this.id),t},s.prototype.resolve=function(t){this.cleanup().resolve(t)},s.prototype.reject=function(t){this.cleanup().reject(t)},t.exports=n},function(t,e,i){"use strict";const n=i(12),{derive:r}=i(44),s=i(97),o=i(53),a=e;a.execute=function(t){try{return a.handle(t)}catch(t){return new o.ErrorResultPacket(t)}},a.handle=function(t){switch(t.cmd){case o.types.CHECK:return a.check(t.tx,t.view,t.flags);case o.types.CHECKINPUT:return a.checkInput(t.tx,t.index,t.coin,t.flags);case o.types.SIGN:return a.sign(t.tx,t.rings,t.type);case o.types.SIGNINPUT:return a.signInput(t.tx,t.index,t.coin,t.ring,t.type);case o.types.ECVERIFY:return a.ecVerify(t.msg,t.sig,t.key);case o.types.ECSIGN:return a.ecSign(t.msg,t.key);case o.types.MINE:return a.mine(t.data,t.target,t.min,t.max);case o.types.SCRYPT:return a.scrypt(t.passwd,t.salt,t.N,t.r,t.p,t.len);default:throw new Error(`Unknown command: "${t.cmd}".`)}},a.check=function(t,e,i){try{t.check(e,i)}catch(t){if("ScriptError"===t.type)return new o.CheckResultPacket(t);throw t}return new o.CheckResultPacket},a.checkInput=function(t,e,i,n){try{t.checkInput(e,i,n)}catch(t){if("ScriptError"===t.type)return new o.CheckInputResultPacket(t);throw t}return new o.CheckInputResultPacket},a.sign=function(t,e,i){const n=t.sign(e,i);return o.SignResultPacket.fromTX(t,n)},a.signInput=function(t,e,i,n,r){const s=t.signInput(t,e,i,n,r);return o.SignInputResultPacket.fromTX(t,e,s)},a.ecVerify=function(t,e,i){const r=n.verify(t,e,i);return new o.ECVerifyResultPacket(r)},a.ecSign=function(t,e){const i=n.sign(t,e);return new o.ECSignResultPacket(i)},a.mine=function(t,e,i,n){const r=s(t,e,i,n);return new o.MineResultPacket(r)},a.scrypt=function(t,e,i,n,s,a){const h=r(t,e,i,n,s,a);return new o.ScryptResultPacket(h)}},function(t,e,i){"use strict";function n(){if(!(this instanceof n))return new n;s.call(this),this.waiting=9,this.header=null,this.pending=[],this.total=0}const r=i(0),s=i(10),o=i(53);Object.setPrototypeOf(n.prototype,s.prototype),n.prototype.feed=function(t){for(this.total+=t.length,this.pending.push(t);this.total>=this.waiting;){const t=this.read(this.waiting);this.parse(t)}},n.prototype.read=function(t){if(r(this.total>=t,"Reading too much."),0===t)return Buffer.alloc(0);const e=this.pending[0];if(e.length>t){const i=e.slice(0,t);return this.pending[0]=e.slice(t),this.total-=i.length,i}if(e.length===t){const t=this.pending.shift();return this.total-=t.length,t}const i=Buffer.allocUnsafe(t);let n=0;for(;n<i.length;){const t=this.pending[0],e=t.copy(i,n);e===t.length?this.pending.shift():this.pending[0]=t.slice(e),n+=e}return r.strictEqual(n,i.length),this.total-=i.length,i},n.prototype.parse=function(t){let e=this.header;if(!e){try{e=this.parseHeader(t)}catch(t){return void this.emit("error",t)}return this.header=e,void(this.waiting=e.size+1)}this.waiting=9,this.header=null;let i;try{i=this.parsePacket(e,t)}catch(t){return void this.emit("error",t)}10===t[t.length-1]?(i.id=e.id,this.emit("packet",i)):this.emit("error",new Error("No trailing newline."))},n.prototype.parseHeader=function(t){return new function(t,e,i){this.id=t,this.cmd=e,this.size=i}(t.readUInt32LE(0,!0),t.readUInt8(4,!0),t.readUInt32LE(5,!0))},n.prototype.parsePacket=function(t,e){switch(t.cmd){case o.types.ENV:return o.EnvPacket.fromRaw(e);case o.types.EVENT:return o.EventPacket.fromRaw(e);case o.types.LOG:return o.LogPacket.fromRaw(e);case o.types.ERROR:return o.ErrorPacket.fromRaw(e);case o.types.ERRORRESULT:return o.ErrorResultPacket.fromRaw(e);case o.types.CHECK:return o.CheckPacket.fromRaw(e);case o.types.CHECKRESULT:return o.CheckResultPacket.fromRaw(e);case o.types.SIGN:return o.SignPacket.fromRaw(e);case o.types.SIGNRESULT:return o.SignResultPacket.fromRaw(e);case o.types.CHECKINPUT:return o.CheckInputPacket.fromRaw(e);case o.types.CHECKINPUTRESULT:return o.CheckInputResultPacket.fromRaw(e);case o.types.SIGNINPUT:return o.SignInputPacket.fromRaw(e);case o.types.SIGNINPUTRESULT:return o.SignInputResultPacket.fromRaw(e);case o.types.ECVERIFY:return o.ECVerifyPacket.fromRaw(e);case o.types.ECVERIFYRESULT:return o.ECVerifyResultPacket.fromRaw(e);case o.types.ECSIGN:return o.ECSignPacket.fromRaw(e);case o.types.ECSIGNRESULT:return o.ECSignResultPacket.fromRaw(e);case o.types.MINE:return o.MinePacket.fromRaw(e);case o.types.MINERESULT:return o.MineResultPacket.fromRaw(e);case o.types.SCRYPT:return o.ScryptPacket.fromRaw(e);case o.types.SCRYPTRESULT:return o.ScryptResultPacket.fromRaw(e);default:throw new Error("Unknown packet.")}},t.exports=n},function(t,e,i){"use strict";function n(){if(!(this instanceof n))return new n}const r=i(4);n.prototype.packet=function(t){const e=10+t.getSize(),i=new r(e);i.writeU32(t.id),i.writeU8(t.cmd),i.seek(4),t.toWriter(i),i.writeU8(10);const n=i.render();return n.writeUInt32LE(n.length-10,5,!0),n},t.exports=n},function(t,e,i){"use strict";function n(t,e){if(!(this instanceof n))return new n(t,e);s.call(this,t,e),this.keyType=o.types.HD,this.id=null,this.wid=-1,this.name=null,this.account=-1,this.branch=-1,this.index=-1}const r=i(11),s=i(47),o=i(80);Object.setPrototypeOf(n.prototype,s.prototype),n.fromOptions=function(t){return(new n).fromOptions(t)},n.fromPrivate=function(t,e,i){return(new n).fromPrivate(t,e,i)},n.generate=function(t,e){return(new n).generate(t,e)},n.fromPublic=function(t,e){return(new n).fromPublic(t,e)},n.fromKey=function(t,e,i){return(new n).fromKey(t,e,i)},n.fromScript=function(t,e,i,r){return(new n).fromScript(t,e,i,r)},n.fromSecret=function(t,e){return(new n).fromSecret(t,e)},n.prototype.toJSON=function(){return{network:this.network.type,wid:this.wid,id:this.id,name:this.name,account:this.account,branch:this.branch,index:this.index,witness:this.witness,nested:this.nested,publicKey:this.publicKey.toString("hex"),script:this.script?this.script.toRaw().toString("hex"):null,program:this.witness?this.getProgram().toRaw().toString("hex"):null,type:r.typesByVal[this.getType()].toLowerCase(),address:this.getAddress("string")}},n.fromJSON=function(t){return(new n).fromJSON(t)},n.fromRaw=function(t){return(new n).fromRaw(t)},n.prototype.fromHD=function(t,e,i,n){return this.keyType=o.types.HD,this.id=t.id,this.wid=t.wid,this.name=t.name,this.account=t.accountIndex,this.branch=i,this.index=n,this.witness=t.witness,this.nested=2===i,e.privateKey?this.fromPrivate(e.privateKey,t.network):this.fromPublic(e.publicKey,t.network)},n.fromHD=function(t,e,i,r){return(new n).fromHD(t,e,i,r)},n.prototype.fromImport=function(t,e){return this.keyType=o.types.KEY,this.id=t.id,this.wid=t.wid,this.name=t.name,this.account=t.accountIndex,this.witness=t.witness,this.fromRaw(e,t.network)},n.fromImport=function(t,e){return(new n).fromImport(t,e)},n.prototype.fromRing=function(t,e){return this.keyType=o.types.KEY,this.id=t.id,this.wid=t.wid,this.name=t.name,this.account=t.accountIndex,this.witness=t.witness,this.fromOptions(e,e.network)},n.fromRing=function(t,e){return(new n).fromRing(t,e)},n.prototype.toPath=function(){const t=new o;switch(t.id=this.id,t.wid=this.wid,t.name=this.name,t.account=this.account,this.keyType){case o.types.HD:t.branch=this.branch,t.index=this.index;break;case o.types.KEY:t.data=this.toRaw()}return t.keyType=this.keyType,t.version=this.getVersion(),t.type=this.getType(),t.hash=this.getHash("hex"),t},n.isWalletKey=function(t){return t instanceof n},t.exports=n},function(t,e,i){"use strict";function n(){if(!(this instanceof n))return new n;this.startHeight=-1,this.startHash=m.NULL_HASH,this.height=-1,this.marked=!1}function r(t,e,i){if(!(this instanceof r))return new r(t,e,i);this.hash=t||m.NULL_HASH,this.height=null!=e?e:-1,this.time=i||0}function s(t){if(!(this instanceof s))return new s(t);this.height=null!=t?t:-1,this.txs=new Map}function o(t,e){this.hash=t||m.NULL_HASH,this.wids=e||new Set}function a(t,e,i){this.hash=t||m.NULL_HASH,this.index=null!=e?e:-1,this.wids=i||new Set}function h(t,e){this.hash=t||m.NULL_HASH,this.wids=e||new Set}function c(t,e){if(!(this instanceof c))return new c(t,e);this.tx=null,this.hash=null,this.mtime=d.now(),this.height=-1,this.block=null,this.index=-1,this.time=0,t&&this.fromTX(t,e)}function u(t){const e=t.readU32(),i=new Set;for(let n=0;n<e;n++)i.add(t.readU32());return i}function f(t){return 4+4*t.size}function l(t,e){t.writeU32(e.size);for(const i of e)t.writeU32(i);return t}const p=i(0),d=i(1),m=i(3),g=i(2),y=i(4),w=i(15);n.prototype.clone=function(){const t=new n;return t.startHeight=this.startHeight,t.startHash=this.startHash,t.height=this.height,t.marked=this.marked,t},n.prototype.fromRaw=function(t){const e=new g(t);return this.startHeight=e.readU32(),this.startHash=e.readHash("hex"),this.height=e.readU32(),this.marked=!0,e.left()>0&&(this.marked=1===e.readU8()),this},n.fromRaw=function(t){return(new n).fromRaw(t)},n.prototype.toRaw=function(){const t=new y(41);return t.writeU32(this.startHeight),t.writeHash(this.startHash),t.writeU32(this.height),t.writeU8(this.marked?1:0),t.render()},r.prototype.clone=function(){return new r(this.hash,this.height,this.time)},r.prototype.toHash=function(){return Buffer.from(this.hash,"hex")},r.prototype.fromEntry=function(t){return this.hash=t.hash,this.height=t.height,this.time=t.time,this},r.prototype.fromJSON=function(t){return this.hash=d.revHex(t.hash),this.height=t.height,this.time=t.time,this},r.prototype.fromRaw=function(t){const e=new g(t);return this.hash=e.readHash("hex"),this.height=e.readU32(),this.time=e.readU32(),this},r.fromEntry=function(t){return(new r).fromEntry(t)},r.fromJSON=function(t){return(new r).fromJSON(t)},r.fromRaw=function(t){return(new r).fromRaw(t)},r.prototype.toRaw=function(){const t=new y(42);return t.writeHash(this.hash),t.writeU32(this.height),t.writeU32(this.time),t.render()},r.prototype.toJSON=function(){return{hash:d.revHex(this.hash),height:this.height,time:this.time}},s.prototype.fromRaw=function(t){const e=new g(t),i=e.readU32();for(let t=0;t<i;t++){const t=e.readHash("hex"),i=o.fromReader(t,e);this.txs.set(i.hash,i)}return this},s.fromRaw=function(t,e){return new s(t).fromRaw(e)},s.prototype.getSize=function(){let t=0;t+=4;for(const e of this.txs.values())t+=32,t+=e.getSize();return t},s.prototype.toRaw=function(){const t=this.getSize(),e=new y(t);e.writeU32(this.txs.size);for(const[t,i]of this.txs)e.writeHash(t),i.toWriter(e);return e.render()},s.prototype.add=function(t,e){let i=this.txs.get(t);return i||(i=new o(t),this.txs.set(t,i)),i.add(e)},s.prototype.remove=function(t,e){const i=this.txs.get(t);return!!i&&(!!i.remove(e)&&(0===i.wids.size&&this.txs.delete(i.hash),!0))},s.prototype.toArray=function(){const t=[];for(const e of this.txs.values())t.push(e);return t},o.prototype.add=function(t){return!this.wids.has(t)&&(this.wids.add(t),!0)},o.prototype.remove=function(t){return this.wids.delete(t)},o.prototype.toWriter=function(t){return l(t,this.wids)},o.prototype.getSize=function(){return f(this.wids)},o.prototype.toRaw=function(){const t=this.getSize();return this.toWriter(new y(t)).render()},o.prototype.fromReader=function(t){return this.wids=u(t),this},o.prototype.fromRaw=function(t){return this.fromReader(new g(t))},o.fromReader=function(t,e){return new o(t).fromReader(e)},o.fromRaw=function(t,e){return new o(t).fromRaw(e)},a.prototype.add=function(t){return!this.wids.has(t)&&(this.wids.add(t),!0)},a.prototype.remove=function(t){return this.wids.delete(t)},a.prototype.toWriter=function(t){return l(t,this.wids)},a.prototype.getSize=function(){return f(this.wids)},a.prototype.toRaw=function(){const t=this.getSize();return this.toWriter(new y(t)).render()},a.prototype.fromReader=function(t){return this.wids=u(t),this},a.prototype.fromRaw=function(t){return this.fromReader(new g(t))},a.fromReader=function(t,e,i){return new a(t,e).fromReader(i)},a.fromRaw=function(t,e,i){return new a(t,e).fromRaw(i)},h.prototype.add=function(t){return!this.wids.has(t)&&(this.wids.add(t),!0)},h.prototype.remove=function(t){return this.wids.delete(t)},h.prototype.toWriter=function(t){return l(t,this.wids)},h.prototype.getSize=function(){return f(this.wids)},h.prototype.toRaw=function(){const t=this.getSize();return this.toWriter(new y(t)).render()},h.prototype.fromReader=function(t){return this.wids=u(t),this},h.prototype.fromRaw=function(t){return this.fromReader(new g(t))},h.fromReader=function(t,e){return new h(t).fromReader(e)},h.fromRaw=function(t,e){return new h(t).fromRaw(e)},c.prototype.fromTX=function(t,e){return this.tx=t,this.hash=t.hash("hex"),e&&this.setBlock(e),this},c.fromTX=function(t,e){return(new c).fromTX(t,e)},c.prototype.setBlock=function(t){this.height=t.height,this.block=t.hash,this.time=t.time},c.prototype.unsetBlock=function(){this.height=-1,this.block=null,this.time=0},c.prototype.getBlock=function(){return-1===this.height?null:new r(this.block,this.height,this.time)},c.prototype.getDepth=function(t){return p("number"==typeof t,"Must pass in height."),-1===this.height?0:t<this.height?0:t-this.height+1},c.prototype.getSize=function(){let t=0;return t+=this.tx.getSize(),t+=4,this.block?(t+=1,t+=32,t+=12):t+=1,t},c.prototype.toRaw=function(){const t=this.getSize(),e=new y(t);let i=this.index;return this.tx.toWriter(e),e.writeU32(this.mtime),this.block?(-1===i&&(i=2147483647),e.writeU8(1),e.writeHash(this.block),e.writeU32(this.height),e.writeU32(this.time),e.writeU32(i)):e.writeU8(0),e.render()},c.prototype.fromRaw=function(t){const e=new g(t);return this.tx=new w,this.tx.fromReader(e),this.hash=this.tx.hash("hex"),this.mtime=e.readU32(),1===e.readU8()&&(this.block=e.readHash("hex"),this.height=e.readU32(),this.time=e.readU32(),this.index=e.readU32(),2147483647===this.index&&(this.index=-1)),this},c.fromRaw=function(t){return(new c).fromRaw(t)},e.ChainState=n,e.BlockMeta=r,e.BlockMapRecord=s,e.TXMapRecord=o,e.OutpointMapRecord=a,e.PathMapRecord=h,e.TXRecord=c,t.exports=e},function(t,e,i){"use strict";function n(t){if(!(this instanceof n))return new n(t);h.call(this),this.options=new r(t),this.network=this.options.network,this.logger=this.options.logger.context("wallet"),this.workers=this.options.workers,this.client=this.options.client,this.feeRate=this.options.feeRate,this.db=k(this.options),this.rpc=new A(this),this.primary=null,this.http=null,I.unsupported||(this.http=new I({walletdb:this,network:this.network,logger:this.logger,prefix:this.options.prefix,apiKey:this.options.apiKey,walletAuth:this.options.walletAuth,noAuth:this.options.noAuth,host:this.options.host,port:this.options.port,ssl:this.options.ssl})),this.state=new B,this.wallets=new Map,this.depth=0,this.rescanning=!1,this.bound=!1,this.readLock=new f,this.writeLock=new u,this.txLock=new u,this.locker=new u,this.widCache=new l(1e4),this.pathMapCache=new l(1e5),this.filter=new S,this._init()}function r(t){if(!(this instanceof r))return new r(t);this.network=g.primary,this.logger=E.global,this.workers=null,this.client=null,this.feeRate=0,this.prefix=null,this.location=null,this.db="memory",this.maxFiles=64,this.cacheSize=16<<20,this.compression=!0,this.bufferKeys=O.binary,this.spv=!1,this.witness=!0,this.checkpoints=!1,this.startHeight=0,this.keepBlocks=this.network.block.keepBlocks,this.wipeNoReally=!1,this.apiKey=null,this.walletAuth=!1,this.noAuth=!1,this.ssl=!1,this.host="127.0.0.1",this.port=this.network.rpcPort+2,this.listen=!1,t&&this.fromOptions(t)}const s=i(0),o=i(33),a=i(106),h=i(30),c=i(1),u=i(23),f=i(186),l=i(57),p=i(3),d=i(52),m=i(108),g=i(6),y=i(80),w=i(62),b=i(248),v=i(187),k=i(92),S=i(42),E=i(34),R=i(21),x=i(188),_=i(129),I=i(245),A=i(250),O=x.walletdb,B=_.ChainState,P=_.BlockMapRecord,M=_.BlockMeta,N=_.PathMapRecord,T=_.OutpointMapRecord,C=_.TXRecord,U=p.U32;Object.setPrototypeOf(n.prototype,h.prototype),n.layout=O,n.prototype._init=function(){let t=1e6,e=-1;this.options.spv&&(t=2e4,e=S.flags.ALL),this.filter=S.fromRate(t,.001,e)},n.prototype._open=async function(){this.options.listen&&await this.logger.open(),await this.db.open(),await this.db.checkVersion("V",6),this.depth=await this.getDepth(),this.options.wipeNoReally&&await this.wipe(),await this.load(),this.logger.info("WalletDB loaded (depth=%d, height=%d, start=%d).",this.depth,this.state.height,this.state.startHeight),this.http&&this.options.listen&&await this.http.open()},n.prototype.set=async function(t){const e=await this.locker.lock();try{return await this._set(t)}finally{e()}},n.prototype._set=async function(t){s("string"==typeof t.id),s("object"==typeof t.hsm);const e=await this.ensure({id:t.id,hsm:t.hsm});this.logger.info("Loaded primary wallet (id=%s, wid=%d, address=%s)",e.id,e.wid,e.getAddress()),this.primary=e,this.rpc.wallet=e},n.prototype._close=async function(){await this.disconnect(),this.http&&this.options.listen&&await this.http.close();for(const t of this.wallets.values())await t.destroy();await this.db.close(),this.options.listen&&await this.logger.close()},n.prototype.load=async function(){const t=await this.txLock.lock();try{await this.connect(),await this.init(),await this.watch(),await this.sync(),await this.resend()}finally{t()}},n.prototype.bind=function(){this.client&&(this.bound||(this.bound=!0,this.client.on("error",t=>{this.emit("error",t)}),this.client.on("block connect",async(t,e)=>{try{await this.addBlock(t,e)}catch(t){this.emit("error",t)}}),this.client.on("block disconnect",async t=>{try{await this.removeBlock(t)}catch(t){this.emit("error",t)}}),this.client.hook("block rescan",async(t,e)=>{try{await this.rescanBlock(t,e)}catch(t){this.emit("error",t)}}),this.client.on("tx",async t=>{try{await this.addTX(t)}catch(t){this.emit("error",t)}}),this.client.on("chain reset",async t=>{try{await this.resetChain(t)}catch(t){this.emit("error",t)}})))},n.prototype.unbind=function(){this.client&&(this.client.removeAllListeners(),this.client.unhook("block rescan"))},n.prototype.connect=async function(){this.client&&(this.bind(),await this.client.open(),await this.setFilter())},n.prototype.disconnect=async function(){this.client&&await this.client.close()},n.prototype.init=async function(){const t=await this.getState(),e=this.options.startHeight;if(t)return void(this.state=t);let i;if(this.client){if(null!=e){if(!(i=await this.client.getEntry(e)))throw new Error("WDB: Could not find start block.")}else i=await this.client.getTip();i=M.fromEntry(i)}else i=M.fromEntry(this.network.genesis);this.logger.info("Initializing WalletDB chain state at %s (%d).",c.revHex(i.hash),i.height),await this.resetState(i,!1)},n.prototype.watch=async function(){let t=this.db.iterator({gte:O.p(p.NULL_HASH),lte:O.p(p.HIGH_HASH)}),e=0,i=0;for(;;){const i=await t.next();if(!i)break;try{const e=O.pp(i.key);this.filter.add(e,"hex")}catch(e){throw await t.end(),e}e++}for(t=this.db.iterator({gte:O.o(p.NULL_HASH,0),lte:O.o(p.HIGH_HASH,4294967295)});;){const e=await t.next();if(!e)break;try{const[i,n]=O.oo(e.key),r=new R(i,n).toRaw();this.filter.add(r)}catch(e){throw await t.end(),e}i++}this.logger.info("Added %d hashes to WalletDB filter.",e),this.logger.info("Added %d outpoints to WalletDB filter.",i),await this.setFilter()},n.prototype.sync=async function(){if(!this.client)return;let t,e=this.state.height;for(;e>=0;){const i=await this.getBlock(e);if(!i)break;if(t=await this.client.getEntry(i.hash))break;e--}t||(e=this.state.startHeight,(t=await this.client.getEntry(this.state.startHash))||(e=0)),await this.scan(e)},n.prototype.scan=async function(t){if(!this.client)return;null==t&&(t=this.state.startHeight),s(c.isU32(t),"WDB: Must pass in a height."),await this.rollback(t),this.logger.info("WalletDB is scanning %d blocks.",this.state.height-t+1);const e=await this.getTip();try{this.rescanning=!0,await this.client.rescan(e.hash)}finally{this.rescanning=!1}},n.prototype.rescan=async function(t){const e=await this.txLock.lock();try{return await this._rescan(t)}finally{e()}},n.prototype._rescan=async function(t){return await this.scan(t)},n.prototype.send=async function(t){this.client?await this.client.send(t):this.emit("send",t)},n.prototype.estimateFee=async function(t){if(this.feeRate>0)return this.feeRate;if(!this.client)return this.network.feeRate;const e=await this.client.estimateFee(t);return e<this.network.feeRate?this.network.feeRate:e>this.network.maxFeeRate?this.network.maxFeeRate:e},n.prototype.setFilter=function(){return this.client?this.client.setFilter(this.filter):(this.emit("set filter",this.filter),Promise.resolve())},n.prototype.addFilter=function(t){return this.client?this.client.addFilter(t):(this.emit("add filter",t),Promise.resolve())},n.prototype.resetFilter=function(){return this.client?this.client.resetFilter():(this.emit("reset filter"),Promise.resolve())},n.prototype.backup=function(t){return this.db.backup(t)},n.prototype.suffix=function(t){s("string"==typeof t);const e=Object.assign({},this.options);return e.location=o.join(this.options.prefix,"walletdb",t),this.suffix=t,this.db=k(e),e.location},n.prototype.list=function(){const t=o.join(this.options.prefix,"walletdb");try{return a.readdirSync(t).filter(function(e){return a.statSync(o.join(t,e)).isDirectory()})}catch(t){return[]}},n.prototype.wipe=async function(){this.logger.warning("Wiping WalletDB TXDB..."),this.logger.warning("I hope you know what you're doing.");const t=this.db.iterator({gte:Buffer.from([0]),lte:Buffer.from([255])}),e=this.db.batch();let i=0;for(;;){const n=await t.next();if(!n)break;try{switch(n.key[0]){case 98:case 99:case 101:case 116:case 111:case 104:case 82:e.del(n.key),i++}}catch(e){throw await t.end(),e}}this.logger.warning("Wiped %d txdb records.",i),await e.write()},n.prototype.getDepth=async function(){const t=this.db.iterator({gte:O.w(0),lte:O.w(4294967295),reverse:!0,limit:1}),e=await t.next();if(!e)return 1;await t.end();return O.ww(e.key)+1},n.prototype.start=function(t){return s(!t.current,"WDB: Batch already started."),t.current=this.db.batch(),t.accountCache.start(),t.pathCache.start(),t.current},n.prototype.drop=function(t){const e=this.batch(t);t.current=null,t.accountCache.drop(),t.pathCache.drop(),e.clear()},n.prototype.clear=function(t){const e=this.batch(t);t.accountCache.clear(),t.pathCache.clear(),e.clear()},n.prototype.batch=function(t){return s(t.current,"WDB: Batch does not exist."),t.current},n.prototype.commit=async function(t){const e=this.batch(t);try{await e.write()}catch(e){throw t.current=null,t.accountCache.drop(),t.pathCache.drop(),e}t.current=null,t.accountCache.commit(),t.pathCache.commit()},n.prototype.testFilter=function(t){return this.filter.test(t,"hex")},n.prototype.addHash=function(t){return this.filter.add(t,"hex"),this.addFilter(t)},n.prototype.addOutpoint=function(t,e){const i=new R(t,e);this.filter.add(i.toRaw())},n.prototype.dump=function(){return this.db.dump()},n.prototype.register=function(t){s(!this.wallets.has(t.wid)),this.wallets.set(t.wid,t)},n.prototype.unregister=function(t){s(this.wallets.has(t.wid)),this.wallets.delete(t.wid)},n.prototype.getWalletID=async function(t){if(!t)return null;if("number"==typeof t)return t;const e=this.widCache.get(t);if(e)return e;const i=await this.db.get(O.l(t));if(!i)return null;const n=i.readUInt32LE(0,!0);return this.widCache.set(t,n),n},n.prototype.get=async function(t){const e=await this.getWalletID(t);if(!e)return null;const i=await this.readLock.lock(e);try{return await this._get(e)}finally{i()}},n.prototype._get=async function(t){const e=this.wallets.get(t);if(e)return e;const i=await this.db.get(O.w(t));if(!i)return null;const n=b.fromRaw(this,i);return await n.open(),this.register(n),n},n.prototype.save=function(t){const e=t.wid,i=t.id,n=this.batch(t);this.widCache.set(i,e),n.put(O.w(e),t.toRaw()),n.put(O.l(i),U(e))},n.prototype.rename=async function(t,e){const i=await this.writeLock.lock();try{return await this._rename(t,e)}finally{i()}},n.prototype._rename=async function(t,e){const i=t.id;if(!w.isName(e))throw new Error("WDB: Bad wallet ID.");if(await this.has(e))throw new Error("WDB: ID not available.");this.start(t).del(O.l(i)),t.id=e,this.save(t),await this.commit(t),this.widCache.remove(i);const n=t.pathCache.values();for(const t of n)t.id=e},n.prototype.renameAccount=function(t,e){const i=t.wallet;this.batch(i).del(O.i(t.wid,t.name)),t.name=e,this.saveAccount(t)},n.prototype.auth=async function(t,e){const i=await this.get(t);if(!i)return null;if("string"==typeof e){if(!c.isHex256(e))throw new Error("WDB: Authentication error.");e=Buffer.from(e,"hex")}if(!d(e,i.token))throw new Error("WDB: Authentication error.");return i},n.prototype.create=async function(t){const e=await this.writeLock.lock();t||(t={});try{return await this._create(t)}finally{e()}},n.prototype._create=async function(t){if(await this.has(t.id))throw new Error("WDB: Wallet already exists.");const e=b.fromOptions(this,t);return e.wid=this.depth++,await e.init(t),this.register(e),this.logger.info("Created wallet %s in WalletDB.",e.id),e},n.prototype.has=async function(t){return null!=await this.getWalletID(t)},n.prototype.ensure=async function(t){const e=await this.get(t.id);return e||await this.create(t)},n.prototype.getAccount=async function(t,e){const i=await this.db.get(O.a(t,e));return i?v.fromRaw(this,i):null},n.prototype.getAccounts=function(t){return this.db.values({gte:O.n(t,0),lte:O.n(t,4294967295),parse:t=>t.toString("ascii")})},n.prototype.getAccountIndex=async function(t,e){const i=await this.db.get(O.i(t,e));return i?i.readUInt32LE(0,!0):-1},n.prototype.getAccountName=async function(t,e){const i=await this.db.get(O.n(t,e));return i?i.toString("ascii"):null},n.prototype.saveAccount=function(t){const e=t.wid,i=t.wallet,n=t.accountIndex,r=t.name,s=this.batch(i);s.put(O.a(e,n),t.toRaw()),s.put(O.i(e,r),U(n)),s.put(O.n(e,n),Buffer.from(r,"ascii")),i.accountCache.push(n,t)},n.prototype.hasAccount=function(t,e){return this.db.has(O.a(t,e))},n.prototype.getPathMap=async function(t){const e=this.pathMapCache.get(t);if(e)return e;const i=await this.db.get(O.p(t));if(!i)return null;const n=N.fromRaw(t,i);return this.pathMapCache.set(t,n),n},n.prototype.saveKey=function(t,e){return this.savePath(t,e.toPath())},n.prototype.savePath=async function(t,e){const i=t.wid,n=e.hash,r=this.batch(t);await this.addHash(n);let s=await this.getPathMap(n);s||(s=new N(n)),s.add(i)&&(this.pathMapCache.set(n,s),t.pathCache.push(n,e),r.put(O.p(n),s.toRaw()),r.put(O.P(i,n),e.toRaw()),r.put(O.r(i,e.account,n),null))},n.prototype.getPath=async function(t,e){const i=await this.db.get(O.P(t,e));if(!i)return null;const n=y.fromRaw(i);return n.wid=t,n.hash=e,n},n.prototype.hasPath=function(t,e){return this.db.has(O.P(t,e))},n.prototype.getHashes=function(){return this.db.keys({gte:O.p(p.NULL_HASH),lte:O.p(p.HIGH_HASH),parse:O.pp})},n.prototype.getOutpoints=function(){return this.db.keys({gte:O.o(p.NULL_HASH,0),lte:O.o(p.HIGH_HASH,4294967295),parse:t=>{const[e,i]=O.oo(t);return new R(e,i)}})},n.prototype.getWalletHashes=function(t){return this.db.keys({gte:O.P(t,p.NULL_HASH),lte:O.P(t,p.HIGH_HASH),parse:O.Pp})},n.prototype.getAccountHashes=function(t,e){return this.db.keys({gte:O.r(t,e,p.NULL_HASH),lte:O.r(t,e,p.HIGH_HASH),parse:O.rr})},n.prototype.getWalletPaths=async function(t){const e=await this.db.range({gte:O.P(t,p.NULL_HASH),lte:O.P(t,p.HIGH_HASH)}),i=[];for(const n of e){const e=O.Pp(n.key),r=y.fromRaw(n.value);r.hash=e,r.wid=t,i.push(r)}return i},n.prototype.getWallets=function(){return this.db.keys({gte:O.l("\0"),lte:O.l("ÿ"),parse:O.ll})},n.prototype.encryptKeys=async function(t,e){const i=t.wid,n=await t.getPaths(),r=this.batch(t);for(let o of n){if(!o.data)continue;s(!o.encrypted);const n=Buffer.from(o.hash,"hex").slice(0,16);(o=o.clone()).data=m.encipher(o.data,e,n),o.encrypted=!0,t.pathCache.push(o.hash,o),r.put(O.P(i,o.hash),o.toRaw())}},n.prototype.decryptKeys=async function(t,e){const i=t.wid,n=await t.getPaths(),r=this.batch(t);for(let o of n){if(!o.data)continue;s(o.encrypted);const n=Buffer.from(o.hash,"hex").slice(0,16);(o=o.clone()).data=m.decipher(o.data,e,n),o.encrypted=!1,t.pathCache.push(o.hash,o),r.put(O.P(i,o.hash),o.toRaw())}},n.prototype.resend=async function(){const t=await this.db.keys({gte:O.w(0),lte:O.w(4294967295)});for(const e of t){const t=O.ww(e);await this.resendPending(t)}},n.prototype.resendPending=async function(t){const e=x.txdb,i=await this.db.keys({gte:e.prefix(t,e.p(p.NULL_HASH)),lte:e.prefix(t,e.p(p.HIGH_HASH))});if(0===i.length)return;this.logger.info("Rebroadcasting %d transactions for %d.",i.length,t);const n=[];for(const r of i){const i=e.pp(r),s=e.prefix(t,e.t(i)),o=await this.db.get(s);if(!o)continue;const a=C.fromRaw(o);a.tx.isCoinbase()||n.push(a.tx)}const r=w.sortDeps(n);for(const t of r)await this.send(t)},n.prototype.getWalletsByTX=async function(t){const e=t.getOutputHashes("hex"),i=new Set;if(!t.isCoinbase())for(const e of t.inputs){const t=e.prevout;if(!this.testFilter(t.toRaw()))continue;const n=await this.getOutpointMap(t.hash,t.index);if(n)for(const t of n.wids)i.add(t)}for(const t of e){if(!this.testFilter(t))continue;const e=await this.getPathMap(t);if(e)for(const t of e.wids)i.add(t)}return 0===i.size?null:i},n.prototype.getState=async function(){const t=await this.db.get(O.R);return t?B.fromRaw(t):null},n.prototype.resetState=async function(t,e){const i=this.db.batch(),n=this.state.clone(),r=this.db.iterator({gte:O.h(0),lte:O.h(4294967295),values:!1});for(;;){const t=await r.next();if(!t)break;try{i.del(t.key)}catch(t){throw await r.end(),t}}n.startHeight=t.height,n.startHash=t.hash,n.height=t.height,n.marked=e,i.put(O.h(t.height),t.toHash()),i.put(O.R,n.toRaw()),await i.write(),this.state=n},n.prototype.syncState=async function(t){const e=this.db.batch(),i=this.state.clone();if(t.height<i.height){let n=i.height,r=n-t.height;r>this.options.keepBlocks&&(r=this.options.keepBlocks);for(let t=0;t<r;t++)e.del(O.h(n)),n--}else if(t.height>i.height){const n=t.height-this.options.keepBlocks;s(t.height===i.height+1,"Bad chain sync."),n>=0&&e.del(O.h(n))}i.height=t.height,e.put(O.h(t.height),t.toHash()),e.put(O.R,i.toRaw()),await e.write(),this.state=i},n.prototype.maybeMark=async function(t){this.state.marked||(this.logger.info("Marking WalletDB start block at %s (%d).",c.revHex(t.hash),t.height),await this.resetState(t,!0))},n.prototype.getBlockMap=async function(t){const e=await this.db.get(O.b(t));return e?P.fromRaw(t,e):null},n.prototype.writeBlockMap=function(t,e,i){this.batch(t).put(O.b(e),i.toRaw())},n.prototype.unwriteBlockMap=function(t,e){this.batch(t).del(O.b(e))},n.prototype.getOutpointMap=async function(t,e){const i=await this.db.get(O.o(t,e));return i?T.fromRaw(t,e,i):null},n.prototype.writeOutpointMap=function(t,e,i,n){const r=this.batch(t);this.addOutpoint(e,i),r.put(O.o(e,i),n.toRaw())},n.prototype.unwriteOutpointMap=function(t,e,i){this.batch(t).del(O.o(e,i))},n.prototype.getBlock=async function(t){const e=await this.db.get(O.h(t));if(!e)return null;const i=new M;return i.hash=e.toString("hex"),i.height=t,i},n.prototype.getTip=async function(){const t=await this.getBlock(this.state.height);if(!t)throw new Error("WDB: Tip not found!");return t},n.prototype.rollback=async function(t){if(t>this.state.height)throw new Error("WDB: Cannot rollback to the future.");if(t===this.state.height)return this.logger.debug("Rolled back to same height (%d).",t),!0;this.logger.info("Rolling back %d WalletDB blocks to height %d.",this.state.height-t,t);let e=await this.getBlock(t),i=!1;return e?(await this.revert(e.height),await this.syncState(e),!0):(e=new M,t>=this.state.startHeight?(e.height=this.state.startHeight,e.hash=this.state.startHash,i=this.state.marked,this.logger.warning("Rolling back WalletDB to start block (%d).",e.height)):(e.height=0,e.hash=this.network.genesis.hash,i=!1,this.logger.warning("Rolling back WalletDB to genesis block.")),await this.revert(e.height),await this.resetState(e,i),!1)},n.prototype.revert=async function(t){const e=this.db.iterator({gte:O.b(t+1),lte:O.b(4294967295),reverse:!0,values:!0});let i=0;for(;;){const t=await e.next();if(!t)break;try{const n=O.bb(t.key),r=P.fromRaw(n,t.value).toArray();i+=r.length;for(let t=r.length-1;t>=0;t--){const e=r[t];await this._unconfirm(e)}}catch(t){throw await e.end(),t}}this.logger.info("Rolled back %d WalletDB transactions.",i)},n.prototype.addBlock=async function(t,e){const i=await this.txLock.lock();try{return await this._addBlock(t,e)}finally{i()}},n.prototype._addBlock=async function(t,e){const i=M.fromEntry(t);let n=0;if(i.height<this.state.height)return this.logger.warning("WalletDB is connecting low blocks (%d).",i.height),n;if(i.height===this.state.height)this.logger.warning("Already saw WalletDB block (%d).",i.height);else if(i.height!==this.state.height+1)throw new Error("WDB: Bad connection (height mismatch).");if(await this.syncState(i),this.options.checkpoints&&i.height<=this.network.lastCheckpoint)return n;for(const t of e)await this._insert(t,i)&&n++;return n>0&&this.logger.info("Connected WalletDB block %s (tx=%d).",c.revHex(i.hash),n),n},n.prototype.removeBlock=async function(t){const e=await this.txLock.lock();try{return await this._removeBlock(t)}finally{e()}},n.prototype._removeBlock=async function(t){const e=M.fromEntry(t);if(e.height>this.state.height)return this.logger.warning("WalletDB is disconnecting high blocks (%d).",e.height),0;if(e.height!==this.state.height)throw new Error("WDB: Bad disconnection (height mismatch).");const i=await this.getBlock(e.height-1);if(!i)throw new Error("WDB: Bad disconnection (no previous block).");const n=await this.getBlockMap(e.height);if(!n)return await this.syncState(i),0;const r=n.toArray();for(let t=r.length-1;t>=0;t--){const e=r[t];await this._unconfirm(e)}return await this.syncState(i),this.logger.warning("Disconnected wallet block %s (tx=%d).",c.revHex(e.hash),n.txs.size),n.txs.size},n.prototype.rescanBlock=async function(t,e){if(this.rescanning)try{await this._addBlock(t,e)}catch(t){throw this.emit("error",t),t}else this.logger.warning("Unsolicited rescan block: %s.",t.height)},n.prototype.addTX=async function(t){const e=await this.txLock.lock();try{return await this._insert(t)}finally{e()}},n.prototype._insert=async function(t,e){const i=await this.getWalletsByTX(t);let n=!1;if(s(!t.mutable,"WDB: Cannot add mutable TX."),!i)return null;this.logger.info("Incoming transaction for %d wallets in WalletDB (%s).",i.size,t.txid()),e&&await this.maybeMark(e);for(const r of i){const i=await this.get(r);s(i),await i.add(t,e)&&(this.logger.info("Added transaction to wallet in WalletDB: %s (%d).",i.id,r),n=!0)}return n?(this.emit("hook balance"),i):null},n.prototype._unconfirm=async function(t){for(const e of t.wids){const i=await this.get(e);s(i),await i.unconfirm(t.hash)}},n.prototype.resetChain=async function(t){const e=await this.txLock.lock();try{return await this._resetChain(t)}finally{e()}},n.prototype._resetChain=async function(t){if(t.height>this.state.height)throw new Error("WDB: Bad reset height.");await this.rollback(t.height)||await this.scan()},r.prototype.fromOptions=function(t){return null!=t.network&&(this.network=g.get(t.network),this.keepBlocks=this.network.block.keepBlocks,this.port=this.network.rpcPort+2),null!=t.logger&&(s("object"==typeof t.logger),this.logger=t.logger),null!=t.workers&&(s("object"==typeof t.workers),this.workers=t.workers),null!=t.client&&(s("object"==typeof t.client),this.client=t.client),null!=t.feeRate&&(s(c.isU64(t.feeRate)),this.feeRate=t.feeRate),null!=t.prefix&&(s("string"==typeof t.prefix),this.prefix=t.prefix,this.location=o.join(this.prefix,"walletdb")),null!=t.location&&(s("string"==typeof t.location),this.location=t.location),null!=t.db&&(s("string"==typeof t.db),this.db=t.db),null!=t.maxFiles&&(s(c.isU32(t.maxFiles)),this.maxFiles=t.maxFiles),null!=t.cacheSize&&(s(c.isU64(t.cacheSize)),this.cacheSize=t.cacheSize),null!=t.compression&&(s("boolean"==typeof t.compression),this.compression=t.compression),null!=t.spv&&(s("boolean"==typeof t.spv),this.spv=t.spv),null!=t.witness&&(s("boolean"==typeof t.witness),this.witness=t.witness),null!=t.checkpoints&&(s("boolean"==typeof t.checkpoints),this.checkpoints=t.checkpoints),null!=t.startHeight&&(s("number"==typeof t.startHeight),s(t.startHeight>=0),this.startHeight=t.startHeight),null!=t.wipeNoReally&&(s("boolean"==typeof t.wipeNoReally),this.wipeNoReally=t.wipeNoReally),null!=t.apiKey&&(s("string"==typeof t.apiKey),this.apiKey=t.apiKey),null!=t.walletAuth&&(s("boolean"==typeof t.walletAuth),this.walletAuth=t.walletAuth),null!=t.noAuth&&(s("boolean"==typeof t.noAuth),this.noAuth=t.noAuth),null!=t.ssl&&(s("boolean"==typeof t.ssl),this.ssl=t.ssl),null!=t.host&&(s("string"==typeof t.host),this.host=t.host),null!=t.port&&(s("number"==typeof t.port),this.port=t.port),null!=t.listen&&(s("boolean"==typeof t.listen),this.listen=t.listen),this},r.fromOptions=function(t){return(new r).fromOptions(t)},t.exports=n},function(t,e,i){"use strict";function n(t){h(this instanceof n,"this","N64"),h(0===t||1===t,"sign","bit"),this.hi=0,this.lo=0,this.sign=t}function r(t,e){if(!(this instanceof r))return new r(t,e);n.call(this,0),this.from(t,e)}function s(t,e){if(!(this instanceof s))return new s(t,e);n.call(this,1),this.from(t,e)}function o(t){if(null==t)return 10;if("number"==typeof t)return t;switch(t){case"bin":return 2;case"oct":return 8;case"dec":return 10;case"hex":return 16}return 0}function a(t){if(Math.clz32)return 32-Math.clz32(t);let e=31;for(;e>=0&&0==(t&1<<e);e--);return e+1}function h(t,e,i){if(!t)throw new TypeError(`'${e}' must be a(n) ${i}.`)}function c(t){return"number"==typeof t&&isFinite(t)}function u(t){return Array.isArray?Array.isArray(t):"Array"==={}.toString.call(t).slice(8,-1)}function f(t,e){return t.allocUnsafe?t.allocUnsafe(e):new t(e)}function l(t,e){return t[e]|t[e+1]<<8|t[e+2]<<16|t[e+3]<<24}function p(t,e){return t[e]<<24|t[e+1]<<16|t[e+2]<<8|t[e+3]}function d(t,e,i){t[i]=255&e,t[i+1]=e>>>8&255,t[i+2]=e>>>16&255,t[i+3]=e>>>24&255}function m(t,e,i){t[i]=e>>>24&255,t[i+1]=e>>>16&255,t[i+2]=e>>>8&255,t[i+3]=255&e}n.prototype._add=function(t,e){const i=this.hi,n=this.lo,r=n+e|0,s=n>>31,o=e>>31,a=(i+t|0)+(1&(s&o|~(r>>31)&(s^o)));return this.hi=0|a,this.lo=r,this},n.prototype.iadd=function(t){return h(n.isN64(t),"operand","int64"),this._add(t.hi,t.lo)},n.prototype.iaddn=function(t){return h(c(t),"operand","number"),this._add(t>>31&-this.sign,0|t)},n.prototype.add=function(t){return this.clone().iadd(t)},n.prototype.addn=function(t){return this.clone().iaddn(t)},n.prototype._sub=function(t,e){return t=~t,-1===(e=~e)?(e=0,t+=1,t|=0):e+=1,this._add(t,e)},n.prototype.isub=function(t){return h(n.isN64(t),"operand","int64"),this._sub(t.hi,t.lo)},n.prototype.isubn=function(t){return h(c(t),"operand","number"),this._sub(t>>31&-this.sign,0|t)},n.prototype.sub=function(t){return this.clone().isub(t)},n.prototype.subn=function(t){return this.clone().isubn(t)},n.prototype._mul=function(t,e){const i=this.hi,n=this.lo,r=65535&i,s=n>>>16,o=65535&n,a=65535&t,h=e>>>16,c=65535&e;let u=0,f=0,l=0,p=0;l+=(p+=o*c)>>>16,f+=(l+=s*c)>>>16,l&=65535,f+=(l+=o*h)>>>16,u+=(f+=r*c)>>>16,f&=65535,u+=(f+=s*h)>>>16,f&=65535,u+=(f+=o*a)>>>16,u+=(i>>>16)*c+r*h+s*a+o*(t>>>16);const d=(u&=65535)<<16|(f&=65535),m=(l&=65535)<<16|(p&=65535);return this.hi=d,this.lo=m,this},n.prototype.imul=function(t){return h(n.isN64(t),"multiplicand","int64"),this._mul(t.hi,t.lo)},n.prototype.imuln=function(t){return h(c(t),"multiplicand","number"),this._mul(t>>31&-this.sign,0|t)},n.prototype.mul=function(t){return this.clone().imul(t)},n.prototype.muln=function(t){return this.clone().imuln(t)},n.prototype.idiv=function(t){let e=this;if(h(n.isN64(t),"divisor","int64"),t.isZero())throw new Error("Cannot divide by zero.");if(e.isZero())return e;if(e.eq(t))return e.set(1);if(e.isSafe()&&t.isSafe()){const i=function(t){return t<0?-Math.floor(-t):Math.floor(t)}(e.toDouble()/t.toDouble());return e.set(i)}let i=!1;e.sign&&(e.hi<0?t.hi<0?(e=e.ineg(),t=t.neg()):(e=e.ineg(),i=!0):t.hi<0&&(t=t.neg(),i=!0));const s=e.toU64(),o=t.toU64();if(s.lt(o))return e.set(0);if(s.ushrn(1).lt(o))return e.set(i?-1:1);const a=new r,c=new r;let u=s.bitLength();for(;u--;)c.ishln(1),c.lo|=s.testn(u),c.gte(o)&&(c.isub(o),a.setn(u,1));return e.hi=a.hi,e.lo=a.lo,i&&e.ineg(),e},n.prototype.idivn=function(t){return h(c(t),"divisor","number"),this.idiv(this._small(t))},n.prototype.div=function(t){return this.clone().idiv(t)},n.prototype.divn=function(t){return this.clone().idivn(t)},n.prototype.imod=function(t){if(h(n.isN64(t),"divisor","int64"),t.isZero())throw new Error("Cannot divide by zero.");if(this.isZero())return this;if(this.eq(t))return this.set(0);if(this.isSafe()&&t.isSafe()){const e=this.toDouble()%t.toDouble();return this.set(e)}return this.isub(this.div(t).imul(t))},n.prototype.imodn=function(t){return h(c(t),"divisor","number"),this.imod(this._small(t))},n.prototype.mod=function(t){return this.clone().imod(t)},n.prototype.modn=function(t){return this.clone().imodn(t)},n.prototype.ipow=function(t){return h(n.isN64(t),"exponent","int64"),this.ipown(t.lo)},n.prototype.ipown=function(t){if(h(c(t),"exponent","number"),this.isZero())return this;const e=this.clone();let i=t>>>0;for(this.set(1);i>0;)1&i&&this.imul(e),i>>>=1,e.imul(e);return this},n.prototype.pow=function(t){return this.clone().ipow(t)},n.prototype.pown=function(t){return this.clone().ipown(t)},n.prototype.sqr=function(){return this.mul(this)},n.prototype.isqr=function(){return this.imul(this)},n.prototype.iand=function(t){return h(n.isN64(t),"operand","int64"),this.hi&=t.hi,this.lo&=t.lo,this},n.prototype.iandn=function(t){return h(c(t),"operand","number"),this.hi&=t>>31&-this.sign,this.lo&=0|t,this},n.prototype.and=function(t){return this.clone().iand(t)},n.prototype.andn=function(t){return this.clone().iandn(t)},n.prototype.ior=function(t){return h(n.isN64(t),"operand","int64"),this.hi|=t.hi,this.lo|=t.lo,this},n.prototype.iorn=function(t){return h(c(t),"operand","number"),this.hi|=t>>31&-this.sign,this.lo|=0|t,this},n.prototype.or=function(t){return this.clone().ior(t)},n.prototype.orn=function(t){return this.clone().iorn(t)},n.prototype.ixor=function(t){return h(n.isN64(t),"operand","int64"),this.hi^=t.hi,this.lo^=t.lo,this},n.prototype.ixorn=function(t){return h(c(t),"operand","number"),this.hi^=t>>31&-this.sign,this.lo^=0|t,this},n.prototype.xor=function(t){return this.clone().ixor(t)},n.prototype.xorn=function(t){return this.clone().ixorn(t)},n.prototype.inot=function(){return this.hi=~this.hi,this.lo=~this.lo,this},n.prototype.not=function(){return this.clone().inot()},n.prototype.ishl=function(t){return h(n.isN64(t),"bits","int64"),this.ishln(t.lo)},n.prototype.ishln=function(t){if(h(c(t),"bits","number"),0===(t&=63))return this;let e=this.hi,i=this.lo;return t<32?(e<<=t,e|=i>>>32-t,i<<=t):(e=i<<t-32,i=0),this.hi=e,this.lo=i,this},n.prototype.shl=function(t){return this.clone().ishl(t)},n.prototype.shln=function(t){return this.clone().ishln(t)},n.prototype.ishr=function(t){return h(n.isN64(t),"bits","int64"),this.ishrn(t.lo)},n.prototype.ishrn=function(t){if(!this.sign)return this.iushrn(t);if(h(c(t),"bits","number"),0===(t&=63))return this;let e=this.hi,i=this.lo;return t<32?(i>>>=t,i|=e<<32-t,e>>=t):(i=e>>t-32,e>>=31),this.hi=e,this.lo=i,this},n.prototype.shr=function(t){return this.clone().ishr(t)},n.prototype.shrn=function(t){return this.clone().ishrn(t)},n.prototype.iushr=function(t){return h(n.isN64(t),"bits","int64"),this.iushrn(t.lo)},n.prototype.iushrn=function(t){if(h(c(t),"bits","number"),0===(t&=63))return this;let e=this.hi,i=this.lo;return t<32?(i>>>=t,i|=e<<32-t,e>>>=t):(i=e>>>t-32,e=0),this.hi=0|e,this.lo=0|i,this},n.prototype.ushr=function(t){return this.clone().iushr(t)},n.prototype.ushrn=function(t){return this.clone().iushrn(t)},n.prototype.setn=function(t,e){return h(c(t),"bit","number"),(t&=63)<32?e?this.lo|=1<<t:this.lo&=~(1<<t):e?this.hi|=1<<t-32:this.hi&=~(1<<t-32),this},n.prototype.testn=function(t){return h(c(t),"bit","number"),(t&=63)<32?this.lo>>>t&1:this.hi>>>t-32&1},n.prototype.setb=function(t,e){return h(c(t),"pos","number"),h(c(e),"ch","number"),t&=7,e&=255,t<4?(this.lo&=~(255<<8*t),this.lo|=e<<8*t):(this.hi&=~(255<<8*(t-4)),this.hi|=e<<8*(t-4)),this},n.prototype.orb=function(t,e){return h(c(t),"pos","number"),h(c(e),"ch","number"),t&=7,e&=255,t<4?this.lo|=e<<8*t:this.hi|=e<<8*(t-4),this},n.prototype.getb=function(t){return h(c(t),"pos","number"),(t&=7)<4?this.lo>>8*t&255:this.hi>>8*(t-4)&255},n.prototype.imaskn=function(t){return h(c(t),"bit","number"),(t&=63)<32?(this.hi=0,this.lo&=(1<<t)-1):(this.hi&=(1<<t-32)-1,this.lo&=4294967295),this},n.prototype.maskn=function(t){return this.clone().imaskn(t)},n.prototype.andln=function(t){return h(c(t),"operand","number"),this.lo&t},n.prototype.ineg=function(){let t=~this.hi,e=~this.lo;return-1===e?(e=0,t+=1,t|=0):e+=1,this.hi=t,this.lo=e,this},n.prototype.neg=function(){return this.clone().ineg()},n.prototype.iabs=function(){return this.isNeg()&&this.ineg(),this},n.prototype.abs=function(){return this.clone().iabs()},n.prototype._cmp=function(t,e){let i=this.hi,n=this.lo;if(i===t&&n===e)return 0;let r=!1;if(this.sign){const e=i<0,n=t<0;if(e&&!n)return-1;if(!e&&n)return 1;r=e}return r||(i>>>=0,t>>>=0),i<t?-1:i>t?1:(n>>>=0,e>>>=0,n<e?-1:1)},n.prototype.cmp=function(t){return h(n.isN64(t),"value","int64"),this._cmp(t.hi,t.lo)},n.prototype.cmpn=function(t){return h(c(t),"value","number"),this._cmp(t>>31&-this.sign,0|t)},n.prototype.eq=function(t){return h(n.isN64(t),"value","int64"),this.hi===t.hi&&this.lo===t.lo},n.prototype.eqn=function(t){return h(c(t),"value","number"),this.hi===(t>>31&-this.sign)&&this.lo===(0|t)},n.prototype.gt=function(t){return this.cmp(t)>0},n.prototype.gtn=function(t){return this.cmpn(t)>0},n.prototype.gte=function(t){return this.cmp(t)>=0},n.prototype.gten=function(t){return this.cmpn(t)>=0},n.prototype.lt=function(t){return this.cmp(t)<0},n.prototype.ltn=function(t){return this.cmpn(t)<0},n.prototype.lte=function(t){return this.cmp(t)<=0},n.prototype.lten=function(t){return this.cmpn(t)<=0},n.prototype.isZero=function(){return 0===this.hi&&0===this.lo},n.prototype.isNeg=function(){return 1===this.sign&&this.hi<0},n.prototype.isOdd=function(){return 1==(1&this.lo)},n.prototype.isEven=function(){return 0==(1&this.lo)},n.prototype.clone=function(){const t=new this.constructor;return t.hi=this.hi,t.lo=this.lo,t},n.prototype.inject=function(t){return h(n.isN64(t),"value","int64"),this.hi=t.hi,this.lo=t.lo,this},n.prototype.set=function(t){h(function(t){return Number.isSafeInteger?Number.isSafeInteger(t):c(t)&&Math.floor(t)===t&&t>=-9007199254740991&&t<=9007199254740991}(t),"number","integer");let e=!1;return t<0&&(t=-t,e=!0),this.hi=t*(1/4294967296)|0,this.lo=0|t,e&&this.ineg(),this},n.prototype.join=function(t,e){return h(c(t),"hi","number"),h(c(e),"lo","number"),this.hi=0|t,this.lo=0|e,this},n.prototype._small=function(t){const e=new this.constructor;return e.hi=t>>31&-this.sign,e.lo=0|t,e},n.prototype.bitLength=function(){let t=this;return this.isNeg()&&(t=this.neg()),0===t.hi?a(t.lo):a(t.hi)+32},n.prototype.byteLength=function(){return Math.ceil(this.bitLength()/8)},n.prototype.isSafe=function(){let t=this.hi;return this.isNeg()&&(t=~t,0===this.lo&&(t+=1)),0==(4292870144&t)},n.prototype.inspect=function(){let t="I64";return this.sign||(t="U64"),`<${t}: ${this.toString(10)}>`},n.prototype.readLE=function(t,e){return h(t&&"number"==typeof t.length,"data","arraylike"),h(e>>0===e,"offset","integer"),h(e+8<=t.length,"offset","valid offset"),this.lo=l(t,e),this.hi=l(t,e+4),e+8},n.prototype.readBE=function(t,e){return h(t&&"number"==typeof t.length,"data","arraylike"),h(e>>0===e,"offset","integer"),h(e+8<=t.length,"offset","valid offset"),this.hi=p(t,e),this.lo=p(t,e+4),e+8},n.prototype.readRaw=function(t,e){return this.readLE(t,e)},n.prototype.writeLE=function(t,e){return h(t&&"number"==typeof t.length,"data","arraylike"),h(e>>0===e,"offset","integer"),h(e+8<=t.length,"offset","valid offset"),d(t,this.lo,e),d(t,this.hi,e+4),e+8},n.prototype.writeBE=function(t,e){return h(t&&"number"==typeof t.length,"data","arraylike"),h(e>>0===e,"offset","integer"),h(e+8<=t.length,"offset","valid offset"),m(t,this.hi,e),m(t,this.lo,e+4),e+8},n.prototype.writeRaw=function(t,e){return this.writeLE(t,e)},n.prototype.toU64=function(){const t=new r;return t.hi=this.hi,t.lo=this.lo,t},n.prototype.toI64=function(){const t=new s;return t.hi=this.hi,t.lo=this.lo,t},n.prototype.toNumber=function(){if(!this.isSafe())throw new Error("Number exceeds 53 bits.");return this.toDouble()},n.prototype.toDouble=function(){let t=this.hi;return this.sign||(t>>>=0),4294967296*t+(this.lo>>>0)},n.prototype.toInt=function(){return this.sign?this.lo:this.lo>>>0},n.prototype.toBool=function(){return!this.isZero()},n.prototype.toBits=function(){return[this.hi,this.lo]},n.prototype.toObject=function(){return{hi:this.hi,lo:this.lo}},n.prototype.toString=function(t,e){if(t=o(t),null==e&&(e=0),h(t>>>0===t,"base","integer"),h(e>>>0===e,"pad","integer"),t<2||t>16)throw new Error("Base ranges between 2 and 16.");if(e>64)throw new Error("Maximum padding is 64 characters.");let i=this,n=!1;i.isNeg()&&(i=i.neg(),n=!0);let r=i.hi>>>0,s=i.lo>>>0,a="";do{const e=r%t;r-=e,r/=t;const i=(s+=4294967296*e)%t;s-=i,s/=t;let n=i;n+=n<10?48:87,a=String.fromCharCode(n)+a}while(s>0||r>0);for(;a.length<e;)a="0"+a;return n&&(a="-"+a),a},n.prototype.toJSON=function(){return this.toString(16,16)},n.prototype.toBN=function(t){const e=this.isNeg();let i=this.hi,n=this.lo;e&&(i=~i,-1===(n=~n)?(n=0,i+=1,i|=0):n+=1),n>>>=0;const r=new t(i>>>=0);return r.ishln(32),r.iadd(new t(n)),e&&r.ineg(),r},n.prototype.toLE=function(t){h("function"==typeof t,"ArrayLike","constructor");const e=f(t,8);return this.writeLE(e,0),e},n.prototype.toBE=function(t){h("function"==typeof t,"ArrayLike","constructor");const e=f(t,8);return this.writeBE(e,0),e},n.prototype.toRaw=function(t){return this.toLE(t)},n.prototype.fromNumber=function(t){return this.set(t)},n.prototype.fromInt=function(t){return h(c(t),"integer","number"),this.join(t>>31&-this.sign,t)},n.prototype.fromBool=function(t){return h("boolean"==typeof t,"value","boolean"),this.hi=0,this.lo=t?1:0,this},n.prototype.fromBits=function(t,e){return this.join(t,e)},n.prototype.fromObject=function(t){return h(t&&"object"==typeof t,"number","object"),this.fromBits(t.hi,t.lo)},n.prototype.fromString=function(t,e){if(e=o(e),h("string"==typeof t,"string","string"),h(e>>>0===e,"base","integer"),e<2||e>16)throw new Error("Base ranges between 2 and 16.");let i=!1,n=0;if(t.length>0&&"-"===t[0]&&(n+=1,i=!0),t.length===n||t.length>n+64)throw new Error("Invalid string (bad length).");let r=0,s=0;for(;n<t.length;n++){let i=t.charCodeAt(n);if(i>=48&&i<=57?i-=48:i>=65&&i<=90?i-=55:i>=97&&i<=122?i-=87:i=e,i>=e)throw new Error("Invalid string (parse error).");if(s*=e,s+=i,r*=e,s>4294967295&&(r+=(s-(i=s%4294967296))/4294967296,s=i),r>4294967295)throw new Error("Invalid string (overflow).")}return this.hi=0|r,this.lo=0|s,i&&this.ineg(),this},n.prototype.fromJSON=function(t){return this.fromString(t,16)},n.prototype.fromBN=function(t){h(t&&u(t.words),"number","big number");const e=t.clone(),i=e.isNeg();if(this.sign&&e.testn(63))throw new Error("Big number overflow.");let n=0;for(;!e.isZero();){if(8===n)throw new Error("Big number overflow.");this.orb(n,e.andln(255)),e.iushrn(8),n++}return i&&this.ineg(),this},n.prototype.fromLE=function(t){return this.readLE(t,0),this},n.prototype.fromBE=function(t){return this.readBE(t,0),this},n.prototype.fromRaw=function(t){return this.fromLE(t)},n.prototype.from=function(t,e){if(null==t)return this;if("number"==typeof t)return"number"==typeof e?this.fromBits(t,e):this.fromNumber(t);if("string"==typeof t)return this.fromString(t,e);if("object"==typeof t)return u(t.words)?this.fromBN(t):"number"==typeof t.length?this.fromRaw(t):this.fromObject(t);if("boolean"==typeof t)return this.fromBool(t);throw new TypeError("Non-numeric object passed to N64.")},n.min=function(t,e){return t.cmp(e)<0?t:e},n.max=function(t,e){return t.cmp(e)>0?t:e},n.random=function(){const t=new this;return t.hi=4294967296*Math.random()|0,t.lo=4294967296*Math.random()|0,t},n.pow=function(t,e){return(new this).fromInt(t).ipown(e)},n.shift=function(t,e){return(new this).fromInt(t).ishln(e)},n.readLE=function(t,e){const i=new this;return i.readLE(t,e),i},n.readBE=function(t,e){const i=new this;return i.readBE(t,e),i},n.readRaw=function(t,e){const i=new this;return i.readRaw(t,e),i},n.fromNumber=function(t){return(new this).fromNumber(t)},n.fromInt=function(t){return(new this).fromInt(t)},n.fromBool=function(t){return(new this).fromBool(t)},n.fromBits=function(t,e){return(new this).fromBits(t,e)},n.fromObject=function(t){return(new this).fromObject(t)},n.fromString=function(t,e){return(new this).fromString(t,e)},n.fromJSON=function(t){return(new this).fromJSON(t)},n.fromBN=function(t){return(new this).fromBN(t)},n.fromLE=function(t){return(new this).fromLE(t)},n.fromBE=function(t){return(new this).fromBE(t)},n.fromRaw=function(t){return(new this).fromRaw(t)},n.from=function(t,e){return(new this).from(t,e)},n.isN64=function(t){return t instanceof n},n.isU64=function(t){return t instanceof r},n.isI64=function(t){return t instanceof s},r.__proto__=n,r.prototype.__proto__=n.prototype,r.ULONG_MIN=0,r.ULONG_MAX=4294967295,r.UINT32_MIN=r(0,0),r.UINT32_MAX=r(0,4294967295),r.UINT64_MIN=r(0,0),r.UINT64_MAX=r(4294967295,4294967295),s.__proto__=n,s.prototype.__proto__=n.prototype,s.LONG_MIN=-2147483648,s.LONG_MAX=2147483647,s.INT32_MIN=s(4294967295,2147483648),s.INT32_MAX=s(0,2147483647),s.INT64_MIN=s(2147483648,0),s.INT64_MAX=s(2147483647,4294967295),e.N64=n,e.U64=r,e.I64=s},function(t,e){t.exports=require("wmcc-native")},function(t,e,i){(function(t){!function(t,e){"use strict";function n(t,e){if(!t)throw new Error(e||"Assertion failed")}function r(t,e){t.super_=e;var i=function(){};i.prototype=e.prototype,t.prototype=new i,t.prototype.constructor=t}function s(t,e,i){if(s.isBN(t))return t;this.negative=0,this.words=null,this.length=0,this.red=null,null!==t&&("le"!==e&&"be"!==e||(i=e,e=10),this._init(t||0,e||10,i||"be"))}function o(t,e,i){for(var n=0,r=Math.min(t.length,i),s=e;s<r;s++){var o=t.charCodeAt(s)-48;n<<=4,n|=o>=49&&o<=54?o-49+10:o>=17&&o<=22?o-17+10:15&o}return n}function a(t,e,i,n){for(var r=0,s=Math.min(t.length,i),o=e;o<s;o++){var a=t.charCodeAt(o)-48;r*=n,r+=a>=49?a-49+10:a>=17?a-17+10:a}return r}function h(t,e,i){i.negative=e.negative^t.negative;var n=t.length+e.length|0;i.length=n,n=n-1|0;var r=0|t.words[0],s=0|e.words[0],o=r*s,a=67108863&o,h=o/67108864|0;i.words[0]=a;for(var c=1;c<n;c++){for(var u=h>>>26,f=67108863&h,l=Math.min(c,e.length-1),p=Math.max(0,c-t.length+1);p<=l;p++){var d=c-p|0;u+=(o=(r=0|t.words[d])*(s=0|e.words[p])+f)/67108864|0,f=67108863&o}i.words[c]=0|f,h=0|u}return 0!==h?i.words[c]=0|h:i.length--,i.strip()}function c(t,e,i){return(new u).mulp(t,e,i)}function u(t,e){this.x=t,this.y=e}function f(t,e){this.name=t,this.p=new s(e,16),this.n=this.p.bitLength(),this.k=new s(1).iushln(this.n).isub(this.p),this.tmp=this._tmp()}function l(){f.call(this,"k256","ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe fffffc2f")}function p(){f.call(this,"p224","ffffffff ffffffff ffffffff ffffffff 00000000 00000000 00000001")}function d(){f.call(this,"p192","ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff")}function m(){f.call(this,"25519","7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed")}function g(t){if("string"==typeof t){var e=s._prime(t);this.m=e.p,this.prime=e}else n(t.gtn(1),"modulus must be greater than 1"),this.m=t,this.prime=null}function y(t){g.call(this,t),this.shift=this.m.bitLength(),this.shift%26!=0&&(this.shift+=26-this.shift%26),this.r=new s(1).iushln(this.shift),this.r2=this.imod(this.r.sqr()),this.rinv=this.r._invmp(this.m),this.minv=this.rinv.mul(this.r).isubn(1).div(this.m),this.minv=this.minv.umod(this.r),this.minv=this.r.sub(this.minv)}"object"==typeof t?t.exports=s:e.BN=s,s.BN=s,s.wordSize=26;var w;try{w=i(65).Buffer}catch(t){}s.isBN=function(t){return t instanceof s||null!==t&&"object"==typeof t&&t.constructor.wordSize===s.wordSize&&Array.isArray(t.words)},s.max=function(t,e){return t.cmp(e)>0?t:e},s.min=function(t,e){return t.cmp(e)<0?t:e},s.prototype._init=function(t,e,i){if("number"==typeof t)return this._initNumber(t,e,i);if("object"==typeof t)return this._initArray(t,e,i);"hex"===e&&(e=16),n(e===(0|e)&&e>=2&&e<=36);var r=0;"-"===(t=t.toString().replace(/\s+/g,""))[0]&&r++,16===e?this._parseHex(t,r):this._parseBase(t,e,r),"-"===t[0]&&(this.negative=1),this.strip(),"le"===i&&this._initArray(this.toArray(),e,i)},s.prototype._initNumber=function(t,e,i){t<0&&(this.negative=1,t=-t),t<67108864?(this.words=[67108863&t],this.length=1):t<4503599627370496?(this.words=[67108863&t,t/67108864&67108863],this.length=2):(n(t<9007199254740992),this.words=[67108863&t,t/67108864&67108863,1],this.length=3),"le"===i&&this._initArray(this.toArray(),e,i)},s.prototype._initArray=function(t,e,i){if(n("number"==typeof t.length),t.length<=0)return this.words=[0],this.length=1,this;this.length=Math.ceil(t.length/3),this.words=new Array(this.length);for(var r=0;r<this.length;r++)this.words[r]=0;var s,o,a=0;if("be"===i)for(r=t.length-1,s=0;r>=0;r-=3)o=t[r]|t[r-1]<<8|t[r-2]<<16,this.words[s]|=o<<a&67108863,this.words[s+1]=o>>>26-a&67108863,(a+=24)>=26&&(a-=26,s++);else if("le"===i)for(r=0,s=0;r<t.length;r+=3)o=t[r]|t[r+1]<<8|t[r+2]<<16,this.words[s]|=o<<a&67108863,this.words[s+1]=o>>>26-a&67108863,(a+=24)>=26&&(a-=26,s++);return this.strip()},s.prototype._parseHex=function(t,e){this.length=Math.ceil((t.length-e)/6),this.words=new Array(this.length);for(var i=0;i<this.length;i++)this.words[i]=0;var n,r,s=0;for(i=t.length-6,n=0;i>=e;i-=6)r=o(t,i,i+6),this.words[n]|=r<<s&67108863,this.words[n+1]|=r>>>26-s&4194303,(s+=24)>=26&&(s-=26,n++);i+6!==e&&(r=o(t,e,i+6),this.words[n]|=r<<s&67108863,this.words[n+1]|=r>>>26-s&4194303),this.strip()},s.prototype._parseBase=function(t,e,i){this.words=[0],this.length=1;for(var n=0,r=1;r<=67108863;r*=e)n++;n--,r=r/e|0;for(var s=t.length-i,o=s%n,h=Math.min(s,s-o)+i,c=0,u=i;u<h;u+=n)c=a(t,u,u+n,e),this.imuln(r),this.words[0]+c<67108864?this.words[0]+=c:this._iaddn(c);if(0!==o){var f=1;for(c=a(t,u,t.length,e),u=0;u<o;u++)f*=e;this.imuln(f),this.words[0]+c<67108864?this.words[0]+=c:this._iaddn(c)}},s.prototype.copy=function(t){t.words=new Array(this.length);for(var e=0;e<this.length;e++)t.words[e]=this.words[e];t.length=this.length,t.negative=this.negative,t.red=this.red},s.prototype.clone=function(){var t=new s(null);return this.copy(t),t},s.prototype._expand=function(t){for(;this.length<t;)this.words[this.length++]=0;return this},s.prototype.strip=function(){for(;this.length>1&&0===this.words[this.length-1];)this.length--;return this._normSign()},s.prototype._normSign=function(){return 1===this.length&&0===this.words[0]&&(this.negative=0),this},s.prototype.inspect=function(){return(this.red?"<BN-R: ":"<BN: ")+this.toString(16)+">"};var b=["","0","00","000","0000","00000","000000","0000000","00000000","000000000","0000000000","00000000000","000000000000","0000000000000","00000000000000","000000000000000","0000000000000000","00000000000000000","000000000000000000","0000000000000000000","00000000000000000000","000000000000000000000","0000000000000000000000","00000000000000000000000","000000000000000000000000","0000000000000000000000000"],v=[0,0,25,16,12,11,10,9,8,8,7,7,7,7,6,6,6,6,6,6,6,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5],k=[0,0,33554432,43046721,16777216,48828125,60466176,40353607,16777216,43046721,1e7,19487171,35831808,62748517,7529536,11390625,16777216,24137569,34012224,47045881,64e6,4084101,5153632,6436343,7962624,9765625,11881376,14348907,17210368,20511149,243e5,28629151,33554432,39135393,45435424,52521875,60466176];s.prototype.toString=function(t,e){t=t||10,e=0|e||1;var i;if(16===t||"hex"===t){i="";for(var r=0,s=0,o=0;o<this.length;o++){var a=this.words[o],h=(16777215&(a<<r|s)).toString(16);i=0!==(s=a>>>24-r&16777215)||o!==this.length-1?b[6-h.length]+h+i:h+i,(r+=2)>=26&&(r-=26,o--)}for(0!==s&&(i=s.toString(16)+i);i.length%e!=0;)i="0"+i;return 0!==this.negative&&(i="-"+i),i}if(t===(0|t)&&t>=2&&t<=36){var c=v[t],u=k[t];i="";var f=this.clone();for(f.negative=0;!f.isZero();){var l=f.modn(u).toString(t);i=(f=f.idivn(u)).isZero()?l+i:b[c-l.length]+l+i}for(this.isZero()&&(i="0"+i);i.length%e!=0;)i="0"+i;return 0!==this.negative&&(i="-"+i),i}n(!1,"Base should be between 2 and 36")},s.prototype.toNumber=function(){var t=this.words[0];return 2===this.length?t+=67108864*this.words[1]:3===this.length&&1===this.words[2]?t+=4503599627370496+67108864*this.words[1]:this.length>2&&n(!1,"Number can only safely store up to 53 bits"),0!==this.negative?-t:t},s.prototype.toJSON=function(){return this.toString(16)},s.prototype.toBuffer=function(t,e){return n(void 0!==w),this.toArrayLike(w,t,e)},s.prototype.toArray=function(t,e){return this.toArrayLike(Array,t,e)},s.prototype.toArrayLike=function(t,e,i){var r=this.byteLength(),s=i||Math.max(1,r);n(r<=s,"byte array longer than desired length"),n(s>0,"Requested array length <= 0"),this.strip();var o,a,h="le"===e,c=new t(s),u=this.clone();if(h){for(a=0;!u.isZero();a++)o=u.andln(255),u.iushrn(8),c[a]=o;for(;a<s;a++)c[a]=0}else{for(a=0;a<s-r;a++)c[a]=0;for(a=0;!u.isZero();a++)o=u.andln(255),u.iushrn(8),c[s-a-1]=o}return c},Math.clz32?s.prototype._countBits=function(t){return 32-Math.clz32(t)}:s.prototype._countBits=function(t){var e=t,i=0;return e>=4096&&(i+=13,e>>>=13),e>=64&&(i+=7,e>>>=7),e>=8&&(i+=4,e>>>=4),e>=2&&(i+=2,e>>>=2),i+e},s.prototype._zeroBits=function(t){if(0===t)return 26;var e=t,i=0;return 0==(8191&e)&&(i+=13,e>>>=13),0==(127&e)&&(i+=7,e>>>=7),0==(15&e)&&(i+=4,e>>>=4),0==(3&e)&&(i+=2,e>>>=2),0==(1&e)&&i++,i},s.prototype.bitLength=function(){var t=this.words[this.length-1],e=this._countBits(t);return 26*(this.length-1)+e},s.prototype.zeroBits=function(){if(this.isZero())return 0;for(var t=0,e=0;e<this.length;e++){var i=this._zeroBits(this.words[e]);if(t+=i,26!==i)break}return t},s.prototype.byteLength=function(){return Math.ceil(this.bitLength()/8)},s.prototype.toTwos=function(t){return 0!==this.negative?this.abs().inotn(t).iaddn(1):this.clone()},s.prototype.fromTwos=function(t){return this.testn(t-1)?this.notn(t).iaddn(1).ineg():this.clone()},s.prototype.isNeg=function(){return 0!==this.negative},s.prototype.neg=function(){return this.clone().ineg()},s.prototype.ineg=function(){return this.isZero()||(this.negative^=1),this},s.prototype.iuor=function(t){for(;this.length<t.length;)this.words[this.length++]=0;for(var e=0;e<t.length;e++)this.words[e]=this.words[e]|t.words[e];return this.strip()},s.prototype.ior=function(t){return n(0==(this.negative|t.negative)),this.iuor(t)},s.prototype.or=function(t){return this.length>t.length?this.clone().ior(t):t.clone().ior(this)},s.prototype.uor=function(t){return this.length>t.length?this.clone().iuor(t):t.clone().iuor(this)},s.prototype.iuand=function(t){var e;e=this.length>t.length?t:this;for(var i=0;i<e.length;i++)this.words[i]=this.words[i]&t.words[i];return this.length=e.length,this.strip()},s.prototype.iand=function(t){return n(0==(this.negative|t.negative)),this.iuand(t)},s.prototype.and=function(t){return this.length>t.length?this.clone().iand(t):t.clone().iand(this)},s.prototype.uand=function(t){return this.length>t.length?this.clone().iuand(t):t.clone().iuand(this)},s.prototype.iuxor=function(t){var e,i;this.length>t.length?(e=this,i=t):(e=t,i=this);for(var n=0;n<i.length;n++)this.words[n]=e.words[n]^i.words[n];if(this!==e)for(;n<e.length;n++)this.words[n]=e.words[n];return this.length=e.length,this.strip()},s.prototype.ixor=function(t){return n(0==(this.negative|t.negative)),this.iuxor(t)},s.prototype.xor=function(t){return this.length>t.length?this.clone().ixor(t):t.clone().ixor(this)},s.prototype.uxor=function(t){return this.length>t.length?this.clone().iuxor(t):t.clone().iuxor(this)},s.prototype.inotn=function(t){n("number"==typeof t&&t>=0);var e=0|Math.ceil(t/26),i=t%26;this._expand(e),i>0&&e--;for(var r=0;r<e;r++)this.words[r]=67108863&~this.words[r];return i>0&&(this.words[r]=~this.words[r]&67108863>>26-i),this.strip()},s.prototype.notn=function(t){return this.clone().inotn(t)},s.prototype.setn=function(t,e){n("number"==typeof t&&t>=0);var i=t/26|0,r=t%26;return this._expand(i+1),this.words[i]=e?this.words[i]|1<<r:this.words[i]&~(1<<r),this.strip()},s.prototype.iadd=function(t){var e;if(0!==this.negative&&0===t.negative)return this.negative=0,e=this.isub(t),this.negative^=1,this._normSign();if(0===this.negative&&0!==t.negative)return t.negative=0,e=this.isub(t),t.negative=1,e._normSign();var i,n;this.length>t.length?(i=this,n=t):(i=t,n=this);for(var r=0,s=0;s<n.length;s++)e=(0|i.words[s])+(0|n.words[s])+r,this.words[s]=67108863&e,r=e>>>26;for(;0!==r&&s<i.length;s++)e=(0|i.words[s])+r,this.words[s]=67108863&e,r=e>>>26;if(this.length=i.length,0!==r)this.words[this.length]=r,this.length++;else if(i!==this)for(;s<i.length;s++)this.words[s]=i.words[s];return this},s.prototype.add=function(t){var e;return 0!==t.negative&&0===this.negative?(t.negative=0,e=this.sub(t),t.negative^=1,e):0===t.negative&&0!==this.negative?(this.negative=0,e=t.sub(this),this.negative=1,e):this.length>t.length?this.clone().iadd(t):t.clone().iadd(this)},s.prototype.isub=function(t){if(0!==t.negative){t.negative=0;var e=this.iadd(t);return t.negative=1,e._normSign()}if(0!==this.negative)return this.negative=0,this.iadd(t),this.negative=1,this._normSign();var i=this.cmp(t);if(0===i)return this.negative=0,this.length=1,this.words[0]=0,this;var n,r;i>0?(n=this,r=t):(n=t,r=this);for(var s=0,o=0;o<r.length;o++)s=(e=(0|n.words[o])-(0|r.words[o])+s)>>26,this.words[o]=67108863&e;for(;0!==s&&o<n.length;o++)s=(e=(0|n.words[o])+s)>>26,this.words[o]=67108863&e;if(0===s&&o<n.length&&n!==this)for(;o<n.length;o++)this.words[o]=n.words[o];return this.length=Math.max(this.length,o),n!==this&&(this.negative=1),this.strip()},s.prototype.sub=function(t){return this.clone().isub(t)};var S=function(t,e,i){var n,r,s,o=t.words,a=e.words,h=i.words,c=0,u=0|o[0],f=8191&u,l=u>>>13,p=0|o[1],d=8191&p,m=p>>>13,g=0|o[2],y=8191&g,w=g>>>13,b=0|o[3],v=8191&b,k=b>>>13,S=0|o[4],E=8191&S,R=S>>>13,x=0|o[5],_=8191&x,I=x>>>13,A=0|o[6],O=8191&A,B=A>>>13,P=0|o[7],M=8191&P,N=P>>>13,T=0|o[8],C=8191&T,U=T>>>13,H=0|o[9],L=8191&H,z=H>>>13,D=0|a[0],F=8191&D,V=D>>>13,K=0|a[1],j=8191&K,q=K>>>13,W=0|a[2],X=8191&W,Y=W>>>13,G=0|a[3],J=8191&G,$=G>>>13,Z=0|a[4],Q=8191&Z,tt=Z>>>13,et=0|a[5],it=8191&et,nt=et>>>13,rt=0|a[6],st=8191&rt,ot=rt>>>13,at=0|a[7],ht=8191&at,ct=at>>>13,ut=0|a[8],ft=8191&ut,lt=ut>>>13,pt=0|a[9],dt=8191&pt,mt=pt>>>13;i.negative=t.negative^e.negative,i.length=19;var gt=(c+(n=Math.imul(f,F))|0)+((8191&(r=(r=Math.imul(f,V))+Math.imul(l,F)|0))<<13)|0;c=((s=Math.imul(l,V))+(r>>>13)|0)+(gt>>>26)|0,gt&=67108863,n=Math.imul(d,F),r=(r=Math.imul(d,V))+Math.imul(m,F)|0,s=Math.imul(m,V);var yt=(c+(n=n+Math.imul(f,j)|0)|0)+((8191&(r=(r=r+Math.imul(f,q)|0)+Math.imul(l,j)|0))<<13)|0;c=((s=s+Math.imul(l,q)|0)+(r>>>13)|0)+(yt>>>26)|0,yt&=67108863,n=Math.imul(y,F),r=(r=Math.imul(y,V))+Math.imul(w,F)|0,s=Math.imul(w,V),n=n+Math.imul(d,j)|0,r=(r=r+Math.imul(d,q)|0)+Math.imul(m,j)|0,s=s+Math.imul(m,q)|0;var wt=(c+(n=n+Math.imul(f,X)|0)|0)+((8191&(r=(r=r+Math.imul(f,Y)|0)+Math.imul(l,X)|0))<<13)|0;c=((s=s+Math.imul(l,Y)|0)+(r>>>13)|0)+(wt>>>26)|0,wt&=67108863,n=Math.imul(v,F),r=(r=Math.imul(v,V))+Math.imul(k,F)|0,s=Math.imul(k,V),n=n+Math.imul(y,j)|0,r=(r=r+Math.imul(y,q)|0)+Math.imul(w,j)|0,s=s+Math.imul(w,q)|0,n=n+Math.imul(d,X)|0,r=(r=r+Math.imul(d,Y)|0)+Math.imul(m,X)|0,s=s+Math.imul(m,Y)|0;var bt=(c+(n=n+Math.imul(f,J)|0)|0)+((8191&(r=(r=r+Math.imul(f,$)|0)+Math.imul(l,J)|0))<<13)|0;c=((s=s+Math.imul(l,$)|0)+(r>>>13)|0)+(bt>>>26)|0,bt&=67108863,n=Math.imul(E,F),r=(r=Math.imul(E,V))+Math.imul(R,F)|0,s=Math.imul(R,V),n=n+Math.imul(v,j)|0,r=(r=r+Math.imul(v,q)|0)+Math.imul(k,j)|0,s=s+Math.imul(k,q)|0,n=n+Math.imul(y,X)|0,r=(r=r+Math.imul(y,Y)|0)+Math.imul(w,X)|0,s=s+Math.imul(w,Y)|0,n=n+Math.imul(d,J)|0,r=(r=r+Math.imul(d,$)|0)+Math.imul(m,J)|0,s=s+Math.imul(m,$)|0;var vt=(c+(n=n+Math.imul(f,Q)|0)|0)+((8191&(r=(r=r+Math.imul(f,tt)|0)+Math.imul(l,Q)|0))<<13)|0;c=((s=s+Math.imul(l,tt)|0)+(r>>>13)|0)+(vt>>>26)|0,vt&=67108863,n=Math.imul(_,F),r=(r=Math.imul(_,V))+Math.imul(I,F)|0,s=Math.imul(I,V),n=n+Math.imul(E,j)|0,r=(r=r+Math.imul(E,q)|0)+Math.imul(R,j)|0,s=s+Math.imul(R,q)|0,n=n+Math.imul(v,X)|0,r=(r=r+Math.imul(v,Y)|0)+Math.imul(k,X)|0,s=s+Math.imul(k,Y)|0,n=n+Math.imul(y,J)|0,r=(r=r+Math.imul(y,$)|0)+Math.imul(w,J)|0,s=s+Math.imul(w,$)|0,n=n+Math.imul(d,Q)|0,r=(r=r+Math.imul(d,tt)|0)+Math.imul(m,Q)|0,s=s+Math.imul(m,tt)|0;var kt=(c+(n=n+Math.imul(f,it)|0)|0)+((8191&(r=(r=r+Math.imul(f,nt)|0)+Math.imul(l,it)|0))<<13)|0;c=((s=s+Math.imul(l,nt)|0)+(r>>>13)|0)+(kt>>>26)|0,kt&=67108863,n=Math.imul(O,F),r=(r=Math.imul(O,V))+Math.imul(B,F)|0,s=Math.imul(B,V),n=n+Math.imul(_,j)|0,r=(r=r+Math.imul(_,q)|0)+Math.imul(I,j)|0,s=s+Math.imul(I,q)|0,n=n+Math.imul(E,X)|0,r=(r=r+Math.imul(E,Y)|0)+Math.imul(R,X)|0,s=s+Math.imul(R,Y)|0,n=n+Math.imul(v,J)|0,r=(r=r+Math.imul(v,$)|0)+Math.imul(k,J)|0,s=s+Math.imul(k,$)|0,n=n+Math.imul(y,Q)|0,r=(r=r+Math.imul(y,tt)|0)+Math.imul(w,Q)|0,s=s+Math.imul(w,tt)|0,n=n+Math.imul(d,it)|0,r=(r=r+Math.imul(d,nt)|0)+Math.imul(m,it)|0,s=s+Math.imul(m,nt)|0;var St=(c+(n=n+Math.imul(f,st)|0)|0)+((8191&(r=(r=r+Math.imul(f,ot)|0)+Math.imul(l,st)|0))<<13)|0;c=((s=s+Math.imul(l,ot)|0)+(r>>>13)|0)+(St>>>26)|0,St&=67108863,n=Math.imul(M,F),r=(r=Math.imul(M,V))+Math.imul(N,F)|0,s=Math.imul(N,V),n=n+Math.imul(O,j)|0,r=(r=r+Math.imul(O,q)|0)+Math.imul(B,j)|0,s=s+Math.imul(B,q)|0,n=n+Math.imul(_,X)|0,r=(r=r+Math.imul(_,Y)|0)+Math.imul(I,X)|0,s=s+Math.imul(I,Y)|0,n=n+Math.imul(E,J)|0,r=(r=r+Math.imul(E,$)|0)+Math.imul(R,J)|0,s=s+Math.imul(R,$)|0,n=n+Math.imul(v,Q)|0,r=(r=r+Math.imul(v,tt)|0)+Math.imul(k,Q)|0,s=s+Math.imul(k,tt)|0,n=n+Math.imul(y,it)|0,r=(r=r+Math.imul(y,nt)|0)+Math.imul(w,it)|0,s=s+Math.imul(w,nt)|0,n=n+Math.imul(d,st)|0,r=(r=r+Math.imul(d,ot)|0)+Math.imul(m,st)|0,s=s+Math.imul(m,ot)|0;var Et=(c+(n=n+Math.imul(f,ht)|0)|0)+((8191&(r=(r=r+Math.imul(f,ct)|0)+Math.imul(l,ht)|0))<<13)|0;c=((s=s+Math.imul(l,ct)|0)+(r>>>13)|0)+(Et>>>26)|0,Et&=67108863,n=Math.imul(C,F),r=(r=Math.imul(C,V))+Math.imul(U,F)|0,s=Math.imul(U,V),n=n+Math.imul(M,j)|0,r=(r=r+Math.imul(M,q)|0)+Math.imul(N,j)|0,s=s+Math.imul(N,q)|0,n=n+Math.imul(O,X)|0,r=(r=r+Math.imul(O,Y)|0)+Math.imul(B,X)|0,s=s+Math.imul(B,Y)|0,n=n+Math.imul(_,J)|0,r=(r=r+Math.imul(_,$)|0)+Math.imul(I,J)|0,s=s+Math.imul(I,$)|0,n=n+Math.imul(E,Q)|0,r=(r=r+Math.imul(E,tt)|0)+Math.imul(R,Q)|0,s=s+Math.imul(R,tt)|0,n=n+Math.imul(v,it)|0,r=(r=r+Math.imul(v,nt)|0)+Math.imul(k,it)|0,s=s+Math.imul(k,nt)|0,n=n+Math.imul(y,st)|0,r=(r=r+Math.imul(y,ot)|0)+Math.imul(w,st)|0,s=s+Math.imul(w,ot)|0,n=n+Math.imul(d,ht)|0,r=(r=r+Math.imul(d,ct)|0)+Math.imul(m,ht)|0,s=s+Math.imul(m,ct)|0;var Rt=(c+(n=n+Math.imul(f,ft)|0)|0)+((8191&(r=(r=r+Math.imul(f,lt)|0)+Math.imul(l,ft)|0))<<13)|0;c=((s=s+Math.imul(l,lt)|0)+(r>>>13)|0)+(Rt>>>26)|0,Rt&=67108863,n=Math.imul(L,F),r=(r=Math.imul(L,V))+Math.imul(z,F)|0,s=Math.imul(z,V),n=n+Math.imul(C,j)|0,r=(r=r+Math.imul(C,q)|0)+Math.imul(U,j)|0,s=s+Math.imul(U,q)|0,n=n+Math.imul(M,X)|0,r=(r=r+Math.imul(M,Y)|0)+Math.imul(N,X)|0,s=s+Math.imul(N,Y)|0,n=n+Math.imul(O,J)|0,r=(r=r+Math.imul(O,$)|0)+Math.imul(B,J)|0,s=s+Math.imul(B,$)|0,n=n+Math.imul(_,Q)|0,r=(r=r+Math.imul(_,tt)|0)+Math.imul(I,Q)|0,s=s+Math.imul(I,tt)|0,n=n+Math.imul(E,it)|0,r=(r=r+Math.imul(E,nt)|0)+Math.imul(R,it)|0,s=s+Math.imul(R,nt)|0,n=n+Math.imul(v,st)|0,r=(r=r+Math.imul(v,ot)|0)+Math.imul(k,st)|0,s=s+Math.imul(k,ot)|0,n=n+Math.imul(y,ht)|0,r=(r=r+Math.imul(y,ct)|0)+Math.imul(w,ht)|0,s=s+Math.imul(w,ct)|0,n=n+Math.imul(d,ft)|0,r=(r=r+Math.imul(d,lt)|0)+Math.imul(m,ft)|0,s=s+Math.imul(m,lt)|0;var xt=(c+(n=n+Math.imul(f,dt)|0)|0)+((8191&(r=(r=r+Math.imul(f,mt)|0)+Math.imul(l,dt)|0))<<13)|0;c=((s=s+Math.imul(l,mt)|0)+(r>>>13)|0)+(xt>>>26)|0,xt&=67108863,n=Math.imul(L,j),r=(r=Math.imul(L,q))+Math.imul(z,j)|0,s=Math.imul(z,q),n=n+Math.imul(C,X)|0,r=(r=r+Math.imul(C,Y)|0)+Math.imul(U,X)|0,s=s+Math.imul(U,Y)|0,n=n+Math.imul(M,J)|0,r=(r=r+Math.imul(M,$)|0)+Math.imul(N,J)|0,s=s+Math.imul(N,$)|0,n=n+Math.imul(O,Q)|0,r=(r=r+Math.imul(O,tt)|0)+Math.imul(B,Q)|0,s=s+Math.imul(B,tt)|0,n=n+Math.imul(_,it)|0,r=(r=r+Math.imul(_,nt)|0)+Math.imul(I,it)|0,s=s+Math.imul(I,nt)|0,n=n+Math.imul(E,st)|0,r=(r=r+Math.imul(E,ot)|0)+Math.imul(R,st)|0,s=s+Math.imul(R,ot)|0,n=n+Math.imul(v,ht)|0,r=(r=r+Math.imul(v,ct)|0)+Math.imul(k,ht)|0,s=s+Math.imul(k,ct)|0,n=n+Math.imul(y,ft)|0,r=(r=r+Math.imul(y,lt)|0)+Math.imul(w,ft)|0,s=s+Math.imul(w,lt)|0;var _t=(c+(n=n+Math.imul(d,dt)|0)|0)+((8191&(r=(r=r+Math.imul(d,mt)|0)+Math.imul(m,dt)|0))<<13)|0;c=((s=s+Math.imul(m,mt)|0)+(r>>>13)|0)+(_t>>>26)|0,_t&=67108863,n=Math.imul(L,X),r=(r=Math.imul(L,Y))+Math.imul(z,X)|0,s=Math.imul(z,Y),n=n+Math.imul(C,J)|0,r=(r=r+Math.imul(C,$)|0)+Math.imul(U,J)|0,s=s+Math.imul(U,$)|0,n=n+Math.imul(M,Q)|0,r=(r=r+Math.imul(M,tt)|0)+Math.imul(N,Q)|0,s=s+Math.imul(N,tt)|0,n=n+Math.imul(O,it)|0,r=(r=r+Math.imul(O,nt)|0)+Math.imul(B,it)|0,s=s+Math.imul(B,nt)|0,n=n+Math.imul(_,st)|0,r=(r=r+Math.imul(_,ot)|0)+Math.imul(I,st)|0,s=s+Math.imul(I,ot)|0,n=n+Math.imul(E,ht)|0,r=(r=r+Math.imul(E,ct)|0)+Math.imul(R,ht)|0,s=s+Math.imul(R,ct)|0,n=n+Math.imul(v,ft)|0,r=(r=r+Math.imul(v,lt)|0)+Math.imul(k,ft)|0,s=s+Math.imul(k,lt)|0;var It=(c+(n=n+Math.imul(y,dt)|0)|0)+((8191&(r=(r=r+Math.imul(y,mt)|0)+Math.imul(w,dt)|0))<<13)|0;c=((s=s+Math.imul(w,mt)|0)+(r>>>13)|0)+(It>>>26)|0,It&=67108863,n=Math.imul(L,J),r=(r=Math.imul(L,$))+Math.imul(z,J)|0,s=Math.imul(z,$),n=n+Math.imul(C,Q)|0,r=(r=r+Math.imul(C,tt)|0)+Math.imul(U,Q)|0,s=s+Math.imul(U,tt)|0,n=n+Math.imul(M,it)|0,r=(r=r+Math.imul(M,nt)|0)+Math.imul(N,it)|0,s=s+Math.imul(N,nt)|0,n=n+Math.imul(O,st)|0,r=(r=r+Math.imul(O,ot)|0)+Math.imul(B,st)|0,s=s+Math.imul(B,ot)|0,n=n+Math.imul(_,ht)|0,r=(r=r+Math.imul(_,ct)|0)+Math.imul(I,ht)|0,s=s+Math.imul(I,ct)|0,n=n+Math.imul(E,ft)|0,r=(r=r+Math.imul(E,lt)|0)+Math.imul(R,ft)|0,s=s+Math.imul(R,lt)|0;var At=(c+(n=n+Math.imul(v,dt)|0)|0)+((8191&(r=(r=r+Math.imul(v,mt)|0)+Math.imul(k,dt)|0))<<13)|0;c=((s=s+Math.imul(k,mt)|0)+(r>>>13)|0)+(At>>>26)|0,At&=67108863,n=Math.imul(L,Q),r=(r=Math.imul(L,tt))+Math.imul(z,Q)|0,s=Math.imul(z,tt),n=n+Math.imul(C,it)|0,r=(r=r+Math.imul(C,nt)|0)+Math.imul(U,it)|0,s=s+Math.imul(U,nt)|0,n=n+Math.imul(M,st)|0,r=(r=r+Math.imul(M,ot)|0)+Math.imul(N,st)|0,s=s+Math.imul(N,ot)|0,n=n+Math.imul(O,ht)|0,r=(r=r+Math.imul(O,ct)|0)+Math.imul(B,ht)|0,s=s+Math.imul(B,ct)|0,n=n+Math.imul(_,ft)|0,r=(r=r+Math.imul(_,lt)|0)+Math.imul(I,ft)|0,s=s+Math.imul(I,lt)|0;var Ot=(c+(n=n+Math.imul(E,dt)|0)|0)+((8191&(r=(r=r+Math.imul(E,mt)|0)+Math.imul(R,dt)|0))<<13)|0;c=((s=s+Math.imul(R,mt)|0)+(r>>>13)|0)+(Ot>>>26)|0,Ot&=67108863,n=Math.imul(L,it),r=(r=Math.imul(L,nt))+Math.imul(z,it)|0,s=Math.imul(z,nt),n=n+Math.imul(C,st)|0,r=(r=r+Math.imul(C,ot)|0)+Math.imul(U,st)|0,s=s+Math.imul(U,ot)|0,n=n+Math.imul(M,ht)|0,r=(r=r+Math.imul(M,ct)|0)+Math.imul(N,ht)|0,s=s+Math.imul(N,ct)|0,n=n+Math.imul(O,ft)|0,r=(r=r+Math.imul(O,lt)|0)+Math.imul(B,ft)|0,s=s+Math.imul(B,lt)|0;var Bt=(c+(n=n+Math.imul(_,dt)|0)|0)+((8191&(r=(r=r+Math.imul(_,mt)|0)+Math.imul(I,dt)|0))<<13)|0;c=((s=s+Math.imul(I,mt)|0)+(r>>>13)|0)+(Bt>>>26)|0,Bt&=67108863,n=Math.imul(L,st),r=(r=Math.imul(L,ot))+Math.imul(z,st)|0,s=Math.imul(z,ot),n=n+Math.imul(C,ht)|0,r=(r=r+Math.imul(C,ct)|0)+Math.imul(U,ht)|0,s=s+Math.imul(U,ct)|0,n=n+Math.imul(M,ft)|0,r=(r=r+Math.imul(M,lt)|0)+Math.imul(N,ft)|0,s=s+Math.imul(N,lt)|0;var Pt=(c+(n=n+Math.imul(O,dt)|0)|0)+((8191&(r=(r=r+Math.imul(O,mt)|0)+Math.imul(B,dt)|0))<<13)|0;c=((s=s+Math.imul(B,mt)|0)+(r>>>13)|0)+(Pt>>>26)|0,Pt&=67108863,n=Math.imul(L,ht),r=(r=Math.imul(L,ct))+Math.imul(z,ht)|0,s=Math.imul(z,ct),n=n+Math.imul(C,ft)|0,r=(r=r+Math.imul(C,lt)|0)+Math.imul(U,ft)|0,s=s+Math.imul(U,lt)|0;var Mt=(c+(n=n+Math.imul(M,dt)|0)|0)+((8191&(r=(r=r+Math.imul(M,mt)|0)+Math.imul(N,dt)|0))<<13)|0;c=((s=s+Math.imul(N,mt)|0)+(r>>>13)|0)+(Mt>>>26)|0,Mt&=67108863,n=Math.imul(L,ft),r=(r=Math.imul(L,lt))+Math.imul(z,ft)|0,s=Math.imul(z,lt);var Nt=(c+(n=n+Math.imul(C,dt)|0)|0)+((8191&(r=(r=r+Math.imul(C,mt)|0)+Math.imul(U,dt)|0))<<13)|0;c=((s=s+Math.imul(U,mt)|0)+(r>>>13)|0)+(Nt>>>26)|0,Nt&=67108863;var Tt=(c+(n=Math.imul(L,dt))|0)+((8191&(r=(r=Math.imul(L,mt))+Math.imul(z,dt)|0))<<13)|0;return c=((s=Math.imul(z,mt))+(r>>>13)|0)+(Tt>>>26)|0,Tt&=67108863,h[0]=gt,h[1]=yt,h[2]=wt,h[3]=bt,h[4]=vt,h[5]=kt,h[6]=St,h[7]=Et,h[8]=Rt,h[9]=xt,h[10]=_t,h[11]=It,h[12]=At,h[13]=Ot,h[14]=Bt,h[15]=Pt,h[16]=Mt,h[17]=Nt,h[18]=Tt,0!==c&&(h[19]=c,i.length++),i};Math.imul||(S=h),s.prototype.mulTo=function(t,e){var i=this.length+t.length;return 10===this.length&&10===t.length?S(this,t,e):i<63?h(this,t,e):i<1024?function(t,e,i){i.negative=e.negative^t.negative,i.length=t.length+e.length;for(var n=0,r=0,s=0;s<i.length-1;s++){var o=r;r=0;for(var a=67108863&n,h=Math.min(s,e.length-1),c=Math.max(0,s-t.length+1);c<=h;c++){var u=s-c,f=(0|t.words[u])*(0|e.words[c]),l=67108863&f;a=67108863&(l=l+a|0),r+=(o=(o=o+(f/67108864|0)|0)+(l>>>26)|0)>>>26,o&=67108863}i.words[s]=a,n=o,o=r}return 0!==n?i.words[s]=n:i.length--,i.strip()}(this,t,e):c(this,t,e)},u.prototype.makeRBT=function(t){for(var e=new Array(t),i=s.prototype._countBits(t)-1,n=0;n<t;n++)e[n]=this.revBin(n,i,t);return e},u.prototype.revBin=function(t,e,i){if(0===t||t===i-1)return t;for(var n=0,r=0;r<e;r++)n|=(1&t)<<e-r-1,t>>=1;return n},u.prototype.permute=function(t,e,i,n,r,s){for(var o=0;o<s;o++)n[o]=e[t[o]],r[o]=i[t[o]]},u.prototype.transform=function(t,e,i,n,r,s){this.permute(s,t,e,i,n,r);for(var o=1;o<r;o<<=1)for(var a=o<<1,h=Math.cos(2*Math.PI/a),c=Math.sin(2*Math.PI/a),u=0;u<r;u+=a)for(var f=h,l=c,p=0;p<o;p++){var d=i[u+p],m=n[u+p],g=i[u+p+o],y=n[u+p+o],w=f*g-l*y;y=f*y+l*g,g=w,i[u+p]=d+g,n[u+p]=m+y,i[u+p+o]=d-g,n[u+p+o]=m-y,p!==a&&(w=h*f-c*l,l=h*l+c*f,f=w)}},u.prototype.guessLen13b=function(t,e){var i=1|Math.max(e,t),n=1&i,r=0;for(i=i/2|0;i;i>>>=1)r++;return 1<<r+1+n},u.prototype.conjugate=function(t,e,i){if(!(i<=1))for(var n=0;n<i/2;n++){var r=t[n];t[n]=t[i-n-1],t[i-n-1]=r,r=e[n],e[n]=-e[i-n-1],e[i-n-1]=-r}},u.prototype.normalize13b=function(t,e){for(var i=0,n=0;n<e/2;n++){var r=8192*Math.round(t[2*n+1]/e)+Math.round(t[2*n]/e)+i;t[n]=67108863&r,i=r<67108864?0:r/67108864|0}return t},u.prototype.convert13b=function(t,e,i,r){for(var s=0,o=0;o<e;o++)s+=0|t[o],i[2*o]=8191&s,s>>>=13,i[2*o+1]=8191&s,s>>>=13;for(o=2*e;o<r;++o)i[o]=0;n(0===s),n(0==(-8192&s))},u.prototype.stub=function(t){for(var e=new Array(t),i=0;i<t;i++)e[i]=0;return e},u.prototype.mulp=function(t,e,i){var n=2*this.guessLen13b(t.length,e.length),r=this.makeRBT(n),s=this.stub(n),o=new Array(n),a=new Array(n),h=new Array(n),c=new Array(n),u=new Array(n),f=new Array(n),l=i.words;l.length=n,this.convert13b(t.words,t.length,o,n),this.convert13b(e.words,e.length,c,n),this.transform(o,s,a,h,n,r),this.transform(c,s,u,f,n,r);for(var p=0;p<n;p++){var d=a[p]*u[p]-h[p]*f[p];h[p]=a[p]*f[p]+h[p]*u[p],a[p]=d}return this.conjugate(a,h,n),this.transform(a,h,l,s,n,r),this.conjugate(l,s,n),this.normalize13b(l,n),i.negative=t.negative^e.negative,i.length=t.length+e.length,i.strip()},s.prototype.mul=function(t){var e=new s(null);return e.words=new Array(this.length+t.length),this.mulTo(t,e)},s.prototype.mulf=function(t){var e=new s(null);return e.words=new Array(this.length+t.length),c(this,t,e)},s.prototype.imul=function(t){return this.clone().mulTo(t,this)},s.prototype.imuln=function(t){n("number"==typeof t),n(t<67108864);for(var e=0,i=0;i<this.length;i++){var r=(0|this.words[i])*t,s=(67108863&r)+(67108863&e);e>>=26,e+=r/67108864|0,e+=s>>>26,this.words[i]=67108863&s}return 0!==e&&(this.words[i]=e,this.length++),this},s.prototype.muln=function(t){return this.clone().imuln(t)},s.prototype.sqr=function(){return this.mul(this)},s.prototype.isqr=function(){return this.imul(this.clone())},s.prototype.pow=function(t){var e=function(t){for(var e=new Array(t.bitLength()),i=0;i<e.length;i++){var n=i/26|0,r=i%26;e[i]=(t.words[n]&1<<r)>>>r}return e}(t);if(0===e.length)return new s(1);for(var i=this,n=0;n<e.length&&0===e[n];n++,i=i.sqr());if(++n<e.length)for(var r=i.sqr();n<e.length;n++,r=r.sqr())0!==e[n]&&(i=i.mul(r));return i},s.prototype.iushln=function(t){n("number"==typeof t&&t>=0);var e,i=t%26,r=(t-i)/26,s=67108863>>>26-i<<26-i;if(0!==i){var o=0;for(e=0;e<this.length;e++){var a=this.words[e]&s,h=(0|this.words[e])-a<<i;this.words[e]=h|o,o=a>>>26-i}o&&(this.words[e]=o,this.length++)}if(0!==r){for(e=this.length-1;e>=0;e--)this.words[e+r]=this.words[e];for(e=0;e<r;e++)this.words[e]=0;this.length+=r}return this.strip()},s.prototype.ishln=function(t){return n(0===this.negative),this.iushln(t)},s.prototype.iushrn=function(t,e,i){n("number"==typeof t&&t>=0);var r;r=e?(e-e%26)/26:0;var s=t%26,o=Math.min((t-s)/26,this.length),a=67108863^67108863>>>s<<s,h=i;if(r-=o,r=Math.max(0,r),h){for(var c=0;c<o;c++)h.words[c]=this.words[c];h.length=o}if(0===o);else if(this.length>o)for(this.length-=o,c=0;c<this.length;c++)this.words[c]=this.words[c+o];else this.words[0]=0,this.length=1;var u=0;for(c=this.length-1;c>=0&&(0!==u||c>=r);c--){var f=0|this.words[c];this.words[c]=u<<26-s|f>>>s,u=f&a}return h&&0!==u&&(h.words[h.length++]=u),0===this.length&&(this.words[0]=0,this.length=1),this.strip()},s.prototype.ishrn=function(t,e,i){return n(0===this.negative),this.iushrn(t,e,i)},s.prototype.shln=function(t){return this.clone().ishln(t)},s.prototype.ushln=function(t){return this.clone().iushln(t)},s.prototype.shrn=function(t){return this.clone().ishrn(t)},s.prototype.ushrn=function(t){return this.clone().iushrn(t)},s.prototype.testn=function(t){n("number"==typeof t&&t>=0);var e=t%26,i=(t-e)/26,r=1<<e;if(this.length<=i)return!1;return!!(this.words[i]&r)},s.prototype.imaskn=function(t){n("number"==typeof t&&t>=0);var e=t%26,i=(t-e)/26;if(n(0===this.negative,"imaskn works only with positive numbers"),this.length<=i)return this;if(0!==e&&i++,this.length=Math.min(i,this.length),0!==e){var r=67108863^67108863>>>e<<e;this.words[this.length-1]&=r}return this.strip()},s.prototype.maskn=function(t){return this.clone().imaskn(t)},s.prototype.iaddn=function(t){return n("number"==typeof t),n(t<67108864),t<0?this.isubn(-t):0!==this.negative?1===this.length&&(0|this.words[0])<t?(this.words[0]=t-(0|this.words[0]),this.negative=0,this):(this.negative=0,this.isubn(t),this.negative=1,this):this._iaddn(t)},s.prototype._iaddn=function(t){this.words[0]+=t;for(var e=0;e<this.length&&this.words[e]>=67108864;e++)this.words[e]-=67108864,e===this.length-1?this.words[e+1]=1:this.words[e+1]++;return this.length=Math.max(this.length,e+1),this},s.prototype.isubn=function(t){if(n("number"==typeof t),n(t<67108864),t<0)return this.iaddn(-t);if(0!==this.negative)return this.negative=0,this.iaddn(t),this.negative=1,this;if(this.words[0]-=t,1===this.length&&this.words[0]<0)this.words[0]=-this.words[0],this.negative=1;else for(var e=0;e<this.length&&this.words[e]<0;e++)this.words[e]+=67108864,this.words[e+1]-=1;return this.strip()},s.prototype.addn=function(t){return this.clone().iaddn(t)},s.prototype.subn=function(t){return this.clone().isubn(t)},s.prototype.iabs=function(){return this.negative=0,this},s.prototype.abs=function(){return this.clone().iabs()},s.prototype._ishlnsubmul=function(t,e,i){var r,s=t.length+i;this._expand(s);var o,a=0;for(r=0;r<t.length;r++){o=(0|this.words[r+i])+a;var h=(0|t.words[r])*e;a=((o-=67108863&h)>>26)-(h/67108864|0),this.words[r+i]=67108863&o}for(;r<this.length-i;r++)a=(o=(0|this.words[r+i])+a)>>26,this.words[r+i]=67108863&o;if(0===a)return this.strip();for(n(-1===a),a=0,r=0;r<this.length;r++)a=(o=-(0|this.words[r])+a)>>26,this.words[r]=67108863&o;return this.negative=1,this.strip()},s.prototype._wordDiv=function(t,e){var i=this.length-t.length,n=this.clone(),r=t,o=0|r.words[r.length-1];0!==(i=26-this._countBits(o))&&(r=r.ushln(i),n.iushln(i),o=0|r.words[r.length-1]);var a,h=n.length-r.length;if("mod"!==e){(a=new s(null)).length=h+1,a.words=new Array(a.length);for(var c=0;c<a.length;c++)a.words[c]=0}var u=n.clone()._ishlnsubmul(r,1,h);0===u.negative&&(n=u,a&&(a.words[h]=1));for(var f=h-1;f>=0;f--){var l=67108864*(0|n.words[r.length+f])+(0|n.words[r.length+f-1]);for(l=Math.min(l/o|0,67108863),n._ishlnsubmul(r,l,f);0!==n.negative;)l--,n.negative=0,n._ishlnsubmul(r,1,f),n.isZero()||(n.negative^=1);a&&(a.words[f]=l)}return a&&a.strip(),n.strip(),"div"!==e&&0!==i&&n.iushrn(i),{div:a||null,mod:n}},s.prototype.divmod=function(t,e,i){if(n(!t.isZero()),this.isZero())return{div:new s(0),mod:new s(0)};var r,o,a;return 0!==this.negative&&0===t.negative?(a=this.neg().divmod(t,e),"mod"!==e&&(r=a.div.neg()),"div"!==e&&(o=a.mod.neg(),i&&0!==o.negative&&o.iadd(t)),{div:r,mod:o}):0===this.negative&&0!==t.negative?(a=this.divmod(t.neg(),e),"mod"!==e&&(r=a.div.neg()),{div:r,mod:a.mod}):0!=(this.negative&t.negative)?(a=this.neg().divmod(t.neg(),e),"div"!==e&&(o=a.mod.neg(),i&&0!==o.negative&&o.isub(t)),{div:a.div,mod:o}):t.length>this.length||this.cmp(t)<0?{div:new s(0),mod:this}:1===t.length?"div"===e?{div:this.divn(t.words[0]),mod:null}:"mod"===e?{div:null,mod:new s(this.modn(t.words[0]))}:{div:this.divn(t.words[0]),mod:new s(this.modn(t.words[0]))}:this._wordDiv(t,e)},s.prototype.div=function(t){return this.divmod(t,"div",!1).div},s.prototype.mod=function(t){return this.divmod(t,"mod",!1).mod},s.prototype.umod=function(t){return this.divmod(t,"mod",!0).mod},s.prototype.divRound=function(t){var e=this.divmod(t);if(e.mod.isZero())return e.div;var i=0!==e.div.negative?e.mod.isub(t):e.mod,n=t.ushrn(1),r=t.andln(1),s=i.cmp(n);return s<0||1===r&&0===s?e.div:0!==e.div.negative?e.div.isubn(1):e.div.iaddn(1)},s.prototype.modn=function(t){n(t<=67108863);for(var e=(1<<26)%t,i=0,r=this.length-1;r>=0;r--)i=(e*i+(0|this.words[r]))%t;return i},s.prototype.idivn=function(t){n(t<=67108863);for(var e=0,i=this.length-1;i>=0;i--){var r=(0|this.words[i])+67108864*e;this.words[i]=r/t|0,e=r%t}return this.strip()},s.prototype.divn=function(t){return this.clone().idivn(t)},s.prototype.egcd=function(t){n(0===t.negative),n(!t.isZero());var e=this,i=t.clone();e=0!==e.negative?e.umod(t):e.clone();for(var r=new s(1),o=new s(0),a=new s(0),h=new s(1),c=0;e.isEven()&&i.isEven();)e.iushrn(1),i.iushrn(1),++c;for(var u=i.clone(),f=e.clone();!e.isZero();){for(var l=0,p=1;0==(e.words[0]&p)&&l<26;++l,p<<=1);if(l>0)for(e.iushrn(l);l-- >0;)(r.isOdd()||o.isOdd())&&(r.iadd(u),o.isub(f)),r.iushrn(1),o.iushrn(1);for(var d=0,m=1;0==(i.words[0]&m)&&d<26;++d,m<<=1);if(d>0)for(i.iushrn(d);d-- >0;)(a.isOdd()||h.isOdd())&&(a.iadd(u),h.isub(f)),a.iushrn(1),h.iushrn(1);e.cmp(i)>=0?(e.isub(i),r.isub(a),o.isub(h)):(i.isub(e),a.isub(r),h.isub(o))}return{a:a,b:h,gcd:i.iushln(c)}},s.prototype._invmp=function(t){n(0===t.negative),n(!t.isZero());var e=this,i=t.clone();e=0!==e.negative?e.umod(t):e.clone();for(var r=new s(1),o=new s(0),a=i.clone();e.cmpn(1)>0&&i.cmpn(1)>0;){for(var h=0,c=1;0==(e.words[0]&c)&&h<26;++h,c<<=1);if(h>0)for(e.iushrn(h);h-- >0;)r.isOdd()&&r.iadd(a),r.iushrn(1);for(var u=0,f=1;0==(i.words[0]&f)&&u<26;++u,f<<=1);if(u>0)for(i.iushrn(u);u-- >0;)o.isOdd()&&o.iadd(a),o.iushrn(1);e.cmp(i)>=0?(e.isub(i),r.isub(o)):(i.isub(e),o.isub(r))}var l;return(l=0===e.cmpn(1)?r:o).cmpn(0)<0&&l.iadd(t),l},s.prototype.gcd=function(t){if(this.isZero())return t.abs();if(t.isZero())return this.abs();var e=this.clone(),i=t.clone();e.negative=0,i.negative=0;for(var n=0;e.isEven()&&i.isEven();n++)e.iushrn(1),i.iushrn(1);for(;;){for(;e.isEven();)e.iushrn(1);for(;i.isEven();)i.iushrn(1);var r=e.cmp(i);if(r<0){var s=e;e=i,i=s}else if(0===r||0===i.cmpn(1))break;e.isub(i)}return i.iushln(n)},s.prototype.invm=function(t){return this.egcd(t).a.umod(t)},s.prototype.isEven=function(){return 0==(1&this.words[0])},s.prototype.isOdd=function(){return 1==(1&this.words[0])},s.prototype.andln=function(t){return this.words[0]&t},s.prototype.bincn=function(t){n("number"==typeof t);var e=t%26,i=(t-e)/26,r=1<<e;if(this.length<=i)return this._expand(i+1),this.words[i]|=r,this;for(var s=r,o=i;0!==s&&o<this.length;o++){var a=0|this.words[o];s=(a+=s)>>>26,a&=67108863,this.words[o]=a}return 0!==s&&(this.words[o]=s,this.length++),this},s.prototype.isZero=function(){return 1===this.length&&0===this.words[0]},s.prototype.cmpn=function(t){var e=t<0;if(0!==this.negative&&!e)return-1;if(0===this.negative&&e)return 1;this.strip();var i;if(this.length>1)i=1;else{e&&(t=-t),n(t<=67108863,"Number is too big");var r=0|this.words[0];i=r===t?0:r<t?-1:1}return 0!==this.negative?0|-i:i},s.prototype.cmp=function(t){if(0!==this.negative&&0===t.negative)return-1;if(0===this.negative&&0!==t.negative)return 1;var e=this.ucmp(t);return 0!==this.negative?0|-e:e},s.prototype.ucmp=function(t){if(this.length>t.length)return 1;if(this.length<t.length)return-1;for(var e=0,i=this.length-1;i>=0;i--){var n=0|this.words[i],r=0|t.words[i];if(n!==r){n<r?e=-1:n>r&&(e=1);break}}return e},s.prototype.gtn=function(t){return 1===this.cmpn(t)},s.prototype.gt=function(t){return 1===this.cmp(t)},s.prototype.gten=function(t){return this.cmpn(t)>=0},s.prototype.gte=function(t){return this.cmp(t)>=0},s.prototype.ltn=function(t){return-1===this.cmpn(t)},s.prototype.lt=function(t){return-1===this.cmp(t)},s.prototype.lten=function(t){return this.cmpn(t)<=0},s.prototype.lte=function(t){return this.cmp(t)<=0},s.prototype.eqn=function(t){return 0===this.cmpn(t)},s.prototype.eq=function(t){return 0===this.cmp(t)},s.red=function(t){return new g(t)},s.prototype.toRed=function(t){return n(!this.red,"Already a number in reduction context"),n(0===this.negative,"red works only with positives"),t.convertTo(this)._forceRed(t)},s.prototype.fromRed=function(){return n(this.red,"fromRed works only with numbers in reduction context"),this.red.convertFrom(this)},s.prototype._forceRed=function(t){return this.red=t,this},s.prototype.forceRed=function(t){return n(!this.red,"Already a number in reduction context"),this._forceRed(t)},s.prototype.redAdd=function(t){return n(this.red,"redAdd works only with red numbers"),this.red.add(this,t)},s.prototype.redIAdd=function(t){return n(this.red,"redIAdd works only with red numbers"),this.red.iadd(this,t)},s.prototype.redSub=function(t){return n(this.red,"redSub works only with red numbers"),this.red.sub(this,t)},s.prototype.redISub=function(t){return n(this.red,"redISub works only with red numbers"),this.red.isub(this,t)},s.prototype.redShl=function(t){return n(this.red,"redShl works only with red numbers"),this.red.shl(this,t)},s.prototype.redMul=function(t){return n(this.red,"redMul works only with red numbers"),this.red._verify2(this,t),this.red.mul(this,t)},s.prototype.redIMul=function(t){return n(this.red,"redMul works only with red numbers"),this.red._verify2(this,t),this.red.imul(this,t)},s.prototype.redSqr=function(){return n(this.red,"redSqr works only with red numbers"),this.red._verify1(this),this.red.sqr(this)},s.prototype.redISqr=function(){return n(this.red,"redISqr works only with red numbers"),this.red._verify1(this),this.red.isqr(this)},s.prototype.redSqrt=function(){return n(this.red,"redSqrt works only with red numbers"),this.red._verify1(this),this.red.sqrt(this)},s.prototype.redInvm=function(){return n(this.red,"redInvm works only with red numbers"),this.red._verify1(this),this.red.invm(this)},s.prototype.redNeg=function(){return n(this.red,"redNeg works only with red numbers"),this.red._verify1(this),this.red.neg(this)},s.prototype.redPow=function(t){return n(this.red&&!t.red,"redPow(normalNum)"),this.red._verify1(this),this.red.pow(this,t)};var E={k256:null,p224:null,p192:null,p25519:null};f.prototype._tmp=function(){var t=new s(null);return t.words=new Array(Math.ceil(this.n/13)),t},f.prototype.ireduce=function(t){var e,i=t;do{this.split(i,this.tmp),e=(i=(i=this.imulK(i)).iadd(this.tmp)).bitLength()}while(e>this.n);var n=e<this.n?-1:i.ucmp(this.p);return 0===n?(i.words[0]=0,i.length=1):n>0?i.isub(this.p):i.strip(),i},f.prototype.split=function(t,e){t.iushrn(this.n,0,e)},f.prototype.imulK=function(t){return t.imul(this.k)},r(l,f),l.prototype.split=function(t,e){for(var i=Math.min(t.length,9),n=0;n<i;n++)e.words[n]=t.words[n];if(e.length=i,t.length<=9)return t.words[0]=0,void(t.length=1);var r=t.words[9];for(e.words[e.length++]=4194303&r,n=10;n<t.length;n++){var s=0|t.words[n];t.words[n-10]=(4194303&s)<<4|r>>>22,r=s}r>>>=22,t.words[n-10]=r,0===r&&t.length>10?t.length-=10:t.length-=9},l.prototype.imulK=function(t){t.words[t.length]=0,t.words[t.length+1]=0,t.length+=2;for(var e=0,i=0;i<t.length;i++){var n=0|t.words[i];e+=977*n,t.words[i]=67108863&e,e=64*n+(e/67108864|0)}return 0===t.words[t.length-1]&&(t.length--,0===t.words[t.length-1]&&t.length--),t},r(p,f),r(d,f),r(m,f),m.prototype.imulK=function(t){for(var e=0,i=0;i<t.length;i++){var n=19*(0|t.words[i])+e,r=67108863&n;n>>>=26,t.words[i]=r,e=n}return 0!==e&&(t.words[t.length++]=e),t},s._prime=function(t){if(E[t])return E[t];var e;if("k256"===t)e=new l;else if("p224"===t)e=new p;else if("p192"===t)e=new d;else{if("p25519"!==t)throw new Error("Unknown prime "+t);e=new m}return E[t]=e,e},g.prototype._verify1=function(t){n(0===t.negative,"red works only with positives"),n(t.red,"red works only with red numbers")},g.prototype._verify2=function(t,e){n(0==(t.negative|e.negative),"red works only with positives"),n(t.red&&t.red===e.red,"red works only with red numbers")},g.prototype.imod=function(t){return this.prime?this.prime.ireduce(t)._forceRed(this):t.umod(this.m)._forceRed(this)},g.prototype.neg=function(t){return t.isZero()?t.clone():this.m.sub(t)._forceRed(this)},g.prototype.add=function(t,e){this._verify2(t,e);var i=t.add(e);return i.cmp(this.m)>=0&&i.isub(this.m),i._forceRed(this)},g.prototype.iadd=function(t,e){this._verify2(t,e);var i=t.iadd(e);return i.cmp(this.m)>=0&&i.isub(this.m),i},g.prototype.sub=function(t,e){this._verify2(t,e);var i=t.sub(e);return i.cmpn(0)<0&&i.iadd(this.m),i._forceRed(this)},g.prototype.isub=function(t,e){this._verify2(t,e);var i=t.isub(e);return i.cmpn(0)<0&&i.iadd(this.m),i},g.prototype.shl=function(t,e){return this._verify1(t),this.imod(t.ushln(e))},g.prototype.imul=function(t,e){return this._verify2(t,e),this.imod(t.imul(e))},g.prototype.mul=function(t,e){return this._verify2(t,e),this.imod(t.mul(e))},g.prototype.isqr=function(t){return this.imul(t,t.clone())},g.prototype.sqr=function(t){return this.mul(t,t)},g.prototype.sqrt=function(t){if(t.isZero())return t.clone();var e=this.m.andln(3);if(n(e%2==1),3===e){var i=this.m.add(new s(1)).iushrn(2);return this.pow(t,i)}for(var r=this.m.subn(1),o=0;!r.isZero()&&0===r.andln(1);)o++,r.iushrn(1);n(!r.isZero());var a=new s(1).toRed(this),h=a.redNeg(),c=this.m.subn(1).iushrn(1),u=this.m.bitLength();for(u=new s(2*u*u).toRed(this);0!==this.pow(u,c).cmp(h);)u.redIAdd(h);for(var f=this.pow(u,r),l=this.pow(t,r.addn(1).iushrn(1)),p=this.pow(t,r),d=o;0!==p.cmp(a);){for(var m=p,g=0;0!==m.cmp(a);g++)m=m.redSqr();n(g<d);var y=this.pow(f,new s(1).iushln(d-g-1));l=l.redMul(y),f=y.redSqr(),p=p.redMul(f),d=g}return l},g.prototype.invm=function(t){var e=t._invmp(this.m);return 0!==e.negative?(e.negative=0,this.imod(e).redNeg()):this.imod(e)},g.prototype.pow=function(t,e){if(e.isZero())return new s(1).toRed(this);if(0===e.cmpn(1))return t.clone();var i=new Array(16);i[0]=new s(1).toRed(this),i[1]=t;for(var n=2;n<i.length;n++)i[n]=this.mul(i[n-1],t);var r=i[0],o=0,a=0,h=e.bitLength()%26;for(0===h&&(h=26),n=e.length-1;n>=0;n--){for(var c=e.words[n],u=h-1;u>=0;u--){var f=c>>u&1;r!==i[0]&&(r=this.sqr(r)),0!==f||0!==o?(o<<=1,o|=f,(4===++a||0===n&&0===u)&&(r=this.mul(r,i[o]),a=0,o=0)):a=0}h=26}return r},g.prototype.convertTo=function(t){var e=t.umod(this.m);return e===t?e.clone():e},g.prototype.convertFrom=function(t){var e=t.clone();return e.red=null,e},s.mont=function(t){return new y(t)},r(y,g),y.prototype.convertTo=function(t){return this.imod(t.ushln(this.shift))},y.prototype.convertFrom=function(t){var e=this.imod(t.mul(this.rinv));return e.red=null,e},y.prototype.imul=function(t,e){if(t.isZero()||e.isZero())return t.words[0]=0,t.length=1,t;var i=t.imul(e),n=i.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),r=i.isub(n).iushrn(this.shift),s=r;return r.cmp(this.m)>=0?s=r.isub(this.m):r.cmpn(0)<0&&(s=r.iadd(this.m)),s._forceRed(this)},y.prototype.mul=function(t,e){if(t.isZero()||e.isZero())return new s(0)._forceRed(this);var i=t.mul(e),n=i.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),r=i.isub(n).iushrn(this.shift),o=r;return r.cmp(this.m)>=0?o=r.isub(this.m):r.cmpn(0)<0&&(o=r.iadd(this.m)),o._forceRed(this)},y.prototype.invm=function(t){return this.imod(t._invmp(this.m).mul(this.r2))._forceRed(this)}}(void 0===t||t,this)}).call(e,i(64)(t))},function(t,e,i){"use strict";const n=i(0),r=i(135),s=i(28),o=e,a=Buffer.from("0000000000000000000000000000000000000000000000000000000000000000","hex"),h=Buffer.from("7fffffffffffffffffffffffffffffff5d576e7357a4501ddfe92f46681b20a0","hex");o.binding=!0,o.generatePrivateKey=function(){let t;do{t=s.randomBytes(32)}while(!r.privateKeyVerify(t));return t},o.publicKeyCreate=function(t,e){return n(Buffer.isBuffer(t)),r.publicKeyCreate(t,e)},o.publicKeyConvert=function(t,e){return r.publicKeyConvert(t,e)},o.privateKeyTweakAdd=function(t,e){return r.privateKeyTweakAdd(t,e)},o.publicKeyTweakAdd=function(t,e,i){return r.publicKeyTweakAdd(t,e,i)},o.ecdh=function(t,e){return r.ecdhUnsafe(t,e,!0).slice(1,33)},o.recover=function(t,e,i,n){let s;i||(i=0);try{e=r.signatureImport(e)}catch(t){return null}try{s=r.recover(t,e,i,n)}catch(t){return null}return s},o.verify=function(t,e,i){if(n(Buffer.isBuffer(t)),n(Buffer.isBuffer(e)),n(Buffer.isBuffer(i)),0===e.length)return!1;if(0===i.length)return!1;try{return e=r.signatureImportLax(e),e=r.signatureNormalize(e),r.verify(t,e,i)}catch(t){return!1}},o.publicKeyVerify=function(t){return r.publicKeyVerify(t)},o.privateKeyVerify=function(t){return r.privateKeyVerify(t)},o.sign=function(t,e){n(Buffer.isBuffer(t)),n(Buffer.isBuffer(e));let i=r.sign(t,e);return i=r.signatureNormalize(i.signature),r.signatureExport(i)},o.fromDER=function(t){return n(Buffer.isBuffer(t)),r.signatureImport(t)},o.toDER=function(t){return n(Buffer.isBuffer(t)),r.signatureExport(t)},o.isLowS=function(t){let e;try{e=r.signatureImport(t).slice(32,64)}catch(t){return!1}return!e.equals(a)&&!(e.compare(h)>0)}},function(t,e){t.exports=require("secp256k1")},function(t,e,i){"use strict";function n(t,e){const i=t[e++];if(!(128&i))return[i,e];const n=15&i;let r=0;for(let i=0;i<n;i++)r<<=8,r|=t[e++];return[r,e]}const r=i(0),s=i(9).ec("secp256k1"),o=i(67),a=i(26),h=s.curve,c=e;c.binding=!1,c.generatePrivateKey=function(){return s.genKeyPair().getPrivate().toArrayLike(Buffer,"be",32)},c.publicKeyCreate=function(t,e){r(Buffer.isBuffer(t)),null==e&&(e=!0);const i=s.keyPair({priv:t});return Buffer.from(i.getPublic(e,"array"))},c.publicKeyConvert=function(t,e){const i=h.decodePoint(t);return null==e&&(e=!0),Buffer.from(i.encode("array",e))},c.privateKeyTweakAdd=function(t,e){const i=new a(e).add(new a(t)).mod(h.n).toArrayLike(Buffer,"be",32);if(!c.privateKeyVerify(i))throw new Error("Private key is invalid.");return i},c.publicKeyTweakAdd=function(t,e,i){const n=h.decodePoint(t),r=h.g.mul(new a(e)).add(n);null==i&&(i=!0);const s=Buffer.from(r.encode("array",i));if(!c.publicKeyVerify(s))throw new Error("Public key is invalid.");return s},c.ecdh=function(t,e){return e=s.keyPair({priv:e}),t=s.keyPair({pub:t}),e.derive(t.getPublic()).toArrayLike(Buffer,"be",32)},c.recover=function(t,e,i,n){i||(i=0),null==n&&(n=!0);let r;try{r=s.recoverPubKey(t,e,i)}catch(t){return null}return Buffer.from(r.encode("array",n))},c.verify=function(t,e,i){if(r(Buffer.isBuffer(t)),r(Buffer.isBuffer(e)),r(Buffer.isBuffer(i)),0===e.length)return!1;if(0===i.length)return!1;e=function(t){let e,i=t,r=0;return 48!==i[r++]?t:([e,r]=n(i,r),i.length>e+r&&(i=i.slice(0,e+r)),2!==i[r++]?t:([e,r]=n(i,r),r+=e,2!==i[r++]?t:([e,r]=n(i,r),i.length>e+r&&(i=i.slice(0,e+r)),i)))}(e);try{return s.verify(t,e,i)}catch(t){return!1}},c.publicKeyVerify=function(t){try{return s.keyPair({pub:t}).validate()}catch(t){return!1}},c.privateKeyVerify=function(t){return 32===t.length&&(0!==(t=new a(t)).cmpn(0)&&t.cmp(h.n)<0)},c.sign=function(t,e){r(Buffer.isBuffer(t)),r(Buffer.isBuffer(e));const i=s.sign(t,e,{canonical:!0});return Buffer.from(i.toDER())},c.fromDER=function(t){r(Buffer.isBuffer(t));const e=new o(t),i=Buffer.allocUnsafe(64);return e.r.toArrayLike(Buffer,"be",32).copy(i,0),e.s.toArrayLike(Buffer,"be",32).copy(i,32),i},c.toDER=function(t){r(Buffer.isBuffer(t));const e=new o({r:new a(t.slice(0,32),"be"),s:new a(t.slice(32,64),"be")});return Buffer.from(e.toDER())},c.isLowS=function(t){let e;try{e=new o(t)}catch(t){return!1}return 0!==e.s.cmpn(0)&&!(e.s.cmp(s.nh)>0)}},function(t,e){t.exports={_from:"elliptic@6.4.0",_id:"elliptic@6.4.0",_inBundle:!1,_integrity:"sha1-ysmvh2LIWDYYcAPI3+GT5eLq5d8=",_location:"/elliptic",_phantomChildren:{},_requested:{type:"version",registry:!0,raw:"elliptic@6.4.0",name:"elliptic",escapedName:"elliptic",rawSpec:"6.4.0",saveSpec:null,fetchSpec:"6.4.0"},_requiredBy:["#USER","/"],_resolved:"https://registry.npmjs.org/elliptic/-/elliptic-6.4.0.tgz",_shasum:"cac9af8762c85836187003c8dfe193e5e2eae5df",_spec:"elliptic@6.4.0",_where:"C:\\Users\\pakru\\Desktop\\New folder",author:{name:"Fedor Indutny",email:"fedor@indutny.com"},bugs:{url:"https://github.com/indutny/elliptic/issues"},bundleDependencies:!1,dependencies:{"bn.js":"^4.4.0",brorand:"^1.0.1","hash.js":"^1.0.0","hmac-drbg":"^1.0.0",inherits:"^2.0.1","minimalistic-assert":"^1.0.0","minimalistic-crypto-utils":"^1.0.0"},deprecated:!1,description:"EC cryptography",devDependencies:{brfs:"^1.4.3",coveralls:"^2.11.3",grunt:"^0.4.5","grunt-browserify":"^5.0.0","grunt-cli":"^1.2.0","grunt-contrib-connect":"^1.0.0","grunt-contrib-copy":"^1.0.0","grunt-contrib-uglify":"^1.0.1","grunt-mocha-istanbul":"^3.0.1","grunt-saucelabs":"^8.6.2",istanbul:"^0.4.2",jscs:"^2.9.0",jshint:"^2.6.0",mocha:"^2.1.0"},files:["lib"],homepage:"https://github.com/indutny/elliptic",keywords:["EC","Elliptic","curve","Cryptography"],license:"MIT",main:"lib/elliptic.js",name:"elliptic",repository:{type:"git",url:"git+ssh://git@github.com/indutny/elliptic.git"},scripts:{jscs:"jscs benchmarks/*.js lib/*.js lib/**/*.js lib/**/**/*.js test/index.js",jshint:"jscs benchmarks/*.js lib/*.js lib/**/*.js lib/**/**/*.js test/index.js",lint:"npm run jscs && npm run jshint",test:"npm run lint && npm run unit",unit:"istanbul test _mocha --reporter=spec test/index.js",version:"grunt dist && git add dist/"},version:"6.4.0"}},function(t,e,i){"use strict";var n=e,r=i(17),s=i(22),o=i(86);n.assert=s,n.toArray=o.toArray,n.zero2=o.zero2,n.toHex=o.toHex,n.encode=o.encode,n.getNAF=function(t,e){for(var i=[],n=1<<e+1,r=t.clone();r.cmpn(1)>=0;){var s;if(r.isOdd()){var o=r.andln(n-1);s=o>(n>>1)-1?(n>>1)-o:o,r.isubn(s)}else s=0;i.push(s);for(var a=0!==r.cmpn(0)&&0===r.andln(n-1)?e+1:1,h=1;h<a;h++)i.push(0);r.iushrn(a)}return i},n.getJSF=function(t,e){var i=[[],[]];t=t.clone(),e=e.clone();for(var n=0,r=0;t.cmpn(-n)>0||e.cmpn(-r)>0;){var s=t.andln(3)+n&3,o=e.andln(3)+r&3;3===s&&(s=-1),3===o&&(o=-1);var a;a=0==(1&s)?0:3!=(c=t.andln(7)+n&7)&&5!==c||2!==o?s:-s,i[0].push(a);var h;if(0==(1&o))h=0;else{var c;h=3!=(c=e.andln(7)+r&7)&&5!==c||2!==s?o:-o}i[1].push(h),2*n===a+1&&(n=1-n),2*r===h+1&&(r=1-r),t.iushrn(1),e.iushrn(1)}return i},n.cachedProperty=function(t,e,i){var n="_"+e;t.prototype[e]=function(){return void 0!==this[n]?this[n]:this[n]=i.call(this)}},n.parseBytes=function(t){return"string"==typeof t?n.toArray(t,"hex"):t},n.intFromLE=function(t){return new r(t,"hex","le")}},function(t,e,i){function n(t){this.rand=t}var r;if(t.exports=function(t){return r||(r=new n(null)),r.generate(t)},t.exports.Rand=n,n.prototype.generate=function(t){return this._rand(t)},n.prototype._rand=function(t){if(this.rand.getBytes)return this.rand.getBytes(t);for(var e=new Uint8Array(t),i=0;i<e.length;i++)e[i]=this.rand.getByte();return e},"object"==typeof self)self.crypto&&self.crypto.getRandomValues?n.prototype._rand=function(t){var e=new Uint8Array(t);return self.crypto.getRandomValues(e),e}:self.msCrypto&&self.msCrypto.getRandomValues?n.prototype._rand=function(t){var e=new Uint8Array(t);return self.msCrypto.getRandomValues(e),e}:"object"==typeof window&&(n.prototype._rand=function(){throw new Error("Not implemented yet")});else try{var s=i(24);if("function"!=typeof s.randomBytes)throw new Error("Not supported");n.prototype._rand=function(t){return s.randomBytes(t)}}catch(t){}},function(t,e,i){"use strict";function n(t,e){this.type=t,this.p=new s(e.p,16),this.red=e.prime?s.red(e.prime):s.mont(this.p),this.zero=new s(0).toRed(this.red),this.one=new s(1).toRed(this.red),this.two=new s(2).toRed(this.red),this.n=e.n&&new s(e.n,16),this.g=e.g&&this.pointFromJSON(e.g,e.gRed),this._wnafT1=new Array(4),this._wnafT2=new Array(4),this._wnafT3=new Array(4),this._wnafT4=new Array(4);var i=this.n&&this.p.div(this.n);!i||i.cmpn(100)>0?this.redN=null:(this._maxwellTrick=!0,this.redN=this.n.toRed(this.red))}function r(t,e){this.curve=t,this.type=e,this.precomputed=null}var s=i(17),o=i(9).utils,a=o.getNAF,h=o.getJSF,c=o.assert;t.exports=n,n.prototype.point=function(){throw new Error("Not implemented")},n.prototype.validate=function(){throw new Error("Not implemented")},n.prototype._fixedNafMul=function(t,e){c(t.precomputed);var i=t._getDoubles(),n=a(e,1),r=(1<<i.step+1)-(i.step%2==0?2:1);r/=3;for(var s=[],o=0;o<n.length;o+=i.step){var h=0;for(e=o+i.step-1;e>=o;e--)h=(h<<1)+n[e];s.push(h)}for(var u=this.jpoint(null,null,null),f=this.jpoint(null,null,null),l=r;l>0;l--){for(o=0;o<s.length;o++){(h=s[o])===l?f=f.mixedAdd(i.points[o]):h===-l&&(f=f.mixedAdd(i.points[o].neg()))}u=u.add(f)}return u.toP()},n.prototype._wnafMul=function(t,e){var i=4,n=t._getNAFPoints(i);i=n.wnd;for(var r=n.points,s=a(e,i),o=this.jpoint(null,null,null),h=s.length-1;h>=0;h--){for(e=0;h>=0&&0===s[h];h--)e++;if(h>=0&&e++,o=o.dblp(e),h<0)break;var u=s[h];c(0!==u),o="affine"===t.type?u>0?o.mixedAdd(r[u-1>>1]):o.mixedAdd(r[-u-1>>1].neg()):u>0?o.add(r[u-1>>1]):o.add(r[-u-1>>1].neg())}return"affine"===t.type?o.toP():o},n.prototype._wnafMulAdd=function(t,e,i,n,r){for(var s=this._wnafT1,o=this._wnafT2,c=this._wnafT3,u=0,f=0;f<n;f++){var l=(x=e[f])._getNAFPoints(t);s[f]=l.wnd,o[f]=l.points}for(f=n-1;f>=1;f-=2){var p=f-1,d=f;if(1===s[p]&&1===s[d]){var m=[e[p],null,null,e[d]];0===e[p].y.cmp(e[d].y)?(m[1]=e[p].add(e[d]),m[2]=e[p].toJ().mixedAdd(e[d].neg())):0===e[p].y.cmp(e[d].y.redNeg())?(m[1]=e[p].toJ().mixedAdd(e[d]),m[2]=e[p].add(e[d].neg())):(m[1]=e[p].toJ().mixedAdd(e[d]),m[2]=e[p].toJ().mixedAdd(e[d].neg()));var g=[-3,-1,-5,-7,0,7,5,1,3],y=h(i[p],i[d]);u=Math.max(y[0].length,u),c[p]=new Array(u),c[d]=new Array(u);for(var w=0;w<u;w++){var b=0|y[0][w],v=0|y[1][w];c[p][w]=g[3*(b+1)+(v+1)],c[d][w]=0,o[p]=m}}else c[p]=a(i[p],s[p]),c[d]=a(i[d],s[d]),u=Math.max(c[p].length,u),u=Math.max(c[d].length,u)}var k=this.jpoint(null,null,null),S=this._wnafT4;for(f=u;f>=0;f--){for(var E=0;f>=0;){var R=!0;for(w=0;w<n;w++)S[w]=0|c[w][f],0!==S[w]&&(R=!1);if(!R)break;E++,f--}if(f>=0&&E++,k=k.dblp(E),f<0)break;for(w=0;w<n;w++){var x,_=S[w];0!==_&&(_>0?x=o[w][_-1>>1]:_<0&&(x=o[w][-_-1>>1].neg()),k="affine"===x.type?k.mixedAdd(x):k.add(x))}}for(f=0;f<n;f++)o[f]=null;return r?k:k.toP()},n.BasePoint=r,r.prototype.eq=function(){throw new Error("Not implemented")},r.prototype.validate=function(){return this.curve.validate(this)},n.prototype.decodePoint=function(t,e){t=o.toArray(t,e);var i=this.p.byteLength();if((4===t[0]||6===t[0]||7===t[0])&&t.length-1==2*i){6===t[0]?c(t[t.length-1]%2==0):7===t[0]&&c(t[t.length-1]%2==1);return this.point(t.slice(1,1+i),t.slice(1+i,1+2*i))}if((2===t[0]||3===t[0])&&t.length-1===i)return this.pointFromX(t.slice(1,1+i),3===t[0]);throw new Error("Unknown point format")},r.prototype.encodeCompressed=function(t){return this.encode(t,!0)},r.prototype._encode=function(t){var e=this.curve.p.byteLength(),i=this.getX().toArray("be",e);return t?[this.getY().isEven()?2:3].concat(i):[4].concat(i,this.getY().toArray("be",e))},r.prototype.encode=function(t,e){return o.encode(this._encode(e),t)},r.prototype.precompute=function(t){if(this.precomputed)return this;var e={doubles:null,naf:null,beta:null};return e.naf=this._getNAFPoints(8),e.doubles=this._getDoubles(4,t),e.beta=this._getBeta(),this.precomputed=e,this},r.prototype._hasDoubles=function(t){if(!this.precomputed)return!1;var e=this.precomputed.doubles;return!!e&&e.points.length>=Math.ceil((t.bitLength()+1)/e.step)},r.prototype._getDoubles=function(t,e){if(this.precomputed&&this.precomputed.doubles)return this.precomputed.doubles;for(var i=[this],n=this,r=0;r<e;r+=t){for(var s=0;s<t;s++)n=n.dbl();i.push(n)}return{step:t,points:i}},r.prototype._getNAFPoints=function(t){if(this.precomputed&&this.precomputed.naf)return this.precomputed.naf;for(var e=[this],i=(1<<t)-1,n=1===i?null:this.dbl(),r=1;r<i;r++)e[r]=e[r-1].add(n);return{wnd:t,points:e}},r.prototype._getBeta=function(){return null},r.prototype.dblp=function(t){for(var e=this,i=0;i<t;i++)e=e.dbl();return e}},function(t,e,i){"use strict";function n(t){u.call(this,"short",t),this.a=new h(t.a,16).toRed(this.red),this.b=new h(t.b,16).toRed(this.red),this.tinv=this.two.redInvm(),this.zeroA=0===this.a.fromRed().cmpn(0),this.threeA=0===this.a.fromRed().sub(this.p).cmpn(-3),this.endo=this._getEndomorphism(t),this._endoWnafT1=new Array(4),this._endoWnafT2=new Array(4)}function r(t,e,i,n){u.BasePoint.call(this,t,"affine"),null===e&&null===i?(this.x=null,this.y=null,this.inf=!0):(this.x=new h(e,16),this.y=new h(i,16),n&&(this.x.forceRed(this.curve.red),this.y.forceRed(this.curve.red)),this.x.red||(this.x=this.x.toRed(this.curve.red)),this.y.red||(this.y=this.y.toRed(this.curve.red)),this.inf=!1)}function s(t,e,i,n){u.BasePoint.call(this,t,"jacobian"),null===e&&null===i&&null===n?(this.x=this.curve.one,this.y=this.curve.one,this.z=new h(0)):(this.x=new h(e,16),this.y=new h(i,16),this.z=new h(n,16)),this.x.red||(this.x=this.x.toRed(this.curve.red)),this.y.red||(this.y=this.y.toRed(this.curve.red)),this.z.red||(this.z=this.z.toRed(this.curve.red)),this.zOne=this.z===this.curve.one}var o=i(38),a=i(9),h=i(17),c=i(39),u=o.base,f=a.utils.assert;c(n,u),t.exports=n,n.prototype._getEndomorphism=function(t){if(this.zeroA&&this.g&&this.n&&1===this.p.modn(3)){var e,i;if(t.beta)e=new h(t.beta,16).toRed(this.red);else{var n=this._getEndoRoots(this.p);e=(e=n[0].cmp(n[1])<0?n[0]:n[1]).toRed(this.red)}if(t.lambda)i=new h(t.lambda,16);else{var r=this._getEndoRoots(this.n);0===this.g.mul(r[0]).x.cmp(this.g.x.redMul(e))?i=r[0]:(i=r[1],f(0===this.g.mul(i).x.cmp(this.g.x.redMul(e))))}var s;return s=t.basis?t.basis.map(function(t){return{a:new h(t.a,16),b:new h(t.b,16)}}):this._getEndoBasis(i),{beta:e,lambda:i,basis:s}}},n.prototype._getEndoRoots=function(t){var e=t===this.p?this.red:h.mont(t),i=new h(2).toRed(e).redInvm(),n=i.redNeg(),r=new h(3).toRed(e).redNeg().redSqrt().redMul(i);return[n.redAdd(r).fromRed(),n.redSub(r).fromRed()]},n.prototype._getEndoBasis=function(t){for(var e,i,n,r,s,o,a,c,u,f=this.n.ushrn(Math.floor(this.n.bitLength()/2)),l=t,p=this.n.clone(),d=new h(1),m=new h(0),g=new h(0),y=new h(1),w=0;0!==l.cmpn(0);){var b=p.div(l);c=p.sub(b.mul(l)),u=g.sub(b.mul(d));var v=y.sub(b.mul(m));if(!n&&c.cmp(f)<0)e=a.neg(),i=d,n=c.neg(),r=u;else if(n&&2==++w)break;a=c,p=l,l=c,g=d,d=u,y=m,m=v}s=c.neg(),o=u;var k=n.sqr().add(r.sqr());return s.sqr().add(o.sqr()).cmp(k)>=0&&(s=e,o=i),n.negative&&(n=n.neg(),r=r.neg()),s.negative&&(s=s.neg(),o=o.neg()),[{a:n,b:r},{a:s,b:o}]},n.prototype._endoSplit=function(t){var e=this.endo.basis,i=e[0],n=e[1],r=n.b.mul(t).divRound(this.n),s=i.b.neg().mul(t).divRound(this.n),o=r.mul(i.a),a=s.mul(n.a),h=r.mul(i.b),c=s.mul(n.b);return{k1:t.sub(o).sub(a),k2:h.add(c).neg()}},n.prototype.pointFromX=function(t,e){(t=new h(t,16)).red||(t=t.toRed(this.red));var i=t.redSqr().redMul(t).redIAdd(t.redMul(this.a)).redIAdd(this.b),n=i.redSqrt();if(0!==n.redSqr().redSub(i).cmp(this.zero))throw new Error("invalid point");var r=n.fromRed().isOdd();return(e&&!r||!e&&r)&&(n=n.redNeg()),this.point(t,n)},n.prototype.validate=function(t){if(t.inf)return!0;var e=t.x,i=t.y,n=this.a.redMul(e),r=e.redSqr().redMul(e).redIAdd(n).redIAdd(this.b);return 0===i.redSqr().redISub(r).cmpn(0)},n.prototype._endoWnafMulAdd=function(t,e,i){for(var n=this._endoWnafT1,r=this._endoWnafT2,s=0;s<t.length;s++){var o=this._endoSplit(e[s]),a=t[s],h=a._getBeta();o.k1.negative&&(o.k1.ineg(),a=a.neg(!0)),o.k2.negative&&(o.k2.ineg(),h=h.neg(!0)),n[2*s]=a,n[2*s+1]=h,r[2*s]=o.k1,r[2*s+1]=o.k2}for(var c=this._wnafMulAdd(1,n,r,2*s,i),u=0;u<2*s;u++)n[u]=null,r[u]=null;return c},c(r,u.BasePoint),n.prototype.point=function(t,e,i){return new r(this,t,e,i)},n.prototype.pointFromJSON=function(t,e){return r.fromJSON(this,t,e)},r.prototype._getBeta=function(){if(this.curve.endo){var t=this.precomputed;if(t&&t.beta)return t.beta;var e=this.curve.point(this.x.redMul(this.curve.endo.beta),this.y);if(t){var i=this.curve,n=function(t){return i.point(t.x.redMul(i.endo.beta),t.y)};t.beta=e,e.precomputed={beta:null,naf:t.naf&&{wnd:t.naf.wnd,points:t.naf.points.map(n)},doubles:t.doubles&&{step:t.doubles.step,points:t.doubles.points.map(n)}}}return e}},r.prototype.toJSON=function(){return this.precomputed?[this.x,this.y,this.precomputed&&{doubles:this.precomputed.doubles&&{step:this.precomputed.doubles.step,points:this.precomputed.doubles.points.slice(1)},naf:this.precomputed.naf&&{wnd:this.precomputed.naf.wnd,points:this.precomputed.naf.points.slice(1)}}]:[this.x,this.y]},r.fromJSON=function(t,e,i){function n(e){return t.point(e[0],e[1],i)}"string"==typeof e&&(e=JSON.parse(e));var r=t.point(e[0],e[1],i);if(!e[2])return r;var s=e[2];return r.precomputed={beta:null,doubles:s.doubles&&{step:s.doubles.step,points:[r].concat(s.doubles.points.map(n))},naf:s.naf&&{wnd:s.naf.wnd,points:[r].concat(s.naf.points.map(n))}},r},r.prototype.inspect=function(){return this.isInfinity()?"<EC Point Infinity>":"<EC Point x: "+this.x.fromRed().toString(16,2)+" y: "+this.y.fromRed().toString(16,2)+">"},r.prototype.isInfinity=function(){return this.inf},r.prototype.add=function(t){if(this.inf)return t;if(t.inf)return this;if(this.eq(t))return this.dbl();if(this.neg().eq(t))return this.curve.point(null,null);if(0===this.x.cmp(t.x))return this.curve.point(null,null);var e=this.y.redSub(t.y);0!==e.cmpn(0)&&(e=e.redMul(this.x.redSub(t.x).redInvm()));var i=e.redSqr().redISub(this.x).redISub(t.x),n=e.redMul(this.x.redSub(i)).redISub(this.y);return this.curve.point(i,n)},r.prototype.dbl=function(){if(this.inf)return this;var t=this.y.redAdd(this.y);if(0===t.cmpn(0))return this.curve.point(null,null);var e=this.curve.a,i=this.x.redSqr(),n=t.redInvm(),r=i.redAdd(i).redIAdd(i).redIAdd(e).redMul(n),s=r.redSqr().redISub(this.x.redAdd(this.x)),o=r.redMul(this.x.redSub(s)).redISub(this.y);return this.curve.point(s,o)},r.prototype.getX=function(){return this.x.fromRed()},r.prototype.getY=function(){return this.y.fromRed()},r.prototype.mul=function(t){return t=new h(t,16),this._hasDoubles(t)?this.curve._fixedNafMul(this,t):this.curve.endo?this.curve._endoWnafMulAdd([this],[t]):this.curve._wnafMul(this,t)},r.prototype.mulAdd=function(t,e,i){var n=[this,e],r=[t,i];return this.curve.endo?this.curve._endoWnafMulAdd(n,r):this.curve._wnafMulAdd(1,n,r,2)},r.prototype.jmulAdd=function(t,e,i){var n=[this,e],r=[t,i];return this.curve.endo?this.curve._endoWnafMulAdd(n,r,!0):this.curve._wnafMulAdd(1,n,r,2,!0)},r.prototype.eq=function(t){return this===t||this.inf===t.inf&&(this.inf||0===this.x.cmp(t.x)&&0===this.y.cmp(t.y))},r.prototype.neg=function(t){if(this.inf)return this;var e=this.curve.point(this.x,this.y.redNeg());if(t&&this.precomputed){var i=this.precomputed,n=function(t){return t.neg()};e.precomputed={naf:i.naf&&{wnd:i.naf.wnd,points:i.naf.points.map(n)},doubles:i.doubles&&{step:i.doubles.step,points:i.doubles.points.map(n)}}}return e},r.prototype.toJ=function(){if(this.inf)return this.curve.jpoint(null,null,null);return this.curve.jpoint(this.x,this.y,this.curve.one)},c(s,u.BasePoint),n.prototype.jpoint=function(t,e,i){return new s(this,t,e,i)},s.prototype.toP=function(){if(this.isInfinity())return this.curve.point(null,null);var t=this.z.redInvm(),e=t.redSqr(),i=this.x.redMul(e),n=this.y.redMul(e).redMul(t);return this.curve.point(i,n)},s.prototype.neg=function(){return this.curve.jpoint(this.x,this.y.redNeg(),this.z)},s.prototype.add=function(t){if(this.isInfinity())return t;if(t.isInfinity())return this;var e=t.z.redSqr(),i=this.z.redSqr(),n=this.x.redMul(e),r=t.x.redMul(i),s=this.y.redMul(e.redMul(t.z)),o=t.y.redMul(i.redMul(this.z)),a=n.redSub(r),h=s.redSub(o);if(0===a.cmpn(0))return 0!==h.cmpn(0)?this.curve.jpoint(null,null,null):this.dbl();var c=a.redSqr(),u=c.redMul(a),f=n.redMul(c),l=h.redSqr().redIAdd(u).redISub(f).redISub(f),p=h.redMul(f.redISub(l)).redISub(s.redMul(u)),d=this.z.redMul(t.z).redMul(a);return this.curve.jpoint(l,p,d)},s.prototype.mixedAdd=function(t){if(this.isInfinity())return t.toJ();if(t.isInfinity())return this;var e=this.z.redSqr(),i=this.x,n=t.x.redMul(e),r=this.y,s=t.y.redMul(e).redMul(this.z),o=i.redSub(n),a=r.redSub(s);if(0===o.cmpn(0))return 0!==a.cmpn(0)?this.curve.jpoint(null,null,null):this.dbl();var h=o.redSqr(),c=h.redMul(o),u=i.redMul(h),f=a.redSqr().redIAdd(c).redISub(u).redISub(u),l=a.redMul(u.redISub(f)).redISub(r.redMul(c)),p=this.z.redMul(o);return this.curve.jpoint(f,l,p)},s.prototype.dblp=function(t){if(0===t)return this;if(this.isInfinity())return this;if(!t)return this.dbl();if(this.curve.zeroA||this.curve.threeA){for(var e=this,i=0;i<t;i++)e=e.dbl();return e}var n=this.curve.a,r=this.curve.tinv,s=this.x,o=this.y,a=this.z,h=a.redSqr().redSqr(),c=o.redAdd(o);for(i=0;i<t;i++){var u=s.redSqr(),f=c.redSqr(),l=f.redSqr(),p=u.redAdd(u).redIAdd(u).redIAdd(n.redMul(h)),d=s.redMul(f),m=p.redSqr().redISub(d.redAdd(d)),g=d.redISub(m),y=p.redMul(g);y=y.redIAdd(y).redISub(l);var w=c.redMul(a);i+1<t&&(h=h.redMul(l)),s=m,a=w,c=y}return this.curve.jpoint(s,c.redMul(r),a)},s.prototype.dbl=function(){return this.isInfinity()?this:this.curve.zeroA?this._zeroDbl():this.curve.threeA?this._threeDbl():this._dbl()},s.prototype._zeroDbl=function(){var t,e,i;if(this.zOne){var n=this.x.redSqr(),r=this.y.redSqr(),s=r.redSqr(),o=this.x.redAdd(r).redSqr().redISub(n).redISub(s);o=o.redIAdd(o);var a=n.redAdd(n).redIAdd(n),h=a.redSqr().redISub(o).redISub(o),c=s.redIAdd(s);c=(c=c.redIAdd(c)).redIAdd(c),t=h,e=a.redMul(o.redISub(h)).redISub(c),i=this.y.redAdd(this.y)}else{var u=this.x.redSqr(),f=this.y.redSqr(),l=f.redSqr(),p=this.x.redAdd(f).redSqr().redISub(u).redISub(l);p=p.redIAdd(p);var d=u.redAdd(u).redIAdd(u),m=d.redSqr(),g=l.redIAdd(l);g=(g=g.redIAdd(g)).redIAdd(g),t=m.redISub(p).redISub(p),e=d.redMul(p.redISub(t)).redISub(g),i=(i=this.y.redMul(this.z)).redIAdd(i)}return this.curve.jpoint(t,e,i)},s.prototype._threeDbl=function(){var t,e,i;if(this.zOne){var n=this.x.redSqr(),r=this.y.redSqr(),s=r.redSqr(),o=this.x.redAdd(r).redSqr().redISub(n).redISub(s);o=o.redIAdd(o);var a=n.redAdd(n).redIAdd(n).redIAdd(this.curve.a),h=a.redSqr().redISub(o).redISub(o);t=h;var c=s.redIAdd(s);c=(c=c.redIAdd(c)).redIAdd(c),e=a.redMul(o.redISub(h)).redISub(c),i=this.y.redAdd(this.y)}else{var u=this.z.redSqr(),f=this.y.redSqr(),l=this.x.redMul(f),p=this.x.redSub(u).redMul(this.x.redAdd(u));p=p.redAdd(p).redIAdd(p);var d=l.redIAdd(l),m=(d=d.redIAdd(d)).redAdd(d);t=p.redSqr().redISub(m),i=this.y.redAdd(this.z).redSqr().redISub(f).redISub(u);var g=f.redSqr();g=(g=(g=g.redIAdd(g)).redIAdd(g)).redIAdd(g),e=p.redMul(d.redISub(t)).redISub(g)}return this.curve.jpoint(t,e,i)},s.prototype._dbl=function(){var t=this.curve.a,e=this.x,i=this.y,n=this.z,r=n.redSqr().redSqr(),s=e.redSqr(),o=i.redSqr(),a=s.redAdd(s).redIAdd(s).redIAdd(t.redMul(r)),h=e.redAdd(e),c=(h=h.redIAdd(h)).redMul(o),u=a.redSqr().redISub(c.redAdd(c)),f=c.redISub(u),l=o.redSqr();l=(l=(l=l.redIAdd(l)).redIAdd(l)).redIAdd(l);var p=a.redMul(f).redISub(l),d=i.redAdd(i).redMul(n);return this.curve.jpoint(u,p,d)},s.prototype.trpl=function(){if(!this.curve.zeroA)return this.dbl().add(this);var t=this.x.redSqr(),e=this.y.redSqr(),i=this.z.redSqr(),n=e.redSqr(),r=t.redAdd(t).redIAdd(t),s=r.redSqr(),o=this.x.redAdd(e).redSqr().redISub(t).redISub(n),a=(o=(o=(o=o.redIAdd(o)).redAdd(o).redIAdd(o)).redISub(s)).redSqr(),h=n.redIAdd(n);h=(h=(h=h.redIAdd(h)).redIAdd(h)).redIAdd(h);var c=r.redIAdd(o).redSqr().redISub(s).redISub(a).redISub(h),u=e.redMul(c);u=(u=u.redIAdd(u)).redIAdd(u);var f=this.x.redMul(a).redISub(u);f=(f=f.redIAdd(f)).redIAdd(f);var l=this.y.redMul(c.redMul(h.redISub(c)).redISub(o.redMul(a)));l=(l=(l=l.redIAdd(l)).redIAdd(l)).redIAdd(l);var p=this.z.redAdd(o).redSqr().redISub(i).redISub(a);return this.curve.jpoint(f,l,p)},s.prototype.mul=function(t,e){return t=new h(t,e),this.curve._wnafMul(this,t)},s.prototype.eq=function(t){if("affine"===t.type)return this.eq(t.toJ());if(this===t)return!0;var e=this.z.redSqr(),i=t.z.redSqr();if(0!==this.x.redMul(i).redISub(t.x.redMul(e)).cmpn(0))return!1;var n=e.redMul(this.z),r=i.redMul(t.z);return 0===this.y.redMul(r).redISub(t.y.redMul(n)).cmpn(0)},s.prototype.eqXToP=function(t){var e=this.z.redSqr(),i=t.toRed(this.curve.red).redMul(e);if(0===this.x.cmp(i))return!0;for(var n=t.clone(),r=this.curve.redN.redMul(e);;){if(n.iadd(this.curve.n),n.cmp(this.curve.p)>=0)return!1;if(i.redIAdd(r),0===this.x.cmp(i))return!0}return!1},s.prototype.inspect=function(){return this.isInfinity()?"<EC JPoint Infinity>":"<EC JPoint x: "+this.x.toString(16,2)+" y: "+this.y.toString(16,2)+" z: "+this.z.toString(16,2)+">"},s.prototype.isInfinity=function(){return 0===this.z.cmpn(0)}},function(t,e){"function"==typeof Object.create?t.exports=function(t,e){t.super_=e,t.prototype=Object.create(e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}})}:t.exports=function(t,e){t.super_=e;var i=function(){};i.prototype=e.prototype,t.prototype=new i,t.prototype.constructor=t}},function(t,e,i){"use strict";function n(t){h.call(this,"mont",t),this.a=new o(t.a,16).toRed(this.red),this.b=new o(t.b,16).toRed(this.red),this.i4=new o(4).toRed(this.red).redInvm(),this.two=new o(2).toRed(this.red),this.a24=this.i4.redMul(this.a.redAdd(this.two))}function r(t,e,i){h.BasePoint.call(this,t,"projective"),null===e&&null===i?(this.x=this.curve.one,this.z=this.curve.zero):(this.x=new o(e,16),this.z=new o(i,16),this.x.red||(this.x=this.x.toRed(this.curve.red)),this.z.red||(this.z=this.z.toRed(this.curve.red)))}var s=i(38),o=i(17),a=i(39),h=s.base,c=i(9).utils;a(n,h),t.exports=n,n.prototype.validate=function(t){var e=t.normalize().x,i=e.redSqr(),n=i.redMul(e).redAdd(i.redMul(this.a)).redAdd(e);return 0===n.redSqrt().redSqr().cmp(n)},a(r,h.BasePoint),n.prototype.decodePoint=function(t,e){return this.point(c.toArray(t,e),1)},n.prototype.point=function(t,e){return new r(this,t,e)},n.prototype.pointFromJSON=function(t){return r.fromJSON(this,t)},r.prototype.precompute=function(){},r.prototype._encode=function(){return this.getX().toArray("be",this.curve.p.byteLength())},r.fromJSON=function(t,e){return new r(t,e[0],e[1]||t.one)},r.prototype.inspect=function(){return this.isInfinity()?"<EC Point Infinity>":"<EC Point x: "+this.x.fromRed().toString(16,2)+" z: "+this.z.fromRed().toString(16,2)+">"},r.prototype.isInfinity=function(){return 0===this.z.cmpn(0)},r.prototype.dbl=function(){var t=this.x.redAdd(this.z).redSqr(),e=this.x.redSub(this.z).redSqr(),i=t.redSub(e),n=t.redMul(e),r=i.redMul(e.redAdd(this.curve.a24.redMul(i)));return this.curve.point(n,r)},r.prototype.add=function(){throw new Error("Not supported on Montgomery curve")},r.prototype.diffAdd=function(t,e){var i=this.x.redAdd(this.z),n=this.x.redSub(this.z),r=t.x.redAdd(t.z),s=t.x.redSub(t.z).redMul(i),o=r.redMul(n),a=e.z.redMul(s.redAdd(o).redSqr()),h=e.x.redMul(s.redISub(o).redSqr());return this.curve.point(a,h)},r.prototype.mul=function(t){for(var e=t.clone(),i=this,n=this.curve.point(null,null),r=[];0!==e.cmpn(0);e.iushrn(1))r.push(e.andln(1));for(var s=r.length-1;s>=0;s--)0===r[s]?(i=i.diffAdd(n,this),n=n.dbl()):(n=i.diffAdd(n,this),i=i.dbl());return n},r.prototype.mulAdd=function(){throw new Error("Not supported on Montgomery curve")},r.prototype.jumlAdd=function(){throw new Error("Not supported on Montgomery curve")},r.prototype.eq=function(t){return 0===this.getX().cmp(t.getX())},r.prototype.normalize=function(){return this.x=this.x.redMul(this.z.redInvm()),this.z=this.curve.one,this},r.prototype.getX=function(){return this.normalize(),this.x.fromRed()}},function(t,e,i){"use strict";function n(t){this.twisted=1!=(0|t.a),this.mOneA=this.twisted&&-1==(0|t.a),this.extended=this.mOneA,c.call(this,"edwards",t),this.a=new a(t.a,16).umod(this.red.m),this.a=this.a.toRed(this.red),this.c=new a(t.c,16).toRed(this.red),this.c2=this.c.redSqr(),this.d=new a(t.d,16).toRed(this.red),this.dd=this.d.redAdd(this.d),u(!this.twisted||0===this.c.fromRed().cmpn(1)),this.oneC=1==(0|t.c)}function r(t,e,i,n,r){c.BasePoint.call(this,t,"projective"),null===e&&null===i&&null===n?(this.x=this.curve.zero,this.y=this.curve.one,this.z=this.curve.one,this.t=this.curve.zero,this.zOne=!0):(this.x=new a(e,16),this.y=new a(i,16),this.z=n?new a(n,16):this.curve.one,this.t=r&&new a(r,16),this.x.red||(this.x=this.x.toRed(this.curve.red)),this.y.red||(this.y=this.y.toRed(this.curve.red)),this.z.red||(this.z=this.z.toRed(this.curve.red)),this.t&&!this.t.red&&(this.t=this.t.toRed(this.curve.red)),this.zOne=this.z===this.curve.one,this.curve.extended&&!this.t&&(this.t=this.x.redMul(this.y),this.zOne||(this.t=this.t.redMul(this.z.redInvm()))))}var s=i(38),o=i(9),a=i(17),h=i(39),c=s.base,u=o.utils.assert;h(n,c),t.exports=n,n.prototype._mulA=function(t){return this.mOneA?t.redNeg():this.a.redMul(t)},n.prototype._mulC=function(t){return this.oneC?t:this.c.redMul(t)},n.prototype.jpoint=function(t,e,i,n){return this.point(t,e,i,n)},n.prototype.pointFromX=function(t,e){(t=new a(t,16)).red||(t=t.toRed(this.red));var i=t.redSqr(),n=this.c2.redSub(this.a.redMul(i)),r=this.one.redSub(this.c2.redMul(this.d).redMul(i)),s=n.redMul(r.redInvm()),o=s.redSqrt();if(0!==o.redSqr().redSub(s).cmp(this.zero))throw new Error("invalid point");var h=o.fromRed().isOdd();return(e&&!h||!e&&h)&&(o=o.redNeg()),this.point(t,o)},n.prototype.pointFromY=function(t,e){(t=new a(t,16)).red||(t=t.toRed(this.red));var i=t.redSqr(),n=i.redSub(this.one),r=i.redMul(this.d).redAdd(this.one),s=n.redMul(r.redInvm());if(0===s.cmp(this.zero)){if(e)throw new Error("invalid point");return this.point(this.zero,t)}var o=s.redSqrt();if(0!==o.redSqr().redSub(s).cmp(this.zero))throw new Error("invalid point");return o.isOdd()!==e&&(o=o.redNeg()),this.point(o,t)},n.prototype.validate=function(t){if(t.isInfinity())return!0;t.normalize();var e=t.x.redSqr(),i=t.y.redSqr(),n=e.redMul(this.a).redAdd(i),r=this.c2.redMul(this.one.redAdd(this.d.redMul(e).redMul(i)));return 0===n.cmp(r)},h(r,c.BasePoint),n.prototype.pointFromJSON=function(t){return r.fromJSON(this,t)},n.prototype.point=function(t,e,i,n){return new r(this,t,e,i,n)},r.fromJSON=function(t,e){return new r(t,e[0],e[1],e[2])},r.prototype.inspect=function(){return this.isInfinity()?"<EC Point Infinity>":"<EC Point x: "+this.x.fromRed().toString(16,2)+" y: "+this.y.fromRed().toString(16,2)+" z: "+this.z.fromRed().toString(16,2)+">"},r.prototype.isInfinity=function(){return 0===this.x.cmpn(0)&&0===this.y.cmp(this.z)},r.prototype._extDbl=function(){var t=this.x.redSqr(),e=this.y.redSqr(),i=this.z.redSqr();i=i.redIAdd(i);var n=this.curve._mulA(t),r=this.x.redAdd(this.y).redSqr().redISub(t).redISub(e),s=n.redAdd(e),o=s.redSub(i),a=n.redSub(e),h=r.redMul(o),c=s.redMul(a),u=r.redMul(a),f=o.redMul(s);return this.curve.point(h,c,f,u)},r.prototype._projDbl=function(){var t,e,i,n=this.x.redAdd(this.y).redSqr(),r=this.x.redSqr(),s=this.y.redSqr();if(this.curve.twisted){var o=(c=this.curve._mulA(r)).redAdd(s);if(this.zOne)t=n.redSub(r).redSub(s).redMul(o.redSub(this.curve.two)),e=o.redMul(c.redSub(s)),i=o.redSqr().redSub(o).redSub(o);else{var a=this.z.redSqr(),h=o.redSub(a).redISub(a);t=n.redSub(r).redISub(s).redMul(h),e=o.redMul(c.redSub(s)),i=o.redMul(h)}}else{var c=r.redAdd(s);a=this.curve._mulC(this.c.redMul(this.z)).redSqr(),h=c.redSub(a).redSub(a);t=this.curve._mulC(n.redISub(c)).redMul(h),e=this.curve._mulC(c).redMul(r.redISub(s)),i=c.redMul(h)}return this.curve.point(t,e,i)},r.prototype.dbl=function(){return this.isInfinity()?this:this.curve.extended?this._extDbl():this._projDbl()},r.prototype._extAdd=function(t){var e=this.y.redSub(this.x).redMul(t.y.redSub(t.x)),i=this.y.redAdd(this.x).redMul(t.y.redAdd(t.x)),n=this.t.redMul(this.curve.dd).redMul(t.t),r=this.z.redMul(t.z.redAdd(t.z)),s=i.redSub(e),o=r.redSub(n),a=r.redAdd(n),h=i.redAdd(e),c=s.redMul(o),u=a.redMul(h),f=s.redMul(h),l=o.redMul(a);return this.curve.point(c,u,l,f)},r.prototype._projAdd=function(t){var e,i,n=this.z.redMul(t.z),r=n.redSqr(),s=this.x.redMul(t.x),o=this.y.redMul(t.y),a=this.curve.d.redMul(s).redMul(o),h=r.redSub(a),c=r.redAdd(a),u=this.x.redAdd(this.y).redMul(t.x.redAdd(t.y)).redISub(s).redISub(o),f=n.redMul(h).redMul(u);return this.curve.twisted?(e=n.redMul(c).redMul(o.redSub(this.curve._mulA(s))),i=h.redMul(c)):(e=n.redMul(c).redMul(o.redSub(s)),i=this.curve._mulC(h).redMul(c)),this.curve.point(f,e,i)},r.prototype.add=function(t){return this.isInfinity()?t:t.isInfinity()?this:this.curve.extended?this._extAdd(t):this._projAdd(t)},r.prototype.mul=function(t){return this._hasDoubles(t)?this.curve._fixedNafMul(this,t):this.curve._wnafMul(this,t)},r.prototype.mulAdd=function(t,e,i){return this.curve._wnafMulAdd(1,[this,e],[t,i],2,!1)},r.prototype.jmulAdd=function(t,e,i){return this.curve._wnafMulAdd(1,[this,e],[t,i],2,!0)},r.prototype.normalize=function(){if(this.zOne)return this;var t=this.z.redInvm();return this.x=this.x.redMul(t),this.y=this.y.redMul(t),this.t&&(this.t=this.t.redMul(t)),this.z=this.curve.one,this.zOne=!0,this},r.prototype.neg=function(){return this.curve.point(this.x.redNeg(),this.y,this.z,this.t&&this.t.redNeg())},r.prototype.getX=function(){return this.normalize(),this.x.fromRed()},r.prototype.getY=function(){return this.normalize(),this.y.fromRed()},r.prototype.eq=function(t){return this===t||0===this.getX().cmp(t.getX())&&0===this.getY().cmp(t.getY())},r.prototype.eqXToP=function(t){var e=t.toRed(this.curve.red).redMul(this.z);if(0===this.x.cmp(e))return!0;for(var i=t.clone(),n=this.curve.redN.redMul(this.z);;){if(i.iadd(this.curve.n),i.cmp(this.curve.p)>=0)return!1;if(e.redIAdd(n),0===this.x.cmp(e))return!0}return!1},r.prototype.toP=r.prototype.normalize,r.prototype.mixedAdd=r.prototype.add},function(t,e,i){"use strict";function n(t){"short"===t.type?this.curve=new a.curve.short(t):"edwards"===t.type?this.curve=new a.curve.edwards(t):this.curve=new a.curve.mont(t),this.g=this.curve.g,this.n=this.curve.n,this.hash=t.hash,h(this.g.validate(),"Invalid curve"),h(this.g.mul(this.n).isInfinity(),"Invalid curve, G*N != O")}function r(t,e){Object.defineProperty(s,t,{configurable:!0,enumerable:!0,get:function(){var i=new n(e);return Object.defineProperty(s,t,{configurable:!0,enumerable:!0,value:i}),i}})}var s=e,o=i(55),a=i(9),h=a.utils.assert;s.PresetCurve=n,r("p192",{type:"short",prime:"p192",p:"ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff",a:"ffffffff ffffffff ffffffff fffffffe ffffffff fffffffc",b:"64210519 e59c80e7 0fa7e9ab 72243049 feb8deec c146b9b1",n:"ffffffff ffffffff ffffffff 99def836 146bc9b1 b4d22831",hash:o.sha256,gRed:!1,g:["188da80e b03090f6 7cbf20eb 43a18800 f4ff0afd 82ff1012","07192b95 ffc8da78 631011ed 6b24cdd5 73f977a1 1e794811"]}),r("p224",{type:"short",prime:"p224",p:"ffffffff ffffffff ffffffff ffffffff 00000000 00000000 00000001",a:"ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff fffffffe",b:"b4050a85 0c04b3ab f5413256 5044b0b7 d7bfd8ba 270b3943 2355ffb4",n:"ffffffff ffffffff ffffffff ffff16a2 e0b8f03e 13dd2945 5c5c2a3d",hash:o.sha256,gRed:!1,g:["b70e0cbd 6bb4bf7f 321390b9 4a03c1d3 56c21122 343280d6 115c1d21","bd376388 b5f723fb 4c22dfe6 cd4375a0 5a074764 44d58199 85007e34"]}),r("p256",{type:"short",prime:null,p:"ffffffff 00000001 00000000 00000000 00000000 ffffffff ffffffff ffffffff",a:"ffffffff 00000001 00000000 00000000 00000000 ffffffff ffffffff fffffffc",b:"5ac635d8 aa3a93e7 b3ebbd55 769886bc 651d06b0 cc53b0f6 3bce3c3e 27d2604b",n:"ffffffff 00000000 ffffffff ffffffff bce6faad a7179e84 f3b9cac2 fc632551",hash:o.sha256,gRed:!1,g:["6b17d1f2 e12c4247 f8bce6e5 63a440f2 77037d81 2deb33a0 f4a13945 d898c296","4fe342e2 fe1a7f9b 8ee7eb4a 7c0f9e16 2bce3357 6b315ece cbb64068 37bf51f5"]}),r("p384",{type:"short",prime:null,p:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe ffffffff 00000000 00000000 ffffffff",a:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe ffffffff 00000000 00000000 fffffffc",b:"b3312fa7 e23ee7e4 988e056b e3f82d19 181d9c6e fe814112 0314088f 5013875a c656398d 8a2ed19d 2a85c8ed d3ec2aef",n:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff c7634d81 f4372ddf 581a0db2 48b0a77a ecec196a ccc52973",hash:o.sha384,gRed:!1,g:["aa87ca22 be8b0537 8eb1c71e f320ad74 6e1d3b62 8ba79b98 59f741e0 82542a38 5502f25d bf55296c 3a545e38 72760ab7","3617de4a 96262c6f 5d9e98bf 9292dc29 f8f41dbd 289a147c e9da3113 b5f0b8c0 0a60b1ce 1d7e819d 7a431d7c 90ea0e5f"]}),r("p521",{type:"short",prime:null,p:"000001ff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff",a:"000001ff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffc",b:"00000051 953eb961 8e1c9a1f 929a21a0 b68540ee a2da725b 99b315f3 b8b48991 8ef109e1 56193951 ec7e937b 1652c0bd 3bb1bf07 3573df88 3d2c34f1 ef451fd4 6b503f00",n:"000001ff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffa 51868783 bf2f966b 7fcc0148 f709a5d0 3bb5c9b8 899c47ae bb6fb71e 91386409",hash:o.sha512,gRed:!1,g:["000000c6 858e06b7 0404e9cd 9e3ecb66 2395b442 9c648139 053fb521 f828af60 6b4d3dba a14b5e77 efe75928 fe1dc127 a2ffa8de 3348b3c1 856a429b f97e7e31 c2e5bd66","00000118 39296a78 9a3bc004 5c8a5fb4 2c7d1bd9 98f54449 579b4468 17afbd17 273e662c 97ee7299 5ef42640 c550b901 3fad0761 353c7086 a272c240 88be9476 9fd16650"]}),r("curve25519",{type:"mont",prime:"p25519",p:"7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed",a:"76d06",b:"1",n:"1000000000000000 0000000000000000 14def9dea2f79cd6 5812631a5cf5d3ed",hash:o.sha256,gRed:!1,g:["9"]}),r("ed25519",{type:"edwards",prime:"p25519",p:"7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed",a:"-1",c:"1",d:"52036cee2b6ffe73 8cc740797779e898 00700a4d4141d8ab 75eb4dca135978a3",n:"1000000000000000 0000000000000000 14def9dea2f79cd6 5812631a5cf5d3ed",hash:o.sha256,gRed:!1,g:["216936d3cd6e53fec0a4e231fdd6dc5c692cc7609525a7b2c9562d608f25d51a","6666666666666666666666666666666666666666666666666666666666666658"]});var c;try{c=i(152)}catch(t){c=void 0}r("secp256k1",{type:"short",prime:"k256",p:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe fffffc2f",a:"0",b:"7",n:"ffffffff ffffffff ffffffff fffffffe baaedce6 af48a03b bfd25e8c d0364141",h:"1",hash:o.sha256,beta:"7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee",lambda:"5363ad4cc05c30e0a5261c028812645a122e22ea20816678df02967c1b23bd72",basis:[{a:"3086d221a7d46bcde86c90e49284eb15",b:"-e4437ed6010e88286f547fa90abfe4c3"},{a:"114ca50f7a8e2f3f657c1108d9d44cfd8",b:"3086d221a7d46bcde86c90e49284eb15"}],gRed:!1,g:["79be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798","483ada7726a3c4655da4fbfc0e1108a8fd17b448a68554199c47d08ffb10d4b8",c]})},function(t,e,i){"use strict";e.sha1=i(147),e.sha224=i(148),e.sha256=i(88),e.sha384=i(149),e.sha512=i(89)},function(t,e,i){"use strict";function n(){if(!(this instanceof n))return new n;f.call(this),this.h=[1732584193,4023233417,2562383102,271733878,3285377520],this.W=new Array(80)}var r=i(14),s=i(31),o=i(87),a=r.rotl32,h=r.sum32,c=r.sum32_5,u=o.ft_1,f=s.BlockHash,l=[1518500249,1859775393,2400959708,3395469782];r.inherits(n,f),t.exports=n,n.blockSize=512,n.outSize=160,n.hmacStrength=80,n.padLength=64,n.prototype._update=function(t,e){for(var i=this.W,n=0;n<16;n++)i[n]=t[e+n];for(;n<i.length;n++)i[n]=a(i[n-3]^i[n-8]^i[n-14]^i[n-16],1);var r=this.h[0],s=this.h[1],o=this.h[2],f=this.h[3],p=this.h[4];for(n=0;n<i.length;n++){var d=~~(n/20),m=c(a(r,5),u(d,s,o,f),p,i[n],l[d]);p=f,f=o,o=a(s,30),s=r,r=m}this.h[0]=h(this.h[0],r),this.h[1]=h(this.h[1],s),this.h[2]=h(this.h[2],o),this.h[3]=h(this.h[3],f),this.h[4]=h(this.h[4],p)},n.prototype._digest=function(t){return"hex"===t?r.toHex32(this.h,"big"):r.split32(this.h,"big")}},function(t,e,i){"use strict";function n(){if(!(this instanceof n))return new n;s.call(this),this.h=[3238371032,914150663,812702999,4144912697,4290775857,1750603025,1694076839,3204075428]}var r=i(14),s=i(88);r.inherits(n,s),t.exports=n,n.blockSize=512,n.outSize=224,n.hmacStrength=192,n.padLength=64,n.prototype._digest=function(t){return"hex"===t?r.toHex32(this.h.slice(0,7),"big"):r.split32(this.h.slice(0,7),"big")}},function(t,e,i){"use strict";function n(){if(!(this instanceof n))return new n;s.call(this),this.h=[3418070365,3238371032,1654270250,914150663,2438529370,812702999,355462360,4144912697,1731405415,4290775857,2394180231,1750603025,3675008525,1694076839,1203062813,3204075428]}var r=i(14),s=i(89);r.inherits(n,s),t.exports=n,n.blockSize=1024,n.outSize=384,n.hmacStrength=192,n.padLength=128,n.prototype._digest=function(t){return"hex"===t?r.toHex32(this.h.slice(0,12),"big"):r.split32(this.h.slice(0,12),"big")}},function(t,e,i){"use strict";function n(){if(!(this instanceof n))return new n;f.call(this),this.h=[1732584193,4023233417,2562383102,271733878,3285377520],this.endian="little"}function r(t,e,i,n){return t<=15?e^i^n:t<=31?e&i|~e&n:t<=47?(e|~i)^n:t<=63?e&n|i&~n:e^(i|~n)}var s=i(14),o=i(31),a=s.rotl32,h=s.sum32,c=s.sum32_3,u=s.sum32_4,f=o.BlockHash;s.inherits(n,f),e.ripemd160=n,n.blockSize=512,n.outSize=160,n.hmacStrength=192,n.padLength=64,n.prototype._update=function(t,e){for(var i=this.h[0],n=this.h[1],s=this.h[2],o=this.h[3],f=this.h[4],g=i,y=n,w=s,b=o,v=f,k=0;k<80;k++){var S=h(a(u(i,r(k,n,s,o),t[l[k]+e],function(t){return t<=15?0:t<=31?1518500249:t<=47?1859775393:t<=63?2400959708:2840853838}(k)),d[k]),f);i=f,f=o,o=a(s,10),s=n,n=S,S=h(a(u(g,r(79-k,y,w,b),t[p[k]+e],function(t){return t<=15?1352829926:t<=31?1548603684:t<=47?1836072691:t<=63?2053994217:0}(k)),m[k]),v),g=v,v=b,b=a(w,10),w=y,y=S}S=c(this.h[1],s,b),this.h[1]=c(this.h[2],o,v),this.h[2]=c(this.h[3],f,g),this.h[3]=c(this.h[4],i,y),this.h[4]=c(this.h[0],n,w),this.h[0]=S},n.prototype._digest=function(t){return"hex"===t?s.toHex32(this.h,"little"):s.split32(this.h,"little")};var l=[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8,3,10,14,4,9,15,8,1,2,7,0,6,13,11,5,12,1,9,11,10,0,8,12,4,13,3,7,15,14,5,6,2,4,0,5,9,7,12,2,10,14,1,3,8,11,6,15,13],p=[5,14,7,0,9,2,11,4,13,6,15,8,1,10,3,12,6,11,3,7,0,13,5,10,14,15,8,12,4,9,1,2,15,5,1,3,7,14,6,9,11,8,12,2,10,0,4,13,8,6,4,1,3,11,15,0,5,12,2,13,9,7,10,14,12,15,10,4,1,5,8,7,6,2,13,14,0,3,9,11],d=[11,14,15,12,5,8,7,9,11,13,14,15,6,7,9,8,7,6,8,13,11,9,7,15,7,12,15,9,11,7,13,12,11,13,6,7,14,9,13,15,14,8,13,6,5,12,7,5,11,12,14,15,14,15,9,8,9,14,5,6,8,6,5,12,9,15,5,11,6,8,13,12,5,12,13,14,11,8,5,6],m=[8,9,9,11,13,15,15,5,7,7,8,11,14,14,12,6,9,13,15,7,12,8,9,11,7,7,12,7,6,15,13,11,9,7,15,11,8,6,6,14,12,13,5,14,13,13,7,5,15,5,8,11,14,14,6,14,6,9,12,9,12,5,15,8,8,5,12,9,12,5,14,6,8,13,6,5,15,13,11,11]},function(t,e,i){"use strict";function n(t,e,i){if(!(this instanceof n))return new n(t,e,i);this.Hash=t,this.blockSize=t.blockSize/8,this.outSize=t.outSize/8,this.inner=null,this.outer=null,this._init(r.toArray(e,i))}var r=i(14),s=i(22);t.exports=n,n.prototype._init=function(t){t.length>this.blockSize&&(t=(new this.Hash).update(t).digest()),s(t.length<=this.blockSize);for(var e=t.length;e<this.blockSize;e++)t.push(0);for(e=0;e<t.length;e++)t[e]^=54;for(this.inner=(new this.Hash).update(t),e=0;e<t.length;e++)t[e]^=106;this.outer=(new this.Hash).update(t)},n.prototype.update=function(t,e){return this.inner.update(t,e),this},n.prototype.digest=function(t){return this.outer.update(this.inner.digest()),this.outer.digest(t)}},function(t,e){t.exports={doubles:{step:4,points:[["e60fce93b59e9ec53011aabc21c23e97b2a31369b87a5ae9c44ee89e2a6dec0a","f7e3507399e595929db99f34f57937101296891e44d23f0be1f32cce69616821"],["8282263212c609d9ea2a6e3e172de238d8c39cabd5ac1ca10646e23fd5f51508","11f8a8098557dfe45e8256e830b60ace62d613ac2f7b17bed31b6eaff6e26caf"],["175e159f728b865a72f99cc6c6fc846de0b93833fd2222ed73fce5b551e5b739","d3506e0d9e3c79eba4ef97a51ff71f5eacb5955add24345c6efa6ffee9fed695"],["363d90d447b00c9c99ceac05b6262ee053441c7e55552ffe526bad8f83ff4640","4e273adfc732221953b445397f3363145b9a89008199ecb62003c7f3bee9de9"],["8b4b5f165df3c2be8c6244b5b745638843e4a781a15bcd1b69f79a55dffdf80c","4aad0a6f68d308b4b3fbd7813ab0da04f9e336546162ee56b3eff0c65fd4fd36"],["723cbaa6e5db996d6bf771c00bd548c7b700dbffa6c0e77bcb6115925232fcda","96e867b5595cc498a921137488824d6e2660a0653779494801dc069d9eb39f5f"],["eebfa4d493bebf98ba5feec812c2d3b50947961237a919839a533eca0e7dd7fa","5d9a8ca3970ef0f269ee7edaf178089d9ae4cdc3a711f712ddfd4fdae1de8999"],["100f44da696e71672791d0a09b7bde459f1215a29b3c03bfefd7835b39a48db0","cdd9e13192a00b772ec8f3300c090666b7ff4a18ff5195ac0fbd5cd62bc65a09"],["e1031be262c7ed1b1dc9227a4a04c017a77f8d4464f3b3852c8acde6e534fd2d","9d7061928940405e6bb6a4176597535af292dd419e1ced79a44f18f29456a00d"],["feea6cae46d55b530ac2839f143bd7ec5cf8b266a41d6af52d5e688d9094696d","e57c6b6c97dce1bab06e4e12bf3ecd5c981c8957cc41442d3155debf18090088"],["da67a91d91049cdcb367be4be6ffca3cfeed657d808583de33fa978bc1ec6cb1","9bacaa35481642bc41f463f7ec9780e5dec7adc508f740a17e9ea8e27a68be1d"],["53904faa0b334cdda6e000935ef22151ec08d0f7bb11069f57545ccc1a37b7c0","5bc087d0bc80106d88c9eccac20d3c1c13999981e14434699dcb096b022771c8"],["8e7bcd0bd35983a7719cca7764ca906779b53a043a9b8bcaeff959f43ad86047","10b7770b2a3da4b3940310420ca9514579e88e2e47fd68b3ea10047e8460372a"],["385eed34c1cdff21e6d0818689b81bde71a7f4f18397e6690a841e1599c43862","283bebc3e8ea23f56701de19e9ebf4576b304eec2086dc8cc0458fe5542e5453"],["6f9d9b803ecf191637c73a4413dfa180fddf84a5947fbc9c606ed86c3fac3a7","7c80c68e603059ba69b8e2a30e45c4d47ea4dd2f5c281002d86890603a842160"],["3322d401243c4e2582a2147c104d6ecbf774d163db0f5e5313b7e0e742d0e6bd","56e70797e9664ef5bfb019bc4ddaf9b72805f63ea2873af624f3a2e96c28b2a0"],["85672c7d2de0b7da2bd1770d89665868741b3f9af7643397721d74d28134ab83","7c481b9b5b43b2eb6374049bfa62c2e5e77f17fcc5298f44c8e3094f790313a6"],["948bf809b1988a46b06c9f1919413b10f9226c60f668832ffd959af60c82a0a","53a562856dcb6646dc6b74c5d1c3418c6d4dff08c97cd2bed4cb7f88d8c8e589"],["6260ce7f461801c34f067ce0f02873a8f1b0e44dfc69752accecd819f38fd8e8","bc2da82b6fa5b571a7f09049776a1ef7ecd292238051c198c1a84e95b2b4ae17"],["e5037de0afc1d8d43d8348414bbf4103043ec8f575bfdc432953cc8d2037fa2d","4571534baa94d3b5f9f98d09fb990bddbd5f5b03ec481f10e0e5dc841d755bda"],["e06372b0f4a207adf5ea905e8f1771b4e7e8dbd1c6a6c5b725866a0ae4fce725","7a908974bce18cfe12a27bb2ad5a488cd7484a7787104870b27034f94eee31dd"],["213c7a715cd5d45358d0bbf9dc0ce02204b10bdde2a3f58540ad6908d0559754","4b6dad0b5ae462507013ad06245ba190bb4850f5f36a7eeddff2c27534b458f2"],["4e7c272a7af4b34e8dbb9352a5419a87e2838c70adc62cddf0cc3a3b08fbd53c","17749c766c9d0b18e16fd09f6def681b530b9614bff7dd33e0b3941817dcaae6"],["fea74e3dbe778b1b10f238ad61686aa5c76e3db2be43057632427e2840fb27b6","6e0568db9b0b13297cf674deccb6af93126b596b973f7b77701d3db7f23cb96f"],["76e64113f677cf0e10a2570d599968d31544e179b760432952c02a4417bdde39","c90ddf8dee4e95cf577066d70681f0d35e2a33d2b56d2032b4b1752d1901ac01"],["c738c56b03b2abe1e8281baa743f8f9a8f7cc643df26cbee3ab150242bcbb891","893fb578951ad2537f718f2eacbfbbbb82314eef7880cfe917e735d9699a84c3"],["d895626548b65b81e264c7637c972877d1d72e5f3a925014372e9f6588f6c14b","febfaa38f2bc7eae728ec60818c340eb03428d632bb067e179363ed75d7d991f"],["b8da94032a957518eb0f6433571e8761ceffc73693e84edd49150a564f676e03","2804dfa44805a1e4d7c99cc9762808b092cc584d95ff3b511488e4e74efdf6e7"],["e80fea14441fb33a7d8adab9475d7fab2019effb5156a792f1a11778e3c0df5d","eed1de7f638e00771e89768ca3ca94472d155e80af322ea9fcb4291b6ac9ec78"],["a301697bdfcd704313ba48e51d567543f2a182031efd6915ddc07bbcc4e16070","7370f91cfb67e4f5081809fa25d40f9b1735dbf7c0a11a130c0d1a041e177ea1"],["90ad85b389d6b936463f9d0512678de208cc330b11307fffab7ac63e3fb04ed4","e507a3620a38261affdcbd9427222b839aefabe1582894d991d4d48cb6ef150"],["8f68b9d2f63b5f339239c1ad981f162ee88c5678723ea3351b7b444c9ec4c0da","662a9f2dba063986de1d90c2b6be215dbbea2cfe95510bfdf23cbf79501fff82"],["e4f3fb0176af85d65ff99ff9198c36091f48e86503681e3e6686fd5053231e11","1e63633ad0ef4f1c1661a6d0ea02b7286cc7e74ec951d1c9822c38576feb73bc"],["8c00fa9b18ebf331eb961537a45a4266c7034f2f0d4e1d0716fb6eae20eae29e","efa47267fea521a1a9dc343a3736c974c2fadafa81e36c54e7d2a4c66702414b"],["e7a26ce69dd4829f3e10cec0a9e98ed3143d084f308b92c0997fddfc60cb3e41","2a758e300fa7984b471b006a1aafbb18d0a6b2c0420e83e20e8a9421cf2cfd51"],["b6459e0ee3662ec8d23540c223bcbdc571cbcb967d79424f3cf29eb3de6b80ef","67c876d06f3e06de1dadf16e5661db3c4b3ae6d48e35b2ff30bf0b61a71ba45"],["d68a80c8280bb840793234aa118f06231d6f1fc67e73c5a5deda0f5b496943e8","db8ba9fff4b586d00c4b1f9177b0e28b5b0e7b8f7845295a294c84266b133120"],["324aed7df65c804252dc0270907a30b09612aeb973449cea4095980fc28d3d5d","648a365774b61f2ff130c0c35aec1f4f19213b0c7e332843967224af96ab7c84"],["4df9c14919cde61f6d51dfdbe5fee5dceec4143ba8d1ca888e8bd373fd054c96","35ec51092d8728050974c23a1d85d4b5d506cdc288490192ebac06cad10d5d"],["9c3919a84a474870faed8a9c1cc66021523489054d7f0308cbfc99c8ac1f98cd","ddb84f0f4a4ddd57584f044bf260e641905326f76c64c8e6be7e5e03d4fc599d"],["6057170b1dd12fdf8de05f281d8e06bb91e1493a8b91d4cc5a21382120a959e5","9a1af0b26a6a4807add9a2daf71df262465152bc3ee24c65e899be932385a2a8"],["a576df8e23a08411421439a4518da31880cef0fba7d4df12b1a6973eecb94266","40a6bf20e76640b2c92b97afe58cd82c432e10a7f514d9f3ee8be11ae1b28ec8"],["7778a78c28dec3e30a05fe9629de8c38bb30d1f5cf9a3a208f763889be58ad71","34626d9ab5a5b22ff7098e12f2ff580087b38411ff24ac563b513fc1fd9f43ac"],["928955ee637a84463729fd30e7afd2ed5f96274e5ad7e5cb09eda9c06d903ac","c25621003d3f42a827b78a13093a95eeac3d26efa8a8d83fc5180e935bcd091f"],["85d0fef3ec6db109399064f3a0e3b2855645b4a907ad354527aae75163d82751","1f03648413a38c0be29d496e582cf5663e8751e96877331582c237a24eb1f962"],["ff2b0dce97eece97c1c9b6041798b85dfdfb6d8882da20308f5404824526087e","493d13fef524ba188af4c4dc54d07936c7b7ed6fb90e2ceb2c951e01f0c29907"],["827fbbe4b1e880ea9ed2b2e6301b212b57f1ee148cd6dd28780e5e2cf856e241","c60f9c923c727b0b71bef2c67d1d12687ff7a63186903166d605b68baec293ec"],["eaa649f21f51bdbae7be4ae34ce6e5217a58fdce7f47f9aa7f3b58fa2120e2b3","be3279ed5bbbb03ac69a80f89879aa5a01a6b965f13f7e59d47a5305ba5ad93d"],["e4a42d43c5cf169d9391df6decf42ee541b6d8f0c9a137401e23632dda34d24f","4d9f92e716d1c73526fc99ccfb8ad34ce886eedfa8d8e4f13a7f7131deba9414"],["1ec80fef360cbdd954160fadab352b6b92b53576a88fea4947173b9d4300bf19","aeefe93756b5340d2f3a4958a7abbf5e0146e77f6295a07b671cdc1cc107cefd"],["146a778c04670c2f91b00af4680dfa8bce3490717d58ba889ddb5928366642be","b318e0ec3354028add669827f9d4b2870aaa971d2f7e5ed1d0b297483d83efd0"],["fa50c0f61d22e5f07e3acebb1aa07b128d0012209a28b9776d76a8793180eef9","6b84c6922397eba9b72cd2872281a68a5e683293a57a213b38cd8d7d3f4f2811"],["da1d61d0ca721a11b1a5bf6b7d88e8421a288ab5d5bba5220e53d32b5f067ec2","8157f55a7c99306c79c0766161c91e2966a73899d279b48a655fba0f1ad836f1"],["a8e282ff0c9706907215ff98e8fd416615311de0446f1e062a73b0610d064e13","7f97355b8db81c09abfb7f3c5b2515888b679a3e50dd6bd6cef7c73111f4cc0c"],["174a53b9c9a285872d39e56e6913cab15d59b1fa512508c022f382de8319497c","ccc9dc37abfc9c1657b4155f2c47f9e6646b3a1d8cb9854383da13ac079afa73"],["959396981943785c3d3e57edf5018cdbe039e730e4918b3d884fdff09475b7ba","2e7e552888c331dd8ba0386a4b9cd6849c653f64c8709385e9b8abf87524f2fd"],["d2a63a50ae401e56d645a1153b109a8fcca0a43d561fba2dbb51340c9d82b151","e82d86fb6443fcb7565aee58b2948220a70f750af484ca52d4142174dcf89405"],["64587e2335471eb890ee7896d7cfdc866bacbdbd3839317b3436f9b45617e073","d99fcdd5bf6902e2ae96dd6447c299a185b90a39133aeab358299e5e9faf6589"],["8481bde0e4e4d885b3a546d3e549de042f0aa6cea250e7fd358d6c86dd45e458","38ee7b8cba5404dd84a25bf39cecb2ca900a79c42b262e556d64b1b59779057e"],["13464a57a78102aa62b6979ae817f4637ffcfed3c4b1ce30bcd6303f6caf666b","69be159004614580ef7e433453ccb0ca48f300a81d0942e13f495a907f6ecc27"],["bc4a9df5b713fe2e9aef430bcc1dc97a0cd9ccede2f28588cada3a0d2d83f366","d3a81ca6e785c06383937adf4b798caa6e8a9fbfa547b16d758d666581f33c1"],["8c28a97bf8298bc0d23d8c749452a32e694b65e30a9472a3954ab30fe5324caa","40a30463a3305193378fedf31f7cc0eb7ae784f0451cb9459e71dc73cbef9482"],["8ea9666139527a8c1dd94ce4f071fd23c8b350c5a4bb33748c4ba111faccae0","620efabbc8ee2782e24e7c0cfb95c5d735b783be9cf0f8e955af34a30e62b945"],["dd3625faef5ba06074669716bbd3788d89bdde815959968092f76cc4eb9a9787","7a188fa3520e30d461da2501045731ca941461982883395937f68d00c644a573"],["f710d79d9eb962297e4f6232b40e8f7feb2bc63814614d692c12de752408221e","ea98e67232d3b3295d3b535532115ccac8612c721851617526ae47a9c77bfc82"]]},naf:{wnd:7,points:[["f9308a019258c31049344f85f89d5229b531c845836f99b08601f113bce036f9","388f7b0f632de8140fe337e62a37f3566500a99934c2231b6cb9fd7584b8e672"],["2f8bde4d1a07209355b4a7250a5c5128e88b84bddc619ab7cba8d569b240efe4","d8ac222636e5e3d6d4dba9dda6c9c426f788271bab0d6840dca87d3aa6ac62d6"],["5cbdf0646e5db4eaa398f365f2ea7a0e3d419b7e0330e39ce92bddedcac4f9bc","6aebca40ba255960a3178d6d861a54dba813d0b813fde7b5a5082628087264da"],["acd484e2f0c7f65309ad178a9f559abde09796974c57e714c35f110dfc27ccbe","cc338921b0a7d9fd64380971763b61e9add888a4375f8e0f05cc262ac64f9c37"],["774ae7f858a9411e5ef4246b70c65aac5649980be5c17891bbec17895da008cb","d984a032eb6b5e190243dd56d7b7b365372db1e2dff9d6a8301d74c9c953c61b"],["f28773c2d975288bc7d1d205c3748651b075fbc6610e58cddeeddf8f19405aa8","ab0902e8d880a89758212eb65cdaf473a1a06da521fa91f29b5cb52db03ed81"],["d7924d4f7d43ea965a465ae3095ff41131e5946f3c85f79e44adbcf8e27e080e","581e2872a86c72a683842ec228cc6defea40af2bd896d3a5c504dc9ff6a26b58"],["defdea4cdb677750a420fee807eacf21eb9898ae79b9768766e4faa04a2d4a34","4211ab0694635168e997b0ead2a93daeced1f4a04a95c0f6cfb199f69e56eb77"],["2b4ea0a797a443d293ef5cff444f4979f06acfebd7e86d277475656138385b6c","85e89bc037945d93b343083b5a1c86131a01f60c50269763b570c854e5c09b7a"],["352bbf4a4cdd12564f93fa332ce333301d9ad40271f8107181340aef25be59d5","321eb4075348f534d59c18259dda3e1f4a1b3b2e71b1039c67bd3d8bcf81998c"],["2fa2104d6b38d11b0230010559879124e42ab8dfeff5ff29dc9cdadd4ecacc3f","2de1068295dd865b64569335bd5dd80181d70ecfc882648423ba76b532b7d67"],["9248279b09b4d68dab21a9b066edda83263c3d84e09572e269ca0cd7f5453714","73016f7bf234aade5d1aa71bdea2b1ff3fc0de2a887912ffe54a32ce97cb3402"],["daed4f2be3a8bf278e70132fb0beb7522f570e144bf615c07e996d443dee8729","a69dce4a7d6c98e8d4a1aca87ef8d7003f83c230f3afa726ab40e52290be1c55"],["c44d12c7065d812e8acf28d7cbb19f9011ecd9e9fdf281b0e6a3b5e87d22e7db","2119a460ce326cdc76c45926c982fdac0e106e861edf61c5a039063f0e0e6482"],["6a245bf6dc698504c89a20cfded60853152b695336c28063b61c65cbd269e6b4","e022cf42c2bd4a708b3f5126f16a24ad8b33ba48d0423b6efd5e6348100d8a82"],["1697ffa6fd9de627c077e3d2fe541084ce13300b0bec1146f95ae57f0d0bd6a5","b9c398f186806f5d27561506e4557433a2cf15009e498ae7adee9d63d01b2396"],["605bdb019981718b986d0f07e834cb0d9deb8360ffb7f61df982345ef27a7479","2972d2de4f8d20681a78d93ec96fe23c26bfae84fb14db43b01e1e9056b8c49"],["62d14dab4150bf497402fdc45a215e10dcb01c354959b10cfe31c7e9d87ff33d","80fc06bd8cc5b01098088a1950eed0db01aa132967ab472235f5642483b25eaf"],["80c60ad0040f27dade5b4b06c408e56b2c50e9f56b9b8b425e555c2f86308b6f","1c38303f1cc5c30f26e66bad7fe72f70a65eed4cbe7024eb1aa01f56430bd57a"],["7a9375ad6167ad54aa74c6348cc54d344cc5dc9487d847049d5eabb0fa03c8fb","d0e3fa9eca8726909559e0d79269046bdc59ea10c70ce2b02d499ec224dc7f7"],["d528ecd9b696b54c907a9ed045447a79bb408ec39b68df504bb51f459bc3ffc9","eecf41253136e5f99966f21881fd656ebc4345405c520dbc063465b521409933"],["49370a4b5f43412ea25f514e8ecdad05266115e4a7ecb1387231808f8b45963","758f3f41afd6ed428b3081b0512fd62a54c3f3afbb5b6764b653052a12949c9a"],["77f230936ee88cbbd73df930d64702ef881d811e0e1498e2f1c13eb1fc345d74","958ef42a7886b6400a08266e9ba1b37896c95330d97077cbbe8eb3c7671c60d6"],["f2dac991cc4ce4b9ea44887e5c7c0bce58c80074ab9d4dbaeb28531b7739f530","e0dedc9b3b2f8dad4da1f32dec2531df9eb5fbeb0598e4fd1a117dba703a3c37"],["463b3d9f662621fb1b4be8fbbe2520125a216cdfc9dae3debcba4850c690d45b","5ed430d78c296c3543114306dd8622d7c622e27c970a1de31cb377b01af7307e"],["f16f804244e46e2a09232d4aff3b59976b98fac14328a2d1a32496b49998f247","cedabd9b82203f7e13d206fcdf4e33d92a6c53c26e5cce26d6579962c4e31df6"],["caf754272dc84563b0352b7a14311af55d245315ace27c65369e15f7151d41d1","cb474660ef35f5f2a41b643fa5e460575f4fa9b7962232a5c32f908318a04476"],["2600ca4b282cb986f85d0f1709979d8b44a09c07cb86d7c124497bc86f082120","4119b88753c15bd6a693b03fcddbb45d5ac6be74ab5f0ef44b0be9475a7e4b40"],["7635ca72d7e8432c338ec53cd12220bc01c48685e24f7dc8c602a7746998e435","91b649609489d613d1d5e590f78e6d74ecfc061d57048bad9e76f302c5b9c61"],["754e3239f325570cdbbf4a87deee8a66b7f2b33479d468fbc1a50743bf56cc18","673fb86e5bda30fb3cd0ed304ea49a023ee33d0197a695d0c5d98093c536683"],["e3e6bd1071a1e96aff57859c82d570f0330800661d1c952f9fe2694691d9b9e8","59c9e0bba394e76f40c0aa58379a3cb6a5a2283993e90c4167002af4920e37f5"],["186b483d056a033826ae73d88f732985c4ccb1f32ba35f4b4cc47fdcf04aa6eb","3b952d32c67cf77e2e17446e204180ab21fb8090895138b4a4a797f86e80888b"],["df9d70a6b9876ce544c98561f4be4f725442e6d2b737d9c91a8321724ce0963f","55eb2dafd84d6ccd5f862b785dc39d4ab157222720ef9da217b8c45cf2ba2417"],["5edd5cc23c51e87a497ca815d5dce0f8ab52554f849ed8995de64c5f34ce7143","efae9c8dbc14130661e8cec030c89ad0c13c66c0d17a2905cdc706ab7399a868"],["290798c2b6476830da12fe02287e9e777aa3fba1c355b17a722d362f84614fba","e38da76dcd440621988d00bcf79af25d5b29c094db2a23146d003afd41943e7a"],["af3c423a95d9f5b3054754efa150ac39cd29552fe360257362dfdecef4053b45","f98a3fd831eb2b749a93b0e6f35cfb40c8cd5aa667a15581bc2feded498fd9c6"],["766dbb24d134e745cccaa28c99bf274906bb66b26dcf98df8d2fed50d884249a","744b1152eacbe5e38dcc887980da38b897584a65fa06cedd2c924f97cbac5996"],["59dbf46f8c94759ba21277c33784f41645f7b44f6c596a58ce92e666191abe3e","c534ad44175fbc300f4ea6ce648309a042ce739a7919798cd85e216c4a307f6e"],["f13ada95103c4537305e691e74e9a4a8dd647e711a95e73cb62dc6018cfd87b8","e13817b44ee14de663bf4bc808341f326949e21a6a75c2570778419bdaf5733d"],["7754b4fa0e8aced06d4167a2c59cca4cda1869c06ebadfb6488550015a88522c","30e93e864e669d82224b967c3020b8fa8d1e4e350b6cbcc537a48b57841163a2"],["948dcadf5990e048aa3874d46abef9d701858f95de8041d2a6828c99e2262519","e491a42537f6e597d5d28a3224b1bc25df9154efbd2ef1d2cbba2cae5347d57e"],["7962414450c76c1689c7b48f8202ec37fb224cf5ac0bfa1570328a8a3d7c77ab","100b610ec4ffb4760d5c1fc133ef6f6b12507a051f04ac5760afa5b29db83437"],["3514087834964b54b15b160644d915485a16977225b8847bb0dd085137ec47ca","ef0afbb2056205448e1652c48e8127fc6039e77c15c2378b7e7d15a0de293311"],["d3cc30ad6b483e4bc79ce2c9dd8bc54993e947eb8df787b442943d3f7b527eaf","8b378a22d827278d89c5e9be8f9508ae3c2ad46290358630afb34db04eede0a4"],["1624d84780732860ce1c78fcbfefe08b2b29823db913f6493975ba0ff4847610","68651cf9b6da903e0914448c6cd9d4ca896878f5282be4c8cc06e2a404078575"],["733ce80da955a8a26902c95633e62a985192474b5af207da6df7b4fd5fc61cd4","f5435a2bd2badf7d485a4d8b8db9fcce3e1ef8e0201e4578c54673bc1dc5ea1d"],["15d9441254945064cf1a1c33bbd3b49f8966c5092171e699ef258dfab81c045c","d56eb30b69463e7234f5137b73b84177434800bacebfc685fc37bbe9efe4070d"],["a1d0fcf2ec9de675b612136e5ce70d271c21417c9d2b8aaaac138599d0717940","edd77f50bcb5a3cab2e90737309667f2641462a54070f3d519212d39c197a629"],["e22fbe15c0af8ccc5780c0735f84dbe9a790badee8245c06c7ca37331cb36980","a855babad5cd60c88b430a69f53a1a7a38289154964799be43d06d77d31da06"],["311091dd9860e8e20ee13473c1155f5f69635e394704eaa74009452246cfa9b3","66db656f87d1f04fffd1f04788c06830871ec5a64feee685bd80f0b1286d8374"],["34c1fd04d301be89b31c0442d3e6ac24883928b45a9340781867d4232ec2dbdf","9414685e97b1b5954bd46f730174136d57f1ceeb487443dc5321857ba73abee"],["f219ea5d6b54701c1c14de5b557eb42a8d13f3abbcd08affcc2a5e6b049b8d63","4cb95957e83d40b0f73af4544cccf6b1f4b08d3c07b27fb8d8c2962a400766d1"],["d7b8740f74a8fbaab1f683db8f45de26543a5490bca627087236912469a0b448","fa77968128d9c92ee1010f337ad4717eff15db5ed3c049b3411e0315eaa4593b"],["32d31c222f8f6f0ef86f7c98d3a3335ead5bcd32abdd94289fe4d3091aa824bf","5f3032f5892156e39ccd3d7915b9e1da2e6dac9e6f26e961118d14b8462e1661"],["7461f371914ab32671045a155d9831ea8793d77cd59592c4340f86cbc18347b5","8ec0ba238b96bec0cbdddcae0aa442542eee1ff50c986ea6b39847b3cc092ff6"],["ee079adb1df1860074356a25aa38206a6d716b2c3e67453d287698bad7b2b2d6","8dc2412aafe3be5c4c5f37e0ecc5f9f6a446989af04c4e25ebaac479ec1c8c1e"],["16ec93e447ec83f0467b18302ee620f7e65de331874c9dc72bfd8616ba9da6b5","5e4631150e62fb40d0e8c2a7ca5804a39d58186a50e497139626778e25b0674d"],["eaa5f980c245f6f038978290afa70b6bd8855897f98b6aa485b96065d537bd99","f65f5d3e292c2e0819a528391c994624d784869d7e6ea67fb18041024edc07dc"],["78c9407544ac132692ee1910a02439958ae04877151342ea96c4b6b35a49f51","f3e0319169eb9b85d5404795539a5e68fa1fbd583c064d2462b675f194a3ddb4"],["494f4be219a1a77016dcd838431aea0001cdc8ae7a6fc688726578d9702857a5","42242a969283a5f339ba7f075e36ba2af925ce30d767ed6e55f4b031880d562c"],["a598a8030da6d86c6bc7f2f5144ea549d28211ea58faa70ebf4c1e665c1fe9b5","204b5d6f84822c307e4b4a7140737aec23fc63b65b35f86a10026dbd2d864e6b"],["c41916365abb2b5d09192f5f2dbeafec208f020f12570a184dbadc3e58595997","4f14351d0087efa49d245b328984989d5caf9450f34bfc0ed16e96b58fa9913"],["841d6063a586fa475a724604da03bc5b92a2e0d2e0a36acfe4c73a5514742881","73867f59c0659e81904f9a1c7543698e62562d6744c169ce7a36de01a8d6154"],["5e95bb399a6971d376026947f89bde2f282b33810928be4ded112ac4d70e20d5","39f23f366809085beebfc71181313775a99c9aed7d8ba38b161384c746012865"],["36e4641a53948fd476c39f8a99fd974e5ec07564b5315d8bf99471bca0ef2f66","d2424b1b1abe4eb8164227b085c9aa9456ea13493fd563e06fd51cf5694c78fc"],["336581ea7bfbbb290c191a2f507a41cf5643842170e914faeab27c2c579f726","ead12168595fe1be99252129b6e56b3391f7ab1410cd1e0ef3dcdcabd2fda224"],["8ab89816dadfd6b6a1f2634fcf00ec8403781025ed6890c4849742706bd43ede","6fdcef09f2f6d0a044e654aef624136f503d459c3e89845858a47a9129cdd24e"],["1e33f1a746c9c5778133344d9299fcaa20b0938e8acff2544bb40284b8c5fb94","60660257dd11b3aa9c8ed618d24edff2306d320f1d03010e33a7d2057f3b3b6"],["85b7c1dcb3cec1b7ee7f30ded79dd20a0ed1f4cc18cbcfcfa410361fd8f08f31","3d98a9cdd026dd43f39048f25a8847f4fcafad1895d7a633c6fed3c35e999511"],["29df9fbd8d9e46509275f4b125d6d45d7fbe9a3b878a7af872a2800661ac5f51","b4c4fe99c775a606e2d8862179139ffda61dc861c019e55cd2876eb2a27d84b"],["a0b1cae06b0a847a3fea6e671aaf8adfdfe58ca2f768105c8082b2e449fce252","ae434102edde0958ec4b19d917a6a28e6b72da1834aff0e650f049503a296cf2"],["4e8ceafb9b3e9a136dc7ff67e840295b499dfb3b2133e4ba113f2e4c0e121e5","cf2174118c8b6d7a4b48f6d534ce5c79422c086a63460502b827ce62a326683c"],["d24a44e047e19b6f5afb81c7ca2f69080a5076689a010919f42725c2b789a33b","6fb8d5591b466f8fc63db50f1c0f1c69013f996887b8244d2cdec417afea8fa3"],["ea01606a7a6c9cdd249fdfcfacb99584001edd28abbab77b5104e98e8e3b35d4","322af4908c7312b0cfbfe369f7a7b3cdb7d4494bc2823700cfd652188a3ea98d"],["af8addbf2b661c8a6c6328655eb96651252007d8c5ea31be4ad196de8ce2131f","6749e67c029b85f52a034eafd096836b2520818680e26ac8f3dfbcdb71749700"],["e3ae1974566ca06cc516d47e0fb165a674a3dabcfca15e722f0e3450f45889","2aeabe7e4531510116217f07bf4d07300de97e4874f81f533420a72eeb0bd6a4"],["591ee355313d99721cf6993ffed1e3e301993ff3ed258802075ea8ced397e246","b0ea558a113c30bea60fc4775460c7901ff0b053d25ca2bdeee98f1a4be5d196"],["11396d55fda54c49f19aa97318d8da61fa8584e47b084945077cf03255b52984","998c74a8cd45ac01289d5833a7beb4744ff536b01b257be4c5767bea93ea57a4"],["3c5d2a1ba39c5a1790000738c9e0c40b8dcdfd5468754b6405540157e017aa7a","b2284279995a34e2f9d4de7396fc18b80f9b8b9fdd270f6661f79ca4c81bd257"],["cc8704b8a60a0defa3a99a7299f2e9c3fbc395afb04ac078425ef8a1793cc030","bdd46039feed17881d1e0862db347f8cf395b74fc4bcdc4e940b74e3ac1f1b13"],["c533e4f7ea8555aacd9777ac5cad29b97dd4defccc53ee7ea204119b2889b197","6f0a256bc5efdf429a2fb6242f1a43a2d9b925bb4a4b3a26bb8e0f45eb596096"],["c14f8f2ccb27d6f109f6d08d03cc96a69ba8c34eec07bbcf566d48e33da6593","c359d6923bb398f7fd4473e16fe1c28475b740dd098075e6c0e8649113dc3a38"],["a6cbc3046bc6a450bac24789fa17115a4c9739ed75f8f21ce441f72e0b90e6ef","21ae7f4680e889bb130619e2c0f95a360ceb573c70603139862afd617fa9b9f"],["347d6d9a02c48927ebfb86c1359b1caf130a3c0267d11ce6344b39f99d43cc38","60ea7f61a353524d1c987f6ecec92f086d565ab687870cb12689ff1e31c74448"],["da6545d2181db8d983f7dcb375ef5866d47c67b1bf31c8cf855ef7437b72656a","49b96715ab6878a79e78f07ce5680c5d6673051b4935bd897fea824b77dc208a"],["c40747cc9d012cb1a13b8148309c6de7ec25d6945d657146b9d5994b8feb1111","5ca560753be2a12fc6de6caf2cb489565db936156b9514e1bb5e83037e0fa2d4"],["4e42c8ec82c99798ccf3a610be870e78338c7f713348bd34c8203ef4037f3502","7571d74ee5e0fb92a7a8b33a07783341a5492144cc54bcc40a94473693606437"],["3775ab7089bc6af823aba2e1af70b236d251cadb0c86743287522a1b3b0dedea","be52d107bcfa09d8bcb9736a828cfa7fac8db17bf7a76a2c42ad961409018cf7"],["cee31cbf7e34ec379d94fb814d3d775ad954595d1314ba8846959e3e82f74e26","8fd64a14c06b589c26b947ae2bcf6bfa0149ef0be14ed4d80f448a01c43b1c6d"],["b4f9eaea09b6917619f6ea6a4eb5464efddb58fd45b1ebefcdc1a01d08b47986","39e5c9925b5a54b07433a4f18c61726f8bb131c012ca542eb24a8ac07200682a"],["d4263dfc3d2df923a0179a48966d30ce84e2515afc3dccc1b77907792ebcc60e","62dfaf07a0f78feb30e30d6295853ce189e127760ad6cf7fae164e122a208d54"],["48457524820fa65a4f8d35eb6930857c0032acc0a4a2de422233eeda897612c4","25a748ab367979d98733c38a1fa1c2e7dc6cc07db2d60a9ae7a76aaa49bd0f77"],["dfeeef1881101f2cb11644f3a2afdfc2045e19919152923f367a1767c11cceda","ecfb7056cf1de042f9420bab396793c0c390bde74b4bbdff16a83ae09a9a7517"],["6d7ef6b17543f8373c573f44e1f389835d89bcbc6062ced36c82df83b8fae859","cd450ec335438986dfefa10c57fea9bcc521a0959b2d80bbf74b190dca712d10"],["e75605d59102a5a2684500d3b991f2e3f3c88b93225547035af25af66e04541f","f5c54754a8f71ee540b9b48728473e314f729ac5308b06938360990e2bfad125"],["eb98660f4c4dfaa06a2be453d5020bc99a0c2e60abe388457dd43fefb1ed620c","6cb9a8876d9cb8520609af3add26cd20a0a7cd8a9411131ce85f44100099223e"],["13e87b027d8514d35939f2e6892b19922154596941888336dc3563e3b8dba942","fef5a3c68059a6dec5d624114bf1e91aac2b9da568d6abeb2570d55646b8adf1"],["ee163026e9fd6fe017c38f06a5be6fc125424b371ce2708e7bf4491691e5764a","1acb250f255dd61c43d94ccc670d0f58f49ae3fa15b96623e5430da0ad6c62b2"],["b268f5ef9ad51e4d78de3a750c2dc89b1e626d43505867999932e5db33af3d80","5f310d4b3c99b9ebb19f77d41c1dee018cf0d34fd4191614003e945a1216e423"],["ff07f3118a9df035e9fad85eb6c7bfe42b02f01ca99ceea3bf7ffdba93c4750d","438136d603e858a3a5c440c38eccbaddc1d2942114e2eddd4740d098ced1f0d8"],["8d8b9855c7c052a34146fd20ffb658bea4b9f69e0d825ebec16e8c3ce2b526a1","cdb559eedc2d79f926baf44fb84ea4d44bcf50fee51d7ceb30e2e7f463036758"],["52db0b5384dfbf05bfa9d472d7ae26dfe4b851ceca91b1eba54263180da32b63","c3b997d050ee5d423ebaf66a6db9f57b3180c902875679de924b69d84a7b375"],["e62f9490d3d51da6395efd24e80919cc7d0f29c3f3fa48c6fff543becbd43352","6d89ad7ba4876b0b22c2ca280c682862f342c8591f1daf5170e07bfd9ccafa7d"],["7f30ea2476b399b4957509c88f77d0191afa2ff5cb7b14fd6d8e7d65aaab1193","ca5ef7d4b231c94c3b15389a5f6311e9daff7bb67b103e9880ef4bff637acaec"],["5098ff1e1d9f14fb46a210fada6c903fef0fb7b4a1dd1d9ac60a0361800b7a00","9731141d81fc8f8084d37c6e7542006b3ee1b40d60dfe5362a5b132fd17ddc0"],["32b78c7de9ee512a72895be6b9cbefa6e2f3c4ccce445c96b9f2c81e2778ad58","ee1849f513df71e32efc3896ee28260c73bb80547ae2275ba497237794c8753c"],["e2cb74fddc8e9fbcd076eef2a7c72b0ce37d50f08269dfc074b581550547a4f7","d3aa2ed71c9dd2247a62df062736eb0baddea9e36122d2be8641abcb005cc4a4"],["8438447566d4d7bedadc299496ab357426009a35f235cb141be0d99cd10ae3a8","c4e1020916980a4da5d01ac5e6ad330734ef0d7906631c4f2390426b2edd791f"],["4162d488b89402039b584c6fc6c308870587d9c46f660b878ab65c82c711d67e","67163e903236289f776f22c25fb8a3afc1732f2b84b4e95dbda47ae5a0852649"],["3fad3fa84caf0f34f0f89bfd2dcf54fc175d767aec3e50684f3ba4a4bf5f683d","cd1bc7cb6cc407bb2f0ca647c718a730cf71872e7d0d2a53fa20efcdfe61826"],["674f2600a3007a00568c1a7ce05d0816c1fb84bf1370798f1c69532faeb1a86b","299d21f9413f33b3edf43b257004580b70db57da0b182259e09eecc69e0d38a5"],["d32f4da54ade74abb81b815ad1fb3b263d82d6c692714bcff87d29bd5ee9f08f","f9429e738b8e53b968e99016c059707782e14f4535359d582fc416910b3eea87"],["30e4e670435385556e593657135845d36fbb6931f72b08cb1ed954f1e3ce3ff6","462f9bce619898638499350113bbc9b10a878d35da70740dc695a559eb88db7b"],["be2062003c51cc3004682904330e4dee7f3dcd10b01e580bf1971b04d4cad297","62188bc49d61e5428573d48a74e1c655b1c61090905682a0d5558ed72dccb9bc"],["93144423ace3451ed29e0fb9ac2af211cb6e84a601df5993c419859fff5df04a","7c10dfb164c3425f5c71a3f9d7992038f1065224f72bb9d1d902a6d13037b47c"],["b015f8044f5fcbdcf21ca26d6c34fb8197829205c7b7d2a7cb66418c157b112c","ab8c1e086d04e813744a655b2df8d5f83b3cdc6faa3088c1d3aea1454e3a1d5f"],["d5e9e1da649d97d89e4868117a465a3a4f8a18de57a140d36b3f2af341a21b52","4cb04437f391ed73111a13cc1d4dd0db1693465c2240480d8955e8592f27447a"],["d3ae41047dd7ca065dbf8ed77b992439983005cd72e16d6f996a5316d36966bb","bd1aeb21ad22ebb22a10f0303417c6d964f8cdd7df0aca614b10dc14d125ac46"],["463e2763d885f958fc66cdd22800f0a487197d0a82e377b49f80af87c897b065","bfefacdb0e5d0fd7df3a311a94de062b26b80c61fbc97508b79992671ef7ca7f"],["7985fdfd127c0567c6f53ec1bb63ec3158e597c40bfe747c83cddfc910641917","603c12daf3d9862ef2b25fe1de289aed24ed291e0ec6708703a5bd567f32ed03"],["74a1ad6b5f76e39db2dd249410eac7f99e74c59cb83d2d0ed5ff1543da7703e9","cc6157ef18c9c63cd6193d83631bbea0093e0968942e8c33d5737fd790e0db08"],["30682a50703375f602d416664ba19b7fc9bab42c72747463a71d0896b22f6da3","553e04f6b018b4fa6c8f39e7f311d3176290d0e0f19ca73f17714d9977a22ff8"],["9e2158f0d7c0d5f26c3791efefa79597654e7a2b2464f52b1ee6c1347769ef57","712fcdd1b9053f09003a3481fa7762e9ffd7c8ef35a38509e2fbf2629008373"],["176e26989a43c9cfeba4029c202538c28172e566e3c4fce7322857f3be327d66","ed8cc9d04b29eb877d270b4878dc43c19aefd31f4eee09ee7b47834c1fa4b1c3"],["75d46efea3771e6e68abb89a13ad747ecf1892393dfc4f1b7004788c50374da8","9852390a99507679fd0b86fd2b39a868d7efc22151346e1a3ca4726586a6bed8"],["809a20c67d64900ffb698c4c825f6d5f2310fb0451c869345b7319f645605721","9e994980d9917e22b76b061927fa04143d096ccc54963e6a5ebfa5f3f8e286c1"],["1b38903a43f7f114ed4500b4eac7083fdefece1cf29c63528d563446f972c180","4036edc931a60ae889353f77fd53de4a2708b26b6f5da72ad3394119daf408f9"]]}}},function(t,e,i){"use strict";function n(t){if(!(this instanceof n))return new n(t);"string"==typeof t&&(a(o.curves.hasOwnProperty(t),"Unknown curve "+t),t=o.curves[t]),t instanceof o.curves.PresetCurve&&(t={curve:t}),this.curve=t.curve.curve,this.n=this.curve.n,this.nh=this.n.ushrn(1),this.g=this.curve.g,this.g=t.curve.g,this.g.precompute(t.curve.n.bitLength()+1),this.hash=t.hash||t.curve.hash}var r=i(17),s=i(154),o=i(9),a=o.utils.assert,h=i(155),c=i(67);t.exports=n,n.prototype.keyPair=function(t){return new h(this,t)},n.prototype.keyFromPrivate=function(t,e){return h.fromPrivate(this,t,e)},n.prototype.keyFromPublic=function(t,e){return h.fromPublic(this,t,e)},n.prototype.genKeyPair=function(t){t||(t={});for(var e=new s({hash:this.hash,pers:t.pers,persEnc:t.persEnc||"utf8",entropy:t.entropy||o.rand(this.hash.hmacStrength),entropyEnc:t.entropy&&t.entropyEnc||"utf8",nonce:this.n.toArray()}),i=this.n.byteLength(),n=this.n.sub(new r(2));;){var a=new r(e.generate(i));if(!(a.cmp(n)>0))return a.iaddn(1),this.keyFromPrivate(a)}},n.prototype._truncateToN=function(t,e){var i=8*t.byteLength()-this.n.bitLength();return i>0&&(t=t.ushrn(i)),!e&&t.cmp(this.n)>=0?t.sub(this.n):t},n.prototype.sign=function(t,e,i,n){"object"==typeof i&&(n=i,i=null),n||(n={}),e=this.keyFromPrivate(e,i),t=this._truncateToN(new r(t,16));for(var o=this.n.byteLength(),a=e.getPrivate().toArray("be",o),h=t.toArray("be",o),u=new s({hash:this.hash,entropy:a,nonce:h,pers:n.pers,persEnc:n.persEnc||"utf8"}),f=this.n.sub(new r(1)),l=0;;l++){var p=n.k?n.k(l):new r(u.generate(this.n.byteLength()));if(!((p=this._truncateToN(p,!0)).cmpn(1)<=0||p.cmp(f)>=0)){var d=this.g.mul(p);if(!d.isInfinity()){var m=d.getX(),g=m.umod(this.n);if(0!==g.cmpn(0)){var y=p.invm(this.n).mul(g.mul(e.getPrivate()).iadd(t));if(0!==(y=y.umod(this.n)).cmpn(0)){var w=(d.getY().isOdd()?1:0)|(0!==m.cmp(g)?2:0);return n.canonical&&y.cmp(this.nh)>0&&(y=this.n.sub(y),w^=1),new c({r:g,s:y,recoveryParam:w})}}}}}},n.prototype.verify=function(t,e,i,n){t=this._truncateToN(new r(t,16)),i=this.keyFromPublic(i,n);var s=(e=new c(e,"hex")).r,o=e.s;if(s.cmpn(1)<0||s.cmp(this.n)>=0)return!1;if(o.cmpn(1)<0||o.cmp(this.n)>=0)return!1;var a=o.invm(this.n),h=a.mul(t).umod(this.n),u=a.mul(s).umod(this.n);if(!this.curve._maxwellTrick){return!(f=this.g.mulAdd(h,i.getPublic(),u)).isInfinity()&&0===f.getX().umod(this.n).cmp(s)}var f;return!(f=this.g.jmulAdd(h,i.getPublic(),u)).isInfinity()&&f.eqXToP(s)},n.prototype.recoverPubKey=function(t,e,i,n){a((3&i)===i,"The recovery param is more than two bits"),e=new c(e,n);var s=this.n,o=new r(t),h=e.r,u=e.s,f=1&i,l=i>>1;if(h.cmp(this.curve.p.umod(this.curve.n))>=0&&l)throw new Error("Unable to find sencond key candinate");h=l?this.curve.pointFromX(h.add(this.curve.n),f):this.curve.pointFromX(h,f);var p=e.r.invm(s),d=s.sub(o).mul(p).umod(s),m=u.mul(p).umod(s);return this.g.mulAdd(d,h,m)},n.prototype.getKeyRecoveryParam=function(t,e,i,n){if(null!==(e=new c(e,n)).recoveryParam)return e.recoveryParam;for(var r=0;r<4;r++){var s;try{s=this.recoverPubKey(t,e,r)}catch(t){continue}if(s.eq(i))return r}throw new Error("Unable to find valid recovery factor")}},function(t,e,i){"use strict";function n(t){if(!(this instanceof n))return new n(t);this.hash=t.hash,this.predResist=!!t.predResist,this.outLen=this.hash.outSize,this.minEntropy=t.minEntropy||this.hash.hmacStrength,this._reseed=null,this.reseedInterval=null,this.K=null,this.V=null;var e=s.toArray(t.entropy,t.entropyEnc||"hex"),i=s.toArray(t.nonce,t.nonceEnc||"hex"),r=s.toArray(t.pers,t.persEnc||"hex");o(e.length>=this.minEntropy/8,"Not enough entropy. Minimum is: "+this.minEntropy+" bits"),this._init(e,i,r)}var r=i(55),s=i(86),o=i(22);t.exports=n,n.prototype._init=function(t,e,i){var n=t.concat(e).concat(i);this.K=new Array(this.outLen/8),this.V=new Array(this.outLen/8);for(var r=0;r<this.V.length;r++)this.K[r]=0,this.V[r]=1;this._update(n),this._reseed=1,this.reseedInterval=281474976710656},n.prototype._hmac=function(){return new r.hmac(this.hash,this.K)},n.prototype._update=function(t){var e=this._hmac().update(this.V).update([0]);t&&(e=e.update(t)),this.K=e.digest(),this.V=this._hmac().update(this.V).digest(),t&&(this.K=this._hmac().update(this.V).update([1]).update(t).digest(),this.V=this._hmac().update(this.V).digest())},n.prototype.reseed=function(t,e,i,n){"string"!=typeof e&&(n=i,i=e,e=null),t=s.toArray(t,e),i=s.toArray(i,n),o(t.length>=this.minEntropy/8,"Not enough entropy. Minimum is: "+this.minEntropy+" bits"),this._update(t.concat(i||[])),this._reseed=1},n.prototype.generate=function(t,e,i,n){if(this._reseed>this.reseedInterval)throw new Error("Reseed is required");"string"!=typeof e&&(n=i,i=e,e=null),i&&(i=s.toArray(i,n||"hex"),this._update(i));for(var r=[];r.length<t;)this.V=this._hmac().update(this.V).digest(),r=r.concat(this.V);var o=r.slice(0,t);return this._update(i),this._reseed++,s.encode(o,e)}},function(t,e,i){"use strict";function n(t,e){this.ec=t,this.priv=null,this.pub=null,e.priv&&this._importPrivate(e.priv,e.privEnc),e.pub&&this._importPublic(e.pub,e.pubEnc)}var r=i(17),s=i(9).utils.assert;t.exports=n,n.fromPublic=function(t,e,i){return e instanceof n?e:new n(t,{pub:e,pubEnc:i})},n.fromPrivate=function(t,e,i){return e instanceof n?e:new n(t,{priv:e,privEnc:i})},n.prototype.validate=function(){var t=this.getPublic();return t.isInfinity()?{result:!1,reason:"Invalid public key"}:t.validate()?t.mul(this.ec.curve.n).isInfinity()?{result:!0,reason:null}:{result:!1,reason:"Public key * N != O"}:{result:!1,reason:"Public key is not a point"}},n.prototype.getPublic=function(t,e){return"string"==typeof t&&(e=t,t=null),this.pub||(this.pub=this.ec.g.mul(this.priv)),e?this.pub.encode(e,t):this.pub},n.prototype.getPrivate=function(t){return"hex"===t?this.priv.toString(16,2):this.priv},n.prototype._importPrivate=function(t,e){this.priv=new r(t,e||16),this.priv=this.priv.umod(this.ec.curve.n)},n.prototype._importPublic=function(t,e){if(t.x||t.y)return"mont"===this.ec.curve.type?s(t.x,"Need x coordinate"):"short"!==this.ec.curve.type&&"edwards"!==this.ec.curve.type||s(t.x&&t.y,"Need both x and y coordinate"),void(this.pub=this.ec.curve.point(t.x,t.y));this.pub=this.ec.curve.decodePoint(t,e)},n.prototype.derive=function(t){return t.mul(this.priv).getX()},n.prototype.sign=function(t,e,i){return this.ec.sign(t,this,e,i)},n.prototype.verify=function(t,e){return this.ec.verify(t,e,this)},n.prototype.inspect=function(){return"<Key priv: "+(this.priv&&this.priv.toString(16,2))+" pub: "+(this.pub&&this.pub.inspect())+" >"}},function(t,e,i){"use strict";function n(t){if(a("ed25519"===t,"only tested with ed25519 so far"),!(this instanceof n))return new n(t);t=s.curves[t].curve;this.curve=t,this.g=t.g,this.g.precompute(t.n.bitLength()+1),this.pointClass=t.point().constructor,this.encodingLength=Math.ceil(t.n.bitLength()/8),this.hash=r.sha512}var r=i(55),s=i(9),o=s.utils,a=o.assert,h=o.parseBytes,c=i(157),u=i(158);t.exports=n,n.prototype.sign=function(t,e){t=h(t);var i=this.keyFromSecret(e),n=this.hashInt(i.messagePrefix(),t),r=this.g.mul(n),s=this.encodePoint(r),o=this.hashInt(s,i.pubBytes(),t).mul(i.priv()),a=n.add(o).umod(this.curve.n);return this.makeSignature({R:r,S:a,Rencoded:s})},n.prototype.verify=function(t,e,i){t=h(t),e=this.makeSignature(e);var n=this.keyFromPublic(i),r=this.hashInt(e.Rencoded(),n.pubBytes(),t),s=this.g.mul(e.S());return e.R().add(n.pub().mul(r)).eq(s)},n.prototype.hashInt=function(){for(var t=this.hash(),e=0;e<arguments.length;e++)t.update(arguments[e]);return o.intFromLE(t.digest()).umod(this.curve.n)},n.prototype.keyFromPublic=function(t){return c.fromPublic(this,t)},n.prototype.keyFromSecret=function(t){return c.fromSecret(this,t)},n.prototype.makeSignature=function(t){return t instanceof u?t:new u(this,t)},n.prototype.encodePoint=function(t){var e=t.getY().toArray("le",this.encodingLength);return e[this.encodingLength-1]|=t.getX().isOdd()?128:0,e},n.prototype.decodePoint=function(t){var e=(t=o.parseBytes(t)).length-1,i=t.slice(0,e).concat(-129&t[e]),n=0!=(128&t[e]),r=o.intFromLE(i);return this.curve.pointFromY(r,n)},n.prototype.encodeInt=function(t){return t.toArray("le",this.encodingLength)},n.prototype.decodeInt=function(t){return o.intFromLE(t)},n.prototype.isPoint=function(t){return t instanceof this.pointClass}},function(t,e,i){"use strict";function n(t,e){this.eddsa=t,this._secret=o(e.secret),t.isPoint(e.pub)?this._pub=e.pub:this._pubBytes=o(e.pub)}var r=i(9).utils,s=r.assert,o=r.parseBytes,a=r.cachedProperty;n.fromPublic=function(t,e){return e instanceof n?e:new n(t,{pub:e})},n.fromSecret=function(t,e){return e instanceof n?e:new n(t,{secret:e})},n.prototype.secret=function(){return this._secret},a(n,"pubBytes",function(){return this.eddsa.encodePoint(this.pub())}),a(n,"pub",function(){return this._pubBytes?this.eddsa.decodePoint(this._pubBytes):this.eddsa.g.mul(this.priv())}),a(n,"privBytes",function(){var t=this.eddsa,e=this.hash(),i=t.encodingLength-1,n=e.slice(0,t.encodingLength);return n[0]&=248,n[i]&=127,n[i]|=64,n}),a(n,"priv",function(){return this.eddsa.decodeInt(this.privBytes())}),a(n,"hash",function(){return this.eddsa.hash().update(this.secret()).digest()}),a(n,"messagePrefix",function(){return this.hash().slice(this.eddsa.encodingLength)}),n.prototype.sign=function(t){return s(this._secret,"KeyPair can only verify"),this.eddsa.sign(t,this)},n.prototype.verify=function(t,e){return this.eddsa.verify(t,e,this)},n.prototype.getSecret=function(t){return s(this._secret,"KeyPair is public only"),r.encode(this.secret(),t)},n.prototype.getPublic=function(t){return r.encode(this.pubBytes(),t)},t.exports=n},function(t,e,i){"use strict";function n(t,e){this.eddsa=t,"object"!=typeof e&&(e=h(e)),Array.isArray(e)&&(e={R:e.slice(0,t.encodingLength),S:e.slice(t.encodingLength)}),o(e.R&&e.S,"Signature without R or S"),t.isPoint(e.R)&&(this._R=e.R),e.S instanceof r&&(this._S=e.S),this._Rencoded=Array.isArray(e.R)?e.R:e.Rencoded,this._Sencoded=Array.isArray(e.S)?e.S:e.Sencoded}var r=i(17),s=i(9).utils,o=s.assert,a=s.cachedProperty,h=s.parseBytes;a(n,"S",function(){return this.eddsa.decodeInt(this.Sencoded())}),a(n,"R",function(){return this.eddsa.decodePoint(this.Rencoded())}),a(n,"Rencoded",function(){return this.eddsa.encodePoint(this.R())}),a(n,"Sencoded",function(){return this.eddsa.encodeInt(this.S())}),n.prototype.toBytes=function(){return this.Rencoded().concat(this.Sencoded())},n.prototype.toHex=function(){return s.encode(this.toBytes(),"hex").toUpperCase()},t.exports=n},function(t,e,i){"use strict";function n(t){if(!(this instanceof n))return new n(t);this.network=null,this.outputs=[],this.time=s.now(),this.expires=-1,this.memo=null,this.paymentUrl=null,this.merchantData=null,t&&this.fromOptions(t)}const r=i(0),s=i(1),o=i(13),a=i(81),h=i(82);n.prototype.fromOptions=function(t){if(null!=t.network&&(r("string"==typeof t.network),this.network=t.network),t.outputs){r(Array.isArray(t.outputs));for(const e of t.outputs){const t=new o(e);this.outputs.push(t)}}return null!=t.time&&(r(s.isInt(t.time)),this.time=t.time),null!=t.expires&&(r(s.isInt(t.expires)),this.expires=t.expires),null!=t.memo&&(r("string"==typeof t.memo),this.memo=t.memo),null!=t.paymentUrl&&(r("string"==typeof t.paymentUrl),this.paymentUrl=t.paymentUrl),t.merchantData&&this.setData(t.merchantData),this},n.fromOptions=function(t){return(new n).fromOptions(t)},n.prototype.isExpired=function(){return-1!==this.expires&&s.now()>this.expires},n.prototype.setData=function(t,e){if(null!=t&&!Buffer.isBuffer(t))return"string"!=typeof t?(r(!e||"json"===e),void(this.merchantData=Buffer.from(JSON.stringify(t),"utf8"))):void(this.merchantData=Buffer.from(t,e));this.merchantData=t},n.prototype.getData=function(t){let e=this.merchantData;if(!e)return null;if(!t)return e;if("json"===t){e=e.toString("utf8");try{e=JSON.parse(e)}catch(t){return null}return e}return e.toString(t)},n.prototype.fromRaw=function(t){const e=new a(t);for(this.network=e.readFieldString(1,!0);2===e.nextTag();){const t=new a(e.readFieldBytes(2)),i=new o;i.value=t.readFieldU64(1,!0),i.script.fromRaw(t.readFieldBytes(2,!0)),this.outputs.push(i)}return this.time=e.readFieldU64(3),this.expires=e.readFieldU64(4,!0),this.memo=e.readFieldString(5,!0),this.paymentUrl=e.readFieldString(6,!0),this.merchantData=e.readFieldBytes(7,!0),this},n.fromRaw=function(t,e){return"string"==typeof t&&(t=Buffer.from(t,e)),(new n).fromRaw(t)},n.prototype.toRaw=function(){const t=new h;null!=this.network&&t.writeFieldString(1,this.network);for(const e of this.outputs){const i=new h;i.writeFieldU64(1,e.value),i.writeFieldBytes(2,e.script.toRaw()),t.writeFieldBytes(2,i.render())}return t.writeFieldU64(3,this.time),-1!==this.expires&&t.writeFieldU64(4,this.expires),null!=this.memo&&t.writeFieldString(5,this.memo),null!=this.paymentUrl&&t.writeFieldString(6,this.paymentUrl),this.merchantData&&t.writeFieldString(7,this.merchantData),t.render()},t.exports=n},function(t,e,i){"use strict";function n(t){if(!(this instanceof n))return new n(t);f.call(this),this.options=t,this.network=this.options.network,this.logger=this.options.logger.context("chaindb"),this.db=b(this.options),this.stateCache=new o(this.network),this.state=new s,this.pending=null,this.current=null,this.coinCache=new k(this.options.coinCache,h),this.cacheHash=new k(this.options.entryCache),this.cacheHeight=new k(this.options.entryCache)}function r(t){if(!(this instanceof r))return new r(t);this.network=g.primary,this.spv=!1,this.witness=!0,this.bip91=!1,this.bip148=!1,this.prune=!1,this.indexTX=!0,this.indexAddress=!0,t&&this.fromOptions(t)}function s(){this.tip=m.NULL_HASH,this.tx=0,this.coin=0,this.value=0,this.committed=!1}function o(t){this.network=t,this.bits=[],this.updates=[],this._init()}function a(t,e,i){this.bit=t,this.hash=e,this.state=i}function h(t){return t.length+80}const c=i(0),u=i(1),f=i(10),l=i(2),p=i(4),d=i(20),m=i(3),g=i(6),y=i(29),w=i(91),b=i(92),v=i(200),k=i(57),S=i(51),E=i(21),R=i(11),x=i(104),_=i(162),I=i(50),A=m.U8,O=m.U32;Object.setPrototypeOf(n.prototype,f.prototype),n.layout=v,n.prototype.open=async function(){this.logger.info("Opening ChainDB..."),await this.db.open(),await this.db.checkVersion("V",3);const t=await this.getState();t?(await this.checkGenesis(),await this.verifyFlags(t),await this.verifyDeployments(),this.stateCache=await this.getStateCache(),this.state=t,this.logger.info("ChainDB successfully loaded.")):(await this.saveFlags(),await this.saveDeployments(),await this.saveGenesis(),this.logger.info("ChainDB successfully initialized.")),this.logger.info("Chain State: hash=%s tx=%d coin=%d value=%s.",this.state.rhash(),this.state.tx,this.state.coin,d.wmcc(this.state.value))},n.prototype.close=function(){return this.db.close()},n.prototype.start=function(){return c(!this.current),c(!this.pending),this.current=this.db.batch(),this.pending=this.state.clone(),this.coinCache.start(),this.cacheHash.start(),this.cacheHeight.start(),this.current},n.prototype.put=function(t,e){c(this.current),this.current.put(t,e)},n.prototype.del=function(t){c(this.current),this.current.del(t)},n.prototype.batch=function(){return c(this.current),this.current},n.prototype.drop=function(){const t=this.current;c(this.current),c(this.pending),this.current=null,this.pending=null,this.coinCache.drop(),this.cacheHash.drop(),this.cacheHeight.drop(),this.stateCache.drop(),t.clear()},n.prototype.commit=async function(){c(this.current),c(this.pending);try{await this.current.write()}catch(t){throw this.current=null,this.pending=null,this.coinCache.drop(),this.cacheHash.drop(),this.cacheHeight.drop(),t}this.pending.committed&&(this.state=this.pending),this.current=null,this.pending=null,this.coinCache.commit(),this.cacheHash.commit(),this.cacheHeight.commit(),this.stateCache.commit()},n.prototype.hasCache=function(t){return"number"==typeof t?this.cacheHeight.has(t):(c("string"==typeof t),this.cacheHash.has(t))},n.prototype.getCache=function(t){return"number"==typeof t?this.cacheHeight.get(t):(c("string"==typeof t),this.cacheHash.get(t))},n.prototype.getHeight=async function(t){if("number"==typeof t)return t;if(c("string"==typeof t),t===m.NULL_HASH)return-1;const e=this.cacheHash.get(t);if(e)return e.height;const i=await this.db.get(v.h(t));return i?i.readUInt32LE(0,!0):-1},n.prototype.getHash=async function(t){if("string"==typeof t)return t;if(c("number"==typeof t),t<0)return null;const e=this.cacheHeight.get(t);if(e)return e.hash;const i=await this.db.get(v.H(t));return i?i.toString("hex"):null},n.prototype.getEntryByHeight=async function(t){if(c("number"==typeof t),t<0)return null;const e=this.cacheHeight.get(t);if(e)return e;const i=await this.db.get(v.H(t));if(!i)return null;const n=i.toString("hex"),r=this.state,s=await this.getEntryByHash(n);return s?(this.state===r&&this.cacheHeight.set(s.height,s),s):null},n.prototype.getEntryByHash=async function(t){if(c("string"==typeof t),t===m.NULL_HASH)return null;const e=this.cacheHash.get(t);if(e)return e;const i=await this.db.get(v.e(t));if(!i)return null;const n=x.fromRaw(i);return this.cacheHash.set(n.hash,n),n},n.prototype.getEntry=function(t){return"number"==typeof t?this.getEntryByHeight(t):this.getEntryByHash(t)},n.prototype.hasEntry=async function(t){return-1!==await this.getHeight(t)},n.prototype.getAncestor=async function(t,e){if(e<0)return null;if(c(e>=0),c(e<=t.height),await this.isMainChain(t))return await this.getEntryByHeight(e);for(;t.height!==e;){const e=this.getPrevCache(t);t=e||await this.getPrevious(t),c(t)}return t},n.prototype.getPrevious=function(t){return this.getEntryByHash(t.prevBlock)},n.prototype.getPrevCache=function(t){return this.cacheHash.get(t.prevBlock)||null},n.prototype.getNext=async function(t){const e=await this.getNextHash(t.hash);return e?await this.getEntryByHash(e):null},n.prototype.getNextEntry=async function(t){const e=await this.getEntryByHeight(t.height+1);return e?e.prevBlock!==t.hash?null:e:null},n.prototype.getTip=function(){return this.getEntryByHash(this.state.tip)},n.prototype.getState=async function(){const t=await this.db.get(v.R);return t?s.fromRaw(t):null},n.prototype.saveGenesis=async function(){const t=this.network.genesisBlock,e=S.fromRaw(t,"hex"),i=x.fromBlock(e);this.logger.info("Writing genesis block to ChainDB."),await this.save(i,e,this.verifyGenesis(e))},n.prototype.verifyGenesis=function(t){const e=new y;if(t.txs.length>1)throw new Error("Invalid number of transactions.");const i=t.txs[0];return e.addTX(i,0),e},n.prototype.checkGenesis=async function(){const t=this.network.genesisBlock,e=S.fromRaw(t,"hex"),i=x.fromBlock(e);await this.getTX(e.txs[0].hash("hex"))||await this.putGenesis(e,i)},n.prototype.putGenesis=async function(t,e){this.start();try{await this._putGenesis(t,e)}catch(t){throw this.drop(),t}await this.commit()},n.prototype._putGenesis=async function(t,e){const i=this.verifyGenesis(t);this.logger.info("Rewriting genesis block to ChainDB."),await this.saveBlock(e,t,i),this.emit("rescan")},n.prototype.getFlags=async function(){const t=await this.db.get(v.O);return t?r.fromRaw(t):null},n.prototype.verifyFlags=async function(t){const e=this.options,i=await this.getFlags();let n=!1,r=!1;if(!i)throw new Error("No flags found.");if(e.network!==i.network)throw new Error("Network mismatch for chain.");if(e.spv&&!i.spv)throw new Error("Cannot retroactively enable SPV.");if(!e.spv&&i.spv)throw new Error("Cannot retroactively disable SPV.");if(!i.witness){if(!e.forceFlags)throw new Error("Cannot retroactively enable witness.");n=!0}if(e.bip91!==i.bip91){if(!e.forceFlags)throw new Error("Cannot retroactively alter BIP91 flag.");n=!0}if(e.bip148!==i.bip148){if(!e.forceFlags)throw new Error("Cannot retroactively alter BIP148 flag.");n=!0}if(e.prune&&!i.prune){if(!e.forceFlags)throw new Error("Cannot retroactively prune.");r=!0}if(!e.prune&&i.prune)throw new Error("Cannot retroactively unprune.");if(e.indexTX&&!i.indexTX)throw new Error("Cannot retroactively enable TX indexing.");if(!e.indexTX&&i.indexTX)throw new Error("Cannot retroactively disable TX indexing.");if(e.indexAddress&&!i.indexAddress)throw new Error("Cannot retroactively enable address indexing.");if(!e.indexAddress&&i.indexAddress)throw new Error("Cannot retroactively disable address indexing.");n&&(await this.logger.info("Rewriting chain flags."),await this.saveFlags()),r&&(await this.logger.info("Retroactively pruning chain."),await this.prune(t.tip))},n.prototype.getStateCache=async function(){const t=new o(this.network),e=await this.db.range({gte:v.v(0,m.ZERO_HASH),lte:v.v(255,m.MAX_HASH),values:!0});for(const i of e){const[e,n]=v.vv(i.key),r=i.value[0];t.insert(e,n,r)}return t},n.prototype.saveDeployments=function(){const t=this.db.batch();return this.writeDeployments(t),t.write()},n.prototype.writeDeployments=function(t){const e=new p(1+17*this.network.deploys.length);e.writeU8(this.network.deploys.length);for(const t of this.network.deploys)e.writeU8(t.bit),e.writeU32(t.startTime),e.writeU32(t.timeout),e.writeI32(t.threshold),e.writeI32(t.window);t.put(v.V,e.render())},n.prototype.checkDeployments=async function(){const t=await this.db.get(v.V);c(t,"No deployment table found.");const e=new l(t),i=e.readU8(),n=[];for(let t=0;t<i;t++){const t=e.readU8(),i=e.readU32(),r=e.readU32(),s=e.readI32(),o=e.readI32(),a=this.network.byBit(t);a&&i===a.startTime&&r===a.timeout&&s===a.threshold&&o===a.window||n.push(t)}return n},n.prototype.verifyDeployments=async function(){let t;try{t=await this.checkDeployments()}catch(e){if("EncodingError"!==e.type)throw e;t=[];for(let e=0;e<32;e++)t.push(e)}if(0===t.length)return!0;const e=this.db.batch();for(const i of t)this.logger.warning("Versionbit deployment params modified."),this.logger.warning("Invalidating cache for bit %d.",i),await this.invalidateCache(i,e);return this.writeDeployments(e),await e.write(),!1},n.prototype.invalidateCache=async function(t,e){const i=await this.db.keys({gte:v.v(t,m.ZERO_HASH),lte:v.v(t,m.MAX_HASH)});for(const t of i)e.del(t)},n.prototype.prune=async function(){const t=this.options,e=this.network.block.keepBlocks,i=this.network.block.pruneAfterHeight;if((await this.getFlags()).prune)throw new Error("Chain is already pruned.");const n=await this.getHeight(this.state.tip);if(n<=i+e)return!1;const s=i+1,o=n-e,a=this.db.batch();for(let t=s;t<=o;t++){const e=await this.getHash(t);if(!e)throw new Error(`Cannot find hash for ${t}.`);a.del(v.b(e)),a.del(v.u(e))}try{t.prune=!0;const e=r.fromOptions(t);c(e.prune),a.put(v.O,e.toRaw()),await a.write()}catch(e){throw t.prune=!1,e}return await this.db.compactRange(),!0},n.prototype.getNextHash=async function(t){const e=await this.db.get(v.n(t));return e?e.toString("hex"):null},n.prototype.isMainHash=async function(t){if(c("string"==typeof t),t===m.NULL_HASH)return!1;if(t===this.network.genesis.hash)return!0;if(t===this.state.tip)return!0;const e=this.cacheHash.get(t);if(e){const i=this.cacheHeight.get(e.height);if(i)return i.hash===t}return!!await this.getNextHash(t)},n.prototype.isMainChain=async function(t){if(t.isGenesis())return!0;if(t.hash===this.state.tip)return!0;const e=this.getCache(t.height);return e?t.hash===e.hash:!!await this.getNextHash(t.hash)},n.prototype.getEntries=function(){return this.db.values({gte:v.e(m.ZERO_HASH),lte:v.e(m.MAX_HASH),parse:t=>x.fromRaw(t)})},n.prototype.getTips=function(){return this.db.keys({gte:v.p(m.ZERO_HASH),lte:v.p(m.MAX_HASH),parse:v.pp})},n.prototype.readCoin=async function(t){if(this.options.spv)return null;const{hash:e,index:i}=t,n=t.toKey(),r=this.state,s=this.coinCache.get(n);if(s)return I.fromRaw(s);const o=await this.db.get(v.c(e,i));return o?(r===this.state&&this.coinCache.set(n,o),I.fromRaw(o)):null},n.prototype.getCoin=async function(t,e){const i=new E(t,e),n=await this.readCoin(i);return n?n.toCoin(i):null},n.prototype.hasCoins=async function(t){for(let e=0;e<t.outputs.length;e++){const i=v.c(t.hash(),e);if(await this.db.has(i))return!0}return!1},n.prototype.getCoinView=async function(t){const e=new y;for(const{prevout:i}of t.inputs){const t=await this.readCoin(i);t&&e.addEntry(i,t)}return e},n.prototype.getSpentView=async function(t){const e=await this.getCoinView(t);for(const{prevout:i}of t.inputs){if(e.hasEntry(i))continue;const{hash:t,index:n}=i,r=await this.getMeta(t);if(!r)continue;const{tx:s,height:o}=r;n<s.outputs.length&&e.addIndex(s,n,o)}return e},n.prototype.getUndoCoins=async function(t){const e=await this.db.get(v.u(t));return e?w.fromRaw(e):new w},n.prototype.getBlock=async function(t){const e=await this.getRawBlock(t);return e?S.fromRaw(e):null},n.prototype.getRawBlock=async function(t){if(this.options.spv)return null;const e=await this.getHash(t);return e?await this.db.get(v.b(e)):null},n.prototype.getBlockView=async function(t){const e=new y,i=await this.getUndoCoins(t.hash());if(i.isEmpty())return e;for(let n=t.txs.length-1;n>0;n--){const r=t.txs[n];for(let t=r.inputs.length-1;t>=0;t--){const n=r.inputs[t];i.apply(e,n.prevout)}}return c(i.isEmpty(),"Undo coins data inconsistency."),e},n.prototype.getMeta=async function(t){if(!this.options.indexTX)return null;const e=await this.db.get(v.t(t));return e?_.fromRaw(e):null},n.prototype.getTX=async function(t){const e=await this.getMeta(t);return e?e.tx:null},n.prototype.hasTX=async function(t){return!!this.options.indexTX&&await this.db.has(v.t(t))},n.prototype.getCoinsByAddress=async function(t){if(!this.options.indexAddress)return[];Array.isArray(t)||(t=[t]);const e=[];for(const i of t){const t=R.getHash(i),n=await this.db.keys({gte:v.C(t,m.ZERO_HASH,0),lte:v.C(t,m.MAX_HASH,4294967295),parse:v.Cc});for(const[t,i]of n){const n=await this.getCoin(t,i);c(n),e.push(n)}}return e},n.prototype.getHashesByAddress=async function(t){if(!this.options.indexTX||!this.options.indexAddress)return[];const e=Object.create(null);for(const i of t){const t=R.getHash(i);await this.db.keys({gte:v.T(t,m.ZERO_HASH),lte:v.T(t,m.MAX_HASH),parse:t=>{const i=v.Tt(t);e[i]=!0}})}return Object.keys(e)},n.prototype.getTXByAddress=async function(t){const e=await this.getMetaByAddress(t),i=[];for(const t of e)i.push(t.tx);return i},n.prototype.getMetaByAddress=async function(t){if(!this.options.indexTX||!this.options.indexAddress)return[];Array.isArray(t)||(t=[t]);const e=await this.getHashesByAddress(t),i=[];for(const t of e){const e=await this.getMeta(t);c(e),i.push(e)}return i},n.prototype.scan=async function(t,e,i){null==t&&(t=this.network.genesis.hash),"number"==typeof t?this.logger.info("Scanning from height %d.",t):this.logger.info("Scanning from block %s.",u.revHex(t));let n=await this.getEntry(t);if(!n)return;if(!await this.isMainChain(n))throw new Error("Cannot rescan an alternate chain.");let r=0;for(;n;){const t=await this.getBlock(n.hash),s=[];if(r++,t){this.emit("block scan",n.rhash(),n.height),this.logger.info("Scanning block %s (%d).",n.rhash(),n.height);for(let i=0;i<t.txs.length;i++){const n=t.txs[i];let r=!1;for(let t=0;t<n.outputs.length;t++){const i=n.outputs[t].getHash();if(i&&e.test(i)){const i=E.fromTX(n,t);e.add(i.toRaw()),r=!0}}if(r)s.push(n);else if(0!==i)for(const{prevout:t}of n.inputs)if(e.test(t.toRaw())){s.push(n);break}}await i(n,s),n=await this.getNext(n)}else{if(!this.options.spv&&!this.options.prune)throw new Error("Block not found.");await i(n,s),n=await this.getNext(n)}}this.logger.info("Finished scanning %d blocks.",r)},n.prototype.save=async function(t,e,i){this.start();try{await this._save(t,e,i)}catch(t){throw this.drop(),t}await this.commit()},n.prototype._save=async function(t,e,i){const n=e.hash();this.put(v.h(n),O(t.height)),this.put(v.e(n),t.toRaw()),this.cacheHash.push(t.hash,t),this.del(v.p(t.prevBlock)),this.put(v.p(n),null),this.saveUpdates(),i?(t.isGenesis()||this.put(v.n(t.prevBlock),n),this.put(v.H(t.height),n),this.cacheHeight.push(t.height,t),await this.saveBlock(t,e,i),this.put(v.R,this.pending.commit(n))):await this.saveBlock(t,e)},n.prototype.reconnect=async function(t,e,i){this.start();try{await this._reconnect(t,e,i)}catch(t){throw this.drop(),t}await this.commit()},n.prototype._reconnect=async function(t,e,i){const n=e.hash();c(!t.isGenesis()),this.put(v.n(t.prevBlock),n),this.put(v.H(t.height),n),this.cacheHeight.push(t.height,t),this.cacheHash.push(t.hash,t),this.saveUpdates(),await this.connectBlock(t,e,i),this.put(v.R,this.pending.commit(n))},n.prototype.disconnect=async function(t,e){this.start();let i;try{i=await this._disconnect(t,e)}catch(t){throw this.drop(),t}return await this.commit(),i},n.prototype._disconnect=async function(t,e){this.del(v.n(t.prevBlock)),this.del(v.H(t.height)),this.cacheHeight.unpush(t.height),this.saveUpdates();const i=await this.disconnectBlock(t,e);return this.put(v.R,this.pending.commit(t.prevBlock)),i},n.prototype.saveUpdates=function(){const t=this.stateCache.updates;if(0!==t.length){this.logger.info("Saving %d state cache updates.",t.length);for(const e of t){const{bit:t,hash:i}=e;this.put(v.v(t,i),e.toRaw())}}},n.prototype.reset=async function(t){const e=await this.getEntry(t);if(!e)throw new Error("Block not found.");if(!await this.isMainChain(e))throw new Error("Cannot reset on alternate chain.");if(this.options.prune)throw new Error("Cannot reset when pruned.");await this.removeChains();let i=await this.getTip();for(c(i),this.logger.debug("Resetting main chain to: %s",e.rhash());;){if(this.start(),i.hash===e.hash){this.put(v.R,this.pending.commit(i.hash)),await this.commit();break}c(!i.isGenesis()),this.del(v.p(i.hash)),this.put(v.p(i.prevBlock),null),this.del(v.H(i.height)),this.del(v.h(i.hash)),this.del(v.e(i.hash)),this.del(v.n(i.prevBlock));try{await this.removeBlock(i)}catch(t){throw this.drop(),t}this.put(v.R,this.pending.commit(i.prevBlock)),await this.commit(),this.cacheHeight.remove(i.height),this.cacheHash.remove(i.hash),i=await this.getPrevious(i),c(i)}return i},n.prototype.removeChains=async function(){const t=await this.getTips();this.start();try{for(const e of t)await this._removeChain(e)}catch(t){throw this.drop(),t}await this.commit()},n.prototype._removeChain=async function(t){let e=await this.getEntryByHash(t);if(!e)throw new Error("Alternate chain tip not found.");for(this.logger.debug("Removing alternate chain: %s.",e.rhash());!await this.isMainChain(e);)c(!e.isGenesis()),this.del(v.p(e.hash)),this.del(v.h(e.hash)),this.del(v.e(e.hash)),this.del(v.b(e.hash)),this.cacheHash.unpush(e.hash),e=await this.getPrevious(e),c(e)},n.prototype.saveBlock=async function(t,e,i){const n=e.hash();this.options.spv||(this.put(v.b(n),e.toRaw()),i&&await this.connectBlock(t,e,i))},n.prototype.removeBlock=async function(t){if(this.options.spv)return new y;const e=await this.getBlock(t.hash);if(!e)throw new Error("Block not found.");return this.del(v.b(e.hash())),await this.disconnectBlock(t,e)},n.prototype.saveView=function(t){for(const[e,i]of t.map)for(const[t,n]of i.outputs){if(n.spent){this.del(v.c(e,t)),this.coinCache.unpush(e+t);continue}const i=n.toRaw();this.put(v.c(e,t),i),this.coinCache.push(e+t,i)}},n.prototype.connectBlock=async function(t,e,i){if(this.options.spv)return;const n=e.hash();this.pending.connect(e);for(let n=0;n<e.txs.length;n++){const r=e.txs[n];if(n>0)for(const{prevout:t}of r.inputs)this.pending.spend(i.getOutput(t));for(const t of r.outputs)t.script.isUnspendable()||this.pending.add(t);this.indexTX(r,i,t,n)}this.saveView(i),i.undo.isEmpty()||this.put(v.u(n),i.undo.commit()),await this.pruneBlock(t)},n.prototype.disconnectBlock=async function(t,e){const i=new y;if(this.options.spv)return i;const n=e.hash(),r=await this.getUndoCoins(n);this.pending.disconnect(e);for(let n=e.txs.length-1;n>=0;n--){const s=e.txs[n];if(n>0)for(let t=s.inputs.length-1;t>=0;t--){const{prevout:e}=s.inputs[t];r.apply(i,e),this.pending.add(i.getOutput(e))}i.removeTX(s,t.height);for(let t=s.outputs.length-1;t>=0;t--){const e=s.outputs[t];e.script.isUnspendable()||this.pending.spend(e)}this.unindexTX(s,i)}return c(r.isEmpty(),"Undo coins data inconsistency."),this.saveView(i),this.del(v.u(n)),i},n.prototype.pruneBlock=async function(t){if(this.options.spv)return;if(!this.options.prune)return;const e=t.height-this.network.block.keepBlocks;if(e<=this.network.block.pruneAfterHeight)return;const i=await this.getHash(e);i&&(this.del(v.b(i)),this.del(v.u(i)))},n.prototype.saveFlags=function(){const t=r.fromOptions(this.options);return this.db.put(v.O,t.toRaw())},n.prototype.indexTX=function(t,e,i,n){const r=t.hash();if(this.options.indexTX){const s=_.fromTX(t,i,n);if(this.put(v.t(r),s.toRaw()),this.options.indexAddress){const i=t.getHashes(e);for(const t of i)this.put(v.T(t,r),null)}}if(this.options.indexAddress){if(!t.isCoinbase())for(const{prevout:i}of t.inputs){const t=e.getOutput(i).getHash();t&&this.del(v.C(t,i.hash,i.index))}for(let e=0;e<t.outputs.length;e++){const i=t.outputs[e].getHash();i&&this.put(v.C(i,r,e),null)}}},n.prototype.unindexTX=function(t,e){const i=t.hash();if(this.options.indexTX&&(this.del(v.t(i)),this.options.indexAddress)){const n=t.getHashes(e);for(const t of n)this.del(v.T(t,i))}if(this.options.indexAddress){if(!t.isCoinbase())for(const{prevout:i}of t.inputs){const t=e.getOutput(i).getHash();t&&this.put(v.C(t,i.hash,i.index),null)}for(let e=0;e<t.outputs.length;e++){const n=t.outputs[e].getHash();n&&this.del(v.C(n,i,e))}}},r.prototype.fromOptions=function(t){return this.network=g.get(t.network),null!=t.spv&&(c("boolean"==typeof t.spv),this.spv=t.spv),null!=t.bip91&&(c("boolean"==typeof t.bip91),this.bip91=t.bip91),null!=t.bip148&&(c("boolean"==typeof t.bip148),this.bip148=t.bip148),null!=t.prune&&(c("boolean"==typeof t.prune),this.prune=t.prune),null!=t.indexTX&&(c("boolean"==typeof t.indexTX),this.indexTX=t.indexTX),null!=t.indexAddress&&(c("boolean"==typeof t.indexAddress),this.indexAddress=t.indexAddress),this},r.fromOptions=function(t){return(new r).fromOptions(t)},r.prototype.toRaw=function(){const t=new p(12);let e=0;return this.spv&&(e|=1),this.witness&&(e|=2),this.prune&&(e|=4),this.indexTX&&(e|=8),this.indexAddress&&(e|=16),this.bip91&&(e|=32),this.bip148&&(e|=64),t.writeU32(this.network.magic),t.writeU32(e),t.writeU32(0),t.render()},r.prototype.fromRaw=function(t){const e=new l(t);this.network=g.fromMagic(e.readU32());const i=e.readU32();return this.spv=0!=(1&i),this.witness=0!=(2&i),this.prune=0!=(4&i),this.indexTX=0!=(8&i),this.indexAddress=0!=(16&i),this.bip91=0!=(32&i),this.bip148=0!=(64&i),this},r.fromRaw=function(t){return(new r).fromRaw(t)},s.prototype.rhash=function(){return u.revHex(this.tip)},s.prototype.clone=function(){const t=new s;return t.tip=this.tip,t.tx=this.tx,t.coin=this.coin,t.value=this.value,t},s.prototype.connect=function(t){this.tx+=t.txs.length},s.prototype.disconnect=function(t){this.tx-=t.txs.length},s.prototype.add=function(t){this.coin++,this.value+=t.value},s.prototype.spend=function(t){this.coin--,this.value-=t.value},s.prototype.commit=function(t){return"string"!=typeof t&&(t=t.toString("hex")),this.tip=t,this.committed=!0,this.toRaw()},s.prototype.toRaw=function(){const t=new p(56);return t.writeHash(this.tip),t.writeU64(this.tx),t.writeU64(this.coin),t.writeU64(this.value),t.render()},s.fromRaw=function(t){const e=new s,i=new l(t);return e.tip=i.readHash("hex"),e.tx=i.readU64(),e.coin=i.readU64(),e.value=i.readU64(),e},o.prototype._init=function(){for(let t=0;t<32;t++)this.bits.push(null);for(const{bit:t}of this.network.deploys)c(!this.bits[t]),this.bits[t]=new Map},o.prototype.set=function(t,e,i){const n=this.bits[t];c(n),n.get(e.hash)!==i&&(n.set(e.hash,i),this.updates.push(new a(t,e.hash,i)))},o.prototype.get=function(t,e){const i=this.bits[t];c(i);const n=i.get(e.hash);return null==n?-1:n},o.prototype.commit=function(){this.updates.length=0},o.prototype.drop=function(){for(const{bit:t,hash:e}of this.updates){const i=this.bits[t];c(i),i.delete(e)}this.updates.length=0},o.prototype.insert=function(t,e,i){const n=this.bits[t];c(n),n.set(e,i)},a.prototype.toRaw=function(){return A(this.state)},t.exports=n},function(t,e){t.exports=require("node-x15")},function(t,e,i){"use strict";function n(t){if(!(this instanceof n))return new n(t);this.tx=new o,this.mtime=s.now(),this.height=-1,this.block=null,this.time=0,this.index=-1,t&&this.fromOptions(t)}const r=i(0),s=i(1),o=i(15),a=i(4),h=i(2);n.prototype.fromOptions=function(t){return t.tx&&(r(t.tx instanceof o),this.tx=t.tx),null!=t.mtime&&(r(s.isU32(t.mtime)),this.mtime=t.mtime),null!=t.height&&(r(s.isInt(t.height)),this.height=t.height),void 0!==t.block&&(r(null===t.block||"string"==typeof t.block),this.block=t.block),null!=t.time&&(r(s.isU32(t.time)),this.time=t.time),null!=t.index&&(r(s.isInt(t.index)),this.index=t.index),this},n.fromOptions=function(t){return(new n).fromOptions(t)},n.prototype.fromTX=function(t,e,i){return this.tx=t,e&&(this.height=e.height,this.block=e.hash,this.time=e.time,this.index=i),this},n.fromTX=function(t,e,i){return(new n).fromTX(t,e,i)},n.prototype.inspect=function(){return this.format()},n.prototype.format=function(t){const e=this.tx.format(t,null,this.index);return e.mtime=this.mtime,e.height=this.height,e.block=this.block?s.revHex(this.block):null,e.time=this.time,e},n.prototype.toJSON=function(){return this.getJSON()},n.prototype.getJSON=function(t,e){const i=this.tx.getJSON(t,e,null,this.index);return i.mtime=this.mtime,i.height=this.height,i.block=this.block?s.revHex(this.block):null,i.time=this.time,i},n.prototype.fromJSON=function(t){return this.tx.fromJSON(t),r(s.isU32(t.mtime)),r(s.isInt(t.height)),r(!t.block||"string"==typeof t.block),r(s.isU32(t.time)),r(s.isInt(t.index)),this.mtime=t.mtime,this.height=t.height,this.block=s.revHex(t.block),this.index=t.index,this},n.fromJSON=function(t){return(new n).fromJSON(JSON)},n.prototype.getSize=function(){let t=0;return t+=this.tx.getSize(),t+=4,this.block?(t+=1,t+=32,t+=12):t+=1,t},n.prototype.toRaw=function(){const t=this.getSize(),e=new a(t);return this.tx.toWriter(e),e.writeU32(this.mtime),this.block?(e.writeU8(1),e.writeHash(this.block),e.writeU32(this.height),e.writeU32(this.time),e.writeU32(this.index)):e.writeU8(0),e.render()},n.prototype.fromRaw=function(t){const e=new h(t);return this.tx.fromReader(e),this.mtime=e.readU32(),1===e.readU8()&&(this.block=e.readHash("hex"),this.height=e.readU32(),this.time=e.readU32(),this.index=e.readU32(),2147483647===this.index&&(this.index=-1)),this},n.fromRaw=function(t,e){return"string"==typeof t&&(t=Buffer.from(t,e)),(new n).fromRaw(t)},n.isTXMeta=function(t){return t instanceof n},t.exports=n},function(t,e,i){"use strict";function n(){if(!(this instanceof n))return new n;this.state=new Uint32Array(16),this.stream=new Uint32Array(16),this.bytes=new Uint8Array(this.stream.buffer),h&&(this.bytes=Buffer.allocUnsafe(64)),this.pos=0,this.ivSize=0}function r(t,e,i,n,r){t[e]+=t[i],t[r]=s(t[r]^t[e],16),t[n]+=t[r],t[i]=s(t[i]^t[n],12),t[e]+=t[i],t[r]=s(t[r]^t[e],8),t[n]+=t[r],t[i]=s(t[i]^t[n],7)}function s(t,e){return t<<e|t>>>32-e}const o=i(0),a=i(18).binding,h=0===new Int8Array(new Int16Array([1]).buffer)[0];n.prototype.init=function(t,e,i){t&&this.initKey(t),e&&this.initIV(e,i)},n.prototype.initKey=function(t){this.state[0]=1634760805,this.state[1]=857760878,this.state[2]=2036477234,this.state[3]=1797285236,this.state[4]=t.readUInt32LE(0,!0),this.state[5]=t.readUInt32LE(4,!0),this.state[6]=t.readUInt32LE(8,!0),this.state[7]=t.readUInt32LE(12,!0),this.state[8]=t.readUInt32LE(16,!0),this.state[9]=t.readUInt32LE(20,!0),this.state[10]=t.readUInt32LE(24,!0),this.state[11]=t.readUInt32LE(28,!0),this.state[12]=0,this.pos=4294967295},n.prototype.initIV=function(t,e){8===t.length?(this.state[13]=0,this.state[14]=t.readUInt32LE(0,!0),this.state[15]=t.readUInt32LE(4,!0)):12===t.length?(this.state[13]=t.readUInt32LE(0,!0),this.state[14]=t.readUInt32LE(4,!0),this.state[15]=t.readUInt32LE(8,!0)):o(!1,"Bad iv size."),this.ivSize=8*t.length,this.setCounter(e)},n.prototype.encrypt=function(t){for(let e=0;e<t.length;e++){if(this.pos>=64){for(let t=0;t<16;t++)this.stream[t]=this.state[t];for(let t=0;t<10;t++)r(this.stream,0,4,8,12),r(this.stream,1,5,9,13),r(this.stream,2,6,10,14),r(this.stream,3,7,11,15),r(this.stream,0,5,10,15),r(this.stream,1,6,11,12),r(this.stream,2,7,8,13),r(this.stream,3,4,9,14);for(let t=0;t<16;t++)this.stream[t]+=this.state[t],h&&this.bytes.writeUInt32LE(this.stream[t],4*t,!0);this.state[12]++,0===this.state[12]&&(o(64===this.ivSize,"Counter overflow."),this.state[13]++,o(0!==this.state[13],"Counter overflow.")),this.pos=0}t[e]^=this.bytes[this.pos++]}return t},n.prototype.setCounter=function(t){t||(t=0);const e=t%4294967296,i=(t-e)/4294967296;this.state[12]=e,64===this.ivSize&&(this.state[13]=i)},n.prototype.getCounter=function(){const t=this.state[12],e=this.state[13];return 64===this.ivSize?4294967296*e+t:t},a&&(n=a.ChaCha20),t.exports=n},function(t,e,i){"use strict";function n(){if(!(this instanceof n))return new n;this.r=new Uint16Array(10),this.h=new Uint16Array(10),this.pad=new Uint16Array(8),this.fin=0,this.leftover=0,this.buffer=Buffer.allocUnsafe(16)}const r=i(18).binding;n.prototype.init=function(t){const e=t.readUInt16LE(0,!0),i=t.readUInt16LE(2,!0),n=t.readUInt16LE(4,!0),r=t.readUInt16LE(6,!0),s=t.readUInt16LE(8,!0),o=t.readUInt16LE(10,!0),a=t.readUInt16LE(12,!0),h=t.readUInt16LE(14,!0);this.r[0]=8191&e,this.r[1]=8191&(e>>>13|i<<3),this.r[2]=7939&(i>>>10|n<<6),this.r[3]=8191&(n>>>7|r<<9),this.r[4]=255&(r>>>4|s<<12),this.r[5]=s>>>1&8190,this.r[6]=8191&(s>>>14|o<<2),this.r[7]=8065&(o>>>11|a<<5),this.r[8]=8191&(a>>>8|h<<8),this.r[9]=h>>>5&127;for(let t=0;t<10;t++)this.h[t]=0;for(let e=0;e<8;e++)this.pad[e]=t.readUInt16LE(16+2*e,!0);this.leftover=0,this.fin=0},n.prototype.blocks=function(t,e,i){const n=this.fin?0:2048,r=new Uint32Array(10);for(;e>=16;){const s=t.readUInt16LE(i+0,!0),o=t.readUInt16LE(i+2,!0),a=t.readUInt16LE(i+4,!0),h=t.readUInt16LE(i+6,!0),c=t.readUInt16LE(i+8,!0),u=t.readUInt16LE(i+10,!0),f=t.readUInt16LE(i+12,!0),l=t.readUInt16LE(i+14,!0);this.h[0]+=8191&s,this.h[1]+=8191&(s>>>13|o<<3),this.h[2]+=8191&(o>>>10|a<<6),this.h[3]+=8191&(a>>>7|h<<9),this.h[4]+=8191&(h>>>4|c<<12),this.h[5]+=c>>>1&8191,this.h[6]+=8191&(c>>>14|u<<2),this.h[7]+=8191&(u>>>11|f<<5),this.h[8]+=8191&(f>>>8|l<<8),this.h[9]+=l>>>5|n;let p=0;for(let t=0;t<10;t++){r[t]=p;for(let e=0;e<10;e++){let i=this.h[e];i*=e<=t?this.r[t-e]:5*this.r[t+10-e],r[t]+=i,4===e&&(p=r[t]>>>13,r[t]&=8191)}p+=r[t]>>>13,r[t]&=8191}p=(p<<2)+p,p+=r[0],r[0]=8191&p,p>>>=13,r[1]+=p;for(let t=0;t<10;t++)this.h[t]=r[t];i+=16,e-=16}},n.prototype.update=function(t){let e=t.length,i=0;if(this.leftover){let n=16-this.leftover;n>e&&(n=e);for(let e=0;e<n;e++)this.buffer[this.leftover+e]=t[i+e];if(e-=n,i+=n,this.leftover+=n,this.leftover<16)return;this.blocks(this.buffer,16,0),this.leftover=0}if(e>=16){const n=-16&e;this.blocks(t,n,i),i+=n,e-=n}if(e){for(let n=0;n<e;n++)this.buffer[this.leftover+n]=t[i+n];this.leftover+=e}},n.prototype.finish=function(){const t=Buffer.allocUnsafe(16),e=new Uint16Array(10);if(this.leftover){let t=this.leftover;for(this.buffer[t++]=1;t<16;t++)this.buffer[t]=0;this.fin=1,this.blocks(this.buffer,16,0)}let i=this.h[1]>>>13;this.h[1]&=8191;for(let t=2;t<10;t++)this.h[t]+=i,i=this.h[t]>>>13,this.h[t]&=8191;this.h[0]+=5*i,i=this.h[0]>>>13,this.h[0]&=8191,this.h[1]+=i,i=this.h[1]>>>13,this.h[1]&=8191,this.h[2]+=i,e[0]=this.h[0]+5,i=e[0]>>>13,e[0]&=8191;for(let t=1;t<10;t++)e[t]=this.h[t]+i,i=e[t]>>>13,e[t]&=8191;let n=(1^i)-1;for(let t=0;t<10;t++)e[t]&=n;n=~n;for(let t=0;t<10;t++)this.h[t]=this.h[t]&n|e[t];this.h[0]=65535&(this.h[0]|this.h[1]<<13),this.h[1]=65535&(this.h[1]>>>3|this.h[2]<<10),this.h[2]=65535&(this.h[2]>>>6|this.h[3]<<7),this.h[3]=65535&(this.h[3]>>>9|this.h[4]<<4),this.h[4]=65535&(this.h[4]>>>12|this.h[5]<<1|this.h[6]<<14),this.h[5]=65535&(this.h[6]>>>2|this.h[7]<<11),this.h[6]=65535&(this.h[7]>>>5|this.h[8]<<8),this.h[7]=65535&(this.h[8]>>>8|this.h[9]<<5);let r=this.h[0]+this.pad[0];this.h[0]=r;for(let t=1;t<8;t++)r=this.h[t]+this.pad[t]+(r>>>16),this.h[t]=r;for(let e=0;e<8;e++)t.writeUInt16LE(this.h[e],2*e,!0);for(let t=0;t<10;t++)this.h[t]=0;for(let t=0;t<10;t++)this.r[t]=0;for(let t=0;t<8;t++)this.pad[t]=0;return t},n.auth=function(t,e){const i=new n;return i.init(e),i.update(t),i.finish()},n.verify=function(t,e){let i=0;for(let n=0;n<16;n++)i|=t[n]^e[n];return 0!=(1&(i=i-1>>>31))},r&&(n=r.Poly1305),t.exports=n},function(t,e,i){"use strict";function n(t,e,i){const n=Math.floor(t.length/8),s=a(1936682341,1886610805),o=a(1685025377,1852075885),h=a(1819895653,1852142177),c=a(1952801890,2037671283),u=a(n<<i-32,0),f=a(0,255),l=a.fromRaw(e,0),p=a.fromRaw(e,8),d=s.ixor(l),m=o.ixor(p),g=h.ixor(l),y=c.ixor(p);let w=0;for(let e=0;e<n;e++){const e=a.fromRaw(t,w);w+=8,y.ixor(e),r(d,m,g,y),r(d,m,g,y),d.ixor(e)}switch(7&t.length){case 7:u.hi|=t[w+6]<<16;case 6:u.hi|=t[w+5]<<8;case 5:u.hi|=t[w+4];case 4:u.lo|=t[w+3]<<24;case 3:u.lo|=t[w+2]<<16;case 2:u.lo|=t[w+1]<<8;case 1:u.lo|=t[w]}return y.ixor(u),r(d,m,g,y),r(d,m,g,y),d.ixor(u),g.ixor(f),r(d,m,g,y),r(d,m,g,y),r(d,m,g,y),r(d,m,g,y),d.ixor(m),d.ixor(g),d.ixor(y),[d.hi,d.lo]}function r(t,e,i,n){t.iadd(e),e.irotl(13),e.ixor(t),t.irotl(32),i.iadd(n),n.irotl(16),n.ixor(i),t.iadd(n),n.irotl(21),n.ixor(t),i.iadd(e),e.irotl(17),e.ixor(i),i.irotl(32)}function s(t,e){return n(t,e,56)}function o(t,e){return n(t,e,59)}function a(t,e){if(!(this instanceof a))return new a(t,e);this.hi=0|t,this.lo=0|e}const h=i(18).binding;h&&(s=h.siphash,o=h.siphash256),a.prototype.iadd=function(t){const e=this.lo+t.lo|0,i=e>>31,n=this.lo>>31,r=t.lo>>31,s=1&(n&r|~i&(n^r)),o=(this.hi+t.hi|0)+s;return this.hi=0|o,this.lo=e,this},a.prototype.ixor=function(t){return this.hi^=t.hi,this.lo^=t.lo,this},a.prototype.irotl=function(t){let e=this.hi,i=this.lo,n=this.hi,r=this.lo;return t<32?(e<<=t,e|=i>>>32-t,i<<=t):(e=i<<t-32,i=0),(t=64-t)<32?(r>>>=t,r|=n<<32-t,n>>>=t):(r=n>>>t-32,n=0),this.hi=e|n,this.lo=i|r,this},a.fromRaw=function(t,e){const i=t.readUInt32LE(e,!0);return new a(t.readUInt32LE(e+4,!0),i)},(e=s).siphash=s,e.siphash256=o,t.exports=e},function(t,e,i){"use strict";function n(t){if(!(this instanceof n))return new n(t);w.call(this),this.config=new r(t),this.config.load(),this.server=null,this.io=null,this.sockets=new S,this.channels=new Map,this.routes=new a,this.mounts=[],this.stack=[],this.hooks=[],this._init()}function r(t){if(!(this instanceof r))return new r(t);this.host="127.0.0.1",this.port=8080,this.sockets=!0,this.ssl=!1,this.keyFile=null,this.certFile=null,this.key=null,this.cert=null,this.ca=null,t&&this.fromOptions(t)}function s(t){if(!(this instanceof s))return new s(t);this.keyLimit=100,this.bodyLimit=20<<20,this.contentType=null,this.timeout=1e4,t&&this.fromOptions(t)}function o(t,e,i){if(!(this instanceof o))return new o(t,e,i);this.ctx=null,this.path=null,this.handler=null,this.regex=/^/,this.map=[],this.compiled=!1,t&&(p("object"==typeof t),this.ctx=t),e&&(e instanceof RegExp?this.regex=e:(p("string"==typeof e),p(e.length>0),this.path=e)),p(i),p("function"==typeof i||"object"==typeof i),this.handler=i}function a(){if(!(this instanceof a))return new a;this.get=[],this.post=[],this.put=[],this.del=[]}function h(t,e,i){if(!(this instanceof h))return new h(t,e,i);m.call(this),this.req=null,this.res=null,this.socket=null,this.method="GET",this.headers=Object.create(null),this.contentType="bin",this.url="/",this.pathname="/",this.path=[],this.trailing=!1,this.query=Object.create(null),this.params=Object.create(null),this.body=Object.create(null),this.hasBody=!1,this.username=null,this.readable=!0,this.writable=!1,t&&this.init(t,e,i)}function c(t,e){if(!(this instanceof c))return new c(t,e);m.call(this),this.req=t,this.res=e,this.sent=!1,this.readable=!1,this.writable=!0,this.statusCode=200,this.res.statusCode=200,t&&this.init(t,e)}function u(t,e){if(!(this instanceof u))return new u(t,e);m.call(this),this.context=e,this.socket=t,this.remoteAddress=t.conn.remoteAddress,this.hooks=Object.create(null),this.channels=new Map,this.auth=!1,this.filter=null,this.prev=null,this.next=null,this.init()}function f(t,e){const i=t.split("&"),n=Object.create(null);if(i.length>e)return n;p(!e||i.length<=e,"Too many keys in querystring.");for(const t of i){const e=t.indexOf("=");let i,r;-1===e?(i=t,r=""):(i=t.substring(0,e),r=t.substring(e+1)),0!==(i=l(i)).length&&(0!==(r=l(r)).length&&(n[i]=r))}return n}function l(t){try{t=(t=decodeURIComponent(t)).replace(/\+/g," ")}catch(t){}return t=t.replace(/\0/g,"")}const p=i(0),d=i(33),m=i(10),g=i(73),{StringDecoder:y}=i(167),w=i(30),b=i(1),v=i(16),k=i(74),{List:S,ListItem:E}=i(94),R=i(59),x=i(5),_=i(52);Object.setPrototypeOf(n.prototype,w.prototype),n.prototype._init=function(){const t=this.config.getBackend(),e=this.config.toHTTP();this.server=t.createServer(e),this._initRouter(),this._initSockets(),this.server.on("connection",t=>{t.on("error",e=>{if("Parse Error"===e.message){let t="http_parser.execute failure";t+=` (parsed=${e.bytesParsed||-1}`,t+=` code=${e.code})`,e=new Error(t)}this.emit("error",e);try{t.destroy()}catch(t){}})}),this.server.on("error",t=>{this.emit("error",t)})},n.prototype._initRouter=function(){this.server.on("request",async(t,e)=>{const i=new h(t,e,t.url),n=new c(t,e);i.on("error",()=>{});try{i.pause(),await this.handleRequest(i,n)}catch(t){n.error(t.statusCode||500,t),this.emit("error",t)}})},n.prototype.handleRequest=async function(t,e){if(await this.handleMounts(t,e))return;if(this.emit("request",t,e),await this.handleStack(t,e))return;const i=this.routes.getHandlers(t.method);if(!i)throw new Error(`No routes found for method: ${t.method}.`);for(const n of i){const i=n.match(t.pathname);if(i){if(t.params=i,await this.handleHooks(t,e))return;if(await n.call(t,e))return}}throw new Error(`No routes found for path: ${t.pathname}.`)},n.prototype.cors=function(){return async(t,e)=>{if(e.setHeader("Access-Control-Allow-Origin","*"),e.setHeader("Access-Control-Allow-Credentials","true"),e.setHeader("Access-Control-Allow-Methods","GET,HEAD,PUT,PATCH,POST,DELETE"),e.setHeader("Access-Control-Allow-Headers","Authorization"),"OPTIONS"===t.method)return e.setStatus(200),void e.end()}},n.prototype.basicAuth=function(t){p(t,"Basic auth requires options.");let e=t.username,i=t.password,n=t.realm;null!=e&&(p("string"==typeof e),p(e.length<=255,"Username too long."),p(b.isAscii(e),"Username must be ASCII."),e=x.hash256(Buffer.from(e,"ascii"))),p("string"==typeof i),p(i.length<=255,"Password too long."),p(b.isAscii(i),"Password must be ASCII."),i=x.hash256(Buffer.from(i,"ascii")),n||(n="server"),p("string"==typeof n);const r=t=>{t.setHeader("WWW-Authenticate",`Basic realm="${n}"`),t.setStatus(401),t.end()};return async(t,n)=>{const s=t.headers.authorization;if(!s)return void r(n);if(s.length>674)return void r(n);const o=s.split(" ");if(2!==o.length)return void r(n);const[a,h]=o;if("Basic"!==a)return void r(n);const c=Buffer.from(h,"base64").toString("ascii").split(":"),u=c.shift(),f=c.join(":");if(e){if(u.length>255)return void r(n);const t=Buffer.from(u,"ascii"),i=x.hash256(t);if(!_(i,e))return void r(n)}if(f.length>255)return void r(n);const l=Buffer.from(f,"ascii"),p=x.hash256(l);_(p,i)?t.username=u:r(n)}},n.prototype.bodyParser=function(t){const e=new s(t);return async(t,i)=>{if(!t.hasBody){try{t.resume(),t.body=await this.parseBody(t,e)}finally{t.pause()}t.hasBody=!0}}},n.prototype.parseBody=async function(t,e){let i=Object.create(null);if("GET"===t.method)return i;let n=t.contentType;if(e.contentType&&(n=e.contentType),"bin"===n)return i;const r=await this.readBody(t,"utf8",e);if(!r)return i;switch(n){case"json":if(!(i=JSON.parse(r))||"object"!=typeof i||Array.isArray(i))throw new Error("JSON body must be an object.");break;case"form":i=f(r,e.keyLimit)}return i},n.prototype.readBody=function(t,e,i){return new Promise((n,r)=>this._readBody(t,e,i,n,r))},n.prototype._readBody=function(t,e,i,n,r){const s=new y(e);let o=!1,a=0,h="";const c=()=>{t.removeListener("data",u),t.removeListener("error",f),t.removeListener("end",l),null!=p&&(p=null,clearTimeout(p))},u=t=>{a+=t.length,o=!0,a>i.bodyLimit?r(new Error("Request body overflow.")):h+=s.write(t)},f=t=>{c(),r(t)},l=()=>{c(),n(o?h:null)};let p=setTimeout(()=>{p=null,c(),r(new Error("Request body timed out."))},i.timeout);t.on("data",u),t.on("error",f),t.on("end",l)},n.prototype.jsonRPC=function(t){return async(e,i)=>{if("POST"!==e.method)return;if("/"!==e.pathname)return;if("string"!=typeof e.body.method)return;let n=await t.call(e.body,e.query);n=JSON.stringify(n),n+="\n",i.setHeader("X-Long-Polling","/?longpoll=1"),i.send(200,n,"json")}},n.prototype.handleMounts=async function(t,e){let i=t.url;for(const n of this.mounts){const r=n.handler;if(n.hasPrefix(t.pathname))return p(0===i.indexOf(n.path)),i=i.substring(n.path.length),t=t.rewrite(i),await r.handleRequest(t,e),!0}return!1},n.prototype.handleStack=async function(t,e){for(const i of this.stack)if(i.hasPrefix(t.pathname)&&await i.call(t,e))return!0;return!1},n.prototype.handleHooks=async function(t,e){for(const i of this.hooks)if(i.hasPrefix(t.pathname)&&await i.call(t,e))return!0;return!1},n.prototype._initSockets=function(){if(!this.config.sockets)return;let t;try{t=i(!function(){var t=new Error('Cannot find module "socket.io"');throw t.code="MODULE_NOT_FOUND",t}())}catch(t){}t&&(this.io=new t({transports:["websocket"],serveClient:!1}),this.io.attach(this.server),this.io.on("connection",t=>{this.addSocket(t)}))},n.prototype.to=function(t,...e){const i=this.channels.get(t);if(i){p(i.size>0);for(let t=i.head;t;t=t.next){t.value.emit(...e)}}},n.prototype.all=function(){for(let t=this.sockets.head;t;t=t.next)t.emit.apply(t,arguments)},n.prototype.addSocket=function(t){const e=new u(t,this);e.on("error",t=>{this.emit("error",t)}),e.on("close",()=>{this.removeSocket(e)}),e.on("join channel",t=>{this.joinChannel(e,t)}),e.on("leave channel",t=>{this.leaveChannel(e,t)}),this.sockets.push(e);for(const e of this.mounts)e.handler.addSocket(t);this.emit("socket",e)},n.prototype.removeSocket=function(t){for(const e of t.channels.keys())this.leaveChannel(t,e);p(this.sockets.remove(t))},n.prototype.joinChannel=function(t,e){let i=t.channels.get(e);if(i)return;let n=this.channels.get(e);n||(n=new S,this.channels.set(e,n)),i=new E(t),n.push(i),t.channels.set(e,i)},n.prototype.leaveChannel=function(t,e){const i=t.channels.get(e);if(!i)return;const n=this.channels.get(e);p(n),p(n.remove(i)),0===n.size&&this.channels.delete(e),t.channels.delete(e)},n.prototype.channel=function(t){const e=this.channels.get(t);return e?(p(e.size>0),e):null},n.prototype._open=function(){return this.listen(this.config.port,this.config.host)},n.prototype._close=function(){return new Promise((t,e)=>{if(this.io)return this.server.once("close",t),void this.io.close();this.server.close(i=>{i?e(i):t()})})},n.prototype.mount=function(t,e,i){e||(e=t,t=null),this.mounts.push(new o(i||this,t,e))},n.prototype.use=function(t,e,i){e||(e=t,t=null),this.stack.push(new o(i||this,t,e))},n.prototype.hook=function(t,e,i){e||(e=t,t=null),this.hooks.push(new o(i||this,t,e))},n.prototype.get=function(t,e,i){this.routes.get.push(new o(i||this,t,e))},n.prototype.post=function(t,e,i){this.routes.post.push(new o(i||this,t,e))},n.prototype.put=function(t,e,i){this.routes.put.push(new o(i||this,t,e))},n.prototype.del=function(t,e,i){this.routes.del.push(new o(i||this,t,e))},n.prototype.address=function(){return this.server.address()},n.prototype.listen=function(t,e){return new Promise((i,n)=>{this.server.once("error",n),this.server.listen(t,e,()=>{const t=this.address();this.emit("listening",t),this.server.removeListener("error",n),i(t)})})},r.prototype.fromOptions=function(t){return p(t),null!=t.host&&(p("string"==typeof t.host),this.host=t.host),null!=t.port&&(p(b.isU16(t.port),"Port must be a number."),this.port=t.port),null!=t.sockets&&(p("boolean"==typeof t.sockets),this.sockets=t.sockets),null!=t.prefix&&(p("string"==typeof t.prefix),this.prefix=t.prefix,this.keyFile=d.join(this.prefix,"key.pem"),this.certFile=d.join(this.prefix,"cert.pem")),null!=t.ssl&&(p("boolean"==typeof t.ssl),this.ssl=t.ssl),null!=t.keyFile&&(p("string"==typeof t.keyFile),this.keyFile=t.keyFile),null!=t.certFile&&(p("string"==typeof t.certFile),this.certFile=t.certFile),null!=t.key&&(p("string"==typeof t.key||Buffer.isBuffer(t.key)),this.key=t.key),null!=t.cert&&(p("string"==typeof t.cert||Buffer.isBuffer(t.cert)),this.cert=t.cert),null!=t.ca&&(p(Array.isArray(t.ca)),this.ca=t.ca),this.ssl&&(p(this.key||this.keyFile,"SSL specified with no provided key."),p(this.cert||this.certFile,"SSL specified with no provided cert.")),this},r.prototype.load=function(){this.ssl&&(this.keyFile&&(this.key=R.readFileSync(this.keyFile)),this.certFile&&(this.cert=R.readFileSync(this.certFile)))},r.fromOptions=function(t){return(new r).fromOptions(t)},r.prototype.getBackend=function(){return this.ssl?i(111):i(75)},r.prototype.toHTTP=function(){if(this.ssl)return{key:this.key,cert:this.cert,ca:this.ca}},s.prototype.fromOptions=function(t){return p(t),null!=t.keyLimit&&(p("number"==typeof t.keyLimit),this.keyLimit=t.keyLimit),null!=t.bodyLimit&&(p("number"==typeof t.bodyLimit),this.bodyLimit=t.bodyLimit),null!=t.contentType&&(p("string"==typeof t.contentType),this.contentType=t.contentType),this},o.prototype.compile=function(){let t=this.path;const e=this.map;this.compiled||(this.compiled=!0,t&&(t=(t=(t=(t=(t=t.replace(/(\/[^\/]+)\?/g,"(?:$1)?")).replace(/\.(?!\+)/g,"\\.")).replace(/\*/g,".*?")).replace(/%/g,"\\")).replace(/:(\w+)/g,(t,i)=>(e.push(i),"([^/]+)")),this.regex=new RegExp("^"+t+"$")))},o.prototype.match=function(t){this.compile(),p(this.regex);const e=this.regex.exec(t);if(!e)return null;const i=Object.create(null);for(let t=1;t<e.length;t++){const n=e[t],r=this.map[t-1];r&&(i[r]=n),i[t-1]=n}return i},o.prototype.hasPrefix=function(t){return!this.path||0===t.indexOf(this.path)},o.prototype.call=async function(t,e){return await this.handler.call(this.ctx,t,e),e.sent},a.prototype.getHandlers=function(t){if(!t)return null;switch(t=t.toUpperCase()){case"GET":return this.get;case"POST":return this.post;case"PUT":return this.put;case"DELETE":return this.del;default:return null}},Object.setPrototypeOf(h.prototype,m.prototype),h.prototype.init=function(t,e,i){if(p(t),p(e),this.req=t,this.res=e,this.socket=t.socket,this.method=t.method,this.headers=t.headers,this.contentType=function(t){switch(t=t||"",t=t.split(";")[0],t=t.toLowerCase(),t=t.trim()){case"text/x-json":case"application/json":return"json";case"application/x-www-form-urlencoded":return"form";case"text/html":case"application/xhtml+xml":return"html";case"text/javascript":case"application/javascript":return"js";case"text/css":return"css";case"text/plain":return"txt";case"application/octet-stream":default:return"bin"}}(t.headers["content-type"]),t.on("error",t=>{this.emit("error",t)}),t.on("data",t=>{this.emit("data",t)}),t.on("end",()=>{this.emit("end")}),null!=i)try{this.parse(i)}catch(t){}},h.prototype.parse=function(t){const e=g.parse(t);let i=e.pathname,n=Object.create(null),r=!1;i?("/"!==(i=i.replace(/\/{2,}/g,"/"))[0]&&(i="/"+i),i.length>1&&"/"===i[i.length-1]&&(i=i.slice(0,-1),r=!0),i=l(i=i.replace(/%2f/gi,""))):i="/",p(i.length>0),p("/"===i[0]),i.length>1&&p("/"!==i[i.length-1]);let s=i;"/"===s[0]&&(s=s.substring(1));let o=s.split("/");1===o.length&&0===o[0].length&&(o=[]),t=i,e.search&&e.search.length>1&&(p("?"===e.search[0]),t+=e.search),e.hash&&e.hash.length>1&&(p("#"===e.hash[0]),t+=e.hash),e.query&&(n=f(e.query,100)),this.url=t,this.pathname=i,this.path=o,this.query=n,this.trailing=r},h.prototype.rewrite=function(t){const e=new h;return e.init(this.req,this.res,t),e.body=this.body,e.hasBody=this.hasBody,e},h.prototype.valid=function(){return new k([this.query,this.params,this.body])},h.prototype.pipe=function(t){return this.req.pipe(t)},h.prototype.pause=function(){return this.req.pause()},h.prototype.resume=function(){return this.req.resume()},h.prototype.destroy=function(){return this.req.destroy()},Object.setPrototypeOf(c.prototype,m.prototype),c.prototype.init=function(t,e){p(t),p(e),e.on("error",t=>{this.emit("error",t)}),e.on("drain",()=>{this.emit("drain")}),e.on("close",()=>{this.emit("close")})},c.prototype.setStatus=function(t){this.statusCode=t,this.res.statusCode=t},c.prototype.setType=function(t){this.setHeader("Content-Type",function(t){switch(t){case"json":return"application/json";case"form":return"application/x-www-form-urlencoded; charset=utf-8";case"html":return"text/html; charset=utf-8";case"xml":return"application/xml; charset=utf-8";case"js":return"application/javascript; charset=utf-8";case"css":return"text/css; charset=utf-8";case"txt":return"text/plain; charset=utf-8";case"bin":return"application/octet-stream";default:return t}}(t))},c.prototype.hasType=function(){return null!=this.getHeader("Content-Type")},c.prototype.destroy=function(){return this.res.destroy()},c.prototype.setHeader=function(t,e){return this.res.setHeader(t,e)},c.prototype.getHeader=function(t){return this.res.getHeader(t)},c.prototype.writeHead=function(t,e){return this.res.writeHead(t,e)},c.prototype.write=function(t,e){return this.res.write(t,e)},c.prototype.end=function(t,e){return this.sent=!0,this.res.end(t,e)},c.prototype.error=function(t,e){this.sent||(t||(t=400),this.send(t,{error:{type:e.type||"Error",message:e.message,code:e.code}}))},c.prototype.redirect=function(t,e){e||(e=t,t=301),this.setStatus(t),this.setHeader("Location",e),this.end()},c.prototype.send=function(t,e,i){if(!this.sent)if(p("number"==typeof t,"Code must be a number."),null==e&&(e={error:{type:"Error",message:"No message."}}),e&&"object"==typeof e&&!Buffer.isBuffer(e)&&(e=JSON.stringify(e,null,2)+"\n",i||(i="json"),p("json"===i,"Bad type passed with json object.")),i||this.hasType()||(i="string"==typeof e?"txt":"bin"),this.setStatus(t),i&&this.setType(i),"string"!=typeof e)if(Buffer.isBuffer(e)){this.setHeader("Content-Length",e.length.toString(10));try{this.write(e),this.end()}catch(t){}}else p(!1,"Bad object passed to send.");else{const t=Buffer.byteLength(e,"utf8");this.setHeader("Content-Length",t.toString(10));try{this.write(e,"utf8"),this.end()}catch(t){}}},Object.setPrototypeOf(u.prototype,m.prototype),u.prototype.init=function(){const t=this.socket,e=t.onevent.bind(t);t.onevent=(t=>{const i=e(t);return this.onevent(t),i}),t.on("error",t=>{this.dispatch("error",t)}),t.on("disconnect",()=>{this.dispatch("close")})},u.prototype.onevent=async function(t){const e=(t.data||[]).slice(),i=e.shift()||"";let n;n="function"==typeof e[e.length-1]?e.pop():this.socket.ack(t.id);let r;try{r=await this.fire(i,e)}catch(t){return void n({type:t.type||"Error",message:t.message,code:t.code})}void 0!==r&&n(null,r)},u.prototype.hook=function(t,e){p(!this.hooks[t],"Event already added."),this.hooks[t]=e},u.prototype.fire=async function(t,e){const i=this.hooks[t];if(i)return await i.call(this.context,e)},u.prototype.join=function(t){this.dispatch("join channel",t)},u.prototype.leave=function(t){this.dispatch("leave channel",t)},u.prototype.dispatch=function(){return m.prototype.emit.apply(this,arguments)},u.prototype.emit=function(){return this.socket.emit.apply(this.socket,arguments)},u.prototype.call=function(...t){const e=this.socket;return new Promise((i,n)=>{t.push(v.wrap(i,n)),e.emit(...t)})},u.prototype.destroy=function(){return this.socket.disconnect()},t.exports=n},function(t,e){t.exports=require("string_decoder")},function(t,e){t.exports=require("net")},function(t,e,i){function n(){}function r(t){var i=""+t.type;return e.BINARY_EVENT!==t.type&&e.BINARY_ACK!==t.type||(i+=t.attachments+"-"),t.nsp&&"/"!==t.nsp&&(i+=t.nsp+","),null!=t.id&&(i+=t.id),null!=t.data&&(i+=JSON.stringify(t.data)),c("encoded %j as %s",t,i),i}function s(){this.reconstructor=null}function o(t){var i=0,n={type:Number(t.charAt(0))};if(null==e.types[n.type])return h();if(e.BINARY_EVENT===n.type||e.BINARY_ACK===n.type){for(var r="";"-"!==t.charAt(++i)&&(r+=t.charAt(i),i!=t.length););if(r!=Number(r)||"-"!==t.charAt(i))throw new Error("Illegal attachments");n.attachments=Number(r)}if("/"===t.charAt(i+1))for(n.nsp="";++i;){if(","===(o=t.charAt(i)))break;if(n.nsp+=o,i===t.length)break}else n.nsp="/";var s=t.charAt(i+1);if(""!==s&&Number(s)==s){for(n.id="";++i;){var o;if(null==(o=t.charAt(i))||Number(o)!=o){--i;break}if(n.id+=t.charAt(i),i===t.length)break}n.id=Number(n.id)}return t.charAt(++i)&&(n=function(t,e){try{t.data=JSON.parse(e)}catch(t){return h()}return t}(n,t.substr(i))),c("decoded %s as %j",t,n),n}function a(t){this.reconPack=t,this.buffers=[]}function h(){return{type:e.ERROR,data:"parser error"}}var c=i(45)("socket.io-parser"),u=i(76),f=i(278),l=i(279),p=i(216);e.protocol=4,e.types=["CONNECT","DISCONNECT","EVENT","ACK","ERROR","BINARY_EVENT","BINARY_ACK"],e.CONNECT=0,e.DISCONNECT=1,e.EVENT=2,e.ACK=3,e.ERROR=4,e.BINARY_EVENT=5,e.BINARY_ACK=6,e.Encoder=n,e.Decoder=s,n.prototype.encode=function(t,i){if(t.type!==e.EVENT&&t.type!==e.ACK||!f(t.data)||(t.type=t.type===e.EVENT?e.BINARY_EVENT:e.BINARY_ACK),c("encoding packet %j",t),e.BINARY_EVENT===t.type||e.BINARY_ACK===t.type)!function(t,e){l.removeBlobs(t,function(t){var i=l.deconstructPacket(t),n=r(i.packet),s=i.buffers;s.unshift(n),e(s)})}(t,i);else{i([r(t)])}},u(s.prototype),s.prototype.add=function(t){var i;if("string"==typeof t)i=o(t),e.BINARY_EVENT===i.type||e.BINARY_ACK===i.type?(this.reconstructor=new a(i),0===this.reconstructor.reconPack.attachments&&this.emit("decoded",i)):this.emit("decoded",i);else{if(!p(t)&&!t.base64)throw new Error("Unknown type: "+t);if(!this.reconstructor)throw new Error("got binary data when not reconstructing a packet");(i=this.reconstructor.takeBinaryData(t))&&(this.reconstructor=null,this.emit("decoded",i))}},s.prototype.destroy=function(){this.reconstructor&&this.reconstructor.finishedReconstruction()},a.prototype.takeBinaryData=function(t){if(this.buffers.push(t),this.buffers.length===this.reconPack.attachments){var e=l.reconstructPacket(this.reconPack,this.buffers);return this.finishedReconstruction(),e}return null},a.prototype.finishedReconstruction=function(){this.reconPack=null,this.buffers=[]}},function(t,e,i){function n(t){"use strict";var e,n,a=this,h=i(75),c=i(111),u={},f=!1,l={"User-Agent":"node-XMLHttpRequest",Accept:"*/*"},p=l,d=["accept-charset","accept-encoding","access-control-request-headers","access-control-request-method","connection","content-length","content-transfer-encoding","cookie","cookie2","date","expect","host","keep-alive","origin","referer","te","trailer","transfer-encoding","upgrade","via"],m=["TRACE","TRACK","CONNECT"],g=!1,y=!1,w={};this.UNSENT=0,this.OPENED=1,this.HEADERS_RECEIVED=2,this.LOADING=3,this.DONE=4,this.readyState=this.UNSENT,this.onreadystatechange=null,this.responseText="",this.responseXML="",this.status=null,this.statusText=null;this.open=function(t,e,i,n,r){if(this.abort(),y=!1,!function(t){return t&&-1===m.indexOf(t)}(t))throw"SecurityError: Request method not allowed";u={method:t,url:e.toString(),async:"boolean"!=typeof i||i,user:n||null,password:r||null},b(this.OPENED)},this.setDisableHeaderCheck=function(t){f=t},this.setRequestHeader=function(t,e){if(this.readyState!=this.OPENED)throw"INVALID_STATE_ERR: setRequestHeader can only be called when state is OPEN";if(!function(t){return f||t&&-1===d.indexOf(t.toLowerCase())}(t))return console.warn('Refused to set unsafe header "'+t+'"'),!1;if(g)throw"INVALID_STATE_ERR: send flag is true";return p[t]=e,!0},this.getResponseHeader=function(t){return"string"==typeof t&&this.readyState>this.OPENED&&n.headers[t.toLowerCase()]&&!y?n.headers[t.toLowerCase()]:null},this.getAllResponseHeaders=function(){if(this.readyState<this.HEADERS_RECEIVED||y)return"";var t="";for(var e in n.headers)"set-cookie"!==e&&"set-cookie2"!==e&&(t+=e+": "+n.headers[e]+"\r\n");return t.substr(0,t.length-2)},this.getRequestHeader=function(t){return"string"==typeof t&&p[t]?p[t]:""},this.send=function(i){if(this.readyState!=this.OPENED)throw"INVALID_STATE_ERR: connection must be opened before send() is called";if(g)throw"INVALID_STATE_ERR: send has already been called";var f,l=!1,d=!1,m=s.parse(u.url);switch(m.protocol){case"https:":l=!0;case"http:":f=m.hostname;break;case"file:":d=!0;break;case void 0:case"":f="localhost";break;default:throw"Protocol not supported."}if(d){if("GET"!==u.method)throw"XMLHttpRequest: Only GET method is supported";if(u.async)r.readFile(m.pathname,"utf8",function(t,e){t?a.handleError(t):(a.status=200,a.responseText=e,b(a.DONE))});else try{this.responseText=r.readFileSync(m.pathname,"utf8"),this.status=200,b(a.DONE)}catch(t){this.handleError(t)}}else{var w=m.port||(l?443:80),v=m.pathname+(m.search?m.search:"");if(p.Host=f,l&&443===w||80===w||(p.Host+=":"+m.port),u.user){void 0===u.password&&(u.password="");var k=new Buffer(u.user+":"+u.password);p.Authorization="Basic "+k.toString("base64")}"GET"===u.method||"HEAD"===u.method?i=null:i?(p["Content-Length"]=Buffer.isBuffer(i)?i.length:Buffer.byteLength(i),p["Content-Type"]||(p["Content-Type"]="text/plain;charset=UTF-8")):"POST"===u.method&&(p["Content-Length"]=0);var S=!1;t&&t.agent&&(S=t.agent);var E={host:f,port:w,path:v,method:u.method,headers:p,agent:S};if(l&&(E.pfx=t.pfx,E.key=t.key,E.passphrase=t.passphrase,E.cert=t.cert,E.ca=t.ca,E.ciphers=t.ciphers,E.rejectUnauthorized=t.rejectUnauthorized),y=!1,u.async){var R=l?c.request:h.request;g=!0,a.dispatchEvent("readystatechange");var x=function(i){if(302===(n=i).statusCode||303===n.statusCode||307===n.statusCode){u.url=n.headers.location;var r=s.parse(u.url);f=r.hostname;var o={hostname:r.hostname,port:r.port,path:r.path,method:303===n.statusCode?"GET":u.method,headers:p};return l&&(o.pfx=t.pfx,o.key=t.key,o.passphrase=t.passphrase,o.cert=t.cert,o.ca=t.ca,o.ciphers=t.ciphers,o.rejectUnauthorized=t.rejectUnauthorized),void(e=R(o,x).on("error",_)).end()}n&&n.setEncoding&&n.setEncoding("utf8"),b(a.HEADERS_RECEIVED),a.status=n.statusCode,n.on("data",function(t){t&&(a.responseText+=t),g&&b(a.LOADING)}),n.on("end",function(){g&&(b(a.DONE),g=!1)}),n.on("error",function(t){a.handleError(t)})},_=function(t){a.handleError(t)};e=R(E,x).on("error",_),i&&e.write(i),e.end(),a.dispatchEvent("loadstart")}else{var I=".node-xmlhttprequest-content-"+process.pid,A=".node-xmlhttprequest-sync-"+process.pid;r.writeFileSync(A,"","utf8");for(var O="var http = require('http'), https = require('https'), fs = require('fs');var doRequest = http"+(l?"s":"")+".request;var options = "+JSON.stringify(E)+";var responseText = '';var req = doRequest(options, function(response) {response.setEncoding('utf8');response.on('data', function(chunk) {  responseText += chunk;});response.on('end', function() {fs.writeFileSync('"+I+"', 'NODE-XMLHTTPREQUEST-STATUS:' + response.statusCode + ',' + responseText, 'utf8');fs.unlinkSync('"+A+"');});response.on('error', function(error) {fs.writeFileSync('"+I+"', 'NODE-XMLHTTPREQUEST-ERROR:' + JSON.stringify(error), 'utf8');fs.unlinkSync('"+A+"');});}).on('error', function(error) {fs.writeFileSync('"+I+"', 'NODE-XMLHTTPREQUEST-ERROR:' + JSON.stringify(error), 'utf8');fs.unlinkSync('"+A+"');});"+(i?"req.write('"+i.replace(/'/g,"\\'")+"');":"")+"req.end();",B=o(process.argv[0],["-e",O]);r.existsSync(A););if(a.responseText=r.readFileSync(I,"utf8"),B.stdin.end(),r.unlinkSync(I),a.responseText.match(/^NODE-XMLHTTPREQUEST-ERROR:/)){var P=a.responseText.replace(/^NODE-XMLHTTPREQUEST-ERROR:/,"");a.handleError(P)}else a.status=a.responseText.replace(/^NODE-XMLHTTPREQUEST-STATUS:([0-9]*),.*/,"$1"),a.responseText=a.responseText.replace(/^NODE-XMLHTTPREQUEST-STATUS:[0-9]*,(.*)/,"$1"),b(a.DONE)}}},this.handleError=function(t){this.status=503,this.statusText=t,this.responseText=t.stack,y=!0,b(this.DONE)},this.abort=function(){e&&(e.abort(),e=null),p=l,this.responseText="",this.responseXML="",y=!0,this.readyState===this.UNSENT||this.readyState===this.OPENED&&!g||this.readyState===this.DONE||(g=!1,b(this.DONE)),this.readyState=this.UNSENT},this.addEventListener=function(t,e){t in w||(w[t]=[]),w[t].push(e)},this.removeEventListener=function(t,e){t in w&&(w[t]=w[t].filter(function(t){return t!==e}))},this.dispatchEvent=function(t){if("function"==typeof a["on"+t]&&a["on"+t](),t in w)for(var e=0,i=w[t].length;e<i;e++)w[t][e].call(a)};var b=function(t){a.readyState!==t&&(a.readyState=t,(u.async||a.readyState<a.OPENED||a.readyState===a.DONE)&&a.dispatchEvent("readystatechange"),a.readyState!==a.DONE||y||(a.dispatchEvent("load"),a.dispatchEvent("loadend")))}}var r=i(106),s=i(73),o=i(219).spawn;t.exports=n,n.XMLHttpRequest=n},function(t,e,i){function n(t){this.path=t.path,this.hostname=t.hostname,this.port=t.port,this.secure=t.secure,this.query=t.query,this.timestampParam=t.timestampParam,this.timestampRequests=t.timestampRequests,this.readyState="",this.agent=t.agent||!1,this.socket=t.socket,this.enablesXDR=t.enablesXDR,this.pfx=t.pfx,this.key=t.key,this.passphrase=t.passphrase,this.cert=t.cert,this.ca=t.ca,this.ciphers=t.ciphers,this.rejectUnauthorized=t.rejectUnauthorized,this.forceNode=t.forceNode,this.extraHeaders=t.extraHeaders,this.localAddress=t.localAddress}var r=i(77),s=i(76);t.exports=n,s(n.prototype),n.prototype.onError=function(t,e){var i=new Error(t);return i.type="TransportError",i.description=e,this.emit("error",i),this},n.prototype.open=function(){return"closed"!==this.readyState&&""!==this.readyState||(this.readyState="opening",this.doOpen()),this},n.prototype.close=function(){return"opening"!==this.readyState&&"open"!==this.readyState||(this.doClose(),this.onClose()),this},n.prototype.send=function(t){if("open"!==this.readyState)throw new Error("Transport not open");this.write(t)},n.prototype.onOpen=function(){this.readyState="open",this.writable=!0,this.emit("open")},n.prototype.onData=function(t){var e=r.decodePacket(t,this.socket.binaryType);this.onPacket(e)},n.prototype.onPacket=function(t){this.emit("packet",t)},n.prototype.onClose=function(){this.readyState="closed",this.emit("close")}},function(t,e,i){"use strict";const n=i(78).Buffer,r=(t,e)=>{const i=n.allocUnsafe(e);for(var r=0,s=0;s<t.length;s++){const e=t[s];e.copy(i,r),r+=e.length}return i};try{const e=i(!function(){var t=new Error('Cannot find module "bufferutil"');throw t.code="MODULE_NOT_FOUND",t}());t.exports=Object.assign({concat:r},e.BufferUtil||e)}catch(e){t.exports={concat:r,mask:(t,e,i,n,r)=>{for(var s=0;s<r;s++)i[n+s]=t[s]^e[3&s]},unmask:(t,e)=>{const i=t.length;for(var n=0;n<i;n++)t[n]^=e[3&n]}}}},function(t,e,i){"use strict";const n=i(78).Buffer;e.BINARY_TYPES=["nodebuffer","arraybuffer","fragments"],e.GUID="258EAFA5-E914-47DA-95CA-C5AB0DC85B11",e.EMPTY_BUFFER=n.alloc(0),e.NOOP=(()=>{})},function(t,e,i){"use strict";function n(){if(!(this instanceof n))return new n;o.call(this),this.logger=h.global,this.calls=Object.create(null),this.mounts=[],this.locker=new a}function r(t,e){Error.call(this),s("number"==typeof t),s("string"==typeof e),this.type="RPCError",this.message=e,this.code=t,Error.captureStackTrace&&Error.captureStackTrace(this,r)}const s=i(0),o=i(10),a=i(23),h=i(34);Object.setPrototypeOf(n.prototype,o.prototype),n.errors={INVALID_REQUEST:-32600,METHOD_NOT_FOUND:-32601,INVALID_PARAMS:-32602,INTERNAL_ERROR:-32603,PARSE_ERROR:-32700,MISC_ERROR:-1,FORBIDDEN_BY_SAFE_MODE:-2,TYPE_ERROR:-3,INVALID_ADDRESS_OR_KEY:-5,OUT_OF_MEMORY:-7,INVALID_PARAMETER:-8,DATABASE_ERROR:-20,DESERIALIZATION_ERROR:-22,VERIFY_ERROR:-25,VERIFY_REJECTED:-26,VERIFY_ALREADY_IN_CHAIN:-27,IN_WARMUP:-28,TRANSACTION_ERROR:-25,TRANSACTION_REJECTED:-26,TRANSACTION_ALREADY_IN_CHAIN:-27,CLIENT_NOT_CONNECTED:-9,CLIENT_IN_INITIAL_DOWNLOAD:-10,CLIENT_NODE_ALREADY_ADDED:-23,CLIENT_NODE_NOT_ADDED:-24,CLIENT_NODE_NOT_CONNECTED:-29,CLIENT_INVALID_IP_OR_SUBNET:-30,CLIENT_P2P_DISABLED:-31,WALLET_ERROR:-4,WALLET_INSUFFICIENT_FUNDS:-6,WALLET_INVALID_ACCOUNT_NAME:-11,WALLET_KEYPOOL_RAN_OUT:-12,WALLET_UNLOCK_NEEDED:-13,WALLET_PASSPHRASE_INCORRECT:-14,WALLET_WRONG_ENC_STATE:-15,WALLET_ENCRYPTION_FAILED:-16,WALLET_ALREADY_UNLOCKED:-17},n.MAGIC_STRING="WMCoin Signed Message:\n",n.prototype.call=async function(t,e){let i=t,r=[],s=!0;Array.isArray(i)||(i=[i],s=!1);for(const t of i){if(!t||"object"!=typeof t){r.push({result:null,error:{message:"Invalid request.",code:n.errors.INVALID_REQUEST},id:null});continue}if(t.id&&"object"==typeof t.id){r.push({result:null,error:{message:"Invalid ID.",code:n.errors.INVALID_REQUEST},id:null});continue}if(null==t.id&&(t.id=null),t.params||(t.params=[]),"string"!=typeof t.method){r.push({result:null,error:{message:"Method not found.",code:n.errors.METHOD_NOT_FOUND},id:t.id});continue}if(!Array.isArray(t.params)){r.push({result:null,error:{message:"Invalid params.",code:n.errors.INVALID_PARAMS},id:t.id});continue}"getwork"!==t.method&&"getblocktemplate"!==t.method&&"getbestblockhash"!==t.method&&(this.logger.debug("Handling RPC call: %s.",t.method),"submitblock"!==t.method&&"getmemorypool"!==t.method&&this.logger.debug(t.params)),"getwork"===t.method&&e.longpoll&&(t.method="getworklp");let i;try{i=await this.execute(t)}catch(e){let i;switch(e.type){case"RPCError":i=e.code;break;case"ValidationError":i=n.errors.TYPE_ERROR;break;case"EncodingError":i=n.errors.DESERIALIZATION_ERROR;break;case"FundingError":i=n.errors.WALLET_INSUFFICIENT_FUNDS;break;default:i=n.errors.INTERNAL_ERROR,this.logger.error("RPC internal error."),this.logger.error(e)}r.push({result:null,error:{message:e.message,code:i},id:t.id});continue}void 0===i&&(i=null),r.push({result:i,error:null,id:t.id})}return s||(r=r[0]),r},n.prototype.execute=async function(t,e){const i=this.calls[t.method];if(!i){for(const i of this.mounts)if(i.calls[t.method])return await i.execute(t,e);throw new r(n.errors.METHOD_NOT_FOUND,`Method not found: ${t.method}.`)}return await i.call(this,t.params,e)},n.prototype.add=function(t,e){s("function"==typeof e,"Handler must be a function."),s(!this.calls[t],"Duplicate RPC call."),this.calls[t]=e},n.prototype.mount=function(t){s(t,"RPC must be an object."),s("function"==typeof t.execute,"Execute must be a method."),this.mounts.push(t)},n.prototype.attach=function(t){s(t,"RPC must be an object."),s("function"==typeof t.execute,"Execute must be a method."),t.mount(this)},Object.setPrototypeOf(r.prototype,Error.prototype),(e=n).RPCError=r,t.exports=e},function(t,e,i){"use strict";const n="abcdefghijklmnopqrstuvwxyz234567",r=[0,6,4,3,1],s={};for(let t=0;t<n.length;t++)s[n[t]]=t;e.encode=function(t){let e="",i=0,s=0;for(let r=0;r<t.length;r++){const o=t[r];switch(i){case 0:e+=n[o>>>3],s=(7&o)<<2,i=1;break;case 1:e+=n[s|o>>>6],e+=n[o>>>1&31],s=(1&o)<<4,i=2;break;case 2:e+=n[s|o>>>4],s=(15&o)<<1,i=3;break;case 3:e+=n[s|o>>>7],e+=n[o>>>2&31],s=(3&o)<<3,i=4;break;case 4:e+=n[s|o>>>5],e+=n[31&o],i=0}}if(i>0){e+=n[s];for(let t=0;t<r[i];t++)e+="="}return e},e.decode=function(t){const e=Buffer.allocUnsafe(5*t.length/8|0);let i,n=0,r=0,o=0;for(i=0;i<t.length;i++){const a=s[t[i]];if(null==a)break;switch(n){case 0:r=a,n=1;break;case 1:e[o++]=r<<3|a>>>2,r=3&a,n=2;break;case 2:r=r<<5|a,n=3;break;case 3:e[o++]=r<<1|a>>>4,r=15&a,n=4;break;case 4:e[o++]=r<<4|a>>>1,r=1&a,n=5;break;case 5:r=r<<5|a,n=6;break;case 6:e[o++]=r<<2|a>>>3,r=7&a,n=7;break;case 7:e[o++]=r<<5|a,n=0}}switch(n){case 0:break;case 1:case 3:case 6:throw new Error("Invalid base32 string.");case 2:if(r>0)throw new Error("Invalid padding.");if("======"!==t.slice(i,i+6))throw new Error("Invalid base32 character.");if(null!=s[t[i+6]])throw new Error("Invalid padding.");break;case 4:if(r>0)throw new Error("Invalid padding.");if("===="!==t.slice(i,i+4))throw new Error("Invalid base32 character.");if(null!=s[t[i+4]])throw new Error("Invalid padding.");break;case 5:if(r>0)throw new Error("Invalid padding.");if("==="!==t.slice(i,i+3))throw new Error("Invalid base32 character.");if(null!=s[t[i+3]])throw new Error("Invalid padding.");break;case 7:if(r>0)throw new Error("Invalid padding.");if("="!==t[i])throw new Error("Invalid base32 character.");if(null!=s[t[i+1]])throw new Error("Invalid padding.")}return e.slice(0,o)}},function(t,e,i){"use strict";function n(t){if(!(this instanceof n))return new n(t);t=new r(t),h.call(this,t),this.options=t,this.network=this.options.network,this.logger=this.options.logger.context("http"),this.node=this.options.node,this.chain=this.node.chain,this.mempool=this.node.mempool,this.pool=this.node.pool,this.fees=this.node.fees,this.miner=this.node.miner,this.rpc=this.node.rpc,this.init()}function r(t){if(!(this instanceof r))return new r(t);this.network=y.primary,this.logger=null,this.node=null,this.apiKey=u.encode(m.randomBytes(20)),this.apiHash=d.hash256(Buffer.from(this.apiKey,"ascii")),this.noAuth=!1,this.prefix=null,this.host="127.0.0.1",this.port=8080,this.ssl=!1,this.keyFile=null,this.certFile=null,this.fromOptions(t)}function s(t,e){if(!t){const t=new Error(e);throw t.statusCode=400,t}}const o=i(0),a=i(33),h=i(166),c=i(1),u=i(25),f=i(42),l=i(15),p=i(21),d=i(5),m=i(28),g=i(52),y=i(6),w=i(74),b=i(96);Object.setPrototypeOf(n.prototype,h.prototype),n.prototype.init=function(){this.on("request",(t,e)=>{"POST"===t.method&&"/"===t.pathname||this.logger.debug("Request for method=%s path=%s (%s).",t.method,t.pathname,t.socket.remoteAddress)}),this.on("listening",t=>{this.logger.info("Node HTTP server listening on %s (port=%d).",t.address,t.port)}),this.initRouter(),this.initSockets()},n.prototype.initRouter=function(){this.use(this.cors()),this.options.noAuth||this.use(this.basicAuth({password:this.options.apiKey,realm:"node"})),this.use(this.bodyParser({contentType:"json"})),this.use(this.jsonRPC(this.rpc)),this.get("/",async(t,e)=>{const i=this.mempool?this.mempool.map.size:0,n=this.mempool?this.mempool.getSize():0;let r=this.pool.hosts.getLocal();r||(r=this.pool.hosts.address),e.send(200,{version:b.version,network:this.network.type,chain:{height:this.chain.height,tip:this.chain.tip.rhash(),progress:this.chain.getProgress()},pool:{host:r.host,port:r.port,agent:this.pool.options.agent,services:this.pool.options.services.toString(2),outbound:this.pool.peers.outbound,inbound:this.pool.peers.inbound},mempool:{tx:i,size:n},time:{uptime:this.node.uptime(),system:c.now(),adjusted:this.network.now(),offset:this.network.time.offset},memory:c.memoryUsage()})}),this.get("/coin/address/:address",async(t,e)=>{const i=t.valid().str("address");s(i,"Address is required."),s(!this.chain.options.spv,"Cannot get coins in SPV mode.");const n=await this.node.getCoinsByAddress(i),r=[];for(const t of n)r.push(t.getJSON(this.network));e.send(200,r)}),this.get("/coin/:hash/:index",async(t,e)=>{const i=t.valid(),n=i.hash("hash"),r=i.u32("index");s(n,"Hash is required."),s(null!=r,"Index is required."),s(!this.chain.options.spv,"Cannot get coins in SPV mode.");const o=await this.node.getCoin(n,r);o?e.send(200,o.getJSON(this.network)):e.send(404)}),this.post("/coin/address",async(t,e)=>{const i=t.valid().array("addresses");s(i,"Address is required."),s(!this.chain.options.spv,"Cannot get coins in SPV mode.");const n=await this.node.getCoinsByAddress(i),r=[];for(const t of n)r.push(t.getJSON(this.network));e.send(200,r)}),this.get("/tx/:hash",async(t,e)=>{const i=t.valid().hash("hash");s(i,"Hash is required."),s(!this.chain.options.spv,"Cannot get TX in SPV mode.");const n=await this.node.getMeta(i);if(!n)return void e.send(404);const r=await this.node.getMetaView(n);e.send(200,n.getJSON(this.network,r))}),this.get("/tx/address/:address",async(t,e)=>{const i=t.valid().str("address");s(i,"Address is required."),s(!this.chain.options.spv,"Cannot get TX in SPV mode.");const n=await this.node.getMetaByAddress(i),r=[];for(const t of n){const e=await this.node.getMetaView(t);r.push(t.getJSON(this.network,e))}e.send(200,r)}),this.post("/tx/address",async(t,e)=>{const i=t.valid().array("addresses");s(i,"Address is required."),s(!this.chain.options.spv,"Cannot get TX in SPV mode.");const n=await this.node.getMetaByAddress(i),r=[];for(const t of n){const e=await this.node.getMetaView(t);r.push(t.getJSON(this.network,e))}e.send(200,r)}),this.get("/block/:block",async(t,e)=>{let i=t.valid().get("block");s("string"==typeof i,"Hash or height required."),s(!this.chain.options.spv,"Cannot get block in SPV mode."),i=64===i.length?c.revHex(i):parseInt(i,10);const n=await this.chain.getBlock(i);if(!n)return void e.send(404);const r=await this.chain.getBlockView(n);if(!r)return void e.send(404);const o=await this.chain.getHeight(i);e.send(200,n.getJSON(this.network,r,o))}),this.get("/mempool",async(t,e)=>{s(this.mempool,"No mempool available.");const i=this.mempool.getSnapshot(),n=[];for(const t of i)n.push(c.revHex(t));e.send(200,n)}),this.post("/broadcast",async(t,e)=>{const i=t.valid().buf("tx");s(i,"TX is required.");const n=l.fromRaw(i);await this.node.sendTX(n),e.send(200,{success:!0})}),this.get("/fee",async(t,e)=>{const i=t.valid().u32("blocks");if(!this.fees)return void e.send(200,{rate:this.network.feeRate});const n=this.fees.estimateFee(i);e.send(200,{rate:n})}),this.post("/reset",async(t,e)=>{const i=t.valid().u32("height");s(null!=i,"Height is required."),await this.chain.reset(i),e.send(200,{success:!0})})},n.prototype.initSockets=function(){this.io&&this.on("socket",t=>{this.handleSocket(t)})},n.prototype.handleSocket=function(t){t.hook("auth",e=>{if(t.auth)throw new Error("Already authed.");if(!this.options.noAuth){const t=new w([e]).str(0,"");if(t.length>255)throw new Error("Invalid API key.");const i=Buffer.from(t,"ascii"),n=d.hash256(i);if(!g(n,this.options.apiHash))throw new Error("Invalid API key.")}return t.auth=!0,this.logger.info("Successful auth from %s.",t.remoteAddress),this.handleAuth(t),null}),t.emit("version",{version:b.version,network:this.network.type})},n.prototype.handleAuth=function(t){t.hook("watch chain",e=>(t.join("chain"),null)),t.hook("unwatch chain",e=>(t.leave("chain"),null)),t.hook("watch mempool",e=>(t.join("mempool"),null)),t.hook("unwatch mempool",e=>(t.leave("mempool"),null)),t.hook("set filter",e=>{const i=new w([e]).buf(0);if(!i)throw new Error("Invalid parameter.");return t.filter=f.fromRaw(i),null}),t.hook("get tip",t=>this.chain.tip.toRaw()),t.hook("get entry",async t=>{const e=new w([t]).numhash(0);if(null==e)throw new Error("Invalid parameter.");const i=await this.chain.getEntry(e);return i&&await this.chain.isMainChain(i)?i.toRaw():null}),t.hook("add filter",e=>{const i=new w([e]).array(0);if(!i)throw new Error("Invalid parameter.");if(!t.filter)throw new Error("No filter set.");const n=new w([i]);for(let t=0;t<i.length;t++){const e=n.buf(t);if(!e)throw new Error("Bad data chunk.");this.filter.add(e),this.node.spv&&this.pool.watch(e)}return null}),t.hook("reset filter",e=>(t.filter=null,null)),t.hook("estimate fee",t=>{const e=new w([t]).u32(0);return this.fees?this.fees.estimateFee(e):this.network.feeRate}),t.hook("send",t=>{const e=new w([t]).buf(0);if(!e)throw new Error("Invalid parameter.");const i=l.fromRaw(e);return this.node.send(i),null}),t.hook("rescan",e=>{const i=new w([e]).numhash(0);if(null==i)throw new Error("Invalid parameter.");return this.scan(t,i)}),this.bindChain()},n.prototype.bindChain=function(){const t=this.mempool||this.pool;this.chain.on("connect",(t,e,i)=>{const n=this.channel("chain");if(!n)return;const r=t.toRaw();this.to("chain","chain connect",r);for(let t=n.head;t;t=t.next){const i=t.value,n=this.filterBlock(i,e);i.emit("block connect",r,n)}}),this.chain.on("disconnect",(t,e,i)=>{if(!this.channel("chain"))return;const n=t.toRaw();this.to("chain","chain disconnect",n),this.to("chain","block disconnect",n)}),this.chain.on("reset",t=>{if(!this.channel("chain"))return;const e=t.toRaw();this.to("chain","chain reset",e)}),t.on("tx",t=>{const e=this.channel("mempool");if(!e)return;const i=t.toRaw();for(let n=e.head;n;n=n.next){const e=n.value;this.filterTX(e,t)&&e.emit("tx",i)}})},n.prototype.filterBlock=function(t,e){if(!t.filter)return[];const i=[];for(const n of e.txs)this.filterTX(t,n)&&i.push(n.toRaw());return i},n.prototype.filterTX=function(t,e){if(!t.filter)return!1;let i=!1;for(let n=0;n<e.outputs.length;n++){const r=e.outputs[n].getHash();if(r&&t.filter.test(r)){const r=p.fromTX(e,n);t.filter.add(r.toRaw()),i=!0}}if(i)return!0;if(!e.isCoinbase())for(const{prevout:i}of e.inputs)if(t.filter.test(i.toRaw()))return!0;return!1},n.prototype.scan=async function(t,e){const i=this.scanner.bind(this,t);return await this.node.scan(e,t.filter,i),null},n.prototype.scanner=function(t,e,i){const n=e.toRaw(),r=[];for(const t of i)r.push(t.toRaw());return t.emit("block rescan",n,r),Promise.resolve()},r.prototype.fromOptions=function(t){return o(t),o(t.node&&"object"==typeof t.node,"HTTP Server requires a Node."),this.node=t.node,this.network=t.node.network,this.logger=t.node.logger,this.port=this.network.rpcPort,null!=t.logger&&(o("object"==typeof t.logger),this.logger=t.logger),null!=t.apiKey&&(o("string"==typeof t.apiKey,"API key must be a string."),o(t.apiKey.length<=255,"API key must be under 256 bytes."),o(c.isAscii(t.apiKey),"API key must be ascii."),this.apiKey=t.apiKey,this.apiHash=d.hash256(Buffer.from(this.apiKey,"ascii"))),null!=t.noAuth&&(o("boolean"==typeof t.noAuth),this.noAuth=t.noAuth),null!=t.prefix&&(o("string"==typeof t.prefix),this.prefix=t.prefix,this.keyFile=a.join(this.prefix,"key.pem"),this.certFile=a.join(this.prefix,"cert.pem")),null!=t.host&&(o("string"==typeof t.host),this.host=t.host),null!=t.port&&(o(c.isU16(t.port),"Port must be a number."),this.port=t.port),null!=t.ssl&&(o("boolean"==typeof t.ssl),this.ssl=t.ssl),null!=t.keyFile&&(o("string"==typeof t.keyFile),this.keyFile=t.keyFile),null!=t.certFile&&(o("string"==typeof t.certFile),this.certFile=t.certFile),t.apiKey||"127.0.0.1"!==this.host&&"::1"!==this.host||(this.noAuth=!0),this},r.fromOptions=function(t){return(new r).fromOptions(t)},t.exports=n},function(t,e,i){"use strict";function n(t){if(!(this instanceof n))return new n(t);this.tx=null,this.height=-1,this.size=0,this.sigops=0,this.priority=0,this.fee=0,this.deltaFee=0,this.time=0,this.value=0,this.coinbase=!1,this.dependencies=!1,this.descFee=0,this.descSize=0,t&&this.fromOptions(t)}const r=i(19),s=i(1),o=i(8),a=i(2),h=i(4),c=i(15);n.prototype.fromOptions=function(t){return this.tx=t.tx,this.height=t.height,this.size=t.size,this.sigops=t.sigops,this.priority=t.priority,this.fee=t.fee,this.deltaFee=t.deltaFee,this.time=t.time,this.value=t.value,this.coinbase=t.coinbase,this.dependencies=t.dependencies,this.descFee=t.descFee,this.descSize=t.descSize,this},n.fromOptions=function(t){return(new n).fromOptions(t)},n.prototype.fromTX=function(t,e,i){const n=o.flags.STANDARD_VERIFY_FLAGS,r=t.getChainValue(e),a=t.getSigopsCost(e,n),h=t.getSigopsSize(a),c=t.getPriority(e,i,h),u=t.getFee(e);let f=!1,l=!1;for(const{prevout:i}of t.inputs)e.isCoinbase(i)&&(l=!0),-1===e.getHeight(i)&&(f=!0);return this.tx=t,this.height=i,this.size=h,this.sigops=a,this.priority=c,this.fee=u,this.deltaFee=u,this.time=s.now(),this.value=r,this.coinbase=l,this.dependencies=f,this.descFee=u,this.descSize=h,this},n.fromTX=function(t,e,i){return(new n).fromTX(t,e,i)},n.prototype.hash=function(t){return this.tx.hash(t)},n.prototype.txid=function(){return this.tx.txid()},n.prototype.getPriority=function(t){const e=(t-this.height)*this.value/this.size;let i=this.priority+Math.floor(e);return i<0&&(i=0),i},n.prototype.getFee=function(){return this.fee},n.prototype.getDeltaFee=function(){return this.deltaFee},n.prototype.getRate=function(){return r.getRate(this.size,this.fee)},n.prototype.getDeltaRate=function(){return r.getRate(this.size,this.deltaFee)},n.prototype.getDescRate=function(){return r.getRate(this.descSize,this.descFee)},n.prototype.memUsage=function(){const t=this.tx;let e=0;e+=176,e+=48,e+=48,e+=208,e+=80,e+=88,e+=80,e+=80,e+=48,e+=32;for(const i of t.inputs){e+=120,e+=104,e+=88,e+=40,e+=80,e+=32,e+=40*i.script.code.length;for(const t of i.script.code)t.data&&(e+=80);e+=96,e+=32,e+=80*i.witness.items.length}e+=32;for(const i of t.outputs){e+=104,e+=40,e+=80,e+=32,e+=40*i.script.code.length;for(const t of i.script.code)t.data&&(e+=80)}return e},n.prototype.isFree=function(t){return this.getPriority(t)>r.FREE_THRESHOLD},n.prototype.getSize=function(){return this.tx.getSize()+42},n.prototype.toRaw=function(){const t=new h(this.getSize());return t.writeBytes(this.tx.toRaw()),t.writeU32(this.height),t.writeU32(this.size),t.writeU32(this.sigops),t.writeDouble(this.priority),t.writeU64(this.fee),t.writeU32(this.time),t.writeU64(this.value),t.writeU8(this.coinbase?1:0),t.writeU8(this.dependencies?1:0),t.render()},n.prototype.fromRaw=function(t){const e=new a(t);return this.tx=c.fromReader(e),this.height=e.readU32(),this.size=e.readU32(),this.sigops=e.readU32(),this.priority=e.readDouble(),this.fee=e.readU64(),this.deltaFee=this.fee,this.time=e.readU32(),this.value=e.readU64(),this.coinbase=1===e.readU8(),this.dependencies=1===e.readU8(),this.descFee=this.fee,this.descSize=this.size,this},n.fromRaw=function(t){return(new n).fromRaw(t)},t.exports=n},function(t,e,i){"use strict";function n(t){if(!(this instanceof n))return new n(t);b.call(this),this.options=new r(t),this.network=this.options.network,this.logger=this.options.logger.context("mempool"),this.workers=this.options.workers,this.chain=this.options.chain,this.fees=this.options.fees,this.locker=this.chain.locker,this.cache=new c(this.options),this.size=0,this.freeCount=0,this.lastTime=0,this.lastFlush=0,this.tip=this.network.genesis.hash,this.waiting=new Map,this.orphans=new Map,this.map=new Map,this.spents=new Map,this.rejects=new _(12e4,1e-6),this.coinIndex=new o,this.txIndex=new s}function r(t){if(!(this instanceof r))return new r(t);this.network=T.primary,this.chain=null,this.logger=null,this.workers=null,this.fees=null,this.limitFree=!0,this.limitFreeRelay=15,this.relayPriority=!0,this.requireStandard=this.network.requireStandard,this.rejectAbsurdFees=!0,this.prematureWitness=!1,this.paranoidChecks=!1,this.replaceByFee=!1,this.maxSize=S.MEMPOOL_MAX_SIZE,this.maxOrphans=S.MEMPOOL_MAX_ORPHANS,this.maxAncestors=S.MEMPOOL_MAX_ANCESTORS,this.expiryTime=S.MEMPOOL_EXPIRY_TIME,this.minRelay=this.network.minRelay,this.prefix=null,this.location=null,this.db="memory",this.maxFiles=64,this.cacheSize=32<<20,this.compression=!0,this.bufferKeys=U.binary,this.persistent=!1,this.fromOptions(t)}function s(){this.index=new Map,this.map=new Map}function o(){this.index=new Map,this.map=new Map}function a(t,e){this.tx=t,this.index=e}function h(t,e,i){this.raw=t.toRaw(),this.missing=e,this.id=i}function c(t){if(!(this instanceof c))return new c(t);this.logger=t.logger,this.chain=t.chain,this.network=t.network,this.db=null,this.batch=null,t.persistent&&(this.db=H(t))}function u(t,e){}function f(t,e){t.descFee+=e.deltaFee,t.descSize+=e.size}function l(t,e){t.descFee-=e.descFee,t.descSize-=e.descSize}function p(t,e){t.descFee-=e.deltaFee}function d(t,e){t.descFee+=e.deltaFee}function m(t,e){let i,n,r=t.deltaFee,s=t.size,o=e.deltaFee,a=e.size;return g(t)&&(r=t.descFee,s=t.descSize),g(e)&&(o=e.descFee,a=e.descSize),i=r*a,n=s*o,i===n&&(i=t.time,n=e.time),i-n}function g(t){const e=t.deltaFee*t.descSize;return t.descFee*t.size>e}const y=i(0),w=i(33),b=i(30),v=i(93),k=i(7),S=i(19),E=i(1),R=i(28),{VerifyError:x}=i(107),_=i(118),I=i(11),A=i(8),O=i(21),B=i(15),P=i(43),M=i(162),N=i(177),T=i(6),C=i(3),U=i(232),H=i(92),L=i(117),z=i(29),D=i(179);Object.setPrototypeOf(n.prototype,b.prototype),n.prototype._open=async function(){if(await this.chain.open(),await this.cache.open(),this.options.persistent){const t=await this.cache.getEntries();for(const e of t)this.trackEntry(e);for(const e of t)if(this.updateAncestors(e,f),this.options.indexAddress){const t=await this.getCoinView(e.tx);this.indexEntry(e,t)}if(this.logger.info("Loaded mempool from disk (%d entries).",t.length),this.fees){const t=await this.cache.getFees();t&&(this.fees.inject(t),this.logger.info("Loaded mempool fee data (rate=%d).",this.fees.estimateFee()))}}this.tip=this.chain.tip.hash;const t=(this.options.maxSize/1024).toFixed(2);this.logger.info("Mempool loaded (maxsize=%dkb).",t)},n.prototype._close=async function(){await this.cache.close()},n.prototype.addBlock=async function(t,e){const i=await this.locker.lock();try{return await this._addBlock(t,e)}finally{i()}},n.prototype._addBlock=async function(t,e){if(0===this.map.size)return void(this.tip=t.hash);const i=[];for(let n=e.length-1;n>=1;n--){const r=e[n],s=r.hash("hex"),o=this.getEntry(s);o?(this.removeEntry(o),this.emit("confirmed",r,t),i.push(o)):(this.removeOrphan(s),this.removeDoubleSpends(r),this.waiting.has(s)&&await this.handleOrphans(r))}this.rejects.reset(),this.fees&&(this.fees.processBlock(t.height,i,this.chain.synced),this.cache.writeFees(this.fees)),this.cache.sync(t.hash),await this.cache.flush(),this.tip=t.hash,0!==i.length&&this.logger.debug("Removed %d txs from mempool for block %d.",i.length,t.height)},n.prototype.removeBlock=async function(t,e){const i=await this.locker.lock();try{return await this._removeBlock(t,e)}finally{i()}},n.prototype._removeBlock=async function(t,e){if(0===this.map.size)return void(this.tip=t.prevBlock);let i=0;for(let n=1;n<e.length;n++){const r=e[n],s=r.hash("hex");if(!this.hasEntry(s)){try{await this.insertTX(r,-1),i++}catch(t){this.emit("error",t);continue}this.emit("unconfirmed",r,t)}}this.rejects.reset(),this.cache.sync(t.prevBlock),await this.cache.flush(),this.tip=t.prevBlock,0!==i&&this.logger.debug("Added %d txs back into the mempool for block %d.",i,t.height)},n.prototype._handleReorg=async function(){const t=this.chain.height+1,e=await this.chain.getMedianTime(this.chain.tip),i=[];for(const[n,r]of this.map){const{tx:s}=r;if(s.isFinal(t,e)){if(s.version>1){let t=!1;for(const{sequence:e}of s.inputs)if(!(e&k.SEQUENCE_DISABLE_FLAG)){t=!0;break}if(t){i.push(n);continue}}r.coinbase&&i.push(n)}else i.push(n)}for(const t of i){const e=this.getEntry(t);e&&this.evictEntry(e)}},n.prototype.reset=async function(){const t=await this.locker.lock();try{return await this._reset()}finally{t()}},n.prototype._reset=async function(){this.logger.info("Mempool reset (%d txs removed).",this.map.size),this.size=0,this.waiting.clear(),this.orphans.clear(),this.map.clear(),this.spents.clear(),this.coinIndex.reset(),this.txIndex.reset(),this.freeCount=0,this.lastTime=0,this.fees&&this.fees.reset(),this.rejects.reset(),this.options.persistent&&(await this.cache.wipe(),this.cache.clear()),this.tip=this.chain.tip.hash},n.prototype.limitSize=function(t){const e=this.options.maxSize;if(this.size<=e)return!1;const i=e-e/10,n=this.options.expiryTime,r=E.now();let s=E.hrtime();const o=new D(m);for(const t of this.map.values())this.hasDepends(t.tx)||(r<t.time+n?o.insert(t):(this.logger.debug("Removing package %s from mempool (too old).",t.txid()),this.evictEntry(t)));if(this.size<=i)return!this.hasEntry(t);for(this.logger.debug("(bench) Heap mempool traversal: %d.",E.hrtime(s)),s=E.hrtime(),this.logger.debug("(bench) Heap mempool queue size: %d.",o.size());o.size()>0;){const t=o.shift(),e=t.hash("hex");if(y(this.hasEntry(e)),this.logger.debug("Removing package %s from mempool (low fee).",t.txid()),this.evictEntry(t),this.size<=i)break}return this.logger.debug("(bench) Heap mempool map removal: %d.",E.hrtime(s)),!this.hasEntry(t)},n.prototype.getTX=function(t){const e=this.map.get(t);return e?e.tx:null},n.prototype.getEntry=function(t){return this.map.get(t)},n.prototype.getCoin=function(t,e){const i=this.map.get(t);return i?this.isSpent(t,e)?null:e>=i.tx.outputs.length?null:P.fromTX(i.tx,e,-1):null},n.prototype.isSpent=function(t,e){const i=O.toKey(t,e);return this.spents.has(i)},n.prototype.getSpent=function(t,e){const i=O.toKey(t,e);return this.spents.get(i)},n.prototype.getSpentTX=function(t,e){const i=O.toKey(t,e),n=this.spents.get(i);return n?n.tx:null},n.prototype.getCoinsByAddress=function(t){Array.isArray(t)||(t=[t]);const e=[];for(const i of t){const t=I.getHash(i,"hex"),n=this.coinIndex.get(t);for(const t of n)e.push(t)}return e},n.prototype.getTXByAddress=function(t){Array.isArray(t)||(t=[t]);const e=[];for(const i of t){const t=I.getHash(i,"hex"),n=this.txIndex.get(t);for(const t of n)e.push(t)}return e},n.prototype.getMetaByAddress=function(t){Array.isArray(t)||(t=[t]);const e=[];for(const i of t){const t=I.getHash(i,"hex"),n=this.txIndex.getMeta(t);for(const t of n)e.push(t)}return e},n.prototype.getAllMetaByAddress=function(t){const e=[];return this.map.forEach((i,n)=>{for(let n of i.tx.inputs)n.getAddress().equals(t)&&e.push(M.fromTX(i.tx));for(let n of i.tx.outputs)n.getAddress().equals(t)&&e.push(M.fromTX(i.tx))}),e},n.prototype.getMeta=function(t){const e=this.getEntry(t);if(!e)return null;const i=M.fromTX(e.tx);return i.mtime=e.time,i},n.prototype.hasEntry=function(t){return this.map.has(t)},n.prototype.has=function(t){return!!this.locker.has(t)||(!!this.hasOrphan(t)||this.hasEntry(t))},n.prototype.exists=function(t){return!!this.locker.hasPending(t)||(!!this.hasOrphan(t)||this.hasEntry(t))},n.prototype.hasReject=function(t){return this.rejects.test(t,"hex")},n.prototype.addTX=async function(t,e){const i=t.hash("hex"),n=await this.locker.lock(i);try{return await this._addTX(t,e)}finally{n()}},n.prototype._addTX=async function(t,e){null==e&&(e=-1);let i;try{i=await this.insertTX(t,e)}catch(e){throw"VerifyError"===e.type&&(t.hasWitness()||e.malleated||this.rejects.add(t.hash())),e}return E.now()-this.lastFlush>10&&(await this.cache.flush(),this.lastFlush=E.now()),i},n.prototype.insertTX=async function(t,e){y(!t.mutable,"Cannot add mutable TX to mempool.");const i=v.lockFlags.STANDARD_LOCKTIME_FLAGS,n=this.chain.height,r=t.hash("hex"),[s,o,a]=t.checkSanity(n);if(!s)throw new x(t,"invalid",o,a);if(t.isCoinbase())throw new x(t,"invalid","coinbase",100);if(this.options.requireStandard&&!this.chain.state.hasCSV()&&t.version>=2)throw new x(t,"nonstandard","premature-version2-tx",0);if(!this.chain.state.hasWitness()&&!this.options.prematureWitness&&t.hasWitness())throw new x(t,"nonstandard","no-witness-yet",0,!0);if(this.options.requireStandard){const[e,i,n]=t.checkStandard();if(!e)throw new x(t,"nonstandard",i,n);if(!this.options.replaceByFee&&t.isRBF())throw new x(t,"nonstandard","replace-by-fee",0)}if(!await this.verifyFinal(t,i))throw new x(t,"nonstandard","non-final",0);if(this.exists(r))throw new x(t,"alreadyknown","txn-already-in-mempool",0);if(await this.chain.hasCoins(t))throw new x(t,"alreadyknown","txn-already-known",0);if(this.isDoubleSpend(t))throw this.emit("conflict",t),new x(t,"duplicate","bad-txns-inputs-spent",0);const h=await this.getCoinView(t),c=this.maybeOrphan(t,h,e);if(c)return c;const u=N.fromTX(t,h,n);if(await this.verify(u,h),await this.addEntry(u,h),this.limitSize(r))throw new x(t,"insufficientfee","mempool full",0);return null},n.prototype.verify=async function(t,e){const i=this.chain.height+1,n=v.lockFlags.STANDARD_LOCKTIME_FLAGS,r=t.tx;if(!await this.verifyLocks(r,e,n))throw new x(r,"nonstandard","non-BIP68-final",0);if(this.options.requireStandard){if(!r.hasStandardInputs(e))throw new x(r,"nonstandard","bad-txns-nonstandard-inputs",0);if(this.chain.state.hasWitness()&&!r.hasStandardWitness(e))throw new x(r,"nonstandard","bad-witness-nonstandard",0,!0)}if(t.sigops>S.MAX_TX_SIGOPS_COST)throw new x(r,"nonstandard","bad-txns-too-many-sigops",0);const s=S.getMinFee(t.size,this.options.minRelay);if(this.options.relayPriority&&t.fee<s&&!t.isFree(i))throw new x(r,"insufficientfee","insufficient priority",0);if(this.options.limitFree&&t.fee<s){const e=E.now();if(this.freeCount*=Math.pow(1-1/600,e-this.lastTime),this.lastTime=e,this.freeCount>10*this.options.limitFreeRelay*1e3)throw new x(r,"insufficientfee","rate limited free transaction",0);this.freeCount+=t.size}if(this.options.rejectAbsurdFees&&t.fee>1e4*s)throw new x(r,"highfee","absurdly-high-fee",0);if(this.countAncestors(t)+1>this.options.maxAncestors)throw new x(r,"nonstandard","too-long-mempool-chain",0);const[o,a,h]=r.checkInputs(e,i);if(-1===o)throw new x(r,"invalid",a,h);let c=A.flags.STANDARD_VERIFY_FLAGS;try{await this.verifyInputs(r,e,c)}catch(t){if(r.hasWitness())throw t;if(c&=~A.flags.VERIFY_WITNESS,c&=~A.flags.VERIFY_CLEANSTACK,!await this.verifyResult(r,e,c))throw t;if(c|=A.flags.VERIFY_CLEANSTACK,await this.verifyResult(r,e,c))throw t;throw t.malleated=!0,t}if(this.options.paranoidChecks){const t=A.flags.MANDATORY_VERIFY_FLAGS;y(await this.verifyResult(r,e,t),"BUG: Verify failed for mandatory but not standard.")}},n.prototype.verifyResult=async function(t,e,i){try{await this.verifyInputs(t,e,i)}catch(t){if("VerifyError"===t.type)return!1;throw t}return!0},n.prototype.verifyInputs=async function(t,e,i){if(!await t.verifyAsync(e,i,this.workers)){if(i&A.flags.ONLY_STANDARD_VERIFY_FLAGS&&(i&=~A.flags.ONLY_STANDARD_VERIFY_FLAGS,await t.verifyAsync(e,i,this.workers)))throw new x(t,"nonstandard","non-mandatory-script-verify-flag",0);throw new x(t,"nonstandard","mandatory-script-verify-flag",100)}},n.prototype.addEntry=async function(t,e){const i=t.tx;this.trackEntry(t,e),this.updateAncestors(t,f),this.emit("tx",i,e),this.emit("add entry",t),this.fees&&this.fees.processTX(t,this.chain.synced),this.logger.debug("Added %s to mempool (txs=%d).",i.txid(),this.map.size),this.cache.save(t),await this.handleOrphans(i)},n.prototype.removeEntry=function(t){const e=t.tx,i=e.hash("hex");this.untrackEntry(t),this.fees&&this.fees.removeTX(i),this.cache.remove(e.hash()),this.emit("remove entry",t)},n.prototype.evictEntry=function(t){this.removeSpenders(t),this.updateAncestors(t,l),this.removeEntry(t)},n.prototype.removeSpenders=function(t){const e=t.tx,i=e.hash("hex");for(let t=0;t<e.outputs.length;t++){const e=this.getSpent(i,t);e&&(this.removeSpenders(e),this.removeEntry(e))}},n.prototype.countAncestors=function(t){return this._countAncestors(t,new Set,t,u)},n.prototype.updateAncestors=function(t,e){return this._countAncestors(t,new Set,t,e)},n.prototype._countAncestors=function(t,e,i,n){const r=t.tx;for(const{prevout:t}of r.inputs){const r=t.hash,s=this.getEntry(r);if(s&&!e.has(r)){if(e.add(r),n(s,i),e.size>this.options.maxAncestors)break;if(this._countAncestors(s,e,i,n),e.size>this.options.maxAncestors)break}}return e.size},n.prototype.countDescendants=function(t){return this._countDescendants(t,new Set)},n.prototype._countDescendants=function(t,e){const i=t.tx,n=i.hash("hex");for(let t=0;t<i.outputs.length;t++){const i=this.getSpent(n,t);if(!i)continue;const r=i.hash("hex");e.has(r)||(e.add(r),this._countDescendants(i,e))}return e.size},n.prototype.getAncestors=function(t){return this._getAncestors(t,[],new Set)},n.prototype._getAncestors=function(t,e,i){const n=t.tx;for(const{prevout:t}of n.inputs){const n=t.hash,r=this.getEntry(n);r&&(i.has(n)||(i.add(n),e.push(r),this._getAncestors(r,e,i)))}return e},n.prototype.getDescendants=function(t){return this._getDescendants(t,[],new Set)},n.prototype._getDescendants=function(t,e,i){const n=t.tx,r=n.hash("hex");for(let t=0;t<n.outputs.length;t++){const n=this.getSpent(r,t);if(!n)continue;const s=n.hash("hex");i.has(s)||(i.add(s),e.push(n),this._getDescendants(n,e,i))}return e},n.prototype.getDepends=function(t){const e=t.getPrevout(),i=[];for(const t of e)this.hasEntry(t)&&i.push(t);return i},n.prototype.hasDepends=function(t){for(const{prevout:e}of t.inputs)if(this.hasEntry(e.hash))return!0;return!1},n.prototype.getBalance=function(){let t=0;for(const[e,i]of this.map){const n=i.tx;for(let i=0;i<n.outputs.length;i++){const n=this.getCoin(e,i);n&&(t+=n.value)}}return t},n.prototype.getHistory=function(){const t=[];for(const e of this.map.values())t.push(e.tx);return t},n.prototype.getOrphan=function(t){return this.orphans.get(t)},n.prototype.hasOrphan=function(t){return this.orphans.has(t)},n.prototype.maybeOrphan=function(t,e,i){const n=new Set,r=[];for(const{prevout:i}of t.inputs)if(!e.hasEntry(i)){if(this.hasReject(i.hash))return this.logger.debug("Not storing orphan %s (rejected parents).",t.txid()),this.rejects.add(t.hash()),r;if(this.hasEntry(i.hash))return this.logger.debug("Not storing orphan %s (non-existent output).",t.txid()),this.rejects.add(t.hash()),r;n.add(i.hash)}if(0===n.size)return null;if(t.getWeight()>S.MAX_TX_WEIGHT)return this.logger.debug("Ignoring large orphan: %s",t.txid()),t.hasWitness()||this.rejects.add(t.hash()),r;if(0===this.options.maxOrphans)return r;this.limitOrphans();const s=t.hash("hex");for(const t of n.keys())this.waiting.has(t)||this.waiting.set(t,new Set),this.waiting.get(t).add(s),r.push(t);return this.orphans.set(s,new h(t,r.length,i)),this.logger.debug("Added orphan %s to mempool.",t.txid()),this.emit("add orphan",t),r},n.prototype.handleOrphans=async function(t){const e=this.resolveOrphans(t);for(const t of e){let e,i;try{e=t.toTX()}catch(t){this.logger.warning("%s %s","Warning: possible memory corruption.","Orphan failed deserialization.");continue}try{i=await this.insertTX(e,t.id)}catch(i){if("VerifyError"===i.type){this.logger.debug("Could not resolve orphan %s: %s.",e.txid(),i.message),e.hasWitness()||i.malleated||this.rejects.add(e.hash()),this.emit("bad orphan",i,t.id);continue}throw i}i&&i.length>0?(this.logger.debug("Transaction %s was double-orphaned in mempool.",e.txid()),this.removeOrphan(e.hash("hex"))):this.logger.debug("Resolved orphan %s in mempool.",e.txid())}},n.prototype.resolveOrphans=function(t){const e=t.hash("hex"),i=this.waiting.get(e);if(!i)return[];y(i.size>0);const n=[];for(const t of i.keys()){const e=this.getOrphan(t);y(e),0==--e.missing&&(this.orphans.delete(t),n.push(e))}return this.waiting.delete(e),n},n.prototype.removeOrphan=function(t){const e=this.getOrphan(t);if(!e)return!1;let i;try{i=e.toTX()}catch(e){return this.orphans.delete(t),this.logger.warning("%s %s","Warning: possible memory corruption.","Orphan failed deserialization."),!1}for(const e of i.getPrevout()){const i=this.waiting.get(e);i&&(y(i.has(t)),i.delete(t),0===i.size&&this.waiting.delete(e))}return this.orphans.delete(t),this.emit("remove orphan",i),!0},n.prototype.limitOrphans=function(){if(this.orphans.size<this.options.maxOrphans)return!1;let t,e=R.randomRange(0,this.orphans.size);for(t of this.orphans.keys()){if(0===e)break;e--}return y(t),this.logger.debug("Removing orphan %s from mempool.",E.revHex(t)),this.removeOrphan(t),!0},n.prototype.isDoubleSpend=function(t){for(const{prevout:e}of t.inputs){const{hash:t,index:i}=e;if(this.isSpent(t,i))return!0}return!1},n.prototype.getSpentView=async function(t){const e=await this.locker.lock();try{return await this.getCoinView(t)}finally{e()}},n.prototype.getCoinView=async function(t){const e=new z;for(const{prevout:i}of t.inputs){const{hash:t,index:n}=i,r=this.getTX(t);if(r){n<r.outputs.length&&e.addIndex(r,n,-1);continue}const s=await this.chain.readCoin(i);s&&e.addEntry(i,s)}return e},n.prototype.getSnapshot=function(){const t=[];for(const e of this.map.keys())t.push(e);return t},n.prototype.verifyLocks=function(t,e,i){return this.chain.verifyLocks(this.chain.tip,t,e,i)},n.prototype.verifyFinal=function(t,e){return this.chain.verifyFinal(this.chain.tip,t,e)},n.prototype.trackEntry=function(t,e){const i=t.tx,n=i.hash("hex");y(!this.map.has(n)),this.map.set(n,t),y(!i.isCoinbase());for(const{prevout:e}of i.inputs){const i=e.toKey();this.spents.set(i,t)}this.options.indexAddress&&e&&this.indexEntry(t,e),this.size+=t.memUsage()},n.prototype.untrackEntry=function(t){const e=t.tx,i=e.hash("hex");y(this.map.has(i)),this.map.delete(i),y(!e.isCoinbase());for(const{prevout:t}of e.inputs){const e=t.toKey();this.spents.delete(e)}this.options.indexAddress&&this.unindexEntry(t),this.size-=t.memUsage()},n.prototype.indexEntry=function(t,e){const i=t.tx;this.txIndex.insert(t,e);for(const{prevout:t}of i.inputs){const{hash:e,index:i}=t;this.coinIndex.remove(e,i)}for(let t=0;t<i.outputs.length;t++)this.coinIndex.insert(i,t)},n.prototype.unindexEntry=function(t){const e=t.tx,i=e.hash("hex");this.txIndex.remove(i);for(const{prevout:t}of e.inputs){const{hash:e,index:i}=t,n=this.getTX(e);n&&this.coinIndex.insert(n,i)}for(let t=0;t<e.outputs.length;t++)this.coinIndex.remove(i,t)},n.prototype.removeDoubleSpends=function(t){for(const{prevout:e}of t.inputs){const{hash:t,index:i}=e,n=this.getSpent(t,i);n&&(this.logger.debug("Removing double spender from mempool: %s.",n.txid()),this.evictEntry(n),this.emit("double spend",n))}},n.prototype.getSize=function(){return this.size},n.prototype.getCount=function(){return this.map.size},n.prototype.prioritise=function(t,e,i){-e>t.priority&&(e=-t.priority),t.priority+=e,-i>t.deltaFee&&(i=-t.deltaFee),0!==i&&(this.updateAncestors(t,p),t.deltaFee+=i,t.descFee+=i,this.updateAncestors(t,d))},r.prototype.fromOptions=function(t){return y(t,"Mempool requires options."),y(t.chain&&"object"==typeof t.chain,"Mempool requires a blockchain."),this.chain=t.chain,this.network=t.chain.network,this.logger=t.chain.logger,this.workers=t.chain.workers,this.requireStandard=this.network.requireStandard,this.minRelay=this.network.minRelay,null!=t.logger&&(y("object"==typeof t.logger),this.logger=t.logger),null!=t.workers&&(y("object"==typeof t.workers),this.workers=t.workers),null!=t.fees&&(y("object"==typeof t.fees),this.fees=t.fees),null!=t.limitFree&&(y("boolean"==typeof t.limitFree),this.limitFree=t.limitFree),null!=t.limitFreeRelay&&(y(E.isU32(t.limitFreeRelay)),this.limitFreeRelay=t.limitFreeRelay),null!=t.relayPriority&&(y("boolean"==typeof t.relayPriority),this.relayPriority=t.relayPriority),null!=t.requireStandard&&(y("boolean"==typeof t.requireStandard),this.requireStandard=t.requireStandard),null!=t.rejectAbsurdFees&&(y("boolean"==typeof t.rejectAbsurdFees),this.rejectAbsurdFees=t.rejectAbsurdFees),null!=t.prematureWitness&&(y("boolean"==typeof t.prematureWitness),this.prematureWitness=t.prematureWitness),null!=t.paranoidChecks&&(y("boolean"==typeof t.paranoidChecks),this.paranoidChecks=t.paranoidChecks),null!=t.replaceByFee&&(y("boolean"==typeof t.replaceByFee),this.replaceByFee=t.replaceByFee),null!=t.maxSize&&(y(E.isU64(t.maxSize)),this.maxSize=t.maxSize),null!=t.maxOrphans&&(y(E.isU32(t.maxOrphans)),this.maxOrphans=t.maxOrphans),null!=t.maxAncestors&&(y(E.isU32(t.maxAncestors)),this.maxAncestors=t.maxAncestors),null!=t.expiryTime&&(y(E.isU32(t.expiryTime)),this.expiryTime=t.expiryTime),null!=t.minRelay&&(y(E.isU64(t.minRelay)),this.minRelay=t.minRelay),null!=t.prefix&&(y("string"==typeof t.prefix),this.prefix=t.prefix,this.location=w.join(this.prefix,"mempool")),null!=t.location&&(y("string"==typeof t.location),this.location=t.location),null!=t.db&&(y("string"==typeof t.db),this.db=t.db),null!=t.maxFiles&&(y(E.isU32(t.maxFiles)),this.maxFiles=t.maxFiles),null!=t.cacheSize&&(y(E.isU64(t.cacheSize)),this.cacheSize=t.cacheSize),null!=t.compression&&(y("boolean"==typeof t.compression),this.compression=t.compression),null!=t.persistent&&(y("boolean"==typeof t.persistent),this.persistent=t.persistent),null!=t.indexAddress&&(y("boolean"==typeof t.indexAddress),this.indexAddress=t.indexAddress),this},r.fromOptions=function(t){return(new r).fromOptions(t)},s.prototype.reset=function(){this.index.clear(),this.map.clear()},s.prototype.get=function(t){const e=this.index.get(t);if(!e)return[];const i=[];for(const t of e.values())i.push(t.tx);return i},s.prototype.getMeta=function(t){const e=this.index.get(t);if(!e)return[];const i=[];for(const t of e.values()){const e=M.fromTX(t.tx);e.mtime=t.time,i.push(e)}return i},s.prototype.insert=function(t,e){const i=t.tx,n=i.hash("hex"),r=i.getHashes(e,"hex");if(0!==r.length){for(const e of r){let i=this.index.get(e);i||(i=new Map,this.index.set(e,i)),y(!i.has(n)),i.set(n,t)}this.map.set(n,r)}},s.prototype.remove=function(t){const e=this.map.get(t);if(e){for(const i of e){const e=this.index.get(i);y(e),y(e.has(t)),e.delete(t),0===e.size&&this.index.delete(i)}this.map.delete(t)}},o.prototype.reset=function(){this.index.clear(),this.map.clear()},o.prototype.get=function(t){const e=this.index.get(t);if(!e)return[];const i=[];for(const t of e.values())i.push(t.toCoin());return i},o.prototype.insert=function(t,e){const i=t.outputs[e],n=t.hash("hex"),r=i.getHash("hex");if(!r)return;let s=this.index.get(r);s||(s=new Map,this.index.set(r,s));const o=O.toKey(n,e);y(!s.has(o)),s.set(o,new a(t,e)),this.map.set(o,r)},o.prototype.remove=function(t,e){const i=O.toKey(t,e),n=this.map.get(i);if(!n)return;const r=this.index.get(n);y(r),y(r.has(i)),r.delete(i),0===r.size&&this.index.delete(n),this.map.delete(i)},a.prototype.toCoin=function(){return P.fromTX(this.tx,this.index,-1)},h.prototype.toTX=function(){return B.fromRaw(this.raw)},c.VERSION=2,c.prototype.getVersion=async function(){const t=await this.db.get(U.V);return t?t.readUInt32LE(0,!0):-1},c.prototype.getTip=async function(){const t=await this.db.get(U.R);return t?t.toString("hex"):null},c.prototype.getFees=async function(){const t=await this.db.get(U.F);if(!t)return null;let e;try{e=L.fromRaw(t)}catch(t){this.logger.warning("Fee data failed deserialization: %s.",t.message)}return e},c.prototype.getEntries=function(){return this.db.values({gte:U.e(C.ZERO_HASH),lte:U.e(C.MAX_HASH),parse:N.fromRaw})},c.prototype.getKeys=function(){return this.db.keys({gte:U.e(C.ZERO_HASH),lte:U.e(C.MAX_HASH)})},c.prototype.open=async function(){this.db&&(await this.db.open(),await this.verify(),this.batch=this.db.batch())},c.prototype.close=async function(){this.db&&(await this.db.close(),this.batch=null)},c.prototype.save=function(t){this.db&&this.batch.put(U.e(t.tx.hash()),t.toRaw())},c.prototype.remove=function(t){this.db&&this.batch.del(U.e(t))},c.prototype.sync=function(t){this.db&&this.batch.put(U.R,Buffer.from(t,"hex"))},c.prototype.writeFees=function(t){this.db&&this.batch.put(U.F,t.toRaw())},c.prototype.clear=function(){this.batch.clear(),this.batch=this.db.batch()},c.prototype.flush=async function(){this.db&&(await this.batch.write(),this.batch=this.db.batch())},c.prototype.init=async function(t){const e=this.db.batch();e.put(U.V,C.U32(c.VERSION)),e.put(U.R,Buffer.from(t,"hex")),await e.write()},c.prototype.verify=async function(){let t,e=await this.getVersion();return-1===e&&(e=c.VERSION,t=this.chain.tip.hash,this.logger.info("Mempool cache is empty. Writing tip %s.",E.revHex(t)),await this.init(t)),e!==c.VERSION?(this.logger.warning("Mempool cache version mismatch (%d != %d)!",e,c.VERSION),this.logger.warning("Invalidating mempool cache."),await this.wipe(),!1):(t=await this.getTip())===this.chain.tip.hash||(this.logger.warning("Mempool tip not consistent with chain tip (%s != %s)!",E.revHex(t),this.chain.tip.rhash()),this.logger.warning("Invalidating mempool cache."),await this.wipe(),!1)},c.prototype.wipe=async function(){const t=this.db.batch(),e=await this.getKeys();for(const i of e)t.del(i);t.put(U.V,C.U32(c.VERSION)),t.put(U.R,Buffer.from(this.chain.tip.hash,"hex")),t.del(U.F),await t.write(),this.logger.info("Removed %d mempool entries from disk.",e.length)},t.exports=n},function(t,e,i){"use strict";function n(t){if(!(this instanceof n))return new n(t);this.compare=r,this.items=[],t&&this.set(t)}function r(t,e){throw new Error("No heap comparator set.")}const s=i(0);n.prototype.init=function(){const t=this.items.length;if(!(t<=1))for(let e=(t/2|0)-1;e>=0;e--)this.down(e,t)},n.prototype.size=function(){return this.items.length},n.prototype.set=function(t){s("function"==typeof t,"Comparator must be a function."),this.compare=t},n.prototype.insert=function(t){return this.items.push(t),this.up(this.items.length-1),this.items.length},n.prototype.shift=function(){if(0===this.items.length)return null;const t=this.items.length-1;return this.swap(0,t),this.down(0,t),this.items.pop()},n.prototype.remove=function(t){if(0===this.items.length)return null;const e=this.items.length-1;return t<0||t>e?null:(e!==t&&(this.swap(t,e),this.down(t,e),this.up(t)),this.items.pop())},n.prototype.swap=function(t,e){const i=this.items[t],n=this.items[e];this.items[t]=n,this.items[e]=i},n.prototype.less=function(t,e){return this.compare(this.items[t],this.items[e])<0},n.prototype.down=function(t,e){for(;;){const i=2*t+1;if(s(i>=0),i<0||i>=e)break;let n=i;const r=i+1;if(r<e&&!this.less(i,r)&&(n=r),!this.less(n,t))break;this.swap(t,n),t=n}},n.prototype.up=function(t){for(;;){const e=(t-1)/2|0;if(s(e>=0),e<0||e===t)break;if(!this.less(t,e))break;this.swap(e,t),t=e}},n.prototype.toArray=function(){const t=new n,e=[];for(t.compare=this.compare,t.items=this.items.slice();t.size()>0;)e.push(t.shift());return e},n.fromArray=function(t,e){const i=new n;return i.set(t),i.items=e,i.init(),i},t.exports=n},function(t,e,i){"use strict";const n=i(0),r=i(7),s=i(26),o=e;o.swap32=function(t){for(let e=0;e<t.length;e+=4){const i=t.readUInt32LE(e,!0);t.writeUInt32BE(i,e,!0)}return t},o.swap32hex=function(t){const e=Buffer.from(t,"hex");return o.swap32(e).toString("hex")},o.rcmp=function(t,e){n(t.length===e.length);for(let i=t.length-1;i>=0;i--){if(t[i]<e[i])return-1;if(t[i]>e[i])return 1}return 0},o.double256=function(t){let e,i,r=0;return n(32===t.length),e=t.readUInt32LE(28,!0),i=t.readUInt32LE(24,!0),r+=6.277101735386681e57*(4294967296*e+i),e=t.readUInt32LE(20,!0),i=t.readUInt32LE(16,!0),r+=3.402823669209385e38*(4294967296*e+i),e=t.readUInt32LE(12,!0),i=t.readUInt32LE(8,!0),r+=0x10000000000000000*(4294967296*e+i),e=t.readUInt32LE(4,!0),i=t.readUInt32LE(0,!0),r+=1*(4294967296*e+i)},o.getDifficulty=function(t){const e=o.double256(t);return 0===e?2.695953529101131e67:Math.floor(2.695953529101131e67/e)},o.getTarget=function(t){const e=r.fromCompact(t);if(e.isNeg())throw new Error("Target is negative.");if(0===e.cmpn(0))throw new Error("Target is zero.");return e.toArrayLike(Buffer,"le",32)},o.getBits=function(t){const e=new s(t,"le");if(0===e.cmpn(0))throw new Error("Target is zero.");return r.toCompact(e)}},function(t,e,i){"use strict";function n(t){if(!(this instanceof n))return new n(t);u.call(this),this.options=new r(t),this.network=this.options.network,this.logger=this.options.logger.context("miner"),this.workers=this.options.workers,this.chain=this.options.chain,this.mempool=this.options.mempool,this.addresses=this.options.addresses,this.locker=this.chain.locker,this.cpu=new y(this),this.address=null,this.init()}function r(t){if(!(this instanceof r))return new r(t);this.network=d.primary,this.logger=null,this.workers=null,this.chain=null,this.mempool=null,this.version=-1,this.addresses=[],this.coinbaseFlags=Buffer.from("mined by wmcc_user","ascii"),this.preverify=!1,this.minWeight=g.MIN_BLOCK_WEIGHT,this.maxWeight=g.MAX_BLOCK_WEIGHT,this.priorityWeight=g.BLOCK_PRIORITY_WEIGHT,this.priorityThreshold=g.BLOCK_PRIORITY_THRESHOLD,this.maxSigops=m.MAX_BLOCK_SIGOPS_COST,this.reservedWeight=4e3,this.reservedSigops=400,this.fromOptions(t)}function s(t,e){return t.priority===e.priority?o(t,e):e.priority-t.priority}function o(t,e){let i=t.rate,n=e.rate;return t.descRate>t.rate&&(i=t.descRate),e.descRate>e.rate&&(n=e.descRate),i===n&&(i=t.priority,n=e.priority),n-i}const a=i(0),h=i(1),c=i(179),u=i(30),f=i(20),l=i(11),p=i(182),d=i(6),m=i(7),g=i(19),y=i(233),w=p.BlockEntry;Object.setPrototypeOf(n.prototype,u.prototype),n.prototype.init=function(){this.cpu.on("error",t=>{this.emit("error",t)}),this.cpu.on("block",(t,e)=>{this.emit("miner found",t,e)})},n.prototype._open=async function(){await this.chain.open(),this.mempool&&await this.mempool.open(),await this.cpu.open(),this.logger.info("Miner loaded (flags=%s).",this.options.coinbaseFlags.toString("utf8")),0===this.addresses.length&&this.logger.info("No default reward address is set for miner.\nClient will use your recent wallet address.")},n.prototype._close=async function(){await this.cpu.close()},n.prototype.createBlock=async function(t,e){const i=await this.locker.lock();try{return await this._createBlock(t,e)}finally{i()}},n.prototype._createBlock=async function(t,e){let i=this.options.version;t||(t=this.chain.tip),e||(e=this.getAddress()),-1===i&&(i=await this.chain.computeBlockVersion(t));const n=await this.chain.getMedianTime(t),r=Math.max(this.network.now(),n+1),s=await this.chain.getDeployments(r,t),o=await this.chain.getTarget(r,t),a=s.hasMTP()?n:r,h=(await this.chain.getBlock(t.hash)).getCoinreserve(),c=new p({prevBlock:t.hash,height:t.height+1,version:i,time:r,bits:o,locktime:a,mtp:n,flags:s.flags,address:e,reserve:h.getAddress(),coinbaseFlags:this.options.coinbaseFlags,witness:s.hasWitness(),interval:this.network.halvingInterval,weight:this.options.reservedWeight,sigops:this.options.reservedSigops});if(this.assemble(c),this.logger.debug("Created block template (height=%d, weight=%d, fees=%d, txs=%s, diff=%d).",c.height,c.weight,f.wmcc(c.fees),c.items.length+1,c.getDifficulty()),this.options.preverify){const t=c.toBlock();try{await this.chain._verifyBlock(t)}catch(t){if("VerifyError"===t.type)throw this.logger.warning("Miner created invalid block!"),this.logger.error(t),new Error("BUG: Miner created invalid block.");throw t}this.logger.debug("Preverified block %d successfully!",c.height)}return this.emit("miner block",c),c},n.prototype.updateTime=function(t){t.time=Math.max(this.network.now(),t.mtp+1)},n.prototype.createJob=function(t,e){return this.cpu.createJob(t,e)},n.prototype.mineBlock=function(t,e){return this.cpu.mineBlock(t,e)},n.prototype.reset=async function(t){try{this.cpu.job.destroy(),this.cpu.workers.destroy()}catch(t){}this.cpu=new y(this),t&&await this.cpu.start()},n.prototype.addAddress=function(t){this.addresses.push(l(t))},n.prototype.getAddress=function(){return a(this.addresses.length),this.address=this.address||this.addresses[Math.random()*this.addresses.length|0]},n.prototype.assemble=function(t){if(!this.mempool)return void t.refresh();a(this.mempool.tip===this.chain.tip.hash,"Mempool/chain tip mismatch! Unsafe to create block.");const e=new Map,i=new c(o);let n=this.options.priorityWeight>0;n&&i.set(s);for(const n of this.mempool.map.values()){const r=w.fromEntry(n,t),s=r.tx;if(s.isCoinbase())throw new Error("Cannot add coinbase to block.");for(const{prevout:t}of s.inputs){const i=t.hash;this.mempool.hasEntry(i)&&(r.depCount+=1,e.has(i)||e.set(i,[]),e.get(i).push(r))}r.depCount>0||i.insert(r)}for(;i.size()>0;){const r=i.shift(),s=r.tx,a=r.hash;let h=t.weight,c=t.sigops;if(!s.isFinal(t.height,t.locktime))continue;if(!t.witness&&s.hasWitness())continue;if((h+=s.getWeight())>this.options.maxWeight)continue;if((c+=r.sigops)>this.options.maxSigops)continue;if(n){if(h>this.options.priorityWeight||r.priority<this.options.priorityThreshold){n=!1,i.set(o),i.init(),i.insert(r);continue}}else if(r.free&&h>=this.options.minWeight)continue;t.weight=h,t.sigops=c,t.fees+=r.fee,t.items.push(r);const u=e.get(a);if(u)for(const t of u)0==--t.depCount&&i.insert(t)}if(t.refresh(),a(t.weight<=m.MAX_BLOCK_WEIGHT,"Block exceeds reserved weight!"),this.options.preverify){const e=t.toBlock();a(e.getWeight()<=t.weight,"Block exceeds reserved weight!"),a(e.getBaseSize()<=m.MAX_BLOCK_SIZE,"Block exceeds max block size.")}},r.prototype.fromOptions=function(t){if(a(t,"Miner requires options."),a(t.chain&&"object"==typeof t.chain,"Miner requires a blockchain."),this.chain=t.chain,this.network=t.chain.network,this.logger=t.chain.logger,this.workers=t.chain.workers,null!=t.logger&&(a("object"==typeof t.logger),this.logger=t.logger),null!=t.workers&&(a("object"==typeof t.workers),this.workers=t.workers),null!=t.mempool&&(a("object"==typeof t.mempool),this.mempool=t.mempool),null!=t.version&&(a(h.isInt(t.version)),this.version=t.version),t.address)if(Array.isArray(t.address))for(const e of t.address)this.addresses.push(new l(e));else this.addresses.push(new l(t.address));if(t.addresses){a(Array.isArray(t.addresses));for(const e of t.addresses)this.addresses.push(new l(e))}if(t.coinbaseFlags){let e=t.coinbaseFlags;"string"==typeof e&&(e=Buffer.from(e,"utf8")),a(Buffer.isBuffer(e)),a(e.length<=20,"Coinbase flags > 20 bytes."),this.coinbaseFlags=e}return null!=t.preverify&&(a("boolean"==typeof t.preverify),this.preverify=t.preverify),null!=t.minWeight&&(a(h.isU32(t.minWeight)),this.minWeight=t.minWeight),null!=t.maxWeight&&(a(h.isU32(t.maxWeight)),a(t.maxWeight<=m.MAX_BLOCK_WEIGHT,"Max weight must be below MAX_BLOCK_WEIGHT"),this.maxWeight=t.maxWeight),null!=t.maxSigops&&(a(h.isU32(t.maxSigops)),a(t.maxSigops<=m.MAX_BLOCK_SIGOPS_COST,"Max sigops must be below MAX_BLOCK_SIGOPS_COST"),this.maxSigops=t.maxSigops),null!=t.priorityWeight&&(a(h.isU32(t.priorityWeight)),this.priorityWeight=t.priorityWeight),null!=t.priorityThreshold&&(a(h.isU32(t.priorityThreshold)),this.priorityThreshold=t.priorityThreshold),null!=t.reservedWeight&&(a(h.isU32(t.reservedWeight)),this.reservedWeight=t.reservedWeight),null!=t.reservedSigops&&(a(h.isU32(t.reservedSigops)),this.reservedSigops=t.reservedSigops),this},r.fromOptions=function(t){return(new r).fromOptions(t)},t.exports=n},function(t,e,i){"use strict";function n(t){if(!(this instanceof n))return new n(t);this.prevBlock=b.NULL_HASH,this.version=1,this.height=0,this.time=0,this.bits=0,this.target=b.ZERO_HASH,this.locktime=0,this.mtp=0,this.flags=0,this.coinbaseFlags=R,this.witness=!1,this.address=new l,this.reserve=new l,this.sigops=400,this.weight=4e3,this.interval=21e4,this.fees=0,this.tree=new o,this.commitment=b.ZERO_HASH,this.left=R,this.right=R,this.items=[],t&&this.fromOptions(t)}function r(t){this.tx=t,this.hash=t.hash("hex"),this.fee=0,this.rate=0,this.priority=0,this.free=!1,this.sigops=0,this.descRate=0,this.depCount=0}function s(t,e,i,n,r,s){this.hash=t,this.root=e,this.nonce1=i,this.nonce2=n,this.time=r,this.nonce=s}function o(){this.steps=[]}const a=i(0),h=i(1),c=i(5),u=i(66),f=i(4),l=i(11),p=i(15),d=i(51),m=i(41),g=i(13),y=i(7),w=i(19),b=i(3),v=i(29),k=i(8),S=i(180),E=(i(44),i(58)),R=Buffer.alloc(0);n.prototype.fromOptions=function(t){return a(t),null!=t.prevBlock&&(a("string"==typeof t.prevBlock),this.prevBlock=t.prevBlock),null!=t.version&&(a("number"==typeof t.version),this.version=t.version),null!=t.height&&(a("number"==typeof t.height),this.height=t.height),null!=t.time&&(a("number"==typeof t.time),this.time=t.time),null!=t.bits&&this.setBits(t.bits),null!=t.target&&this.setTarget(t.target),null!=t.locktime&&(a("number"==typeof t.locktime),this.locktime=t.locktime),null!=t.mtp&&(a("number"==typeof t.mtp),this.mtp=t.mtp),null!=t.flags&&(a("number"==typeof t.flags),this.flags=t.flags),null!=t.coinbaseFlags&&(a(Buffer.isBuffer(t.coinbaseFlags)),this.coinbaseFlags=t.coinbaseFlags),null!=t.witness&&(a("boolean"==typeof t.witness),this.witness=t.witness),null!=t.address&&this.address.fromOptions(t.address),null!=t.reserve&&this.reserve.fromOptions(t.reserve),null!=t.sigops&&(a("number"==typeof t.sigops),this.sigops=t.sigops),null!=t.weight&&(a("number"==typeof t.weight),this.weight=t.weight),null!=t.interval&&(a("number"==typeof t.interval),this.interval=t.interval),null!=t.fees&&(a("number"==typeof t.fees),this.fees=t.fees),null!=t.items&&(a(Array.isArray(t.items)),this.items=t.items),this},n.fromOptions=function(t){return(new n).fromOptions(t)},n.prototype.getWitnessHash=function(){const t=b.ZERO_HASH,e=[];e.push(b.ZERO_HASH);for(const t of this.items)e.push(t.tx.witnessHash());const[i,n]=u.createRoot(e);return a(!n),c.root256(i,t)},n.prototype.getWitnessScript=function(){return k.fromCommitment(this.commitment)},n.prototype.setBits=function(t){a("number"==typeof t),this.bits=t,this.target=S.getTarget(t)},n.prototype.setTarget=function(t){a(Buffer.isBuffer(t)),this.bits=S.getBits(t),this.target=t},n.prototype.getReward=function(){return y.getReward(this.height,this.interval)+this.fees},n.prototype.getReserve=function(){return y.BASE_RESERVE},n.prototype.createCoinbase=function(t){const e=y.WITNESS_SCALE_FACTOR,i=new p,n=new m;n.script.pushInt(this.height),n.script.pushData(b.ZERO_HASH160),n.script.pushData(h.nonce(4)),n.script.pushData(b.ZERO_U64),n.script.compile(),this.witness&&(n.witness.push(b.ZERO_HASH),n.witness.compile()),i.inputs.push(n);const r=new g;r.script.fromPubkeyhash(b.ZERO_HASH160),r.value=this.getReward(),i.outputs.push(r);const s=new g;if(s.script.fromPubkeyhash(b.ZERO_HASH160),s.value=this.getReserve(),i.outputs.push(s),this.witness){const e=new g;e.script.fromCommitment(t),i.outputs.push(e)}const o=n.script.get(0);a(o);const c=5-o.getSize();return a(c>=0),this.witness?(a.strictEqual(i.getWeight()+c*e,860),a.strictEqual(i.getBaseSize()+c,206),a.strictEqual(i.getSize()+c,242)):(a.strictEqual(i.getWeight()+c*e,636),a.strictEqual(i.getBaseSize()+c,159),a.strictEqual(i.getSize()+c,159)),n.script.setData(1,this.coinbaseFlags),n.script.compile(),r.script.fromAddress(this.address),s.script.fromAddress(this.reserve),i.refresh(),a(n.script.getSize()<=100,"Coinbase input script is too large!"),i},n.prototype.refresh=function(){const t=this.getWitnessHash(),e=this.createCoinbase(t),i=e.toNormal();let n=0;n+=4,n+=1,n+=e.inputs[0].getSize(),n-=12;const r=i.slice(0,n);n+=8;const s=i.slice(n);this.commitment=t,this.left=r,this.right=s,this.tree=o.fromItems(this.items)},n.prototype.getRawCoinbase=function(t,e){let i=0;i+=this.left.length,i+=8,i+=this.right.length;const n=new f(i);return n.writeBytes(this.left),n.writeU32BE(t),n.writeU32BE(e),n.writeBytes(this.right),n.render()},n.prototype.getRoot=function(t,e){const i=this.getRawCoinbase(t,e),n=c.hash256(i);return this.tree.withFirst(n)},n.prototype.getHeader=function(t,e,i){const n=new f(80);return n.writeU32(this.version),n.writeHash(this.prevBlock),n.writeHash(t),n.writeU32(e),n.writeU32(this.bits),n.writeU32(i),n.render()},n.prototype.getProof=function(t,e,i,n){const r=this.getRoot(t,e),o=this.getHeader(r,i,n);return new s(E.digest(o),r,t,e,i,n)},n.prototype.getCoinbase=function(t,e){const i=this.getRawCoinbase(t,e),n=p.fromRaw(i);if(this.witness){const t=n.inputs[0];t.witness.push(b.ZERO_HASH),t.witness.compile(),n.refresh()}return n},n.prototype.commit=function(t){const e=t.root,i=t.nonce1,n=t.nonce2,r=t.time,s=t.nonce,o=new d;o.version=this.version,o.prevBlock=this.prevBlock,o.merkleRoot=e.toString("hex"),o.time=r,o.bits=this.bits,o.nonce=s;const a=this.getCoinbase(i,n);o.txs.push(a);for(const t of this.items)o.txs.push(t.tx);return o},n.prototype.toCoinbase=function(){return this.getCoinbase(0,0)},n.prototype.toBlock=function(){const t=this.getProof(0,0,this.time,0);return this.commit(t)},n.prototype.getDifficulty=function(){return S.getDifficulty(this.target)},n.prototype.setAddress=function(t){this.address=l(t),this.refresh()},n.prototype.addTX=function(t,e){a(!t.mutable,"Cannot add mutable TX to block.");const i=r.fromTX(t,e,this),n=i.tx.getWeight(),s=i.sigops;return!!t.isFinal(this.height,this.locktime)&&(!(this.weight+n>y.MAX_BLOCK_WEIGHT)&&(!(this.sigops+s>y.MAX_BLOCK_SIGOPS_COST)&&(!(!this.witness&&t.hasWitness())&&(this.weight+=n,this.sigops+=s,this.fees+=i.fee,this.items.push(i),!0))))},n.prototype.pushTX=function(t,e){a(!t.mutable,"Cannot add mutable TX to block."),e||(e=new v);const i=r.fromTX(t,e,this),n=i.tx.getWeight(),s=i.sigops;return this.weight+=n,this.sigops+=s,this.fees+=i.fee,this.items.push(i),!0},r.fromTX=function(t,e,i){const n=new r(t);return n.fee=t.getFee(e),n.rate=t.getRate(e),n.priority=t.getPriority(e,i.height),n.free=!1,n.sigops=t.getSigopsCost(e,i.flags),n.descRate=n.rate,n},r.fromEntry=function(t,e){const i=new r(t.tx);return i.fee=t.getFee(),i.rate=t.getDeltaRate(),i.priority=t.getPriority(e.height),i.free=t.getDeltaFee()<w.getMinFee(t.size),i.sigops=t.sigops,i.descRate=t.getDescRate(),i},s.prototype.rhash=function(){return h.revHex(this.hash.toString("hex"))},s.prototype.verify=function(t){return S.rcmp(this.hash,t)<=0},s.prototype.getDifficulty=function(){return S.getDifficulty(this.hash)},o.prototype.withFirst=function(t){for(const e of this.steps)t=c.root256(t,e);return t},o.prototype.toJSON=function(){const t=[];for(const e of this.steps)t.push(e.toString("hex"));return t},o.prototype.fromItems=function(t){const e=[];e.push(b.ZERO_HASH);for(const i of t)e.push(i.tx.hash());return this.fromLeaves(e)},o.fromItems=function(t){return(new o).fromItems(t)},o.prototype.fromBlock=function(t){const e=[];e.push(b.ZERO_HASH);for(let i=1;i<t.length;i++){const n=t[i];e.push(n.hash())}return this.fromLeaves(e)},o.fromBlock=function(t){return(new o).fromBlock(t)},o.prototype.fromLeaves=function(t){let e=t.length;for(;e>1;){const i=[b.ZERO_HASH];this.steps.push(t[1]),e%2&&t.push(t[e-1]);for(let n=2;n<e;n+=2){const e=c.root256(t[n],t[n+1]);i.push(e)}e=(t=i).length}return this},o.fromLeaves=function(t){return(new o).fromLeaves(t)},(e=n).BlockTemplate=n,e.BlockEntry=r,t.exports=e},function(t,e,i){"use strict";function n(){if(!(this instanceof n))return new n;h.call(this),this.socket=new c.Socket,this.state=n.states.INIT,this.target=n.states.INIT,this.destHost="0.0.0.0",this.destPort=0,this.username="",this.password="",this.name="localhost",this.destroyed=!1,this.timeout=null,this.proxied=!1}function r(t,e,i,n){if(!(this instanceof r))return new r(t,e,i,n);h.call(this),a("string"==typeof t),a("number"==typeof e),this.socket=null,this.host=t,this.port=e,this.username=i||null,this.password=n||null,this.bytesWritten=0,this.bytesRead=0,this.remoteAddress=null,this.remotePort=0,this.ops=[]}function s(t){const e=t.indexOf("@");if(-1===e){const e=f.fromHostname(t,1080);return{host:e.host,port:e.port}}const i=t.substring(0,e),n=t.substring(e+1),r=i.split(":");a(r.length>1,"Bad username and password.");const s=f.fromHostname(n,1080);return{host:s.host,port:s.port,username:r[0],password:r[1]}}function o(t,e){const i=new p(t);if(i.left()<e+2)throw new Error("Bad SOCKS address length.");i.seek(e);const n=i.readU8();let r,s;switch(n){case 1:if(i.left()<6)throw new Error("Bad SOCKS ipv4 length.");r=f.toString(i.readBytes(4)),s=i.readU16BE();break;case 3:{const t=i.readU8();if(i.left()<t+2)throw new Error("Bad SOCKS domain length.");r=i.readString(t,"utf8"),s=i.readU16BE();break}case 4:if(i.left()<18)throw new Error("Bad SOCKS ipv6 length.");r=f.toString(i.readBytes(16)),s=i.readU16BE();break;default:throw new Error(`Unknown SOCKS address type: ${n}.`)}return{type:n,host:r,port:s}}const a=i(0),h=i(10),c=i(168),u=i(1),f=i(46),l=i(4),p=i(2);Object.setPrototypeOf(n.prototype,h.prototype),n.states={INIT:0,CONNECT:1,HANDSHAKE:2,AUTH:3,PROXY:4,PROXY_DONE:5,RESOLVE:6,RESOLVE_DONE:7},n.statesByVal=u.reverse(n.states),n.errors=["","General failure","Connection not allowed","Network is unreachable","Host is unreachable","Connection refused","TTL expired","Command not supported","Address type not supported","Unknown proxy error"],n.prototype.error=function(t){if(this.destroyed)return;if(t instanceof Error)return this.emit("error",t),void this.destroy();const e=u.fmt.apply(u,arguments);this.emit("error",new Error(e)),this.destroy()},n.prototype.getError=function(t){return t>=n.errors.length?n.errors[9]:n.errors[t]},n.prototype.destroy=function(){this.destroyed||(this.destroyed=!0,this.socket.destroy(),this.stopTimeout(),this.state!==this.target&&this.emit("close"))},n.prototype.startTimeout=function(){this.timeout=setTimeout(()=>{const t=n.statesByVal[this.state];this.timeout=null,this.error("SOCKS request timed out (state=%s).",t)},8e3)},n.prototype.stopTimeout=function(){null!=this.timeout&&(clearTimeout(this.timeout),this.timeout=null)},n.prototype.connect=function(t,e){a("number"==typeof t),a("string"==typeof e),this.state=n.states.CONNECT,this.socket.connect(t,e),this.socket.on("connect",()=>{this.proxied||this.handleConnect()}),this.socket.on("data",t=>{this.proxied||this.handleData(t)}),this.socket.on("error",t=>{this.proxied||this.handleError(t)}),this.socket.on("close",()=>{this.proxied||this.handleClose()})},n.prototype.open=function(t){a(this.state===n.states.INIT),a(t),null!=t.username&&(a("string"==typeof t.username),this.username=t.username,a("string"==typeof t.password,"Username must have a password.")),null!=t.password&&(a("string"==typeof t.password),this.password=t.password),this.startTimeout(),this.connect(t.port,t.host)},n.prototype.proxy=function(t){a(t),a("string"==typeof t.destHost),a("number"==typeof t.destPort),this.destHost=t.destHost,this.destPort=t.destPort,this.target=n.states.PROXY_DONE,this.open(t)},n.prototype.resolve=function(t){a(t),a("string"==typeof t.name),this.name=t.name,this.target=n.states.RESOLVE_DONE,this.open(t)},n.prototype.handleConnect=function(){a(this.state===n.states.CONNECT),this.sendHandshake()},n.prototype.handleError=function(t){this.error(t)},n.prototype.handleClose=function(){if(this.state===this.target)this.destroy();else{const t=n.statesByVal[this.state];this.error("SOCKS request destroyed (state=%s).",t)}},n.prototype.handleData=function(t){switch(this.state){case n.states.INIT:this.error("Data before SOCKS connection.");break;case n.states.CONNECT:this.error("Data before SOCKS handshake.");break;case n.states.HANDSHAKE:this.handleHandshake(t);break;case n.states.AUTH:this.handleAuth(t);break;case n.states.PROXY:this.handleProxy(t);break;case n.states.RESOLVE:this.handleResolve(t);break;case n.states.PROXY_DONE:case n.states.RESOLVE_DONE:break;default:a(!1,"Bad state.")}},n.prototype.sendHandshake=function(){let t;this.username?((t=Buffer.allocUnsafe(4))[0]=5,t[1]=2,t[2]=0,t[3]=2):((t=Buffer.allocUnsafe(3))[0]=5,t[1]=1,t[2]=0),this.state=n.states.HANDSHAKE,this.socket.write(t)},n.prototype.handleHandshake=function(t){if(2===t.length)if(5===t[0])switch(this.emit("handshake"),t[1]){case 255:this.error("No acceptable SOCKS auth methods.");break;case 2:this.sendAuth();break;case 0:this.state=n.states.AUTH,this.auth();break;default:this.error("SOCKS handshake error: %d.",t[1])}else this.error("Bad SOCKS version for handshake.");else this.error("Bad SOCKS handshake response (size).")},n.prototype.sendAuth=function(){const t=this.username,e=this.password;if(!t)return void this.error("No username passed for SOCKS auth.");if(!e)return void this.error("No password passed for SOCKS auth.");const i=Buffer.byteLength(t,"ascii"),r=Buffer.byteLength(e,"ascii"),s=new l(3+i+r);s.writeU8(1),s.writeU8(i),s.writeString(t,"ascii"),s.writeU8(r),s.writeString(e,"ascii");const o=s.render();this.state=n.states.AUTH,this.socket.write(o)},n.prototype.handleAuth=function(t){2===t.length?1===t[0]?0===t[1]?this.auth():this.error("SOCKS auth failure: %d.",t[0]):this.error("Bad SOCKS auth version number."):this.error("Bad packet size for SOCKS auth.")},n.prototype.auth=function(){switch(this.emit("auth"),this.target){case n.states.PROXY_DONE:this.sendProxy();break;case n.states.RESOLVE_DONE:this.sendResolve();break;default:this.error("Bad target state.")}},n.prototype.sendProxy=function(){const t=this.destHost,e=this.destPort;let i,r,s,o;switch(f.getStringType(t)){case f.types.IPV4:s=1,o=(i=f.toBuffer(t)).slice(12,16),r=4;break;case f.types.IPV6:s=4,o=i=f.toBuffer(t),r=16;break;default:s=3,r=1+(o=Buffer.from(t,"ascii")).length}const a=new l(6+r);a.writeU8(5),a.writeU8(1),a.writeU8(0),a.writeU8(s),3===s&&a.writeU8(o.length),a.writeBytes(o),a.writeU16BE(e);const h=a.render();this.state=n.states.PROXY,this.socket.write(h)},n.prototype.handleProxy=function(t){if(t.length<6)return void this.error("Bad packet size for SOCKS connect.");if(5!==t[0])return void this.error("Bad SOCKS version for connect.");if(0!==t[1]){const e=this.getError(t[1]);return void this.error("SOCKS connect error: %s.",e)}if(0!==t[2])return void this.error("SOCKS connect failed (padding).");let e;try{e=o(t,3)}catch(t){return void this.error(t)}this.state=n.states.PROXY_DONE,this.stopTimeout(),this.proxied=!0,this.emit("proxy address",e),this.emit("proxy",this.socket)},n.prototype.sendResolve=function(){const t=this.name,e=Buffer.byteLength(t,"utf8"),i=new l(7+e);i.writeU8(5),i.writeU8(240),i.writeU8(0),i.writeU8(3),i.writeU8(e),i.writeString(t,"utf8"),i.writeU16BE(0);const r=i.render();this.state=n.states.RESOLVE,this.socket.write(r)},n.prototype.handleResolve=function(t){if(t.length<6)return void this.error("Bad packet size for tor resolve.");if(5!==t[0])return void this.error("Bad SOCKS version for tor resolve.");if(0!==t[1]){const e=this.getError(t[1]);return void this.error("Tor resolve error: %s (%s).",e,this.name)}if(0!==t[2])return void this.error("Tor resolve failed (padding).");let e;try{e=o(t,3)}catch(t){return void this.error(t)}3!==e.type?(this.state=n.states.RESOLVE_DONE,this.destroy(),this.emit("resolve",[e.host])):this.error("Bad address type for tor resolve.")},n.resolve=function(t){const e=new n;return new Promise((i,n)=>{e.resolve(t),e.on("resolve",i),e.on("error",n)})},n.proxy=function(t){const e=new n;return new Promise((i,n)=>{e.proxy(t),e.on("proxy",i),e.on("error",n)})},Object.setPrototypeOf(r.prototype,h.prototype),r.prototype.connect=async function(t,e){a(!this.socket,"Already connected.");const i={host:this.host,port:this.port,username:this.username,password:this.password,destHost:e,destPort:t};let r;try{r=await n.proxy(i)}catch(t){return void this.emit("error",t)}this.remoteAddress=e,this.remotePort=t,this.socket=r,this.socket.on("error",t=>{this.emit("error",t)}),this.socket.on("close",()=>{this.emit("close")}),this.socket.on("data",t=>{this.bytesRead+=t.length,this.emit("data",t)}),this.socket.on("drain",()=>{this.emit("drain")}),this.socket.on("timeout",()=>{this.emit("timeout")});for(const t of this.ops)t.call(this);this.ops.length=0,this.emit("connect")},r.prototype.setKeepAlive=function(t,e){this.socket?this.socket.setKeepAlive(t,e):this.ops.push(()=>{this.socket.setKeepAlive(t,e)})},r.prototype.setNoDelay=function(t){this.socket?this.socket.setNoDelay(t):this.ops.push(()=>{this.socket.setNoDelay(t)})},r.prototype.setTimeout=function(t,e){this.socket?this.socket.setTimeout(t,e):this.ops.push(()=>{this.socket.setTimeout(t,e)})},r.prototype.write=function(t,e){return a(this.socket,"Not connected."),this.bytesWritten+=t.length,this.socket.write(t,e)},r.prototype.end=function(){return a(this.socket,"Not connected."),this.socket.end()},r.prototype.pause=function(){return a(this.socket,"Not connected."),this.socket.pause()},r.prototype.resume=function(){return a(this.socket,"Not connected."),this.socket.resume()},r.prototype.destroy=function(){this.socket&&this.socket.destroy()},e.connect=function(t,e,i){const n=s(t),o=new r(n.host,n.port,n.username,n.password);return o.connect(e,i),o},e.resolve=function(t,e){const i=s(t);return n.resolve({host:i.host,port:i.port,username:i.username,password:i.password,name:e})}},function(t,e,i){"use strict";function n(t){if(!(this instanceof n))return new n(t);a.call(this),this.options=t,this.network=this.options.network,this.logger=this.options.logger.context("peer"),this.locker=new g,this.parser=new u(this.network),this.framer=new f(this.network),this.id=-1,this.socket=null,this.opened=!1,this.outbound=!1,this.loader=!1,this.address=new R,this.local=new R,this.connected=!1,this.destroyed=!1,this.ack=!1,this.handshake=!1,this.time=0,this.lastSend=0,this.lastRecv=0,this.drainSize=0,this.drainQueue=[],this.banScore=0,this.invQueue=[],this.onPacket=null,this.next=null,this.prev=null,this.version=-1,this.services=0,this.height=-1,this.agent=null,this.noRelay=!1,this.preferHeaders=!1,this.hashContinue=null,this.spvFilter=null,this.feeRate=-1,this.bip151=null,this.bip150=null,this.compactMode=-1,this.compactWitness=!1,this.merkleBlock=null,this.merkleTime=-1,this.merkleMatches=0,this.merkleMap=null,this.syncing=!1,this.sentAddr=!1,this.sentGetAddr=!1,this.challenge=null,this.lastPong=-1,this.lastPing=-1,this.minPing=-1,this.blockTime=-1,this.bestHash=null,this.bestHeight=-1,this.connectTimeout=null,this.pingTimer=null,this.invTimer=null,this.stallTimer=null,this.addrFilter=new y(5e3,.001),this.invFilter=new y(5e4,1e-6),this.blockMap=new Map,this.txMap=new Map,this.responseMap=new Map,this.compactBlocks=new Map,this._init()}function r(t){if(!(this instanceof r))return new r(t);this.network=x.primary,this.logger=_.global,this.createSocket=I.createSocket,this.version=d.PROTOCOL_VERSION,this.services=d.LOCAL_SERVICES,this.agent=d.USER_AGENT,this.noRelay=!1,this.spv=!1,this.compact=!1,this.headers=!1,this.banScore=d.BAN_SCORE,this.getHeight=r.getHeight,this.isFull=r.isFull,this.hasWitness=r.hasWitness,this.createNonce=r.createNonce,this.hasNonce=r.hasNonce,this.getRate=r.getRate,t&&this.fromOptions(t)}function s(){this.timeout=0,this.jobs=[]}const o=i(0),a=i(10),h=i(1),c=i(16),u=i(238),f=i(236),l=i(61),p=i(7),d=i(60),m=i(36),g=i(23),y=i(118),w=i(120),b=i(119),v=i(98),k=i(51),S=i(15),E=i(3),R=i(79),x=i(6),_=i(34),I=i(121),A=d.services,O=m.types,B=l.types;Object.setPrototypeOf(n.prototype,a.prototype),n.DRAIN_MAX=10<<20,n.STALL_INTERVAL=5e3,n.PING_INTERVAL=3e4,n.INV_INTERVAL=5e3,n.RESPONSE_TIMEOUT=3e4,n.BLOCK_TIMEOUT=12e4,n.TX_TIMEOUT=12e4,n.TIMEOUT_INTERVAL=12e5,n.fromInbound=function(t,e){const i=new n(t);return i.accept(e),i},n.fromOutbound=function(t,e){const i=new n(t);return i.connect(e),i},n.fromOptions=function(t){return new n(new r(t))},n.prototype._init=function(){this.parser.on("packet",async t=>{try{await this.readPacket(t)}catch(t){this.error(t),this.destroy()}}),this.parser.on("error",t=>{this.destroyed||(this.error(t),this.sendReject("malformed","error parsing message"),this.increaseBan(10))})},n.prototype.hostname=function(){return this.address.hostname},n.prototype.framePacket=function(t,e,i){return this.bip151&&this.bip151.handshake?this.bip151.packet(t,e):this.framer.packet(t,e,i)},n.prototype.feedParser=function(t){return this.bip151&&this.bip151.handshake?this.bip151.feed(t):this.parser.feed(t)},n.prototype.setCipher=function(t){o(!this.bip151,"BIP151 already set."),o(this.socket,"Peer must be initialized with a socket."),o(!this.opened,"Cannot set cipher after open."),this.bip151=new w(t),this.bip151.on("error",t=>{this.error(t),this.destroy()}),this.bip151.on("rekey",()=>{this.destroyed||(this.logger.debug("Rekeying with peer (%s).",this.hostname()),this.send(this.bip151.toRekey()))}),this.bip151.on("packet",(t,e)=>{let i=null;try{i=this.parser.parsePayload(t,e)}catch(t){return void this.parser.error(t)}this.parser.emit("packet",i)})},n.prototype.setAuth=function(t,e){const i=this.bip151,n=this.hostname(),r=this.outbound;o(this.bip151,"BIP151 not set."),o(!this.bip150,"BIP150 already set."),o(this.socket,"Peer must be initialized with a socket."),o(!this.opened,"Cannot set auth after open."),this.bip150=new b(i,n,r,t,e),this.bip151.bip150=this.bip150},n.prototype.bind=function(t){o(!this.socket),this.socket=t,this.socket.once("error",t=>{this.connected&&(this.error(t),this.destroy())}),this.socket.once("close",()=>{this.error("Socket hangup."),this.destroy()}),this.socket.on("drain",()=>{this.handleDrain()}),this.socket.on("data",t=>{this.lastRecv=h.ms(),this.feedParser(t)}),this.socket.setNoDelay(!0)},n.prototype.accept=function(t){return o(!this.socket),this.address=R.fromSocket(t,this.network),this.address.services=0,this.time=h.ms(),this.outbound=!1,this.connected=!0,this.bind(t),t},n.prototype.connect=function(t){o(!this.socket);const e=this.options.createSocket(t.port,t.host);return this.address=t,this.outbound=!0,this.connected=!1,this.bind(e),e},n.prototype.tryOpen=async function(){try{await this.open()}catch(t){}},n.prototype.open=async function(){try{await this._open()}catch(t){throw this.error(t),this.destroy(),t}},n.prototype._open=async function(){this.opened=!0,await this.initConnect(),await this.initStall(),await this.initBIP151(),await this.initBIP150(),await this.initVersion(),await this.finalize(),o(!this.destroyed),this.emit("open")},n.prototype.initConnect=function(){return this.connected?(o(!this.outbound),Promise.resolve()):new Promise((t,e)=>{const i=()=>{null!=this.connectTimeout&&(clearTimeout(this.connectTimeout),this.connectTimeout=null),this.socket.removeListener("error",n)},n=t=>{i(),e(t)};this.socket.once("connect",()=>{this.time=h.ms(),this.connected=!0,this.emit("connect"),i(),t()}),this.socket.once("error",n),this.connectTimeout=setTimeout(()=>{this.connectTimeout=null,i(),e(new Error("Connection timed out."))},1e4)})},n.prototype.initStall=function(){return o(!this.stallTimer),o(!this.destroyed),this.stallTimer=setInterval(()=>{this.maybeTimeout()},n.STALL_INTERVAL),Promise.resolve()},n.prototype.initBIP151=async function(){if(o(!this.destroyed),this.bip151){o(!this.bip151.completed),this.logger.info("Attempting BIP151 handshake (%s).",this.hostname()),this.send(this.bip151.toEncinit());try{await this.bip151.wait(3e3)}catch(t){this.error(t)}if(this.destroyed)throw new Error("Peer was destroyed during BIP151 handshake.");o(this.bip151.completed),this.bip151.handshake&&(this.logger.info("BIP151 handshake complete (%s).",this.hostname()),this.logger.info("Connection is encrypted (%s).",this.hostname()))}},n.prototype.initBIP150=async function(){if(o(!this.destroyed),this.bip150){if(o(this.bip151),o(!this.bip150.completed),!this.bip151.handshake)throw new Error("BIP151 handshake was not completed for BIP150.");if(this.logger.info("Attempting BIP150 handshake (%s).",this.hostname()),this.bip150.outbound){if(!this.bip150.peerIdentity)throw new Error("No known identity for peer.");this.send(this.bip150.toChallenge())}await this.bip150.wait(3e3),o(!this.destroyed),o(this.bip150.completed),this.bip150.auth&&(this.logger.info("BIP150 handshake complete (%s).",this.hostname()),this.logger.info("Peer is authed (%s): %s.",this.hostname(),this.bip150.getAddress()))}},n.prototype.initVersion=async function(){if(o(!this.destroyed),this.sendVersion(),this.ack||(await this.wait(B.VERACK,1e4),o(this.ack)),-1===this.version&&(this.logger.debug("Peer sent a verack without a version (%s).",this.hostname()),await this.wait(B.VERSION,1e4),o(-1!==this.version)),this.destroyed)throw new Error("Peer was destroyed during handshake.");this.handshake=!0,this.logger.debug("Version handshake complete (%s).",this.hostname())},n.prototype.finalize=async function(){o(!this.destroyed),this.pingTimer=setInterval(()=>{this.sendPing()},n.PING_INTERVAL),this.invTimer=setInterval(()=>{this.flushInv()},n.INV_INTERVAL)},n.prototype.announceBlock=function(t){if(!this.handshake)return;if(this.destroyed)return;Array.isArray(t)||(t=[t]);const e=[];for(const i of t)o(i instanceof k),this.invFilter.test(i.hash())||(1!==this.compactMode?this.preferHeaders?e.push(i.toHeaders()):e.push(i.toInv()):(this.invFilter.add(i.hash()),this.sendCompactBlock(i)));this.preferHeaders?this.sendHeaders(e):this.queueInv(e)},n.prototype.announceTX=function(t){if(!this.handshake)return;if(this.destroyed)return;if(this.noRelay)return;Array.isArray(t)||(t=[t]);const e=[];for(const i of t)if(o(i instanceof S),!this.invFilter.test(i.hash())&&(!this.spvFilter||i.isWatched(this.spvFilter))){if(-1!==this.feeRate){const t=i.hash("hex"),e=this.options.getRate(t);if(-1!==e&&e<this.feeRate)continue}e.push(i.toInv())}this.queueInv(e)},n.prototype.queueInv=function(t){if(!this.handshake)return;if(this.destroyed)return;Array.isArray(t)||(t=[t]);let e=!1;for(const i of t)i.type===O.BLOCK&&(e=!0),this.invQueue.push(i);(this.invQueue.length>=500||e)&&this.flushInv()},n.prototype.flushInv=function(){if(this.destroyed)return;const t=this.invQueue;if(0===t.length)return;this.invQueue=[],this.logger.spam("Serving %d inv items to %s.",t.length,this.hostname());const e=[];for(const i of t)this.invFilter.added(i.hash,"hex")&&e.push(i);for(let t=0;t<e.length;t+=1e3){const i=e.slice(t,t+1e3);this.send(new l.InvPacket(i))}},n.prototype.sendInv=function(t){if(this.handshake&&!this.destroyed){Array.isArray(t)||(t=[t]);for(const e of t)this.invFilter.add(e.hash,"hex");if(0!==t.length){this.logger.spam("Serving %d inv items to %s.",t.length,this.hostname());for(let e=0;e<t.length;e+=1e3){const i=t.slice(e,e+1e3);this.send(new l.InvPacket(i))}}}},n.prototype.sendHeaders=function(t){if(this.handshake&&!this.destroyed){Array.isArray(t)||(t=[t]);for(const e of t)this.invFilter.add(e.hash());if(0!==t.length){this.logger.spam("Serving %d headers to %s.",t.length,this.hostname());for(let e=0;e<t.length;e+=2e3){const i=t.slice(e,e+2e3);this.send(new l.HeadersPacket(i))}}}},n.prototype.sendCompactBlock=function(t){const e=this.compactWitness,i=v.CompactBlock.fromBlock(t,e);this.send(new l.CmpctBlockPacket(i,e))},n.prototype.sendVersion=function(){const t=new l.VersionPacket;t.version=this.options.version,t.services=this.options.services,t.time=this.network.now(),t.remote=this.address,t.local.setNull(),t.local.services=this.options.services,t.nonce=this.options.createNonce(this.hostname()),t.agent=this.options.agent,t.height=this.options.getHeight(),t.noRelay=this.options.noRelay,this.send(t)},n.prototype.sendGetAddr=function(){this.sentGetAddr||(this.sentGetAddr=!0,this.send(new l.GetAddrPacket))},n.prototype.sendPing=function(){this.handshake&&(this.version<=d.PONG_VERSION?this.send(new l.PingPacket):this.challenge?this.logger.debug("Peer has not responded to ping (%s).",this.hostname()):(this.lastPing=h.ms(),this.challenge=h.nonce(),this.send(new l.PingPacket(this.challenge))))},n.prototype.sendFilterLoad=function(t){this.handshake&&this.options.spv&&this.services&A.BLOOM&&this.send(new l.FilterLoadPacket(t))},n.prototype.sendFeeRate=function(t){this.handshake&&this.send(new l.FeeFilterPacket(t))},n.prototype.destroy=function(){const t=this.connected;if(this.destroyed)return;this.destroyed=!0,this.connected=!1,this.socket.destroy(),this.socket=null,this.bip151&&this.bip151.destroy(),this.bip150&&this.bip150.destroy(),null!=this.pingTimer&&(clearInterval(this.pingTimer),this.pingTimer=null),null!=this.invTimer&&(clearInterval(this.invTimer),this.invTimer=null),null!=this.stallTimer&&(clearInterval(this.stallTimer),this.stallTimer=null),null!=this.connectTimeout&&(clearTimeout(this.connectTimeout),this.connectTimeout=null);const e=this.drainQueue;this.drainSize=0,this.drainQueue=[];for(const t of e)t.reject(new Error("Peer was destroyed."));for(const[t,e]of this.responseMap)this.responseMap.delete(t),e.reject(new Error("Peer was destroyed."));this.locker.destroy(),this.emit("close",t)},n.prototype.write=function(t){if(this.destroyed)throw new Error("Peer is destroyed (write).");this.lastSend=h.ms(),!1===this.socket.write(t)&&this.needsDrain(t.length)},n.prototype.send=function(t){if(this.destroyed)throw new Error("Peer is destroyed (send).");let e=null;if(t.type===B.TX){const i=t.tx;t.witness?i.isCoinbase()||(e=i.witnessHash()):e=i.hash()}this.sendRaw(t.cmd,t.toRaw(),e),this.addTimeout(t)},n.prototype.sendRaw=function(t,e,i){const n=this.framePacket(t,e,i);this.write(n)},n.prototype.drain=function(){return this.destroyed?Promise.reject(new Error("Peer is destroyed.")):0===this.drainSize?Promise.resolve():new Promise((t,e)=>{this.drainQueue.push(c.job(t,e))})},n.prototype.handleDrain=function(){const t=this.drainQueue;if(this.drainSize=0,0!==t.length){this.drainQueue=[];for(const e of t)e.resolve()}},n.prototype.needsDrain=function(t){this.drainSize+=t,this.drainSize>=n.DRAIN_MAX&&(this.logger.warning("Peer is not reading: %dmb buffered (%s).",h.mb(this.drainSize),this.hostname()),this.error("Peer stalled (drain)."),this.destroy())},n.prototype.addTimeout=function(t){const e=n.RESPONSE_TIMEOUT;if(this.outbound)switch(t.type){case B.MEMPOOL:this.request(B.INV,e);break;case B.GETBLOCKS:this.options.isFull()||this.request(B.INV,e);break;case B.GETHEADERS:this.request(B.HEADERS,2*e);break;case B.GETDATA:this.request(B.DATA,2*e);break;case B.GETBLOCKTXN:this.request(B.BLOCKTXN,e)}},n.prototype.fulfill=function(t){switch(t.type){case B.BLOCK:case B.CMPCTBLOCK:case B.MERKLEBLOCK:case B.TX:case B.NOTFOUND:{const e=this.response(B.DATA,t);o(!e||0===e.jobs.length);break}}return this.response(t.type,t)},n.prototype.maybeTimeout=function(){const t=h.ms();for(const[e,i]of this.responseMap)if(t>i.timeout){const t=l.typesByVal[e];return this.error("Peer is stalling (%s).",t.toLowerCase()),void this.destroy()}if(this.merkleBlock&&(o(-1!==this.merkleTime),t>this.merkleTime+n.BLOCK_TIMEOUT))return this.error("Peer is stalling (merkleblock)."),void this.destroy();if(this.syncing&&this.loader&&!this.options.isFull()&&t>this.blockTime+n.BLOCK_TIMEOUT)return this.error("Peer is stalling (block)."),void this.destroy();if(this.options.isFull()||!this.syncing){for(const e of this.blockMap.values())if(t>e+n.BLOCK_TIMEOUT)return this.error("Peer is stalling (block)."),void this.destroy();for(const e of this.txMap.values())if(t>e+n.TX_TIMEOUT)return this.error("Peer is stalling (tx)."),void this.destroy();for(const e of this.compactBlocks.values())if(t>e.now+n.RESPONSE_TIMEOUT)return this.error("Peer is stalling (blocktxn)."),void this.destroy()}if(t>this.time+6e4){if(o(0!==this.time),0===this.lastRecv||0===this.lastSend)return this.error("Peer is stalling (no message)."),void this.destroy();if(t>this.lastSend+n.TIMEOUT_INTERVAL)return this.error("Peer is stalling (send)."),void this.destroy();const e=this.version<=d.PONG_VERSION?4:1;if(t>this.lastRecv+n.TIMEOUT_INTERVAL*e)return this.error("Peer is stalling (recv)."),void this.destroy();if(this.challenge&&t>this.lastPing+n.TIMEOUT_INTERVAL)return this.error("Peer is stalling (ping)."),void this.destroy()}},n.prototype.request=function(t,e){if(this.destroyed)return null;let i=this.responseMap.get(t);return i||(i=new s,this.responseMap.set(t,i)),i.setTimeout(e),i},n.prototype.response=function(t,e){const i=this.responseMap.get(t);return i?(this.responseMap.delete(t),i):null},n.prototype.wait=function(t,e){return new Promise((i,n)=>{if(this.destroyed)return void n(new Error("Peer is destroyed (request)."));const r=this.request(t);r.setTimeout(e),r.addJob(i,n)})},n.prototype.error=function(t){if(!this.destroyed){if("string"==typeof t){const e=h.fmt.apply(h,arguments);t=new Error(e)}if("string"==typeof t.code&&"E"===t.code[0]){const e=t.code;(t=new Error(e)).code=e,t.message=`Socket Error: ${e}`}t.message+=` (${this.hostname()})`,this.emit("error",t)}},n.prototype.blockType=function(){return this.options.spv?O.FILTERED_BLOCK:this.options.compact&&this.hasCompactSupport()&&this.hasCompact()?O.CMPCT_BLOCK:this.hasWitness()?O.WITNESS_BLOCK:O.BLOCK},n.prototype.txType=function(){return this.hasWitness()?O.WITNESS_TX:O.TX},n.prototype.getData=function(t){this.send(new l.GetDataPacket(t))},n.prototype.getItems=function(t,e){const i=[];for(const n of e)i.push(new m(t,n));0!==i.length&&this.getData(i)},n.prototype.getBlock=function(t){this.getItems(this.blockType(),t)},n.prototype.getTX=function(t){this.getItems(this.txType(),t)},n.prototype.getFullBlock=function(t){o(!this.options.spv);let e=O.BLOCK;this.hasWitness()&&(e|=m.WITNESS_FLAG),this.getItems(e,[t])},n.prototype.readPacket=async function(t){if(!this.destroyed)switch(t.type){case B.ENCINIT:case B.ENCACK:case B.AUTHCHALLENGE:case B.AUTHREPLY:case B.AUTHPROPOSE:case B.PONG:try{this.socket.pause(),await this.handlePacket(t)}finally{this.destroyed||this.socket.resume()}break;default:{const e=await this.locker.lock();try{this.socket.pause(),await this.handlePacket(t)}finally{this.destroyed||this.socket.resume(),e()}break}}},n.prototype.handlePacket=async function(t){if(this.destroyed)throw new Error("Destroyed peer sent a packet.");this.bip151&&this.bip151.job&&!this.bip151.completed&&t.type!==B.ENCINIT&&t.type!==B.ENCACK&&this.bip151.reject(new Error("Message before BIP151 handshake.")),this.bip150&&this.bip150.job&&!this.bip150.completed&&t.type!==B.AUTHCHALLENGE&&t.type!==B.AUTHREPLY&&t.type!==B.AUTHPROPOSE&&this.bip150.reject(new Error("Message before BIP150 auth."));const e=this.fulfill(t);switch(t.type){case B.VERSION:await this.handleVersion(t);break;case B.VERACK:await this.handleVerack(t);break;case B.PING:await this.handlePing(t);break;case B.PONG:await this.handlePong(t);break;case B.SENDHEADERS:await this.handleSendHeaders(t);break;case B.FILTERLOAD:await this.handleFilterLoad(t);break;case B.FILTERADD:await this.handleFilterAdd(t);break;case B.FILTERCLEAR:await this.handleFilterClear(t);break;case B.FEEFILTER:await this.handleFeeFilter(t);break;case B.SENDCMPCT:await this.handleSendCmpct(t);break;case B.ENCINIT:await this.handleEncinit(t);break;case B.ENCACK:await this.handleEncack(t);break;case B.AUTHCHALLENGE:await this.handleAuthChallenge(t);break;case B.AUTHREPLY:await this.handleAuthReply(t);break;case B.AUTHPROPOSE:await this.handleAuthPropose(t)}this.onPacket&&await this.onPacket(t),this.emit("packet",t),e&&e.resolve(t)},n.prototype.handleVersion=async function(t){if(-1!==this.version)throw new Error("Peer sent a duplicate version.");if(this.version=t.version,this.services=t.services,this.height=t.height,this.agent=t.agent,this.noRelay=t.noRelay,this.local=t.remote,!this.network.selfConnect&&this.options.hasNonce(t.nonce))throw new Error("We connected to ourself. Oops.");if(this.version<d.MIN_VERSION)throw new Error("Peer does not support required protocol version.");if(this.outbound){if(!(this.services&A.NETWORK))throw new Error("Peer does not support network services.");if(this.options.headers&&this.version<d.HEADERS_VERSION)throw new Error("Peer does not support getheaders.");if(this.options.spv){if(!(this.services&A.BLOOM))throw new Error("Peer does not support BIP37.");if(this.version<d.BLOOM_VERSION)throw new Error("Peer does not support BIP37.")}if(this.options.hasWitness()&&!(this.services&A.WITNESS))throw new Error("Peer does not support segregated witness.");this.options.compact&&(this.hasCompactSupport()||this.logger.debug("Peer does not support compact blocks (%s).",this.hostname()))}this.send(new l.VerackPacket)},n.prototype.handleVerack=async function(t){this.ack?this.logger.debug("Peer sent duplicate ack (%s).",this.hostname()):(this.ack=!0,this.logger.debug("Received verack (%s).",this.hostname()))},n.prototype.handlePing=async function(t){t.nonce&&this.send(new l.PongPacket(t.nonce))},n.prototype.handlePong=async function(t){const e=t.nonce,i=h.ms();if(this.challenge){if(!e.equals(this.challenge))return e.equals(E.ZERO_U64)?(this.logger.debug("Peer sent a zero nonce (%s).",this.hostname()),void(this.challenge=null)):void this.logger.debug("Peer sent the wrong nonce (%s).",this.hostname());i>=this.lastPing?(this.lastPong=i,-1===this.minPing&&(this.minPing=i-this.lastPing),this.minPing=Math.min(this.minPing,i-this.lastPing)):this.logger.debug("Timing mismatch (what?) (%s).",this.hostname()),this.challenge=null}else this.logger.debug("Peer sent an unsolicited pong (%s).",this.hostname())},n.prototype.handleSendHeaders=async function(t){this.preferHeaders?this.logger.debug("Peer sent a duplicate sendheaders (%s).",this.hostname()):this.preferHeaders=!0},n.prototype.handleFilterLoad=async function(t){t.isWithinConstraints()?(this.spvFilter=t.filter,this.noRelay=!1):this.increaseBan(100)},n.prototype.handleFilterAdd=async function(t){const e=t.data;e.length>p.MAX_SCRIPT_PUSH?this.increaseBan(100):(this.spvFilter&&this.spvFilter.add(e),this.noRelay=!1)},n.prototype.handleFilterClear=async function(t){this.spvFilter&&this.spvFilter.reset(),this.noRelay=!1},n.prototype.handleFeeFilter=async function(t){const e=t.rate;e<0||e>p.getMaxMoney(t.height)?this.increaseBan(100):this.feeRate=e},n.prototype.handleSendCmpct=async function(t){-1===this.compactMode?t.version>2?this.logger.info("Peer request compact blocks version %d (%s).",t.version,this.hostname()):t.mode>1?this.logger.info("Peer request compact blocks mode %d (%s).",t.mode,this.hostname()):(this.logger.info("Peer initialized compact blocks (mode=%d, version=%d) (%s).",t.mode,t.version,this.hostname()),this.compactMode=t.mode,this.compactWitness=2===t.version):this.logger.debug("Peer sent a duplicate sendcmpct (%s).",this.hostname())},n.prototype.handleEncinit=async function(t){this.bip151&&(this.bip151.encinit(t.publicKey,t.cipher),this.send(this.bip151.toEncack()))},n.prototype.handleEncack=async function(t){this.bip151&&this.bip151.encack(t.publicKey)},n.prototype.handleAuthChallenge=async function(t){if(!this.bip150)return;const e=this.bip150.challenge(t.hash);this.send(new l.AuthReplyPacket(e))},n.prototype.handleAuthReply=async function(t){if(!this.bip150)return;const e=this.bip150.reply(t.signature);e&&this.send(new l.AuthProposePacket(e))},n.prototype.handleAuthPropose=async function(t){if(!this.bip150)return;const e=this.bip150.propose(t.hash);this.send(new l.AuthChallengePacket(e))},n.prototype.sendGetHeaders=function(t,e){const i=new l.GetHeadersPacket(t,e);let n=null;i.locator.length>0&&(n=h.revHex(i.locator[0]));let r=null;e&&(r=h.revHex(e)),this.logger.debug("Requesting headers packet from peer with getheaders (%s).",this.hostname()),this.logger.debug("Sending getheaders (hash=%s, stop=%s).",n,r),this.send(i)},n.prototype.sendGetBlocks=function(t,e){const i=new l.GetBlocksPacket(t,e);let n=null;i.locator.length>0&&(n=h.revHex(i.locator[0]));let r=null;e&&(r=h.revHex(e)),this.logger.debug("Requesting inv packet from peer with getblocks (%s).",this.hostname()),this.logger.debug("Sending getblocks (hash=%s, stop=%s).",n,r),this.send(i)},n.prototype.sendMempool=function(){this.handshake&&(this.services&A.BLOOM?(this.logger.debug("Requesting inv packet from peer with mempool (%s).",this.hostname()),this.send(new l.MempoolPacket)):this.logger.debug("Cannot request mempool for non-bloom peer (%s).",this.hostname()))},n.prototype.sendReject=function(t,e,i,n){const r=l.RejectPacket.fromReason(t,e,i,n);i?this.logger.debug("Rejecting %s %s (%s): code=%s reason=%s.",i,h.revHex(n),this.hostname(),t,e):this.logger.debug("Rejecting packet from %s: code=%s reason=%s.",this.hostname(),t,e),this.logger.debug("Sending reject packet to peer (%s).",this.hostname()),this.send(r)},n.prototype.sendCompact=function(t){if(this.services&d.services.WITNESS&&this.version>=d.COMPACT_WITNESS_VERSION)return this.logger.info("Initializing witness compact blocks (%s).",this.hostname()),void this.send(new l.SendCmpctPacket(t,2));this.version>=d.COMPACT_VERSION&&(this.logger.info("Initializing normal compact blocks (%s).",this.hostname()),this.send(new l.SendCmpctPacket(t,1)))},n.prototype.increaseBan=function(t){return this.banScore+=t,this.banScore>=this.options.banScore&&(this.logger.debug("Ban threshold exceeded (%s).",this.hostname()),this.ban(),!0)},n.prototype.ban=function(){this.emit("ban")},n.prototype.reject=function(t,e){return this.sendReject(e.code,e.reason,t,e.hash),this.increaseBan(e.score)},n.prototype.hasServices=function(t){return(this.services&t)===t},n.prototype.hasWitness=function(){return 0!=(this.services&A.WITNESS)},n.prototype.hasCompactSupport=function(){return!(this.version<d.COMPACT_VERSION)&&(!this.options.hasWitness()||!!(this.services&A.WITNESS)&&this.version>=d.COMPACT_WITNESS_VERSION)},n.prototype.hasCompact=function(){return-1!==this.compactMode&&(!this.options.hasWitness()||!!this.compactWitness)},n.prototype.inspect=function(){return"<Peer:"+` handshake=${this.handshake}`+` host=${this.hostname()}`+` outbound=${this.outbound}`+` ping=${this.minPing}`+">"},r.prototype.fromOptions=function(t){return o(t,"Options are required."),null!=t.network&&(this.network=x.get(t.network)),null!=t.logger&&(o("object"==typeof t.logger),this.logger=t.logger),null!=t.createSocket&&(o("function"==typeof t.createSocket),this.createSocket=t.createSocket),null!=t.version&&(o("number"==typeof t.version),this.version=t.version),null!=t.services&&(o("number"==typeof t.services),this.services=t.services),null!=t.agent&&(o("string"==typeof t.agent),this.agent=t.agent),null!=t.noRelay&&(o("boolean"==typeof t.noRelay),this.noRelay=t.noRelay),null!=t.spv&&(o("boolean"==typeof t.spv),this.spv=t.spv),null!=t.compact&&(o("boolean"==typeof t.compact),this.compact=t.compact),null!=t.headers&&(o("boolean"==typeof t.headers),this.headers=t.headers),null!=t.banScore&&(o("number"==typeof t.banScore),this.banScore=t.banScore),null!=t.getHeight&&(o("function"==typeof t.getHeight),this.getHeight=t.getHeight),null!=t.isFull&&(o("function"==typeof t.isFull),this.isFull=t.isFull),null!=t.hasWitness&&(o("function"==typeof t.hasWitness),this.hasWitness=t.hasWitness),null!=t.createNonce&&(o("function"==typeof t.createNonce),this.createNonce=t.createNonce),null!=t.hasNonce&&(o("function"==typeof t.hasNonce),this.hasNonce=t.hasNonce),null!=t.getRate&&(o("function"==typeof t.getRate),this.getRate=t.getRate),this},r.fromOptions=function(t){return(new r).fromOptions(t)},r.getHeight=function(){return 0},r.isFull=function(){return!1},r.hasWitness=function(){return!0},r.createNonce=function(t){return h.nonce()},r.hasNonce=function(t){return!1},r.getRate=function(t){return-1},s.prototype.addJob=function(t,e){this.jobs.push(c.job(t,e))},s.prototype.setTimeout=function(t){this.timeout=h.ms()+t},s.prototype.reject=function(t){for(const e of this.jobs)e.reject(t);this.jobs.length=0},s.prototype.resolve=function(t){for(const e of this.jobs)e.resolve(t);this.jobs.length=0},t.exports=n},function(t,e,i){"use strict";function n(t){if(!(this instanceof n))return new n(t);s.call(this),this.config=new l("wmcc"),this.config.inject(t),this.config.load(t),t.config&&this.config.open("wmcc.conf"),this.network=a.get(this.config.network),this.startTime=-1,this.bound=[],this.plugins=Object.create(null),this.stack=[],this.logger=null,this.workers=null,this.spv=!1,this.chain=null,this.fees=null,this.mempool=null,this.pool=null,this.miner=null,this.http=null,this.init()}const r=i(0),s=i(30),o=i(1),a=i(6),h=i(34),c=i(124),u=i(12),f=i(18),l=i(123);Object.setPrototypeOf(n.prototype,s.prototype),n.prototype.initOptions=function(){let t=new h;const e=this.config;e.has("logger")&&(t=e.obj("logger")),t.set({filename:e.bool("log-file")?e.location("debug.log"):null,level:e.str("log-level"),console:e.bool("log-console"),shrink:e.bool("log-shrink")}),this.logger=t.context("node"),this.workers=new c({enabled:e.bool("workers"),size:e.uint("workers-size"),timeout:e.uint("workers-timeout"),file:e.str("worker-file")})},n.prototype.init=function(){this.initOptions(),this.on("error",()=>{}),this.workers.on("spawn",t=>{this.logger.info("Spawning worker process: %d.",t.id)}),this.workers.on("exit",(t,e)=>{this.logger.warning("Worker %d exited: %s.",e.id,t)}),this.workers.on("log",(t,e)=>{this.logger.debug("Worker %d says:",e.id),this.logger.debug(t)}),this.workers.on("error",(t,e)=>{e?this.logger.error("Worker %d error: %s",e.id,t.message):this.emit("error",t)}),this.hook("preopen",()=>this.handlePreopen()),this.hook("preclose",()=>this.handlePreclose()),this.hook("open",()=>this.handleOpen()),this.hook("close",()=>this.handleClose())},n.prototype.ensure=function(){return this.config.ensure()},n.prototype.location=function(t){return this.config.location(t)},n.prototype.handlePreopen=async function(){await this.logger.open(),await this.workers.open(),this.bind(this.network.time,"offset",t=>{this.logger.info("Time offset: %d (%d minutes).",t,t/60|0)}),this.bind(this.network.time,"sample",(t,e)=>{this.logger.debug("Added time data: samples=%d, offset=%d (%d minutes).",e,t,t/60|0)}),this.bind(this.network.time,"mismatch",()=>{this.logger.warning("Adjusted time mismatch!"),this.logger.warning("Please make sure your system clock is correct!")})},n.prototype.handleOpen=async function(){this.startTime=o.now(),u.binding||(this.logger.warning("Warning: secp256k1-node was not built."),this.logger.warning("Verification will be slow.")),f.binding||(this.logger.warning("Warning: wmcc-native was not built."),this.logger.warning("Hashing will be slow.")),this.workers.enabled||(this.logger.warning("Warning: worker pool is disabled."),this.logger.warning("Verification will be slow."))},n.prototype.handlePreclose=async function(){},n.prototype.handleClose=async function(){for(const[t,e,i]of this.bound)t.removeListener(e,i);this.bound.length=0,this.startTime=-1,await this.workers.close(),await this.logger.close()},n.prototype.bind=function(t,e,i){this.bound.push([t,e,i]),t.on(e,i)},n.prototype.error=function(t){this.logger.error(t),this.emit("error",t)},n.prototype.uptime=function(){return-1===this.startTime?0:o.now()-this.startTime},n.prototype.use=function(t){r(t,"Plugin must be an object."),r("function"==typeof t.init,"`init` must be a function."),r(!this.loaded,"Cannot add plugin after node is loaded.");const e=t.init(this);if(r(!e.open||"function"==typeof e.open,"`open` must be a function."),r(!e.close||"function"==typeof e.close,"`close` must be a function."),t.id){switch(r("string"==typeof t.id,"`id` must be a string."),t.id){case"chain":case"fees":case"mempool":case"miner":case"pool":case"rpc":case"http":r(!1,`${t.id} is already added.`)}r(!this.plugins[t.id],`${t.id} is already added.`),this.plugins[t.id]=e}return this.stack.push(e),"function"==typeof e.on&&e.on("error",t=>this.error(t)),e},n.prototype.has=function(t){return null!=this.plugins[t]},n.prototype.get=function(t){switch(r("string"==typeof t,"Plugin name must be a string."),t){case"chain":return r(this.chain,"chain is not loaded."),this.chain;case"fees":return r(this.fees,"fees is not loaded."),this.fees;case"mempool":return r(this.mempool,"mempool is not loaded."),this.mempool;case"miner":return r(this.miner,"miner is not loaded."),this.miner;case"pool":return r(this.pool,"pool is not loaded."),this.pool;case"rpc":return r(this.rpc,"rpc is not loaded."),this.rpc;case"http":return r(this.http,"http is not loaded."),this.http}return this.plugins[t]||null},n.prototype.require=function(t){const e=this.get(t);return r(e,`${t} is not loaded.`),e},n.prototype.loadPlugins=function(){const t=this.config.array("plugins",[]),e=this.config.func("loader");for(let i of t)"string"==typeof i&&(r(e,"Must pass a loader function."),i=e(i)),this.use(i)},n.prototype.openPlugins=async function(){for(const t of this.stack)t.open&&await t.open()},n.prototype.closePlugins=async function(){for(const t of this.stack)t.close&&await t.close()},t.exports=n},function(t,e,i){"use strict";function n(){if(!(this instanceof n))return n.create();this.jobs=new Map,this.busy=new Set,this.destroyed=!1}function r(){}const s=i(0);n.create=function(){const t=new n;return function(e,i){return t.lock(e,i)}},n.prototype.has=function(t){return this.busy.has(t)},n.prototype.hasPending=function(t){return this.jobs.has(t)},n.prototype.lock=function(t,e){return this.destroyed?Promise.reject(new Error("Lock is destroyed.")):null==t?Promise.resolve(r):e?(s(this.busy.has(t)),Promise.resolve(r)):this.busy.has(t)?new Promise((e,i)=>{this.jobs.has(t)||this.jobs.set(t,[]),this.jobs.get(t).push(new function(t,e){this.resolve=t,this.reject=e}(e,i))}):(this.busy.add(t),Promise.resolve(this.unlock(t)))},n.prototype.unlock=function(t){const e=this;return function i(){const n=e.jobs.get(t);if(s(e.destroyed||e.busy.has(t)),e.busy.delete(t),!n)return;s(!e.destroyed);const r=n.shift();s(r),0===n.length&&e.jobs.delete(t),e.busy.add(t),r.resolve(i)}},n.prototype.destroy=function(){s(!this.destroyed,"Lock is already destroyed.");const t=this.jobs;this.destroyed=!0,this.jobs=new Map,this.busy=new Map;for(const e of t.values())for(const t of e)t.reject(new Error("Lock was destroyed."))},t.exports=n},function(t,e,i){"use strict";function n(t,e){if(!(this instanceof n))return new n(t,e);o(t,"Database is required."),this.db=t,this.network=t.network,this.wallet=null,this.receive=null,this.change=null,this.nested=null,this.wid=0,this.id=null,this.name=null,this.initialized=!1,this.witness=!0===this.db.options.witness,this.watchOnly=!1,this.type=n.types.PUBKEYHASH,this.m=1,this.n=1,this.accountIndex=0,this.receiveDepth=0,this.changeDepth=0,this.nestedDepth=0,this.lookahead=0,this.accountKey=null,this.keys=[],e&&this.fromOptions(e)}function r(t,e){return t.compare(e)}const s=i(1),o=i(0),a=i(2),h=i(4),c=i(3),u=i(80),f=i(62),l=i(8),p=i(128),d=i(109);n.types={PUBKEYHASH:0,MULTISIG:1},n.typesByVal={0:"pubkeyhash",1:"multisig"},n.prototype.fromOptions=function(t){if(o(t,"Options are required."),o(s.isU32(t.wid)),o(f.isName(t.id),"Bad Wallet ID."),o(d.isHD(t.accountKey),"Account key is required."),o(s.isU32(t.accountIndex),"Account index is required."),this.wid=t.wid,this.id=t.id,null!=t.name&&(o(f.isName(t.name),"Bad account name."),this.name=t.name),null!=t.initialized&&(o("boolean"==typeof t.initialized),this.initialized=t.initialized),null!=t.witness&&(o("boolean"==typeof t.witness),this.witness=t.witness),null!=t.watchOnly&&(o("boolean"==typeof t.watchOnly),this.watchOnly=t.watchOnly),null!=t.type&&("string"==typeof t.type?(this.type=n.types[t.type.toUpperCase()],o(null!=this.type)):(o("number"==typeof t.type),this.type=t.type,o(n.typesByVal[this.type]))),null!=t.m&&(o(s.isU8(t.m)),this.m=t.m),null!=t.n&&(o(s.isU8(t.n)),this.n=t.n),null!=t.accountIndex&&(o(s.isU32(t.accountIndex)),this.accountIndex=t.accountIndex),null!=t.receiveDepth&&(o(s.isU32(t.receiveDepth)),this.receiveDepth=t.receiveDepth),null!=t.changeDepth&&(o(s.isU32(t.changeDepth)),this.changeDepth=t.changeDepth),null!=t.nestedDepth&&(o(s.isU32(t.nestedDepth)),this.nestedDepth=t.nestedDepth),null!=t.lookahead&&(o(s.isU32(t.lookahead)),o(t.lookahead>=0),o(t.lookahead<=n.MAX_LOOKAHEAD),this.lookahead=t.lookahead),this.accountKey=t.accountKey,this.n>1&&(this.type=n.types.MULTISIG),this.name||(this.name=this.accountIndex.toString(10)),this.m<1||this.m>this.n)throw new Error("m ranges between 1 and n");if(t.keys){o(Array.isArray(t.keys));for(const e of t.keys)this.pushKey(e)}return this},n.fromOptions=function(t,e){return new n(t).fromOptions(e)},n.MAX_LOOKAHEAD=40,n.prototype.init=async function(){if(this.keys.length!==this.n-1)return o(!this.initialized),void this.save();o(0===this.receiveDepth),o(0===this.changeDepth),o(0===this.nestedDepth),this.initialized=!0,await this.initDepth()},n.prototype.open=function(){return this.initialized?this.receive?Promise.resolve():(this.receive=this.deriveReceive(this.receiveDepth-1),this.change=this.deriveChange(this.changeDepth-1),this.witness&&(this.nested=this.deriveNested(this.nestedDepth-1)),Promise.resolve()):Promise.resolve()},n.prototype.pushKey=function(t){if("string"==typeof t&&(t=d.PublicKey.fromBase58(t,this.network)),o(t.network===this.network,"Network mismatch for account key."),!d.isPublic(t))throw new Error("Must add HD keys to wallet.");if(!t.isAccount())throw new Error("Must add HD account keys to BIP44 wallet.");if(this.type!==n.types.MULTISIG)throw new Error("Cannot add keys to non-multisig wallet.");if(t.equals(this.accountKey))throw new Error("Cannot add own key.");if(-1===s.binaryInsert(this.keys,t,r,!0))return!1;if(this.keys.length>this.n-1)throw s.binaryRemove(this.keys,t,r),new Error("Cannot add more keys.");return!0},n.prototype.spliceKey=function(t){if("string"==typeof t&&(t=d.PublicKey.fromBase58(t,this.network)),o(t.network===this.network,"Network mismatch for account key."),!d.isPublic(t))throw new Error("Must add HD keys to wallet.");if(!t.isAccount())throw new Error("Must add HD account keys to BIP44 wallet.");if(this.type!==n.types.MULTISIG)throw new Error("Cannot remove keys from non-multisig wallet.");if(this.keys.length===this.n-1)throw new Error("Cannot remove key.");return s.binaryRemove(this.keys,t,r)},n.prototype.addSharedKey=async function(t){const e=this.pushKey(t);if(await this.hasDuplicate())throw this.spliceKey(t),new Error("Cannot add a key from another account.");return await this.init(),e},n.prototype.hasDuplicate=function(){if(this.keys.length!==this.n-1)return!1;const t=this.deriveReceive(0).getScriptHash("hex");return this.wallet.hasAddress(t)},n.prototype.removeSharedKey=function(t){return!!this.spliceKey(t)&&(this.save(),!0)},n.prototype.createReceive=function(){return this.createKey(0)},n.prototype.createChange=function(){return this.createKey(1)},n.prototype.createNested=function(){return this.createKey(2)},n.prototype.createKey=async function(t){let e,i;switch(t){case 0:e=this.deriveReceive(this.receiveDepth),i=this.deriveReceive(this.receiveDepth+this.lookahead),await this.saveKey(i),this.receiveDepth++,this.receive=e;break;case 1:e=this.deriveChange(this.changeDepth),i=this.deriveReceive(this.changeDepth+this.lookahead),await this.saveKey(i),this.changeDepth++,this.change=e;break;case 2:e=this.deriveNested(this.nestedDepth),i=this.deriveNested(this.nestedDepth+this.lookahead),await this.saveKey(i),this.nestedDepth++,this.nested=e;break;default:throw new Error(`Bad branch: ${t}.`)}return this.save(),e},n.prototype.deriveReceive=function(t,e){return this.deriveKey(0,t,e)},n.prototype.deriveChange=function(t,e){return this.deriveKey(1,t,e)},n.prototype.deriveNested=function(t,e){if(!this.witness)throw new Error("Cannot derive nested on non-witness account.");return this.deriveKey(2,t,e)},n.prototype.derivePath=function(t,e){switch(t.keyType){case u.types.HD:return this.deriveKey(t.branch,t.index,e);case u.types.KEY:{o(this.type===n.types.PUBKEYHASH);let i=t.data;return t.encrypted&&!(i=e.decipher(i,t.hash))?null:p.fromImport(this,i)}case u.types.ADDRESS:return null;default:throw new Error("Bad key type.")}},n.prototype.deriveKey=function(t,e,i){o("number"==typeof t);const r=[];let s;s=i&&i.key&&!this.watchOnly?(s=i.key.deriveAccount(44,this.accountIndex)).derive(t).derive(e):this.accountKey.derive(t).derive(e);const a=p.fromHD(this,s,t,e);switch(this.type){case n.types.PUBKEYHASH:break;case n.types.MULTISIG:r.push(s.publicKey);for(const i of this.keys){const n=i.derive(t).derive(e);r.push(n.publicKey)}a.script=l.fromMultisig(this.m,this.n,r)}return a},n.prototype.save=function(){return this.db.saveAccount(this)},n.prototype.saveKey=function(t){return this.db.saveKey(this.wallet,t)},n.prototype.savePath=function(t){return this.db.savePath(this.wallet,t)},n.prototype.initDepth=async function(){this.receive=this.deriveReceive(0),this.receiveDepth=1,await this.saveKey(this.receive);for(let t=0;t<this.lookahead;t++){const e=this.deriveReceive(t+1);await this.saveKey(e)}this.change=this.deriveChange(0),this.changeDepth=1,await this.saveKey(this.change);for(let t=0;t<this.lookahead;t++){const e=this.deriveChange(t+1);await this.saveKey(e)}if(this.witness){this.nested=this.deriveNested(0),this.nestedDepth=1,await this.saveKey(this.nested);for(let t=0;t<this.lookahead;t++){const e=this.deriveNested(t+1);await this.saveKey(e)}}this.save()},n.prototype.syncDepth=async function(t,e,i){let n=!1,r=null;if(t>this.receiveDepth){const e=this.receiveDepth+this.lookahead;o(t<=e+1);for(let i=e;i<t+this.lookahead;i++){const t=this.deriveReceive(i);await this.saveKey(t)}this.receive=this.deriveReceive(t-1),this.receiveDepth=t,n=!0,r=this.receive}if(e>this.changeDepth){const t=this.changeDepth+this.lookahead;o(e<=t+1);for(let i=t;i<e+this.lookahead;i++){const t=this.deriveChange(i);await this.saveKey(t)}this.change=this.deriveChange(e-1),this.changeDepth=e,n=!0}if(this.witness&&i>this.nestedDepth){const t=this.nestedDepth+this.lookahead;o(i<=t+1);for(let e=t;e<i+this.lookahead;e++){const t=this.deriveNested(e);await this.saveKey(t)}this.nested=this.deriveNested(i-1),this.nestedDepth=i,n=!0,r=this.nested}return n&&this.save(),r},n.prototype.setLookahead=async function(t){if(t!==this.lookahead){if(t<this.lookahead){const e=this.lookahead-t;return this.receiveDepth+=e,this.receive=this.deriveReceive(this.receiveDepth-1),this.changeDepth+=e,this.change=this.deriveChange(this.changeDepth-1),this.witness&&(this.nestedDepth+=e,this.nested=this.deriveNested(this.nestedDepth-1)),this.lookahead=t,void this.save()}{const e=this.receiveDepth+this.lookahead,i=this.receiveDepth+t;for(let t=e;t<i;t++){const e=this.deriveReceive(t);await this.saveKey(e)}}{const e=this.changeDepth+this.lookahead,i=this.changeDepth+t;for(let t=e;t<i;t++){const e=this.deriveChange(t);await this.saveKey(e)}}if(this.witness){const e=this.nestedDepth+this.lookahead,i=this.nestedDepth+t;for(let t=e;t<i;t++){const e=this.deriveNested(t);await this.saveKey(e)}}this.lookahead=t,this.save()}else this.db.logger.warning("Lookahead is not changing for: %s/%s.",this.id,this.name)},n.prototype.getAddress=function(t){return this.getReceive(t)},n.prototype.getReceive=function(t){return this.receive?this.receive.getAddress(t):null},n.prototype.getChange=function(t){return this.change?this.change.getAddress(t):null},n.prototype.getNested=function(t){return this.nested?this.nested.getAddress(t):null},n.prototype.getTempReceive=function(t){return this.deriveReceive(this.receiveDepth).getAddress(t)},n.prototype.inspect=function(){return{wid:this.wid,name:this.name,network:this.network,initialized:this.initialized,witness:this.witness,watchOnly:this.watchOnly,type:n.typesByVal[this.type].toLowerCase(),m:this.m,n:this.n,accountIndex:this.accountIndex,receiveDepth:this.receiveDepth,changeDepth:this.changeDepth,nestedDepth:this.nestedDepth,lookahead:this.lookahead,address:this.initialized?this.receive.getAddress():null,nestedAddress:this.initialized&&this.nested?this.nested.getAddress():null,accountKey:this.accountKey.toBase58(),keys:this.keys.map(t=>t.toBase58())}},n.prototype.toJSON=function(t){return{wid:t?void 0:this.wid,id:t?void 0:this.id,name:this.name,initialized:this.initialized,witness:this.witness,watchOnly:this.watchOnly,type:n.typesByVal[this.type].toLowerCase(),m:this.m,n:this.n,accountIndex:this.accountIndex,receiveDepth:this.receiveDepth,changeDepth:this.changeDepth,nestedDepth:this.nestedDepth,lookahead:this.lookahead,receiveAddress:this.receive?this.receive.getAddress("string"):null,nestedAddress:this.nested?this.nested.getAddress("string"):null,changeAddress:this.change?this.change.getAddress("string"):null,accountKey:this.accountKey.toBase58(),keys:this.keys.map(t=>t.toBase58())}},n.prototype.getSize=function(){let t=0;return t+=c.sizeVarString(this.name,"ascii"),t+=105,t+=82*this.keys.length},n.prototype.toRaw=function(){const t=this.getSize(),e=new h(t);e.writeVarString(this.name,"ascii"),e.writeU8(this.initialized?1:0),e.writeU8(this.witness?1:0),e.writeU8(this.type),e.writeU8(this.m),e.writeU8(this.n),e.writeU32(this.accountIndex),e.writeU32(this.receiveDepth),e.writeU32(this.changeDepth),e.writeU32(this.nestedDepth),e.writeU8(this.lookahead),e.writeBytes(this.accountKey.toRaw()),e.writeU8(this.keys.length);for(const t of this.keys)e.writeBytes(t.toRaw());return e.render()},n.prototype.fromRaw=function(t){const e=new a(t);this.name=e.readVarString("ascii"),this.initialized=1===e.readU8(),this.witness=1===e.readU8(),this.type=e.readU8(),this.m=e.readU8(),this.n=e.readU8(),this.accountIndex=e.readU32(),this.receiveDepth=e.readU32(),this.changeDepth=e.readU32(),this.nestedDepth=e.readU32(),this.lookahead=e.readU8(),this.accountKey=d.PublicKey.fromRaw(e.readBytes(82)),o(n.typesByVal[this.type]);const i=e.readU8();for(let t=0;t<i;t++){const t=d.PublicKey.fromRaw(e.readBytes(82));this.pushKey(t)}return this},n.fromRaw=function(t,e){return new n(t).fromRaw(e)},n.isAccount=function(t){return t instanceof n},t.exports=n},function(t,e,i){"use strict";const n=i(0),r=e;r.walletdb={binary:!0,p:function(t){n("string"==typeof t);const e=Buffer.allocUnsafe(1+t.length/2);return e[0]=112,e.write(t,1,"hex"),e},pp:function(t){return n(Buffer.isBuffer(t)),n(t.length>=21),t.toString("hex",1)},P:function(t,e){n("number"==typeof t),n("string"==typeof e);const i=Buffer.allocUnsafe(5+e.length/2);return i[0]=80,i.writeUInt32BE(t,1,!0),i.write(e,5,"hex"),i},Pp:function(t){return n(Buffer.isBuffer(t)),n(t.length>=25),t.toString("hex",5)},r:function(t,e,i){n("number"==typeof t),n("number"==typeof e),n("string"==typeof i);const r=Buffer.allocUnsafe(9+i.length/2);return r[0]=114,r.writeUInt32BE(t,1,!0),r.writeUInt32BE(e,5,!0),r.write(i,9,"hex"),r},rr:function(t){return n(Buffer.isBuffer(t)),n(t.length>=29),t.toString("hex",9)},w:function(t){n("number"==typeof t);const e=Buffer.allocUnsafe(5);return e[0]=119,e.writeUInt32BE(t,1,!0),e},ww:function(t){return n(Buffer.isBuffer(t)),n(5===t.length),t.readUInt32BE(1,!0)},l:function(t){n("string"==typeof t);const e=Buffer.byteLength(t,"ascii"),i=Buffer.allocUnsafe(1+e);return i[0]=108,e>0&&i.write(t,1,"ascii"),i},ll:function(t){return n(Buffer.isBuffer(t)),n(t.length>=1),t.toString("ascii",1)},a:function(t,e){n("number"==typeof t),n("number"==typeof e);const i=Buffer.allocUnsafe(9);return i[0]=97,i.writeUInt32BE(t,1,!0),i.writeUInt32BE(e,5,!0),i},i:function(t,e){n("number"==typeof t),n("string"==typeof e);const i=Buffer.byteLength(e,"ascii"),r=Buffer.allocUnsafe(5+i);return r[0]=105,r.writeUInt32BE(t,1,!0),i>0&&r.write(e,5,"ascii"),r},ii:function(t){return n(Buffer.isBuffer(t)),n(t.length>=5),[t.readUInt32BE(1,!0),t.toString("ascii",5)]},n:function(t,e){n("number"==typeof t),n("number"==typeof e);const i=Buffer.allocUnsafe(9);return i[0]=110,i.writeUInt32BE(t,1,!0),i.writeUInt32BE(e,5,!0),i},R:Buffer.from([82]),h:function(t){n("number"==typeof t);const e=Buffer.allocUnsafe(5);return e[0]=104,e.writeUInt32BE(t,1,!0),e},b:function(t){n("number"==typeof t);const e=Buffer.allocUnsafe(5);return e[0]=98,e.writeUInt32BE(t,1,!0),e},bb:function(t){return n(Buffer.isBuffer(t)),n(5===t.length),t.readUInt32BE(1,!0)},o:function(t,e){n("string"==typeof t),n("number"==typeof e);const i=Buffer.allocUnsafe(37);return i[0]=111,i.write(t,1,"hex"),i.writeUInt32BE(e,33,!0),i},oo:function(t){return n(Buffer.isBuffer(t)),n(37===t.length),[t.toString("hex",1,33),t.readUInt32BE(33,!0)]}},r.txdb={binary:!0,prefix:function(t,e){n("number"==typeof t),n(Buffer.isBuffer(e));const i=Buffer.allocUnsafe(5+e.length);return i[0]=116,i.writeUInt32BE(t,1),e.copy(i,5),i},pre:function(t){return n(Buffer.isBuffer(t)),n(t.length>=5),t.readUInt32BE(1,!0)},R:Buffer.from([82]),hi:function(t,e,i){n("string"==typeof e),n("number"==typeof i);const r=Buffer.allocUnsafe(37);return r[0]=t,r.write(e,1,"hex"),r.writeUInt32BE(i,33,!0),r},hii:function(t){return n(Buffer.isBuffer(t)),n(t.length-5==37),t=t.slice(6),[t.toString("hex",0,32),t.readUInt32BE(32,!0)]},ih:function(t,e,i){n("number"==typeof e),n("string"==typeof i);const r=Buffer.allocUnsafe(37);return r[0]=t,r.writeUInt32BE(e,1,!0),r.write(i,5,"hex"),r},ihh:function(t){return n(Buffer.isBuffer(t)),n(t.length-5==37),t=t.slice(6),[t.readUInt32BE(0,!0),t.toString("hex",4,36)]},iih:function(t,e,i,r){n("number"==typeof e),n("number"==typeof i),n("string"==typeof r);const s=Buffer.allocUnsafe(41);return s[0]=t,s.writeUInt32BE(e,1,!0),s.writeUInt32BE(i,5,!0),s.write(r,9,"hex"),s},iihh:function(t){return n(Buffer.isBuffer(t)),n(t.length-5==41),t=t.slice(6),[t.readUInt32BE(0,!0),t.readUInt32BE(4,!0),t.toString("hex",8,40)]},ihi:function(t,e,i,r){n("number"==typeof e),n("string"==typeof i),n("number"==typeof r);const s=Buffer.allocUnsafe(41);return s[0]=t,s.writeUInt32BE(e,1,!0),s.write(i,5,"hex"),s.writeUInt32BE(r,37,!0),s},ihii:function(t){return n(Buffer.isBuffer(t)),n(t.length-5==41),t=t.slice(6),[t.readUInt32BE(0,!0),t.toString("hex",4,36),t.readUInt32BE(36,!0)]},ha:function(t,e){n("string"==typeof e);const i=Buffer.allocUnsafe(33);return i[0]=t,i.write(e,1,"hex"),i},haa:function(t){return n(Buffer.isBuffer(t)),n(t.length-5==33),(t=t.slice(6)).toString("hex",0)},t:function(t){return this.ha(116,t)},tt:function(t){return this.haa(t)},c:function(t,e){return this.hi(99,t,e)},cc:function(t){return this.hii(t)},d:function(t,e){return this.hi(100,t,e)},dd:function(t){return this.hii(t)},s:function(t,e){return this.hi(115,t,e)},ss:function(t){return this.hii(t)},p:function(t){return this.ha(112,t)},pp:function(t){return this.haa(t)},m:function(t,e){return this.ih(109,t,e)},mm:function(t){return this.ihh(t)},h:function(t,e){return this.ih(104,t,e)},hh:function(t){return this.ihh(t)},T:function(t,e){return this.ih(84,t,e)},Tt:function(t){return this.ihh(t)},P:function(t,e){return this.ih(80,t,e)},Pp:function(t){return this.ihh(t)},M:function(t,e,i){return this.iih(77,t,e,i)},Mm:function(t){return this.iihh(t)},H:function(t,e,i){return this.iih(72,t,e,i)},Hh:function(t){return this.iihh(t)},C:function(t,e,i){return this.ihi(67,t,e,i)},Cc:function(t){return this.ihii(t)},r:function(t){return this.ha(114,t)},b:function(t){n("number"==typeof t);const e=Buffer.allocUnsafe(5);return e[0]=98,e.writeUInt32BE(t,1,!0),e},bb:function(t){return n(Buffer.isBuffer(t)),n(t.length-5==5),(t=t.slice(6)).readUInt32BE(0,!0)}}},function(t,e,i){"use strict";t.exports=["ebd41040e4bb3ec742c9e381d31ef2a41a48b6685c96e7cef3c1df6cd4331c99","ca42dd41745fd0b81eb902362cf9d8bf719da1bd1b1efc946f5b4c99f42c1b9e","eb04cf5eb1f39afa762f2bb120f296cba520c1b97db1589565b81cb9a17b7244","6dc47172e01cbcb0bf62580d895fe2b8ac9ad4f873801e0c10b9c837d21eb177","16af57a9f676b0ab126095aa5ebadef22ab31119d644ac95cd4b93dbf3f26aeb","8c7209279ac04e275e16d07fd3b775e80154b5968046e31f52dd25766324e9a7","687fa451382278fff0c8b11f8d43d576671c6eb2bceab413fb83d965d06d2ff2","0791ca0749b20782aad3c7d7bd0cdfc9485835843eb2d7996009ce43ab6c6927","8095210805db4bbc355e4428d8fd6ec2cde3ab5fb97a9942988eb8f4dcd06016","73c176434f1bc6d5adf45b0e76e727287c8de57616c1e6e6141a2b2cbc7d8e4c","af8b6762a1e528228161a95d5c559ee266278f75d79e830189a503506abd6b4c","ff856a2d251dcd88d36656f450126798cfabaade40799c722de4d2b5db36a73a","ca2d82a08677072f8ab6764ff035676cfe3e5e325e012172df3f92096db79b85","a0459b9f63b22559f5fa5d4c6db3f9f72ff19342033578f073bf1d1b46cbb912","a0234f3bc8527ca5628eec81ad5d69895da5680dc91d1cb8477f33f878b95b0b","69fac9bd55fb0ac78d53bbee5cf1d597989fd0aaab20a25151bdf1733ee7d122","d8e0febc1db2e38d00940f37d27d41344d993e734b99d5656d9778d4d8143624","d7a7a0fb5d7e2731d771e9484ebcdef71d5f0c3e0a2948782bc83ee0ea699ef4","bd81ce3b4f6591d11a67b5fc7a47fdef25521bf9aa4e18b9e3df2e34a7803be8","3f06e55681d496f5be169eb5389f9f2b8ff61e1708df6881724849cd5d27cb69","a45ede3bbbf09c8ae15c72efc07268d693a21c996fd51e67ca079460fd6d8873","85a0dd7dd720adb7ff05f83d542b209dc7ff4528f7d677b18389fea5e5c49e86","18f1fc7f205df8adddeb7fe007dd57e3af375a9c4d8d73546bf4f1fed1e18d35","e75e72ed9f560eec6eb4800073a43fc3ad19195a392282017895974a99026b6c","7908b40314c138100b518d0735807ffbfcf8518a0095337105ba386b153dd927","6ea54741d004667eed1b4816634aa3a79e6e4b96950f8279dafc8d9bd8812137","0c258a12a5674aef25f28ba7dcfaeceea348e541e6f5cc4ee63b71b361606ac3","ef3cb417fc8ebf6f97876c9e4ece39de1ea5fe649141d1028b7d11c0b2298ced","cecddc905099d8dadfc5b1d209b737cbe2c18cfb2c10c0ff0bcf0d3286fc1aa2","c3846bf24b9e93ca64274c0ec67c1ecc5e024ffcacd2d74019350e81fe546ae4","1465fa205397b876faa6f0a9958e5590e40fcc7faa4fb7c2c8677521fb5fb658","c766a9bef2d4071c863a31aa4920e813b2d198608cb7b7cfe21143b836df09ea","7600295eefe85b9e1fd624db76062aaaae59818a54d2774cd4c0b2c01131e1b3","21db20123660bb2ed418205da11ee7a85a65e2bc6e55b5af7e7899c8a266d92e","3e9099b5015e8f486c00bcea9d111ee721faba355a89bcf1df69561e3dc6325c","4348a0e9444c78cb265e058d5e8944b4d84f9662bd26db257f8934a443c70161","7431e5f4c3c1ce4690774f0b61e05440883ba9a01ed00ba6abd7806ed3b118cf","0f993c8aef97baaf5687140ed59ad1821bb4afacf0aa9a58b5d57a338a3afbcb","0687260331a72403d909f105e69bcf0d32e1bd2493ffc6d9206d11bcd6770739","767c955a76412c89af688e90a1c70f556cfd6b6025dbea10416d7eb6831f8c40","62dd0be9b9f50a163ea0f8e75c053b1eca57ea55c8688f647c6881f2c8357b95","be6c4da2bbb9ba59b6f3939768374246c3c005993fa98f020d1dedbed48a81d5","37d51006c512eaab626421f1ec8c92013fc5f82ae98ee533eb4619b8deb4d06c","8d722f81a9c113c0791df136a2966db26c950a971db46b4199f4ea54b78bfb9f","9acfab7e43c8d880d06b262a94deeee4b4659989c3d0caf19baf6405e41ab7df","f1c1b50ae5a20dd8030ec9f6bc24823dd367b5255759b4e71b61fce9f7375d73","4200f5043ac8590ebb527d209ed1503029fbcbd41ca1b506ec27f15ade7dac69","0c2cd63df7806fa399ede809116b575bf87989f06518f9808c860503178baf66","15f0ba00a3ac7af3ac884c072b1011a077bd77c097f40164b2f8598abd83860c","a71272aeaaa3cfe8727f7fb39f0fb3d1e5426e9060b06ee6f13e9a3c5833cd43","1793927a0614549789adce2f8f34f7f0b66d0f3ae3a3b84d21ec15dbba4fadc7","b9bea7860a962ea3611dab97ab6da3e21c1068b97d55575ed0e11279c11c8932","a22dba681e97376e2d397d728aae3a9b6296b9fdba60bc2e11f647f2c675fb37","41c923866ab4cad6b7ad578081582e020797a6cbdf4fff78ce8396b38937d7f5","327a3d761abadea034eb998406275cb1a4776efdae2fdf6d0168ea1c4f5567d0","e3b6a2db2ed7ce48842f7ac53241c7b71d54144bfb40c11f3f1d0b42f5eea12d","b6191a50d0c3977f7da99bcdaac86a227daeb9679ec70ba3b0c9d92271c170d3","960adf0063e96356750c2965dd0a0867da0b9cbd6e77714aeafb2349ab393da3","c0a6f4dc63a24bfdcf54ef2a6a082a0a72de35803e2ff5ff527ae5d87206dfd5","e4c73430d7a5b50925df43370a0d216e9a79b9d6db8373a0c69eb1cc31c7c52a","0f4e9cdd264b025550d170806340214fe94434c9b02f697ec710fc5feafb5e38","35ae5bddd8f7ae635cffba5682a8f00b95f48462c7108ee9a0e5292b074aafb2","eaa962c4fa4a6bafebe415196d351ccd888d4f53f3fa8ae6d7c466a94e6042bb","e28393773da845a679f2080cc7fb44a3b7a1c3792cb7eb7729fdcb6a8d99aea7","2d47437de17951215a12f3c58e51c729a58026ef1fcc0a5fb3d9dc012f600d19","b478b812250df878635c2aa7ec7d155eaa625ee82916e2cd294361886cd1fbd4","a4310d50af18a6447190372a86afaf8b951ffb431d837f1e5688b45971ed1557","4b03f45807ad70f21bfc2cae71c9fde4604c064cf5ffb686bae5dbaad7fdd34c","5edb7ac43b82a06a8761e8d7be4979ebf2611f7dd79bf91c1c6b566a219ed766","2399561127a57125de8cefea610ddf2fa078b5c8067f4e828290bfb860e84b3c","69ddd7ea90bb57c93e135dc85ea6fcd5480b603239bdc454fc758b2a26cf7f79","6c61dac3a2def031506be036d2a6fe401994fbd13df9c8d466599274c446ec98","668c83947da63b724bece1743c31a0e6aed0db8ec5b31be377bb784f91b6716f","ecc3e9c3407503bee091aa952f41348ff88baa863b2264befac807901574e939","f9e67d336c51002ac054c632022d66dda2e7e3fff10ad061ed31d8bbb410cfb2","bf0feefb9e3a581ad5f9e9db7589985743d261085c4d314f6f5d7259aa421612","03950fb49a531f3e1991942398dfa9e0ea32d7ba1cdd9bc85db57ed9400b434a","3c5f81fea5fab82c64bfa2eaecafcde8e077fc8620a7cae537163df36edbf378","cbb522d7b7f127ad6a0113865bdf1cd4102e7d0759af635a7cf4720dc963c53b","04048028bf1f2864d48f9ad4d83294366a828856553f3b14303f90147f5d40ef","2530cc8e98321502bad96f9b1fba1b099e2d299e0f4548bb914f363bc0d4531f","063e4afac491dfd332f3089b8542e94617d893d7fe944e10a7937ee29d9693c0","136335439334a7698016a0d324de72284e079d7b5220bb8fbd747816eebebaca","45140b3247eb9cc8c5b4f0d7b53091f73292089e6e5a63e2749dd3aca9198eda","2ce1cb0bf9d2f9e102993fbe215152c3b2dd0cabde1c68e5319b839154dbb7f5","568d6905a2c88708a4b3025190edcfedb1974a606a13c6e5290fcb2ae63edab5","0376ab1d54c5f9803ce4b2e201a0ee7eef7b57b636e8a93c9b8d4860c96f5fa7","0a81ec5a929777f145904af38d5d509f66b5e2c58fcdb531058b0e17f3f0b41b","70a73f7f376b60074248904534b11482d5bf0e698ecc498df52577ebf2e93b9a","bd71fdf6da97e4cf62d1647add2581b07d79adf8397eb4ecba9c5e8488821423","5c58468d55f58e497e743982d2b50010b6d165374acf83a7d4a32db768c4408e","fcbfe2886206f72b27593c8b070297e12d769ed10ed7930705a8098effc14d17","8c4edfd04348f322969e7e29a4cd4dca004655061c16e1b076422ef342ad630e","bfd88fe1101c41ae3e801bf8be56350ee9bad1a6b9bd515edc5c6d5b8711ac44","513b2cecb810d4cde5dd85391adfc6c2dd60d87bb736d2b521484aa47a0ebef6","88497f01602f3154246ae28c4d5aef10f1d87ebb76626f4ae0b7f95ba7968799","bc104f15a48be709dca542a7e1d4b9df6f054527e802eaa92d595444258afe71","55926084ec963a64b96e2abe01ce0ba86a64fbfebcc7aab5afc155b37fd76066","c1b48299aba5208fe9630ace55ca68a03eda5a519c8802a0d3a673be8f8e557d","e17890ee09a3fbf4f48b9c414a17d637b7a50647e9bc752322727fcc1742a911","c7ba6567de93a798ae1faa791e712d378fae1f93c4397fea441bb7cbe6fd5995","9a114025197c5bb95d94e63d55cd43790847b646b23cdf11ada4a00eff15fb48","edf7ebbca27a2a384d387b7d4010c666e2edb4843e4c29b4ae1d5b9332e6b24d","fd73dad31c644ff1b43bef0ccdda96710b9cd9875eca7e31707af3e96d522bbd","3e84ba4342908516e77573c0992f0979ca084e4685681ff195ccba8a229b8a76","978cd966f2faa07ba7aa9500d9c02e9d77f2cdada6ad6ba74af4b91c66593c50","49e7a442acf0ea6287050054b52564b650e4f49e42e348d6aa38e039e957b1c1","eec5496b988ce98625b934092eec2908bed0b0f316c2d4730c84eaf1f3d34881","3cfc3c14d1f684ff17e38c43ca440c00b967ec933e8bfe064ca1d72c90f2adb0","1c01c6f4dbb2fefc22558b2bca32563f49844acfc32b7be4b0ff599f9e8c7af7","f09b122c7114f4a09bd4ea4f4a99d558b46e4c25cd81140d29c05613914c3841","d95fea3ca4eedce74cd76e75fc6d1ff62c441f0fa8bc77f034b19e5db258015d","f96f23f4c3e79c077a46988d5af5900676a0f039cb645dd17549b216c82440ce","e23d4a036d7b70e9f595b1422079d2b91edfbb1fb651a0633eaa8a9dc5f80703","9a6ec012e1a7da9dbe34194d478ad7c0db1822fb071df12981496ed104384113","59769007f7685d0fcd50872f9f95d5755a5b2b457d81f3692b610a98672f0e1b","dd6936fe21f8f077c123a1a521c12224f72255b73e03a7260693e8a24b0fa389","b0bfd52bb0d7d9bd92bf5d4dc13da255c02c542f378365ea893911f55e55f23c","91e2f5788d5810eba7ba58737de1548a8ecacd014598bc0b143e041b17052552","f356bea244b7a91eb35d53ca9ad7864ace018e2d35d5f8f96ddf68a6f41aa474","8a866fd1b276b57e578e921c65828a2bed58e9f2f288054134b7f1f4bfc9cc74","8fe4fb0af93a4d0d67db0bebb23e37c71bf325dcbcdd240ea04daf58b47e1840","88ef81de202eb018452e43f864725cea5fbd1fc2d9d205730709c5d8b8690f46","7d05ebb682339f8c9451ee094eebfefa7953a114edb2f44949452fab7d2fc185","7e37cb8b4c47090cab36551ba6f45db840680fba166a952db100717f43053fc2","cb3ccbb76031e5e0138f8dd39a23f9de47ffc35e43c1144cea27d46a5ab1cb5f","31ad6648f8104138c738f39ea4320133393e3a18cc02296ef97c2ac9ef6731d0","552f7bdcf1a7af9e6ce672017f4f12abf77240c78e761ac203d1d9d20ac89988","4b22d5a6aec99f3cdb79aa5ec06838479cd5ecba7164f7f22dc1d65f63d85708","d6f034bd94aa233f0297eca4245b283973e447aa590f310c77f48fdf83112254","52f0e1c4e58ec629291b60317f074671b85d7ea80d5b07273463534b32b40234","e793c9b02fd8aa13e21c31228accb08119643b749c898964b1746d46c3d4cbd2","4ff460d54b9c86dabfbcfc5712e0400d2bed3fbc4d4fbdaa86e06adcd2a9ad7a","bec94911c2955676db6c0a550986d76e3ba005667c442c9762b4fbb773de228c","179fbc148a3dd00fd24ea13458cc43bfa7f59c8182d783a513f6ebec100c8924","3c4fb0b95ab8b30032f432b86f535fe172c185d0fd39865837cf36187fa6f428","4d2491414cfe956746ec4cefa6cf6f72e28a1329432f9d8a907ac4cb5dadc15a","5d56499be4d2e08bcfcad08a3e38723d50503bde706948e42f55603019e528ae","30d0895a9a448a262091635522d1f52010b5867acae12c78ef958fd4f4389f2f","43df5774b03e7fef5fe40d931a7bedf1bb2e6b42738c4e6d3841103d3aa7f339","02ed0eb28c14da45165c566791700d6451d7fb56f0b2ab1d3b8eb070e56edff5","5cc3d78e4e1d5e45547a04e6873e64f90cf9536d1ccc2ef800f355c4c5fd70fd","49351b903444c185ccdc5c693d24d8555cb208d6a8141307699f4af063199d78","8de78655e1be7f7847800b93f694d21d368cc06e033e7fab04bb5eb99da6b700","2a99f5bc1174b73cbb1d620884e01c34e51ccb3978da125f0e33268883bf4158","6b9c08e86eb0f767cfad65cd98b62149e5494a67f5845e7bd1ed019f27b86bd6","d487a56f83b07482e85e963394c1ecc2c9e51d0903ee946b02c301581ed99e16","8b45da1c06f791eb0cabf26be588f5fb23165c2e614bf885562d0dce50b29b02","a1339d33281a0b56e557d3d32b1ce7f9367eb094bd5fa72a7e5004c8ded7cafe","b676f2eddae8775cd36cb0f63cd1d4603961f49e6265ba013a2f0307b6d0b804"]},function(t,e,i){"use strict";function n(t){if(!(this instanceof n))return new n(t);this.merchantData=null,this.transactions=[],this.refundTo=[],this.memo=null,t&&this.fromOptions(t)}const r=i(0),s=i(13),o=i(15),a=i(8),h=i(81),c=i(82),u=i(159);n.prototype.fromOptions=function(t){if(t.merchantData&&this.setData(t.merchantData),t.transactions){r(Array.isArray(t.transactions));for(const e of t.transactions){const t=new o(e);this.transactions.push(t)}}if(t.refundTo){r(Array.isArray(t.refundTo));for(const e of t.refundTo){const t=new s(e);this.refundTo.push(t)}}return null!=t.memo&&(r("string"==typeof t.memo),this.memo=t.memo),this},n.fromOptions=function(t){return(new n).fromOptions(t)},n.prototype.setData=u.prototype.setData,n.prototype.getData=u.prototype.getData,n.prototype.fromRaw=function(t){const e=new h(t);for(this.merchantData=e.readFieldBytes(1,!0);2===e.nextTag();){const t=o.fromRaw(e.readFieldBytes(2));this.transactions.push(t)}for(;3===e.nextTag();){const t=new h(e.readFieldBytes(3)),i=new s;i.value=t.readFieldU64(1,!0),i.script=a.fromRaw(t.readFieldBytes(2,!0)),this.refundTo.push(i)}return this.memo=e.readFieldString(4,!0),this},n.fromRaw=function(t,e){return"string"==typeof t&&(t=Buffer.from(t,e)),(new n).fromRaw(t)},n.prototype.toRaw=function(){const t=new c;this.merchantData&&t.writeFieldBytes(1,this.merchantData);for(const e of this.transactions)t.writeFieldBytes(2,e.toRaw());for(const e of this.refundTo){const i=new c;i.writeFieldU64(1,e.value),i.writeFieldBytes(2,e.script.toRaw()),t.writeFieldBytes(3,i.render())}return null!=this.memo&&t.writeFieldString(4,this.memo),t.render()},t.exports=n},function(t,e,i){"use strict";const n=i(0),r=i(192),s=i(101),o=i(1),a=i(5),h=i(193),c=i(189),u=e;u.trusted=new Set,u.allowUntrusted=!1,u.oid={"1.2.840.10040.4.1":{key:"dsa",hash:null},"1.2.840.10040.4.2":{key:"dsa",hash:null},"1.2.840.10040.4.3":{key:"dsa",hash:"sha1"},"1.2.840.113549.1.1.1":{key:"rsa",hash:null},"1.2.840.113549.1.1.2":{key:"rsa",hash:"md2"},"1.2.840.113549.1.1.3":{key:"rsa",hash:"md4"},"1.2.840.113549.1.1.4":{key:"rsa",hash:"md5"},"1.2.840.113549.1.1.5":{key:"rsa",hash:"sha1"},"1.2.840.113549.1.1.11":{key:"rsa",hash:"sha256"},"1.2.840.113549.1.1.12":{key:"rsa",hash:"sha384"},"1.2.840.113549.1.1.13":{key:"rsa",hash:"sha512"},"1.2.840.113549.1.1.14":{key:"rsa",hash:"sha224"},"1.2.840.10045.2.1":{key:"ecdsa",hash:null},"1.2.840.10045.4.1":{key:"ecdsa",hash:"sha1"},"1.2.840.10045.4.3.1":{key:"ecdsa",hash:"sha224"},"1.2.840.10045.4.3.2":{key:"ecdsa",hash:"sha256"},"1.2.840.10045.4.3.3":{key:"ecdsa",hash:"sha384"},"1.2.840.10045.4.3.4":{key:"ecdsa",hash:"sha512"}},u.curves={"1.3.132.0.33":"p224","1.2.840.10045.3.1.7":"p256","1.3.132.0.34":"p384","1.3.132.0.35":"p521"},u.getSubjectOID=function(t,e){const i=t.tbs.subject;for(const t of i)if(t.type===e)return t.value;return null},u.getCAName=function(t){return u.getSubjectOID(t,"2.5.4.3")||u.getSubjectOID(t,"2.5.4.11")||u.getSubjectOID(t,"2.5.4.10")||"Unknown"},u.isTrusted=function(t){const e=a.sha256(t.raw).toString("hex");return u.trusted.has(e)},u.setTrust=function(t){n(Array.isArray(t),"Certs must be an array.");for(let e of t){if("string"==typeof e){const t=s.decode(e);n("certificate"===t.type,"Must add certificates to trust."),e=t.data}n(Buffer.isBuffer(e),"Certificates must be PEM or DER."),e=u.parse(e);const t=a.sha256(e.raw).toString("hex");u.trusted.add(t)}},u.setFingerprints=function(t){n(Array.isArray(t),"Certs must be an array.");for(let e of t)"string"==typeof e&&(e=Buffer.from(e,"hex")),n(Buffer.isBuffer(e),"Fingerprint must be a buffer."),n(32===e.length,"Fingerprint must be a sha256 hash."),e=e.toString("hex"),u.trusted.add(e)},u.getKeyAlgorithm=function(t){const e=t.tbs.pubkey.alg.alg,i=u.oid[e];if(!i)throw new Error(`Unknown key algorithm: ${e}.`);return i},u.getSigAlgorithm=function(t){const e=t.sigAlg.alg,i=u.oid[e];if(!i||!i.hash)throw new Error(`Unknown signature algorithm: ${e}.`);return i},u.getCurve=function(t){let e;try{e=r.parseOID(t)}catch(t){throw new Error("Could not parse curve OID.")}const i=u.curves[e];if(!i)throw new Error(`Unknown ECDSA curve: ${e}.`);return i},u.parse=function(t){try{return r.parseCert(t)}catch(t){throw new Error("Could not parse DER certificate.")}},u.getPublicKey=function(t){const e=u.getKeyAlgorithm(t),i=t.tbs.pubkey.pubkey,n=t.tbs.pubkey.alg.params;let r=null;if("ecdsa"===e.key){if(!n)throw new Error("No curve selected for ECDSA (cert).");r=u.getCurve(n)}return{alg:e.key,data:i,params:n,curve:r}},u.verifyTime=function(t){const e=t.tbs.validity,i=o.now();return i>e.notBefore&&i<e.notAfter},u.getSigningKey=function(t,e){if(n(0!==e.length,"No chain available."),"string"==typeof t){let e=null;if("ecdsa"===(t=s.decode(t)).alg){if(!t.params)throw new Error("No curve selected for ECDSA (key).");e=u.getCurve(t.params)}t={alg:t.alg,data:t.data,params:t.params,curve:e}}else{const i=u.parse(e[0]),n=u.getPublicKey(i);t={alg:n.alg,data:t,params:n.params,curve:n.curve}}return t},u.signSubject=function(t,e,i,n){const r=u.getSigningKey(i,n);return h.sign(t,e,r)},u.getVerifyKey=function(t){if(0===t.length)throw new Error("No verify key available (cert chain).");const e=u.parse(t[0]);return u.getPublicKey(e)},u.verifySubject=function(t,e,i,n){const r=u.getVerifyKey(n);return h.verify(t,e,i,r)},u.parseChain=function(t){const e=[];for(const i of t){const t=u.parse(i);e.push(t)}return e},u.verifyTimes=function(t){for(const e of t)if(!u.verifyTime(e))return!1;return!0},u.verifyTrust=function(t){if(u.allowUntrusted)return!0;for(const e of t)if(u.isTrusted(e))return!0;return!1},u.verifyChain=function(t){const e=u.parseChain(t);if(!u.verifyTimes(e))throw new Error("Invalid certificate times.");for(let t=1;t<e.length;t++){const i=e[t-1],n=e[t],r=u.getSigAlgorithm(i),s=u.getPublicKey(n),o=i.tbs.raw,a=i.sig;if(!h.verify(r.hash,o,a,s))throw new Error(`${r.key} verification failed for chain.`)}if(!u.verifyTrust(e))throw new Error("Certificate chain is untrusted.");return!0},u.setFingerprints(c)},function(t,e,i){"use strict";const n=i(2),r=e;r.readTag=function(t){let e=t.readU8();const i=0==(32&e);if(31==(31&e)){let i=e;for(e=0;128==(128&i);)e<<=7,e|=127&(i=t.readU8())}else e&=31;return{type:e,primitive:i,size:r.readSize(t,i)}},r.readSize=function(t,e){let i=t.readU8();if(!e&&128===i)throw new Error("Indefinite size.");if(0==(128&i))return i;const n=127&i;if(n>3)throw new Error("Length octet is too long.");i=0;for(let e=0;e<n;e++)i<<=8,i|=t.readU8();return i},r.readSeq=function(t){const e=r.implicit(t,16);return t.readBytes(e.size)},r.implicit=function(t,e){const i=r.readTag(t);if(i.type!==e)throw new Error(`Unexpected tag: ${i.type}.`);return i},r.explicit=function(t,e){const i=t.offset;return r.readTag(t).type===e||(t.offset=i,!1)},r.seq=function(t){return new n(r.readSeq(t),!0)},r.readInt=function(t,e){const i=r.implicit(t,2),n=t.readBytes(i.size);return e?n.readUIntBE(0,n.length):n},r.readExplicitInt=function(t,e,i){return r.explicit(t,e)?r.readInt(t,i):-1},r.readBitstr=function(t){const e=r.implicit(t,3),i=t.readBytes(e.size);return r.alignBitstr(i)},r.readString=function(t){const e=r.readTag(t);switch(e.type){case 3:{const i=t.readBytes(e.size);return r.alignBitstr(i).toString("utf8")}case 4:case 18:case 19:case 20:case 21:case 22:case 25:case 12:case 26:case 27:case 28:case 29:case 30:return t.readString("utf8",e.size);default:throw new Error(`Unexpected tag: ${e.type}.`)}},r.alignBitstr=function(t){const e=t[0],i=8*(t.length-1)-e,n=t.slice(1),r=8-i%8;if(8===r||0===n.length)return n;const s=Buffer.allocUnsafe(n.length);s[0]=n[0]>>>r;for(let t=1;t<n.length;t++)s[t]=n[t-1]<<8-r,s[t]|=n[t]>>>r;return s},r.readCert=function(t){const e=t;return e.start(),t=r.seq(e),{tbs:r.readTBS(t),sigAlg:r.readAlgIdent(t),sig:r.readBitstr(t),raw:e.endData(!0)}},r.readTBS=function(t){const e=t;return e.start(),t=r.seq(e),{version:r.readExplicitInt(t,0,!0),serial:r.readInt(t),sig:r.readAlgIdent(t),issuer:r.readName(t),validity:r.readValidity(t),subject:r.readName(t),pubkey:r.readPubkey(t),raw:e.endData(!0)}},r.readPubkey=function(t){return t=r.seq(t),{alg:r.readAlgIdent(t),pubkey:r.readBitstr(t)}},r.readName=function(t){const e=[];for(t=r.seq(t);t.left();)r.implicit(t,17),r.implicit(t,16),e.push({type:r.readOID(t),value:r.readString(t)});return e},r.readValidity=function(t){return t=r.seq(t),{notBefore:r.readTime(t),notAfter:r.readTime(t)}},r.readTime=function(t){const e=r.readTag(t),i=t.readString("ascii",e.size);let n,s,o,a,h,c;switch(e.type){case 23:n=0|i.slice(0,2),s=0|i.slice(2,4),o=0|i.slice(4,6),a=0|i.slice(6,8),h=0|i.slice(8,10),c=0|i.slice(10,12),n=n<70?2e3+n:1900+n;break;case 24:n=0|i.slice(0,4),s=0|i.slice(4,6),o=0|i.slice(6,8),a=0|i.slice(8,10),h=0|i.slice(10,12),c=0|i.slice(12,14);break;default:throw new Error(`Unexpected tag: ${e.type}.`)}return Date.UTC(n,s-1,o,a,h,c,0)/1e3},r.readOID=function(t){const e=r.implicit(t,6),i=t.readBytes(e.size);return r.formatOID(i)},r.formatOID=function(t){const e=new n(t),i=[];let r=0,s=0;for(;e.left();)r<<=7,r|=127&(s=e.readU8()),0==(128&s)&&(i.push(r),r=0);128&s&&i.push(r);return[i[0]/40|0,i[0]%40].concat(i.slice(1)).join(".")},r.readAlgIdent=function(t){let e=null;t=r.seq(t);const i=r.readOID(t);if(t.left()>0){const i=r.readTag(t);0===(e=t.readBytes(i.size)).length&&(e=null)}return{alg:i,params:e}},r.readRSAPublic=function(t){return t=r.seq(t),{modulus:r.readInt(t),publicExponent:r.readInt(t)}},r.readRSAPrivate=function(t){return t=r.seq(t),{version:r.readInt(t,!0),modulus:r.readInt(t),publicExponent:r.readInt(t),privateExponent:r.readInt(t),prime1:r.readInt(t),prime2:r.readInt(t),exponent1:r.readInt(t),exponent2:r.readInt(t),coefficient:r.readInt(t)}},r.parseRSAPublic=function(t){return r.readRSAPublic(new n(t,!0))},r.parseRSAPrivate=function(t){return r.readRSAPrivate(new n(t,!0))},r.parseCert=function(t){return r.readCert(new n(t,!0))},r.parseTBS=function(t){return r.readTBS(new n(t,!0))}},function(t,e,i){"use strict";const n=i(194),r=i(195);e.verify=function(t,e,i,s){switch(s.alg){case"rsa":return n.verify(t,e,i,s.data);case"ecdsa":return r.verify(s.curve,t,e,i,s.data);default:throw new Error("Unsupported algorithm.")}},e.sign=function(t,e,i){switch(i.alg){case"rsa":return n.sign(t,e,i.data);case"ecdsa":return r.sign(i.curve,t,e,i.data);default:throw new Error("Unsupported algorithm.")}}},function(t,e,i){"use strict";function n(t,e){return`${t.toUpperCase()}-${e.toUpperCase()}`}const r=i(0),s=i(24),o=i(101);e.verify=function(t,e,i,a){r("string"==typeof t,"No algorithm selected."),r(Buffer.isBuffer(e)),r(Buffer.isBuffer(i)),r(Buffer.isBuffer(a));const h=n("rsa",t),c=o.encode(a,"rsa","public key"),u=s.createVerify(h);try{return u.update(e),u.verify(c,i)}catch(t){return!1}},e.sign=function(t,e,i){r("string"==typeof t,"No algorithm selected."),r(Buffer.isBuffer(e)),r(Buffer.isBuffer(i));const a=n("rsa",t),h=o.encode(i,"rsa","private key"),c=s.createSign(a);return c.update(e),c.sign(h)}},function(t,e,i){"use strict";const n=i(0),r=i(9),s=i(5);e.verify=function(t,e,i,o,a){n("string"==typeof t,"No curve selected."),n("string"==typeof e,"No algorithm selected."),n(Buffer.isBuffer(i)),n(Buffer.isBuffer(o)),n(Buffer.isBuffer(a));const h=r.ec(t),c=s.hash(e,i);try{return h.verify(c,o,a)}catch(t){return!1}},e.sign=function(t,e,i,o){n("string"==typeof t,"No curve selected."),n("string"==typeof e,"No algorithm selected."),n(Buffer.isBuffer(i)),n(Buffer.isBuffer(o));const a=r.ec(t),h=s.hash(e,i),c=a.sign(h,o,{canonical:!0});return Buffer.from(c.toDER())}},function(t,e,i){"use strict";function n(t,e,i){if(!(this instanceof n))return new n(t,e,i);h("function"==typeof t,"Backend is required."),h("string"==typeof e,"Filename is required."),this.options=new o(i),this.backend=t,this.location=e,this.locker=new c,this.loading=!1,this.closing=!1,this.loaded=!1,this.db=null,this.binding=null,this.init()}function r(t){this.batch=t.binding.batch()}function s(t,e){(e=new a(e)).keyAsBuffer=t.options.bufferKeys,this.iter=t.db.iterator(e)}function o(t){this.createIfMissing=!0,this.errorIfExists=!1,this.compression=!0,this.cacheSize=8<<20,this.writeBufferSize=4<<20,this.maxOpenFiles=64,this.maxFileSize=2<<20,this.paranoidChecks=!1,this.memory=!1,this.sync=!1,this.mapSize=274877906944,this.writeMap=!1,this.noSubdir=!0,this.bufferKeys=!0,t&&this.fromOptions(t)}function a(t){this.gte=null,this.lte=null,this.keys=!0,this.values=!1,this.fillCache=!1,this.keyAsBuffer=!0,this.valueAsBuffer=!0,this.reverse=!1,this.highWaterMark=16384,t&&this.fromOptions(t)}const h=i(0),c=i(23),u=i(16),f=Buffer.from([0]),l=Buffer.from([255]);let p;n.prototype.init=function(){let t=new(0,this.backend)(this.location),e=t;for(;t.db&&"function"==typeof t.db.put&&t.db!==t;)e=t=t.db;t.binding&&(e=t.binding),this.db=t,this.binding=e},n.prototype.open=async function(){const t=await this.locker.lock();try{return await this._open()}finally{t()}},n.prototype._open=async function(){if(this.loaded)throw new Error("Database is already open.");h(!this.loading),h(!this.closing),this.loading=!0;try{await this.load()}catch(t){throw this.loading=!1,t}this.loading=!1,this.loaded=!0},n.prototype.close=async function(){const t=await this.locker.lock();try{return await this._close()}finally{t()}},n.prototype._close=async function(){if(!this.loaded)throw new Error("Database is already closed.");h(!this.loading),h(!this.closing),this.loaded=!1,this.closing=!0;try{await this.unload()}catch(t){throw this.loaded=!0,this.closing=!1,t}this.closing=!1},n.prototype.load=function(){return new Promise((t,e)=>{this.binding.open(this.options,u.wrap(t,e))})},n.prototype.unload=function(){return new Promise((t,e)=>{this.binding.close(u.wrap(t,e))})},n.prototype.destroy=function(){return new Promise((t,e)=>{this.loaded||this.closing?e(new Error("Cannot destroy open database.")):this.backend.destroy?this.backend.destroy(this.location,u.wrap(t,e)):e(new Error("Cannot destroy (method not available)."))})},n.prototype.repair=function(){return new Promise((t,e)=>{this.loaded||this.closing?e(new Error("Cannot repair open database.")):this.backend.repair?this.backend.repair(this.location,u.wrap(t,e)):e(new Error("Cannot repair (method not available)."))})},n.prototype.backup=function(t){return this.binding.backup?new Promise((e,i)=>{this.loaded?this.binding.backup(t,u.wrap(e,i)):i(new Error("Database is closed."))}):this.clone(t)},n.prototype.get=function(t){return new Promise((e,i)=>{this.loaded?this.binding.get(t,(t,n)=>{if(t)return function(t){return!!t&&(t.notFound||"NotFoundError"===t.type||/not\s*found/i.test(t.message))}(t)?void e(null):void i(t);e(n)}):i(new Error("Database is closed."))})},n.prototype.put=function(t,e){return e||(e=f),new Promise((i,n)=>{this.loaded?this.binding.put(t,e,u.wrap(i,n)):n(new Error("Database is closed."))})},n.prototype.del=function(t){return new Promise((e,i)=>{this.loaded?this.binding.del(t,u.wrap(e,i)):i(new Error("Database is closed."))})},n.prototype.batch=function(t){if(!t){if(!this.loaded)throw new Error("Database is closed.");return new r(this)}return new Promise((e,i)=>{this.loaded?this.binding.batch(t,u.wrap(e,i)):i(new Error("Database is closed."))})},n.prototype.iterator=function(t){if(!this.loaded)throw new Error("Database is closed.");return new s(this,t)},n.prototype.getProperty=function(t){if(!this.loaded)throw new Error("Database is closed.");return this.binding.getProperty?this.binding.getProperty(t):""},n.prototype.approximateSize=function(t,e){return new Promise((i,n)=>{this.loaded?this.binding.approximateSize?this.binding.approximateSize(t,e,u.wrap(i,n)):n(new Error("Cannot get size.")):n(new Error("Database is closed."))})},n.prototype.compactRange=function(t,e){return t||(t=f),e||(e=l),new Promise((i,n)=>{this.loaded?this.binding.compactRange?this.binding.compactRange(t,e,u.wrap(i,n)):i():n(new Error("Database is closed."))})},n.prototype.has=async function(t){return null!=await this.get(t)},n.prototype.range=async function(t){const e=[],i=t.parse,n=this.iterator({gte:t.gte,lte:t.lte,keys:!0,values:!0});for(;;){let t=await n.next();if(!t)break;if(i)try{t=i(t.key,t.value)}catch(t){throw await n.end(),t}t&&e.push(t)}return e},n.prototype.offset=async function(t){const e=t.parse,i=this.iterator({gte:t.gte,lte:t.lte,reverse:t.reverse,keys:!0,values:!1});for(;;){const n=await i.next();if(!n)break;let r=n.key;if(e)try{r=e(r)}catch(t){throw await i.end(),t}let s=!1;if(r&&(s=await t.break(r)),s){await i.end();break}}},n.prototype.keys=async function(t){const e=[],i=t.parse,n=this.iterator({gte:t.gte,lte:t.lte,limit:t.limit,reverse:t.reverse,keys:!0,values:!1});for(;;){const t=await n.next();if(!t)break;let r=t.key;if(i)try{r=i(r)}catch(t){throw await n.end(),t}r&&e.push(r)}return e},n.prototype.values=async function(t){const e=[],i=t.parse,n=this.iterator({gte:t.gte,lte:t.lte,keys:!1,values:!0});for(;;){const t=await n.next();if(!t)break;let r=t.value;if(i)try{r=i(r)}catch(t){throw await n.end(),t}r&&e.push(r)}return e},n.prototype.count=async function(t){const e=this.iterator({gte:t.gte,lte:t.lte,keys:!0,values:!1});let i=0;for(;;){if(!await e.next())break;i++}return i},n.prototype.dump=async function(){const t=Object.create(null),e=await this.range({gte:f,lte:l});for(const i of e){const e=i.key.toString("hex"),n=i.value.toString("hex");t[e]=n}return t},n.prototype.checkVersion=async function(t,e){let i=await this.get(t);if(!i)return(i=Buffer.allocUnsafe(4)).writeUInt32LE(e,0,!0),void await this.put(t,i);if((i=i.readUInt32LE(0,!0))!==e)throw new Error(p)},n.prototype.clone=async function(t){if(!this.loaded)throw new Error("Database is closed.");const e=new o(this.options);e.createIfMissing=!0,e.errorIfExists=!0;const i=new n(this.backend,t,e);await i.open();let r=i.batch(),s=0;const a=this.iterator({keys:!0,values:!0});for(;;){const t=await a.next();if(!t)break;if(r.put(t.key,t.value),(s+=t.value.length)>=256<<20){s=0;try{await r.write()}catch(t){throw await a.end(),await i.close(),t}r=i.batch()}}try{await r.write()}finally{await i.close()}},r.prototype.put=function(t,e){return e||(e=f),this.batch.put(t,e),this},r.prototype.del=function(t){return this.batch.del(t),this},r.prototype.write=function(){return new Promise((t,e)=>{this.batch.write(u.wrap(t,e))})},r.prototype.clear=function(){return this.batch.clear(),this},s.prototype.next=function(){return new Promise((t,e)=>{this.iter.next((i,n,r)=>{i?this.iter.end(()=>e(i)):void 0!==n||void 0!==r?t(new function(t,e){this.key=t,this.value=e}(n,r)):this.iter.end(u.wrap(t,e))})})},s.prototype.seek=function(t){this.iter.seek(t)},s.prototype.end=function(){return new Promise((t,e)=>{this.iter.end(u.wrap(t,e))})},o.prototype.fromOptions=function(t){return h(t,"Options are required."),null!=t.createIfMissing&&(h("boolean"==typeof t.createIfMissing,"`createIfMissing` must be a boolean."),this.createIfMissing=t.createIfMissing),null!=t.errorIfExists&&(h("boolean"==typeof t.errorIfExists,"`errorIfExists` must be a boolean."),this.errorIfExists=t.errorIfExists),null!=t.compression&&(h("boolean"==typeof t.compression,"`compression` must be a boolean."),this.compression=t.compression),null!=t.cacheSize&&(h("number"==typeof t.cacheSize,"`cacheSize` must be a number."),h(t.cacheSize>=0),this.cacheSize=Math.floor(t.cacheSize/2),this.writeBufferSize=Math.floor(t.cacheSize/4)),null!=t.maxFiles&&(h("number"==typeof t.maxFiles,"`maxFiles` must be a number."),h(t.maxFiles>=0),this.maxOpenFiles=t.maxFiles),null!=t.maxFileSize&&(h("number"==typeof t.maxFileSize,"`maxFileSize` must be a number."),h(t.maxFileSize>=0),this.maxFileSize=t.maxFileSize),null!=t.paranoidChecks&&(h("boolean"==typeof t.paranoidChecks,"`paranoidChecks` must be a boolean."),this.paranoidChecks=t.paranoidChecks),null!=t.memory&&(h("boolean"==typeof t.memory,"`memory` must be a boolean."),this.memory=t.memory),null!=t.sync&&(h("boolean"==typeof t.sync,"`sync` must be a boolean."),this.sync=t.sync),null!=t.mapSize&&(h("number"==typeof t.mapSize,"`mapSize` must be a number."),h(t.mapSize>=0),this.mapSize=t.mapSize),null!=t.writeMap&&(h("boolean"==typeof t.writeMap,"`writeMap` must be a boolean."),this.writeMap=t.writeMap),null!=t.noSubdir&&(h("boolean"==typeof t.noSubdir,"`noSubdir` must be a boolean."),this.noSubdir=t.noSubdir),null!=t.bufferKeys&&(h("boolean"==typeof t.bufferKeys,"`bufferKeys` must be a boolean."),this.bufferKeys=t.bufferKeys),this},a.prototype.fromOptions=function(t){if(h(t,"Options are required."),null!=t.gte&&(h(Buffer.isBuffer(t.gte)||"string"==typeof t.gte),this.gte=t.gte),null!=t.lte&&(h(Buffer.isBuffer(t.lte)||"string"==typeof t.lte),this.lte=t.lte),null!=t.keys&&(h("boolean"==typeof t.keys),this.keys=t.keys),null!=t.values&&(h("boolean"==typeof t.values),this.values=t.values),null!=t.fillCache&&(h("boolean"==typeof t.fillCache),this.fillCache=t.fillCache),null!=t.keyAsBuffer&&(h("boolean"==typeof t.keyAsBuffer),this.keyAsBuffer=t.keyAsBuffer),null!=t.valueAsBuffer&&(h("boolean"==typeof t.valueAsBuffer),this.valueAsBuffer=t.valueAsBuffer),null!=t.reverse&&(h("boolean"==typeof t.reverse),this.reverse=t.reverse),null!=t.limit&&(h("number"==typeof t.limit),h(t.limit>=0),this.limit=t.limit),!this.keys&&!this.values)throw new Error("Keys and/or values must be chosen.");return this},p="Warning: Your database does not match the current database version. This is likely because the database layout or serialization format has changed drastically. If you want to dump your data, downgrade to your previous version first. If you do not think you should be seeing this error, post an issue on the repo.",t.exports=n},function(t,e,i){"use strict";e.get=function(t){try{switch(t){case"leveldown":return i(256);case"rocksdown":return i(!function(){var t=new Error('Cannot find module "rocksdown"');throw t.code="MODULE_NOT_FOUND",t}());case"lmdb":return i(!function(){var t=new Error('Cannot find module "lmdb"');throw t.code="MODULE_NOT_FOUND",t}());case"memory":return i(198);default:throw new Error(`Database backend "${t}" not found.`)}}catch(e){if("MODULE_NOT_FOUND"===e.code)throw new Error(`Database backend "${t}" not found.`);throw e}}},function(t,e,i){"use strict";function n(t){if(!(this instanceof n))return new n(t);this.location=t||"memory",this.options={},this.tree=new u(h,!0)}function r(t,e){this.options=e||{},this.ops=[],this.db=t,this.written=!1}function s(t,e,i){this.type=t,this.key=e,this.value=i}function o(t,e){this.db=t,this.options=new a(e),this.iter=null,this.ended=!1,this.total=0,this.init()}function a(t){this.keys=!0,this.values=!0,this.start=null,this.end=null,this.gt=!1,this.lt=!1,this.keyAsBuffer=!0,this.valueAsBuffer=!0,this.reverse=!1,this.limit=-1,t&&this.fromOptions(t)}function h(t,e){return t.compare(e)}const c=i(0),u=i(199),f=Buffer.alloc(0);n.prototype.search=function(t){"string"==typeof t&&(t=Buffer.from(t,"utf8")),c(Buffer.isBuffer(t),"Key must be a Buffer.");const e=this.tree.search(t);if(e)return e.value},n.prototype.insert=function(t,e){return"string"==typeof t&&(t=Buffer.from(t,"utf8")),"string"==typeof e&&(e=Buffer.from(e,"utf8")),null==e&&(e=f),c(Buffer.isBuffer(t),"Key must be a Buffer."),c(Buffer.isBuffer(e),"Value must be a Buffer."),null!=this.tree.insert(t,e)},n.prototype.remove=function(t){return"string"==typeof t&&(t=Buffer.from(t,"utf8")),c(Buffer.isBuffer(t),"Key must be a Buffer."),null!=this.tree.remove(t)},n.prototype.range=function(t,e){return"string"==typeof t&&(t=Buffer.from(t,"utf8")),"string"==typeof e&&(e=Buffer.from(e,"utf8")),c(!t||Buffer.isBuffer(t),"Key must be a Buffer."),c(!e||Buffer.isBuffer(e),"Key must be a Buffer."),this.tree.range(t,e)},n.prototype.open=function(t,e){e||(e=t,t=null),t||(t={}),this.options=t,setImmediate(e)},n.prototype.close=function(t){setImmediate(t)},n.prototype.get=function(t,e,i){i||(i=e,e=null),e||(e={});let n=this.search(t);if(!n){const t=new Error("MEMDB_NOTFOUND: Key not found.");return t.notFound=!0,t.type="NotFoundError",void setImmediate(()=>i(t))}!1===e.asBuffer&&(n=n.toString("utf8")),setImmediate(()=>i(null,n))},n.prototype.put=function(t,e,i,n){n||(n=i,i=null),this.insert(t,e),setImmediate(n)},n.prototype.del=function(t,e,i){i||(i=e,e=null),this.remove(t),setImmediate(i)},n.prototype.batch=function(t,e,i){i||(i=e,e=null);const n=new r(this,e);return t?(n.ops=t,void n.write(i)):n},n.prototype.iterator=function(t){return new o(this,t)},n.prototype.getProperty=function(t){return""},n.prototype.approximateSize=function(t,e,i){const n=this.range(t,e);let r=0;for(const t of n)r+=t.key.length,r+=t.value.length;setImmediate(()=>i(null,r))},n.destroy=function(t,e){setImmediate(e)},n.repair=function(t,e){setImmediate(e)},r.prototype.put=function(t,e){return c(!this.written,"Already written."),this.ops.push(new s("put",t,e)),this},r.prototype.del=function(t){return c(!this.written,"Already written."),this.ops.push(new s("del",t)),this},r.prototype.write=function(t){if(this.written)return setImmediate(()=>t(new Error("Already written."))),this;for(const e of this.ops)switch(e.type){case"put":this.db.insert(e.key,e.value);break;case"del":this.db.remove(e.key);break;default:return setImmediate(()=>t(new Error("Bad op."))),this}return this.ops=[],this.written=!0,setImmediate(t),this},r.prototype.clear=function(){return c(!this.written,"Already written."),this.ops=[],this},o.prototype.init=function(){const t=this.db.tree.snapshot(),e=this.db.tree.iterator(t);this.options.reverse?this.options.end?(e.seekMax(this.options.end),this.options.lt&&e.valid()&&0===e.compare(this.options.end)&&e.prev()):e.seekLast():this.options.start?(e.seekMin(this.options.start),this.options.gt&&e.valid()&&0===e.compare(this.options.start)&&e.next()):e.seekFirst(),this.iter=e},o.prototype.next=function(t){const e=this.options,i=this.iter;if(!this.iter)return void setImmediate(()=>t(new Error("Cannot call next.")));let n;if(e.reverse?(n=i.prev())&&e.start&&(e.gt?i.compare(e.start)<=0&&(n=!1):i.compare(e.start)<0&&(n=!1)):(n=i.next())&&e.end&&(e.lt?i.compare(e.end)>=0&&(n=!1):i.compare(e.end)>0&&(n=!1)),!n)return this.iter=null,void setImmediate(t);if(-1!==e.limit){if(this.total>=e.limit)return this.iter=null,void setImmediate(t);this.total+=1}let r=i.key,s=i.value;e.keys||(r=f),e.values||(s=f),e.keyAsBuffer||(r=r.toString("utf8")),e.valueAsBuffer||(s=s.toString("utf8")),setImmediate(()=>t(null,r,s))},o.prototype.seek=function(t){c(this.iter,"Already ended."),"string"==typeof t&&(t=Buffer.from(t,"utf8")),c(Buffer.isBuffer(t),"Key must be a Buffer."),this.options.reverse?this.iter.seekMax(t):this.iter.seekMin(t)},o.prototype.end=function(t){this.ended?setImmediate(()=>t(new Error("Already ended."))):(this.ended=!0,this.iter=null,setImmediate(t))},a.prototype.fromOptions=function(t){return null!=t.keys&&(c("boolean"==typeof t.keys),this.keys=t.keys),null!=t.values&&(c("boolean"==typeof t.values),this.values=t.values),null!=t.start&&(this.start=t.start),null!=t.end&&(this.end=t.end),null!=t.gte&&(this.start=t.gte),null!=t.lte&&(this.end=t.lte),null!=t.gt&&(this.gt=!0,this.start=t.gt),null!=t.lt&&(this.lt=!0,this.end=t.lt),null!=this.start&&("string"==typeof this.start&&(this.start=Buffer.from(this.start,"utf8")),c(Buffer.isBuffer(this.start),"`start` must be a Buffer.")),null!=this.end&&("string"==typeof this.end&&(this.end=Buffer.from(this.end,"utf8")),c(Buffer.isBuffer(this.end),"`end` must be a Buffer.")),null!=t.keyAsBuffer&&(c("boolean"==typeof t.keyAsBuffer),this.keyAsBuffer=t.keyAsBuffer),null!=t.valueAsBuffer&&(c("boolean"==typeof t.valueAsBuffer),this.valueAsBuffer=t.valueAsBuffer),null!=t.reverse&&(c("boolean"==typeof t.reverse),this.reverse=t.reverse),null!=t.limit&&(c("number"==typeof t.limit),this.limit=t.limit),this},t.exports=n},function(t,e,i){"use strict";function n(t,e){if(!(this instanceof n))return new n(t,e);u("function"==typeof t),this.root=p,this.compare=t,this.unique=e||!1}function r(t,e){this.tree=t,this.root=e,this.current=e,this.key=null,this.value=null}function s(t,e){this.key=t,this.value=e,this.color=f,this.parent=p,this.left=p,this.right=p}function o(){this.key=null,this.value=null,this.color=l,this.parent=null,this.left=null,this.right=null}function a(t,e){this.key=t,this.value=e}function h(t,e){e.isNull()||(t.left=e.clone(),t.left.parent=t,h(t.left,e.left),c(t.left,e.right))}function c(t,e){e.isNull()||(t.right=e.clone(),t.right.parent=t,h(t.right,e.left),c(t.right,e.right))}const u=i(0),f=0,l=1;let p;n.prototype.reset=function(){this.root=p},n.prototype.search=function(t){let e=this.root;for(;!e.isNull();){const i=this.compare(t,e.key);if(0===i)return e;e=i<0?e.left:e.right}return null},n.prototype.insert=function(t,e){let i,n=this.root,r=!1;for(;!n.isNull();){const s=this.compare(t,n.key);if(this.unique&&0===s)return n.key=t,n.value=e,n;i=n,s<0?(r=!0,n=n.left):(r=!1,n=n.right)}const o=new s(t,e);return i?(o.parent=i,r?i.left=o:i.right=o,this.insertFixup(o),o):(this.root=o,this.insertFixup(o),o)},n.prototype.insertFixup=function(t){for(t.color=f;t!==this.root&&t.parent.color===f;)if(t.parent===t.parent.parent.left){const e=t.parent.parent.right;e.isNull()||e.color!==f?(t===t.parent.right&&(t=t.parent,this.rotl(t)),t.parent.color=l,t.parent.parent.color=f,this.rotr(t.parent.parent)):(t.parent.color=l,e.color=l,t.parent.parent.color=f,t=t.parent.parent)}else{const e=t.parent.parent.left;e.isNull()||e.color!==f?(t===t.parent.left&&(t=t.parent,this.rotr(t)),t.parent.color=l,t.parent.parent.color=f,this.rotl(t.parent.parent)):(t.parent.color=l,e.color=l,t.parent.parent.color=f,t=t.parent.parent)}this.root.color=l},n.prototype.remove=function(t){let e=this.root;for(;!e.isNull();){const i=this.compare(t,e.key);if(0===i)return this.removeNode(e),e;e=i<0?e.left:e.right}return null},n.prototype.removeNode=function(t){let e=t;t.left.isNull()||t.right.isNull()||(e=this.successor(t));const i=e.left.isNull()?e.right:e.left;i.parent=e.parent,e.parent.isNull()?this.root=i:e===e.parent.left?e.parent.left=i:e.parent.right=i,e!==t&&(t.key=e.key,t.value=e.value),e.color===l&&this.removeFixup(i)},n.prototype.removeFixup=function(t){for(;t!==this.root&&t.color===l;)if(t===t.parent.left){let e=t.parent.right;e.color===f&&(e.color=l,t.parent.color=f,this.rotl(t.parent),e=t.parent.right),e.left.color===l&&e.right.color===l?(e.color=f,t=t.parent):(e.right.color===l&&(e.left.color=l,e.color=f,this.rotr(e),e=t.parent.right),e.color=t.parent.color,t.parent.color=l,e.right.color=l,this.rotl(t.parent),t=this.root)}else{let e=t.parent.left;e.color===f&&(e.color=l,t.parent.color=f,this.rotr(t.parent),e=t.parent.left),e.right.color===l&&e.left.color===l?(e.color=f,t=t.parent):(e.left.color===l&&(e.right.color=l,e.color=f,this.rotl(e),e=t.parent.left),e.color=t.parent.color,t.parent.color=l,e.left.color=l,this.rotr(t.parent),t=this.root)}t.color=l},n.prototype.rotl=function(t){const e=t.right;t.right=e.left,e.left.isNull()||(e.left.parent=t),e.parent=t.parent,t.parent.isNull()?this.root=e:t===t.parent.left?t.parent.left=e:t.parent.right=e,e.left=t,t.parent=e},n.prototype.rotr=function(t){const e=t.left;t.left=e.right,e.right.isNull()||(e.right.parent=t),e.parent=t.parent,t.parent.isNull()?this.root=e:t===t.parent.right?t.parent.right=e:t.parent.left=e,e.right=t,t.parent=e},n.prototype.min=function(t){if(t.isNull())return t;for(;!t.left.isNull();)t=t.left;return t},n.prototype.max=function(t){if(t.isNull())return t;for(;!t.right.isNull();)t=t.right;return t},n.prototype.successor=function(t){if(!t.right.isNull()){for(t=t.right;!t.left.isNull();)t=t.left;return t}let e=t.parent;for(;!e.isNull()&&t===e.right;)t=e,e=e.parent;return e},n.prototype.predecessor=function(t){if(!t.left.isNull()){for(t=t.left;!t.right.isNull();)t=t.right;return t}let e=t.parent;for(;!e.isNull()&&t===e.left;)t=e,e=e.parent;return e},n.prototype.clone=function(){if(this.root.isNull())return p;const t=[];let e,i,n=this.root,r=!0;for(;;)if(n.isNull()){if(0===t.length)break;e=n=t.pop(),r=!1,n=n.right}else{const s=n.clone();e&&(s.parent=e),r?e?e.left=s:i=s:e?e.right=s:i=s,t.push(s),e=s,r=!0,n=n.left}return u(i),i},n.prototype.snapshot=function(){if(this.root.isNull())return p;const t=this.root.clone();return h(t,t.left),c(t,t.right),t},n.prototype.iterator=function(t){return new r(this,t||this.root)},n.prototype.range=function(t,e){const i=this.iterator(),n=[];for(t?i.seekMin(t):i.seekFirst();i.next()&&!(e&&i.compare(e)>0);)n.push(i.data());return n},r.prototype.compare=function(t){return u(null!=this.key,"No key."),this.tree.compare(this.key,t)},r.prototype.valid=function(){return!this.current.isNull()},r.prototype.reset=function(){this.current=this.root,this.key=null,this.value=null},r.prototype.seekFirst=function(){this.current=this.tree.min(this.root),this.key=this.current.key,this.value=this.current.value},r.prototype.seekLast=function(){this.current=this.tree.max(this.root),this.key=this.current.key,this.value=this.current.value},r.prototype.seek=function(t){return this.seekMin(t)},r.prototype.seekMin=function(t){u(null!=t,"No key passed to seek.");let e=this.current,i=p;for(;!e.isNull();){const n=this.tree.compare(e.key,t);if(0===n){i=e;break}n>0?(i=e,e=e.left):e=e.right}this.current=i,this.key=i.key,this.value=i.value},r.prototype.seekMax=function(t){u(null!=t,"No key passed to seek.");let e=this.current,i=p;for(;!e.isNull();){const n=this.tree.compare(e.key,t);if(0===n){i=e;break}n<0?(i=e,e=e.right):e=e.left}this.current=i,this.key=i.key,this.value=i.value},r.prototype.prev=function(){return this.current.isNull()?(this.key=null,this.value=null,!1):(this.key=this.current.key,this.value=this.current.value,this.current=this.tree.predecessor(this.current),!0)},r.prototype.next=function(){return this.current.isNull()?(this.key=null,this.value=null,!1):(this.key=this.current.key,this.value=this.current.value,this.current=this.tree.successor(this.current),!0)},r.prototype.data=function(){return u(null!=this.key,"No data available."),new a(this.key,this.value)},s.prototype.clone=function(){const t=new s(this.key,this.value);return t.color=this.color,t.parent=this.parent,t.left=this.left,t.right=this.right,t},s.prototype.copy=function(){return new a(this.key,this.value)},s.prototype.inspect=function(){return{key:this.key,value:this.value,color:this.color===f?"red":"black",left:this.left,right:this.right}},s.prototype.isNull=function(){return!1},o.prototype.inspect=function(){return"NIL"},o.prototype.isNull=function(){return!0},a.prototype.inspect=function(){return{key:this.key,value:this.value}},p=new o,t.exports=n},function(t,e,i){"use strict";function n(t,e,i){return Buffer.isBuffer(e)?e.copy(t,i):(s("string"==typeof e),t.write(e,i,"hex"))}function r(t,e){const i=Buffer.allocUnsafe(33);return i[0]=t,n(i,e,1),i}const s=i(0),o={binary:!0,R:Buffer.from([82]),O:Buffer.from([79]),V:Buffer.from([118]),e:function(t){return r(101,t)},h:function(t){return r(104,t)},H:function(t){return function(t,e){const i=Buffer.allocUnsafe(5);return s("number"==typeof e),i[0]=t,i.writeUInt32BE(e,1,!0),i}(72,t)},n:function(t){return r(110,t)},p:function(t){return r(112,t)},b:function(t){return r(98,t)},t:function(t){return r(116,t)},c:function(t,e){return function(t,e,i){const r=Buffer.allocUnsafe(37);return s("number"==typeof i),r[0]=t,n(r,e,1),r.writeUInt32BE(i,33,!0),r}(99,t,e)},u:function(t){return r(117,t)},v:function(t,e){const i=Buffer.allocUnsafe(34);return s("number"==typeof t),i[0]=118,i[1]=t,n(i,e,2),i},vv:function(t){return s(Buffer.isBuffer(t)),s(34===t.length),[t[1],t.toString("hex",2,34)]},T:function(t,e){let i=t.length;"string"==typeof t&&(i/=2);let r;return 32===i?((r=Buffer.allocUnsafe(65))[0]=171,n(r,t,1),n(r,e,33)):20===i?((r=Buffer.allocUnsafe(53))[0]=84,n(r,t,1),n(r,e,21)):s(!1),r},C:function(t,e,i){let r=t.length;s("number"==typeof i),"string"==typeof t&&(r/=2);let o;return 32===r?((o=Buffer.allocUnsafe(69))[0]=154,n(o,t,1),n(o,e,33),o.writeUInt32BE(i,65,!0)):20===r?((o=Buffer.allocUnsafe(57))[0]=67,n(o,t,1),n(o,e,21),o.writeUInt32BE(i,53,!0)):s(!1),o},pp:function(t){return s(Buffer.isBuffer(t)),s(33===t.length),t.toString("hex",1,33)},Cc:function(t){s(Buffer.isBuffer(t));let e,i;return 69===t.length?(e=t.toString("hex",33,65),i=t.readUInt32BE(65,0)):57===t.length?(e=t.toString("hex",21,53),i=t.readUInt32BE(53,0)):s(!1),[e,i]},Tt:function(t){return s(Buffer.isBuffer(t)),65===t.length?t.toString("hex",33,65):(s(53===t.length),t.toString("hex",21,53))}};t.exports=o},function(t,e,i){"use strict";function n(t){if(!(this instanceof n))return new n(t);this.address=new h,this.amount=-1,this.label=null,this.message=null,this.request=null,t&&this.fromOptions(t)}function r(t){try{t=(t=decodeURIComponent(t)).replace(/\+/g," ")}catch(t){throw new Error("Malformed URI.")}if(-1!==t.indexOf("\0"))throw new Error("Malformed URI.");return t}function s(t){return t=encodeURIComponent(t),t=t.replace(/%20/g,"+")}const o=i(0),a=i(1),h=i(11),c=i(20);n.prototype.fromOptions=function(t){return"string"==typeof t?this.fromString(t):(t.address&&this.address.fromOptions(t.address),null!=t.amount&&(o(a.isU64(t.amount),"Amount must be a uint64."),this.amount=t.amount),t.label&&(o("string"==typeof t.label,"Label must be a string."),this.label=t.label),t.message&&(o("string"==typeof t.message,"Message must be a string."),this.message=t.message),t.request&&(o("string"==typeof t.request,"Request must be a string."),this.request=t.request),this)},n.fromOptions=function(t){return(new n).fromOptions(t)},n.prototype.fromString=function(t,e){o("string"==typeof t),o(t.length>8,"Not a WMCC URI.");const i=t.substring(0,8);o("wmcc:"===i,"Not a WMCC URI.");const n=(t=t.substring(8)).indexOf("?");let s,a;if(-1===n?s=t:(s=t.substring(0,n),a=t.substring(n+1)),this.address.fromString(s,e),!a)return this;const h=function(t){const e=t.split("&"),i=new function(){this.amount=null,this.label=null,this.message=null,this.r=null};let n=0;for(const t of e){const e=t.indexOf("=");let s,a;if(-1===e?(s=t,a=""):(s=t.substring(0,e),a=t.substring(e+1)),0!==s.length){switch(o(n<4,"Too many keys in querystring."),s){case"amount":o(null==i.amount,"Duplicate key in querystring (amount)."),i.amount=r(a);break;case"label":o(null==i.label,"Duplicate key in querystring (label)."),i.label=r(a);break;case"message":o(null==i.message,"Duplicate key in querystring (message)."),i.message=r(a);break;case"r":o(null==i.r,"Duplicate key in querystring (r)."),i.r=r(a);break;default:o(!1,`Unknown querystring key: ${a}.`)}n++}else o(0===a.length,"Empty key in querystring.")}return i}(a);return h.amount&&(o(h.amount.length>0,"Value is empty."),o("-"!==h.amount[0],"Value is negative."),this.amount=c.value(h.amount)),h.label&&(this.label=h.label),h.message&&(this.message=h.message),h.r&&(this.request=h.r),this},n.fromString=function(t,e){return(new n).fromString(t,e)},n.prototype.toString=function(){let t="wmcc:";t+=this.address.toString();const e=[];return-1!==this.amount&&e.push(`amount=${c.wmcc(this.amount)}`),this.label&&e.push(`label=${s(this.label)}`),this.message&&e.push(`message=${s(this.message)}`),this.request&&e.push(`r=${s(this.request)}`),e.length>0&&(t+="?"+e.join("&")),t},n.prototype.inspect=function(){return`<URI: ${this.toString()}>`},t.exports=n},function(t,e,i){"use strict";function n(){if(!(this instanceof n))return new n;this.chacha20=new s,this.poly1305=new o,this.aadLen=0,this.cipherLen=0,this.polyKey=null}const r=i(0),s=i(163),o=i(164);n.prototype.init=function(t,e){const i=Buffer.allocUnsafe(32);i.fill(0),this.chacha20.init(t,e),this.chacha20.encrypt(i),this.poly1305.init(i),this.chacha20.encrypt(Buffer.allocUnsafe(32)),r(1===this.chacha20.getCounter()),this.polyKey=i,this.aadLen=0,this.cipherLen=0},n.prototype.aad=function(t){r(0===this.cipherLen,"Cannot update aad."),this.poly1305.update(t),this.aadLen+=t.length},n.prototype.encrypt=function(t){return 0===this.cipherLen&&this.pad16(this.aadLen),this.chacha20.encrypt(t),this.poly1305.update(t),this.cipherLen+=t.length,t},n.prototype.decrypt=function(t){return 0===this.cipherLen&&this.pad16(this.aadLen),this.cipherLen+=t.length,this.poly1305.update(t),this.chacha20.encrypt(t),t},n.prototype.auth=function(t){return 0===this.cipherLen&&this.pad16(this.aadLen),this.cipherLen+=t.length,this.poly1305.update(t),t},n.prototype.finish=function(){const t=Buffer.allocUnsafe(16);let e,i;return e=this.aadLen%4294967296,i=(this.aadLen-e)/4294967296,t.writeUInt32LE(e,0,!0),t.writeUInt32LE(i,4,!0),e=this.cipherLen%4294967296,i=(this.cipherLen-e)/4294967296,t.writeUInt32LE(e,8,!0),t.writeUInt32LE(i,12,!0),0===this.cipherLen&&this.pad16(this.aadLen),this.pad16(this.cipherLen),this.poly1305.update(t),this.poly1305.finish()},n.prototype.pad16=function(t){if(0==(t%=16))return;const e=Buffer.allocUnsafe(16-t);e.fill(0),this.poly1305.update(e)},t.exports=n},function(t,e,i){"use strict";const n=i(5);e.extract=function(t,e,i){return n.hmac(i,t,e)},e.expand=function(t,e,i,r){const s=n.hash(r,Buffer.alloc(0)).length,o=Math.ceil(i/s);if(o>255)throw new Error("Too many blocks.");const a=Buffer.allocUnsafe(i);if(0===o)return a;const h=Buffer.allocUnsafe(s+e.length+1);e.copy(h,s),h[h.length-1]=1;let c=n.hmac(r,h.slice(s),t);c.copy(a,0);for(let e=1;e<o;e++)c.copy(h,0),h[h.length-1]++,(c=n.hmac(r,h,t)).copy(a,e*s);return a}},function(t,e,i){"use strict";function n(t,e,i){if(!(this instanceof n))return new n(t,e,i);this.K=Buffer.allocUnsafe(o),this.V=Buffer.allocUnsafe(o),this.rounds=0,this.init(t,e,i)}const r=i(0),s=i(5),o=32,a=Buffer.allocUnsafe(o+1),h=Buffer.allocUnsafe(2*o+48),c=Buffer.allocUnsafe(a.length+h.length);n.prototype.init=function(t,e,i){for(let t=0;t<this.V.length;t++)this.K[t]=0,this.V[t]=1;this.reseed(t,e,i)},n.prototype.reseed=function(t,e,i){const n=h;r(Buffer.isBuffer(t)),r(Buffer.isBuffer(e)),r(Buffer.isBuffer(i)),r(t.length===o),r(e.length===o),r(48===i.length),t.copy(n,0),e.copy(n,o),i.copy(n,2*o),this.update(n),this.rounds=1},n.prototype.iterate=function(){const t=a;this.V.copy(t,0),t[o]=0,this.K=s.hmac("sha256",t,this.K),this.V=s.hmac("sha256",this.V,this.K)},n.prototype.update=function(t){const e=c;r(Buffer.isBuffer(t)),r(t.length===2*o+48),this.V.copy(e,0),e[o]=0,t.copy(e,o+1),this.K=s.hmac("sha256",e,this.K),this.V=s.hmac("sha256",this.V,this.K),e[o]=1,this.K=s.hmac("sha256",e,this.K),this.V=s.hmac("sha256",this.V,this.K)},n.prototype.generate=function(t){if(this.rounds>281474976710656)throw new Error("Reseed is required.");const e=Buffer.allocUnsafe(t);let i=0;for(;i<t;)this.V=s.hmac("sha256",this.V,this.K),this.V.copy(e,i),i+=o;return this.iterate(),this.rounds++,e},t.exports=n},function(t,e,i){"use strict";const n=i(0),r=i(9),s=i(67),o=i(26),a=i(204),h=i(5).sha256,c=r.ec("secp256k1").curve,u=Buffer.allocUnsafe(64),f=e;f.hash=function(t,e){const i=e.toArrayLike(Buffer,"be",32),n=u;return i.copy(n,0),t.copy(n,32),new o(h(n))},f.trySign=function(t,e,i,n){if(0===e.cmpn(0))throw new Error("Bad private key.");if(e.cmp(c.n)>=0)throw new Error("Bad private key.");if(0===i.cmpn(0))return null;if(i.cmp(c.n)>=0)return null;let r=c.g.mul(i);n&&(r=r.add(n)),r.y.isOdd()&&(i=i.umod(c.n),i=c.n.sub(i));const o=f.hash(t,r.getX());if(0===o.cmpn(0))return null;if(o.cmp(c.n)>=0)return null;let a=o.imul(e);return a=i.isub(a),0===(a=a.umod(c.n)).cmpn(0)?null:new s({r:r.getX(),s:a})},f.sign=function(t,e,i){const n=new o(e),r=f.drbg(t,e,i),s=c.n.byteLength();let a;i&&(a=c.decodePoint(i));let h;for(;!h;){const e=new o(r.generate(s));h=f.trySign(t,n,e,a)}return h},f.verify=function(t,e,i){const n=new s(e),r=f.hash(t,n.r);if(r.cmp(c.n)>=0)throw new Error("Invalid hash.");if(0===r.cmpn(0))throw new Error("Invalid hash.");if(n.s.cmp(c.n)>=0)throw new Error("Invalid S value.");if(n.r.cmp(c.p)>0)throw new Error("Invalid R value.");const o=c.decodePoint(i).mul(r),a=c.g.mul(n.s),h=o.add(a);if(h.y.isOdd())throw new Error("Odd R value.");return 0===h.getX().cmp(n.r)},f.recover=function(t,e){const i=new s(t),n=f.hash(e,i.r);if(n.cmp(c.n)>=0)throw new Error("Invalid hash.");if(0===n.cmpn(0))throw new Error("Invalid hash.");if(i.s.cmp(c.n)>=0)throw new Error("Invalid S value.");if(i.r.cmp(c.p)>0)throw new Error("Invalid R value.");let r=n.invm(c.n);r=r.umod(c.n);let o=i.s;o=(o=(o=(o=c.n.sub(o)).umod(c.n)).imul(r)).umod(c.n);let a=c.pointFromX(i.r,!1).mul(r),h=c.g.mul(o);const u=a.add(h);a=u.mul(n),h=c.g.mul(i.s);const l=a.add(h);if(l.y.isOdd())throw new Error("Odd R value.");if(0!==l.getX().cmp(i.r))throw new Error("Could not recover pubkey.");return Buffer.from(u.encode("array",!0))},f.combineSigs=function(t){let e,i,n=new o(0);for(let r=0;r<t.length;r++){const o=new s(t[r]);if(0===o.s.cmpn(0))throw new Error("Bad S value.");if(o.s.cmp(c.n)>=0)throw new Error("Bad S value.");if(e||(e=o.r),i&&0!==i.r.cmp(o.r))throw new Error("Bad signature combination.");n=(n=n.iadd(o.s)).umod(c.n),i=o}if(0===n.cmpn(0))throw new Error("Bad combined signature.");return new s({r:e,s:n})},f.combineKeys=function(t){if(0===t.length)throw new Error;if(1===t.length)return t[0];let e=c.decodePoint(t[0]);for(let i=1;i<t.length;i++){const n=c.decodePoint(t[i]);e=e.add(n)}return Buffer.from(e.encode("array",!0))},f.partialSign=function(t,e,i,n){const r=new o(e),s=new o(i),a=c.decodePoint(n),h=f.trySign(t,r,s,a);if(!h)throw new Error("Bad K value.");return h},f.alg=Buffer.from("Schnorr+SHA256  ","ascii"),f.drbg=function(t,e,i){const r=Buffer.allocUnsafe(48);return r.fill(0),i&&(n(32===i.length),i.copy(r,0)),f.alg.copy(r,32),new a(e,t,r)},f.generateNoncePair=function(t,e,i){const n=f.drbg(t,e,i),r=c.n.byteLength();let s;for(;0===(s=new o(n.generate(r))).cmpn(0)||s.cmp(c.n)>=0;);return Buffer.from(c.g.mul(s).encode("array",!0))}},function(t,e,i){"use strict";function n(t){if(!(this instanceof n))return new n(t);this.bits=d.MIN_ENTROPY,this.language="english",this.entropy=null,this.phrase=null,this.passphrase="",t&&this.fromOptions(t)}const r=i(0),s=i(1),o=i(5),a=i(72),h=i(28),c=i(70),u=i(4),f=i(2),l=i(3),p=i(207),d=i(110),m=i(208),g=Object.create(null);n.languages=["simplified chinese","traditional chinese","english","french","italian","japanese","spanish"],n.prototype.fromOptions=function(t){return"string"==typeof t&&(t={phrase:t}),null!=t.bits&&(r(s.isU16(t.bits)),r(t.bits>=d.MIN_ENTROPY),r(t.bits<=d.MAX_ENTROPY),r(t.bits%32==0),this.bits=t.bits),t.language&&(r("string"==typeof t.language),r(-1!==n.languages.indexOf(t.language)),this.language=t.language),t.passphrase&&(r("string"==typeof t.passphrase),this.passphrase=t.passphrase),t.phrase?(this.fromPhrase(t.phrase),this):t.entropy?(this.fromEntropy(t.entropy),this):this},n.fromOptions=function(t){return(new n).fromOptions(t)},n.prototype.destroy=function(){this.bits=d.MIN_ENTROPY,this.language="english",this.entropy&&(a(this.entropy),this.entropy=null),this.phrase=null,this.passphrase=""},n.prototype.toSeed=function(t){t||(t=this.passphrase),this.passphrase=t;const e=m(this.getPhrase()),i=m("mnemonic"+t);return c.derive(Buffer.from(e,"utf8"),Buffer.from(i,"utf8"),2048,64,"sha512")},n.prototype.getEntropy=function(){return this.entropy||(this.entropy=h.randomBytes(this.bits/8)),r(this.bits/8===this.entropy.length),this.entropy},n.prototype.getPhrase=function(){if(this.phrase)return this.phrase;const t=this.bits+this.bits/32,e=this.getEntropy(),i=o.sha256(e),r=Math.ceil(t/8),s=Buffer.allocUnsafe(r);e.copy(s,0),i.copy(s,e.length);const a=n.getWordlist(this.language);let h=[];for(let e=0;e<t/11;e++){let t=0;for(let i=0;i<11;i++){const n=11*e+i,r=n%8;t<<=1,t|=s[(n-r)/8]>>>7-r&1}h.push(a.words[t])}return h="japanese"===this.language?h.join("　"):h.join(" "),this.phrase=h,h},n.prototype.fromPhrase=function(t){r("string"==typeof t),r(t.length<=1e3);const e=t.trim().split(/[\s\u3000]+/),i=11*e.length,s=i%32;r(0!==s,"Invalid checksum.");const a=i-s;r(a>=d.MIN_ENTROPY),r(a<=d.MAX_ENTROPY),r(a%32==0);const h=Math.ceil(i/8),c=Buffer.allocUnsafe(h);c.fill(0);const u=n.getLanguage(e[0]),f=n.getWordlist(u);for(let t=0;t<e.length;t++){const i=e[t],n=f.map[i];if(null==n)throw new Error("Could not find word.");for(let e=0;e<11;e++){const i=11*t+e,r=i%8,s=n>>>10-e&1;c[(i-r)/8]|=s<<7-r}}const l=Math.ceil(s/8),p=c.slice(0,c.length-l),m=c.slice(c.length-l),g=o.sha256(p);for(let t=0;t<s;t++){const e=t%8,i=(t-e)/8;if((m[i]>>>7-e&1)!==(g[i]>>>7-e&1))throw new Error("Invalid checksum.")}return r(a/8===p.length),this.bits=a,this.language=u,this.entropy=p,this.phrase=t,this},n.fromPhrase=function(t){return(new n).fromPhrase(t)},n.prototype.fromEntropy=function(t,e){return r(Buffer.isBuffer(t)),r(8*t.length>=d.MIN_ENTROPY),r(8*t.length<=d.MAX_ENTROPY),r(8*t.length%32==0),r(!e||-1!==n.languages.indexOf(e)),this.entropy=t,this.bits=8*t.length,e&&(this.language=e),this},n.fromEntropy=function(t,e){return(new n).fromEntropy(t,e)},n.getLanguage=function(t){for(const e of n.languages){if(null!=n.getWordlist(e).map[t])return e}throw new Error("Could not determine language.")},n.getWordlist=function(t){const e=g[t];if(e)return e;const i=new function(t){this.words=t,this.map=Object.create(null);for(let e=0;e<t.length;e++){const i=t[e];this.map[i]=e}}(p.get(t));return g[t]=i,i},n.prototype.toJSON=function(){return{bits:this.bits,language:this.language,entropy:this.getEntropy().toString("hex"),phrase:this.getPhrase(),passphrase:this.passphrase}},n.prototype.fromJSON=function(t){return r(s.isU16(t.bits)),r("string"==typeof t.language),r("string"==typeof t.entropy),r("string"==typeof t.phrase),r("string"==typeof t.passphrase),r(t.bits>=d.MIN_ENTROPY),r(t.bits<=d.MAX_ENTROPY),r(t.bits%32==0),r(t.bits/8==t.entropy.length/2),this.bits=t.bits,this.language=t.language,this.entropy=Buffer.from(t.entropy,"hex"),this.phrase=t.phrase,this.passphrase=t.passphrase,this},n.fromJSON=function(t){return(new n).fromJSON(t)},n.prototype.getSize=function(){let t=0;return t+=3,t+=this.getEntropy().length,t+=l.sizeVarString(this.getPhrase(),"utf8"),t+=l.sizeVarString(this.passphrase,"utf8")},n.prototype.toWriter=function(t){const e=n.languages.indexOf(this.language);return r(-1!==e),t.writeU16(this.bits),t.writeU8(e),t.writeBytes(this.getEntropy()),t.writeVarString(this.getPhrase(),"utf8"),t.writeVarString(this.passphrase,"utf8"),t},n.prototype.toRaw=function(t){const e=this.getSize();return this.toWriter(new u(e)).render()},n.prototype.fromReader=function(t){const e=t.readU16();r(e>=d.MIN_ENTROPY),r(e<=d.MAX_ENTROPY),r(e%32==0);const i=n.languages[t.readU8()];return r(i),this.bits=e,this.language=i,this.entropy=t.readBytes(e/8),this.phrase=t.readVarString("utf8"),this.passphrase=t.readVarString("utf8"),this},n.prototype.fromRaw=function(t){return this.fromReader(new f(t))},n.fromReader=function(t){return(new n).fromReader(t)},n.fromRaw=function(t){return(new n).fromRaw(t)},n.prototype.toString=function(){return this.getPhrase()},n.prototype.inspect=function(){return`<Mnemonic: ${this.getPhrase()}>`},n.isMnemonic=function(t){return t instanceof n},t.exports=n},function(t,e,i){"use strict";e.get=function(t){switch(t){case"simplified chinese":return i(262);case"traditional chinese":return i(263);case"english":return i(264);case"french":return i(265);case"italian":return i(266);case"japanese":return i(267);case"spanish":return i(268);default:throw new Error(`Unknown language: ${t}.`)}}},function(t,e,i){"use strict";t.exports=function(t){return t.normalize("NFKD")}},function(t,e,i){"use strict";function n(t){if(!(this instanceof n))return new n(t);this.network=c.primary,this.depth=0,this.parentFingerPrint=0,this.childIndex=0,this.chainCode=p.ZERO_HASH,this.publicKey=p.ZERO_KEY,this.fingerPrint=-1,this._xpubkey=null,t&&this.fromOptions(t)}const r=i(0),s=i(1),o=i(5),a=i(72),h=i(12),c=i(6),u=i(4),f=i(2),l=i(25),p=i(3),d=i(110);n.prototype.fromOptions=function(t){return r(t,"No options for HDPublicKey"),r(s.isU8(t.depth)),r(s.isU32(t.parentFingerPrint)),r(s.isU32(t.childIndex)),r(Buffer.isBuffer(t.chainCode)),r(Buffer.isBuffer(t.publicKey)),t.network&&(this.network=c.get(t.network)),this.depth=t.depth,this.parentFingerPrint=t.parentFingerPrint,this.childIndex=t.childIndex,this.chainCode=t.chainCode,this.publicKey=t.publicKey,this},n.fromOptions=function(t){return(new n).fromOptions(t)},n.prototype.toPublic=function(){return this},n.prototype.xprivkey=function(){return null},n.prototype.xpubkey=function(){return this._xpubkey||(this._xpubkey=this.toBase58()),this._xpubkey},n.prototype.destroy=function(){this.depth=0,this.childIndex=0,this.parentFingerPrint=0,a(this.chainCode),a(this.publicKey),this.fingerPrint=-1,this._xpubkey=null},n.prototype.derive=function(t,e){if(r("number"==typeof t),t>>>0!==t)throw new Error("Index out of range.");if(t&d.HARDENED||e)throw new Error("Cannot derive hardened.");if(this.depth>=255)throw new Error("Depth too high.");const i=this.getID(t),s=d.cache.get(i);if(s)return s;const a=u.pool(37);a.writeBytes(this.publicKey),a.writeU32BE(t);const c=a.render(),f=o.hmac("sha512",c,this.chainCode),l=f.slice(0,32),p=f.slice(32,64);let m;try{m=h.publicKeyTweakAdd(this.publicKey,l,!0)}catch(e){return this.derive(t+1)}if(-1===this.fingerPrint){const t=o.hash160(this.publicKey);this.fingerPrint=t.readUInt32BE(0,!0)}const g=new n;return g.network=this.network,g.depth=this.depth+1,g.parentFingerPrint=this.fingerPrint,g.childIndex=t,g.chainCode=p,g.publicKey=m,d.cache.set(i,g),g},n.prototype.getID=function(t){return this.network.keyPrefix.xpubkey58+this.publicKey.toString("hex")+t},n.prototype.deriveAccount=function(t,e){return r(s.isU32(t)),r(s.isU32(e)),r(this.isAccount(e),"Cannot derive account index."),this},n.prototype.isMaster=function(){return d.isMaster(this)},n.prototype.isAccount=function(t){return d.isAccount(this,t)},n.isValidPath=function(t){try{return d.parsePath(t,!1),!0}catch(t){return!1}},n.prototype.derivePath=function(t){const e=d.parsePath(t,!1);let i=this;for(const t of e)i=i.derive(t);return i},n.prototype.equals=function(t){return r(n.isHDPublicKey(t)),this.network===t.network&&this.depth===t.depth&&this.parentFingerPrint===t.parentFingerPrint&&this.childIndex===t.childIndex&&this.chainCode.equals(t.chainCode)&&this.publicKey.equals(t.publicKey)},n.prototype.compare=function(t){r(n.isHDPublicKey(t));let e=this.depth-t.depth;return 0!==e?e:0!=(e=this.parentFingerPrint-t.parentFingerPrint)?e:0!=(e=this.childIndex-t.childIndex)?e:0!==(e=this.chainCode.compare(t.chainCode))?e:0!==(e=this.publicKey.compare(t.publicKey))?e:0},n.prototype.toJSON=function(){return{xpubkey:this.xpubkey()}},n.prototype.fromJSON=function(t,e){return r(t.xpubkey,"Could not handle HD key JSON."),this.fromBase58(t.xpubkey,e),this},n.fromJSON=function(t,e){return(new n).fromJSON(t,e)},n.isBase58=function(t,e){if("string"!=typeof t)return!1;if(t.length<4)return!1;const i=t.substring(0,4);try{return c.fromPublic58(i,e),!0}catch(t){return!1}},n.isRaw=function(t,e){if(!Buffer.isBuffer(t))return!1;if(t.length<4)return!1;const i=t.readUInt32BE(0,!0);try{return c.fromPublic(i,e),!0}catch(t){return!1}},n.prototype.fromBase58=function(t,e){return r("string"==typeof t),this._xpubkey=t,this.fromRaw(l.decode(t),e)},n.prototype.fromReader=function(t,e){const i=t.readU32BE();return this.network=c.fromPublic(i,e),this.depth=t.readU8(),this.parentFingerPrint=t.readU32BE(),this.childIndex=t.readU32BE(),this.chainCode=t.readBytes(32),this.publicKey=t.readBytes(33),t.verifyChecksum(),this},n.prototype.fromRaw=function(t,e){return this.fromReader(new f(t),e)},n.prototype.toBase58=function(t){return l.encode(this.toRaw(t))},n.prototype.toWriter=function(t,e){return e||(e=this.network),e=c.get(e),t.writeU32BE(e.keyPrefix.xpubkey),t.writeU8(this.depth),t.writeU32BE(this.parentFingerPrint),t.writeU32BE(this.childIndex),t.writeBytes(this.chainCode),t.writeBytes(this.publicKey),t.writeChecksum(),t},n.prototype.getSize=function(){return 82},n.prototype.toRaw=function(t){return this.toWriter(new u(82),t).render()},n.fromBase58=function(t,e){return(new n).fromBase58(t,e)},n.fromReader=function(t,e){return(new n).fromReader(t,e)},n.fromRaw=function(t,e){return(new n).fromRaw(t,e)},n.isHDPublicKey=function(t){return t instanceof n},t.exports=n},function(t,e,i){"use strict";function n(t){if(!(this instanceof n))return new n(t);t||(t={}),"string"==typeof t&&(t={uri:t}),a.call(this),this.options=t,this.network=o.get(t.network),this.uri=t.uri||`http://localhost:${this.network.rpcPort}`,this.socket=null,this.apiKey=t.apiKey,this.auth=t.auth,this.rpc=new h(t)}function r(t){return t?(t.toRaw&&(t=t.toRaw()),Buffer.isBuffer(t)&&(t=t.toString("hex")),t):null}const s=i(0),o=i(6),a=i(30),h=i(211),c=i(95);Object.setPrototypeOf(n.prototype,a.prototype),n.prototype._open=async function(){let t;try{t=i(212)}catch(t){}t&&(this.socket=new t(this.uri,{transports:["websocket"],forceNew:!0}),this.socket.on("error",t=>{this.emit("error",t)}),this.socket.on("version",t=>{t.network!==this.network.type&&this.emit("error",new Error("Wrong network."))}),this.socket.on("wallet tx",t=>{this.emit("tx",t)}),this.socket.on("wallet confirmed",t=>{this.emit("confirmed",t)}),this.socket.on("wallet unconfirmed",t=>{this.emit("unconfirmed",t)}),this.socket.on("wallet conflict",t=>{this.emit("conflict",t)}),this.socket.on("wallet updated",t=>{this.emit("updated",t)}),this.socket.on("wallet address",t=>{this.emit("address",t)}),this.socket.on("wallet balance",t=>{this.emit("balance",t)}),await this.onConnect(),await this.sendAuth())},n.prototype._close=function(){return this.socket?(this.socket.disconnect(),this.socket=null,Promise.resolve()):Promise.resolve()},n.prototype.onConnect=function(){return new Promise((t,e)=>{this.socket.once("connect",t)})},n.prototype.sendAuth=function(){return new Promise((t,e)=>{this.socket.emit("auth",this.apiKey,i=>{i?e(new Error(i.message)):t()})})},n.prototype.sendWalletAuth=function(){return new Promise((t,e)=>{this.socket.emit("wallet auth",this.apiKey,i=>{i?e(new Error(i.message)):t()})})},n.prototype.onDisconnect=function(){return new Promise((t,e)=>{this.socket.once("disconnect",t)})},n.prototype._request=async function(t,e,i){this.token&&(i||(i={}),i.token=this.token);let n;i&&"get"===t&&(n=i,i=null);const r=await c({method:t,uri:this.uri+e,pool:!0,query:n,json:i,auth:{username:"wmccrpc",password:this.apiKey||""}});if(404===r.statusCode)return null;if(401===r.statusCode)throw new Error("Unauthorized (bad API key).");if(200!==r.statusCode)throw new Error(`Status code: ${r.statusCode}.`);if("json"!==r.type)throw new Error("Bad response (wrong content-type).");if(!r.body)throw new Error("Bad response (no body).");const s=r.headers["x-wmcc-network"];if(s&&s!==this.network.type)throw new Error("Bad response (wrong network).");if(r.body.error)throw new Error(r.body.error.message);return r.body},n.prototype._get=function(t,e){return this._request("get",t,e)},n.prototype._post=function(t,e){return this._request("post",t,e)},n.prototype._put=function(t,e){return this._request("put",t,e)},n.prototype._del=function(t,e){return this._request("delete",t,e)},n.prototype.getMempool=function(){return this._get("/mempool")},n.prototype.getInfo=function(){return this._get("/")},n.prototype.getCoinsByAddress=function(t){return this._get(`/coin/address/${t}`)},n.prototype.getCoinsByAddresses=function(t){return this._post("/coin/address",{addresses:t})},n.prototype.getCoin=function(t,e){return this._get(`/coin/${t}/${e}`)},n.prototype.getTXByAddress=function(t){return this._get(`/tx/address/${t}`)},n.prototype.getTXByAddresses=function(t){return this._post("/tx/address",{addresses:t})},n.prototype.getTX=function(t){return this._get(`/tx/${t}`)},n.prototype.getBlock=function(t){return this._get(`/block/${t}`)},n.prototype.broadcast=function(t){return this._post("/broadcast",{tx:r(t)})},n.prototype.rescan=function(t){return this._post("/wallet/_admin/rescan",{height:t})},n.prototype.reset=function(t){return this._post("/reset",{height:t})},n.prototype.resend=function(){return this._post("/wallet/_admin/resend",{})},n.prototype.backup=function(t){return this._post("/wallet/_admin/backup",{path:t})},n.prototype.join=function(t,e){return this.socket?new Promise((i,n)=>{this.socket.emit("wallet join",t,e,t=>{t?n(new Error(t.message)):i()})}):Promise.resolve()},n.prototype.leave=function(t){return this.socket?new Promise((e,i)=>{this.socket.emit("wallet leave",t,t=>{t?i(new Error(t.message)):e()})}):Promise.resolve()},n.prototype.getWallets=function(){return this._get("/wallet/_admin/wallets")},n.prototype.createWallet=function(t){return s(t.id,"Must pass an id parameter"),this._put(`/wallet/${t.id}`,t)},n.prototype.getWallet=function(t){return this._get(`/wallet/${t}`)},n.prototype.getHistory=function(t,e){return this._get(`/wallet/${t}/tx/history`,{account:e})},n.prototype.getCoins=function(t,e){return this._get(`/wallet/${t}/coin`,{account:e})},n.prototype.getPending=function(t,e){return this._get(`/wallet/${t}/tx/unconfirmed`,{account:e})},n.prototype.getBalance=function(t,e){return this._get(`/wallet/${t}/balance`,{account:e})},n.prototype.getLast=function(t,e,i){return this._get(`/wallet/${t}/tx/last`,{account:e,limit:i})},n.prototype.getRange=function(t,e,i){const n={account:e,start:i.start,end:i.end,limit:i.limit,reverse:i.reverse};return this._get(`/wallet/${t}/tx/range`,n)},n.prototype.getWalletTX=function(t,e){return this._get(`/wallet/${t}/tx/${e}`)},n.prototype.getWalletBlocks=function(t){return this._get(`/wallet/${t}/block`)},n.prototype.getWalletBlock=function(t,e){return this._get(`/wallet/${t}/block/${e}`)},n.prototype.getWalletCoin=function(t,e,i,n){return this._get(`/wallet/${t}/coin/${i}/${n}`,{account:e})},n.prototype.send=function(t,e){const i=Object.assign({},e);return i.outputs||(i.outputs=[]),i.outputs=i.outputs.map(t=>({value:t.value,address:t.address,script:r(t.script)})),this._post(`/wallet/${t}/send`,i)},n.prototype.retoken=async function(t,e){return(await this._post(`/wallet/${t}/retoken`,{passphrase:e})).token},n.prototype.setPassphrase=function(t,e,i){const n={old:e,passphrase:i};return this._post(`/wallet/${t}/passphrase`,n)},n.prototype.createTX=function(t,e){const i=Object.assign({},e);return i.outputs||(i.outputs=[]),i.outputs=i.outputs.map(t=>({value:t.value,address:t.address,script:r(t.script)})),this._post(`/wallet/${t}/create`,i)},n.prototype.sign=function(t,e,i){const n=Object.assign({},i);return n.tx=r(e),this._post(`/wallet/${t}/sign`,n)},n.prototype.zapWallet=function(t,e,i){return this._post(`/wallet/${t}/zap`,{account:e,age:i})},n.prototype.getKey=function(t,e){return this._get(`/wallet/${t}/key/${e}`)},n.prototype.getWIF=function(t,e,i){return this._get(`/wallet/${t}/wif/${e}`,{passphrase:i})},n.prototype.addSharedKey=function(t,e,i){const n={account:e,accountKey:i};return this._put(`/wallet/${t}/shared-key`,n)},n.prototype.removeSharedKey=function(t,e,i){const n={account:e,accountKey:i};return this._del(`/wallet/${t}/shared-key`,n)},n.prototype.importPrivate=function(t,e,i){const n={account:e,privateKey:i};return this._post(`/wallet/${t}/import`,n)},n.prototype.importPublic=function(t,e,i){const n={account:e,publicKey:i};return this._post(`/wallet/${t}/import`,n)},n.prototype.importAddress=function(t,e,i){return this._post(`/wallet/${t}/import`,{account:e,address:i})},n.prototype.lockCoin=function(t,e,i){return this._put(`/wallet/${t}/coin/locked`,{hash:e,index:i})},n.prototype.unlockCoin=function(t,e,i){return this._del(`/wallet/${t}/coin/locked`,{hash:e,index:i})},n.prototype.getLocked=function(t){return this._get(`/wallet/${t}/coin/locked`)},n.prototype.lock=function(t){return this._post(`/wallet/${t}/lock`,{})},n.prototype.unlock=function(t,e,i){return this._post(`/wallet/${t}/unlock`,{passphrase:e,timeout:i})},n.prototype.resendWallet=function(t){return this._post(`/wallet/${t}/resend`,{})},n.prototype.getAccounts=function(t){return this._get(`/wallet/${t}/account`)},n.prototype.getMaster=function(t){return this._get(`/wallet/${t}/master`)},n.prototype.getAccount=function(t,e){return this._get(`/wallet/${t}/account/${e}`)},n.prototype.createAccount=function(t,e,i){return this._put(`/wallet/${t}/account/${e}`,i||{})},n.prototype.createAddress=function(t,e){return e||(e={}),"string"==typeof e&&(e={account:e}),this._post(`/wallet/${t}/address`,e)},n.prototype.createChange=function(t,e){return e||(e={}),"string"==typeof e&&(e={account:e}),this._post(`/wallet/${t}/change`,e)},n.prototype.createNested=function(t,e){return e||(e={}),"string"==typeof e&&(e={account:e}),this._post(`/wallet/${t}/nested`,e)},t.exports=n},function(t,e,i){"use strict";function n(t){if(!(this instanceof n))return new n(t);t||(t={}),"string"==typeof t&&(t={uri:t}),this.options=t,this.network=s.get(t.network),this.uri=t.uri||`http://localhost:${this.network.rpcPort}`,this.apiKey=t.apiKey,this.id=0}function r(t,e){Error.call(this),this.type="RPCError",this.message=String(t),this.code=e>>>0,Error.captureStackTrace&&Error.captureStackTrace(this,r)}const s=i(6),o=i(95);n.prototype.execute=async function(t,e){const i=await o({method:"POST",uri:this.uri,pool:!0,json:{method:t,params:e,id:this.id++},auth:{username:"wmccrpc",password:this.apiKey||""}});if(401===i.statusCode)throw new r("Unauthorized (bad API key).",-1);if(200!==i.statusCode)throw new Error(`Status code: ${i.statusCode}.`);if("json"!==i.type)throw new Error("Bad response (wrong content-type).");if(!i.body)throw new Error("No body for JSON-RPC response.");if(i.body.error)throw new r(i.body.error.message,i.body.error.code);return i.body.result},Object.setPrototypeOf(r.prototype,Error.prototype),t.exports=n},function(t,e,i){function n(t,e){"object"==typeof t&&(e=t,t=void 0),e=e||{};var i,n=r(t),s=n.source,c=n.id,u=n.path,f=h[c]&&u in h[c].nsps;return e.forceNew||e["force new connection"]||!1===e.multiplex||f?(a("ignoring socket cache for %s",s),i=o(s,e)):(h[c]||(a("new io instance for %s",s),h[c]=o(s,e)),i=h[c]),n.query&&!e.query&&(e.query=n.query),i.socket(n.path,e)}var r=i(273),s=i(169),o=i(217),a=i(45)("socket.io-client");t.exports=e=n;var h=e.managers={};e.protocol=s.protocol,e.connect=n,e.Manager=i(217),e.Socket=i(229)},function(t,e){var i=/^(?:(?![^:@]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,n=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"];t.exports=function(t){var e=t,r=t.indexOf("["),s=t.indexOf("]");-1!=r&&-1!=s&&(t=t.substring(0,r)+t.substring(r,s).replace(/:/g,";")+t.substring(s,t.length));for(var o=i.exec(t||""),a={},h=14;h--;)a[n[h]]=o[h]||"";return-1!=r&&-1!=s&&(a.source=e,a.host=a.host.substring(1,a.host.length-1).replace(/;/g,":"),a.authority=a.authority.replace("[","").replace("]","").replace(/;/g,":"),a.ipv6uri=!0),a}},function(t,e,i){function n(t){function i(){if(i.enabled){var t=i,n=+new Date,s=n-(r||n);t.diff=s,t.prev=r,t.curr=n,r=n;for(var o=new Array(arguments.length),a=0;a<o.length;a++)o[a]=arguments[a];o[0]=e.coerce(o[0]),"string"!=typeof o[0]&&o.unshift("%O");var h=0;o[0]=o[0].replace(/%([a-zA-Z%])/g,function(i,n){if("%%"===i)return i;h++;var r=e.formatters[n];if("function"==typeof r){var s=o[h];i=r.call(t,s),o.splice(h,1),h--}return i}),e.formatArgs.call(t,o);(i.log||e.log||console.log.bind(console)).apply(t,o)}}return i.namespace=t,i.enabled=e.enabled(t),i.useColors=e.useColors(),i.color=function(t){var i,n=0;for(i in t)n=(n<<5)-n+t.charCodeAt(i),n|=0;return e.colors[Math.abs(n)%e.colors.length]}(t),"function"==typeof e.init&&e.init(i),i}(e=t.exports=n.debug=n.default=n).coerce=function(t){return t instanceof Error?t.stack||t.message:t},e.disable=function(){e.enable("")},e.enable=function(t){e.save(t),e.names=[],e.skips=[];for(var i=("string"==typeof t?t:"").split(/[\s,]+/),n=i.length,r=0;r<n;r++)i[r]&&("-"===(t=i[r].replace(/\*/g,".*?"))[0]?e.skips.push(new RegExp("^"+t.substr(1)+"$")):e.names.push(new RegExp("^"+t+"$")))},e.enabled=function(t){var i,n;for(i=0,n=e.skips.length;i<n;i++)if(e.skips[i].test(t))return!1;for(i=0,n=e.names.length;i<n;i++)if(e.names[i].test(t))return!0;return!1},e.humanize=i(275),e.names=[],e.skips=[],e.formatters={};var r},function(t,e){var i={}.toString;t.exports=Array.isArray||function(t){return"[object Array]"==i.call(t)}},function(t,e){t.exports=function(t){return global.Buffer&&global.Buffer.isBuffer(t)||global.ArrayBuffer&&t instanceof ArrayBuffer}},function(t,e,i){function n(t,e){if(!(this instanceof n))return new n(t,e);t&&"object"==typeof t&&(e=t,t=void 0),(e=e||{}).path=e.path||"/socket.io",this.nsps={},this.subs=[],this.opts=e,this.reconnection(!1!==e.reconnection),this.reconnectionAttempts(e.reconnectionAttempts||1/0),this.reconnectionDelay(e.reconnectionDelay||1e3),this.reconnectionDelayMax(e.reconnectionDelayMax||5e3),this.randomizationFactor(e.randomizationFactor||.5),this.backoff=new l({min:this.reconnectionDelay(),max:this.reconnectionDelayMax(),jitter:this.randomizationFactor()}),this.timeout(null==e.timeout?2e4:e.timeout),this.readyState="closed",this.uri=t,this.connecting=[],this.lastPing=null,this.encoding=!1,this.packetBuffer=[];var i=e.parser||a;this.encoder=new i.Encoder,this.decoder=new i.Decoder,this.autoConnect=!1!==e.autoConnect,this.autoConnect&&this.open()}var r=i(280),s=i(229),o=i(76),a=i(169),h=i(230),c=i(231),u=i(45)("socket.io-client:manager"),f=i(228),l=i(299),p=Object.prototype.hasOwnProperty;t.exports=n,n.prototype.emitAll=function(){this.emit.apply(this,arguments);for(var t in this.nsps)p.call(this.nsps,t)&&this.nsps[t].emit.apply(this.nsps[t],arguments)},n.prototype.updateSocketIds=function(){for(var t in this.nsps)p.call(this.nsps,t)&&(this.nsps[t].id=this.generateId(t))},n.prototype.generateId=function(t){return("/"===t?"":t+"#")+this.engine.id},o(n.prototype),n.prototype.reconnection=function(t){return arguments.length?(this._reconnection=!!t,this):this._reconnection},n.prototype.reconnectionAttempts=function(t){return arguments.length?(this._reconnectionAttempts=t,this):this._reconnectionAttempts},n.prototype.reconnectionDelay=function(t){return arguments.length?(this._reconnectionDelay=t,this.backoff&&this.backoff.setMin(t),this):this._reconnectionDelay},n.prototype.randomizationFactor=function(t){return arguments.length?(this._randomizationFactor=t,this.backoff&&this.backoff.setJitter(t),this):this._randomizationFactor},n.prototype.reconnectionDelayMax=function(t){return arguments.length?(this._reconnectionDelayMax=t,this.backoff&&this.backoff.setMax(t),this):this._reconnectionDelayMax},n.prototype.timeout=function(t){return arguments.length?(this._timeout=t,this):this._timeout},n.prototype.maybeReconnectOnOpen=function(){!this.reconnecting&&this._reconnection&&0===this.backoff.attempts&&this.reconnect()},n.prototype.open=n.prototype.connect=function(t,e){if(u("readyState %s",this.readyState),~this.readyState.indexOf("open"))return this;u("opening %s",this.uri),this.engine=r(this.uri,this.opts);var i=this.engine,n=this;this.readyState="opening",this.skipReconnect=!1;var s=h(i,"open",function(){n.onopen(),t&&t()}),o=h(i,"error",function(e){if(u("connect_error"),n.cleanup(),n.readyState="closed",n.emitAll("connect_error",e),t){var i=new Error("Connection error");i.data=e,t(i)}else n.maybeReconnectOnOpen()});if(!1!==this._timeout){var a=this._timeout;u("connect attempt will timeout after %d",a);var c=setTimeout(function(){u("connect attempt timed out after %d",a),s.destroy(),i.close(),i.emit("error","timeout"),n.emitAll("connect_timeout",a)},a);this.subs.push({destroy:function(){clearTimeout(c)}})}return this.subs.push(s),this.subs.push(o),this},n.prototype.onopen=function(){u("open"),this.cleanup(),this.readyState="open",this.emit("open");var t=this.engine;this.subs.push(h(t,"data",c(this,"ondata"))),this.subs.push(h(t,"ping",c(this,"onping"))),this.subs.push(h(t,"pong",c(this,"onpong"))),this.subs.push(h(t,"error",c(this,"onerror"))),this.subs.push(h(t,"close",c(this,"onclose"))),this.subs.push(h(this.decoder,"decoded",c(this,"ondecoded")))},n.prototype.onping=function(){this.lastPing=new Date,this.emitAll("ping")},n.prototype.onpong=function(){this.emitAll("pong",new Date-this.lastPing)},n.prototype.ondata=function(t){this.decoder.add(t)},n.prototype.ondecoded=function(t){this.emit("packet",t)},n.prototype.onerror=function(t){u("error",t),this.emitAll("error",t)},n.prototype.socket=function(t,e){function i(){~f(r.connecting,n)||r.connecting.push(n)}var n=this.nsps[t];if(!n){n=new s(this,t,e),this.nsps[t]=n;var r=this;n.on("connecting",i),n.on("connect",function(){n.id=r.generateId(t)}),this.autoConnect&&i()}return n},n.prototype.destroy=function(t){var e=f(this.connecting,t);~e&&this.connecting.splice(e,1),this.connecting.length||this.close()},n.prototype.packet=function(t){u("writing packet %j",t);var e=this;t.query&&0===t.type&&(t.nsp+="?"+t.query),e.encoding?e.packetBuffer.push(t):(e.encoding=!0,this.encoder.encode(t,function(i){for(var n=0;n<i.length;n++)e.engine.write(i[n],t.options);e.encoding=!1,e.processPacketQueue()}))},n.prototype.processPacketQueue=function(){if(this.packetBuffer.length>0&&!this.encoding){var t=this.packetBuffer.shift();this.packet(t)}},n.prototype.cleanup=function(){u("cleanup");for(var t=this.subs.length,e=0;e<t;e++){this.subs.shift().destroy()}this.packetBuffer=[],this.encoding=!1,this.lastPing=null,this.decoder.destroy()},n.prototype.close=n.prototype.disconnect=function(){u("disconnect"),this.skipReconnect=!0,this.reconnecting=!1,"opening"===this.readyState&&this.cleanup(),this.backoff.reset(),this.readyState="closed",this.engine&&this.engine.close()},n.prototype.onclose=function(t){u("onclose"),this.cleanup(),this.backoff.reset(),this.readyState="closed",this.emit("close",t),this._reconnection&&!this.skipReconnect&&this.reconnect()},n.prototype.reconnect=function(){if(this.reconnecting||this.skipReconnect)return this;var t=this;if(this.backoff.attempts>=this._reconnectionAttempts)u("reconnect failed"),this.backoff.reset(),this.emitAll("reconnect_failed"),this.reconnecting=!1;else{var e=this.backoff.duration();u("will wait %dms before reconnect attempt",e),this.reconnecting=!0;var i=setTimeout(function(){t.skipReconnect||(u("attempting reconnect"),t.emitAll("reconnect_attempt",t.backoff.attempts),t.emitAll("reconnecting",t.backoff.attempts),t.skipReconnect||t.open(function(e){e?(u("reconnect attempt error"),t.reconnecting=!1,t.reconnect(),t.emitAll("reconnect_error",e.data)):(u("reconnect success"),t.onreconnect())}))},e);this.subs.push({destroy:function(){clearTimeout(i)}})}},n.prototype.onreconnect=function(){var t=this.backoff.attempts;this.reconnecting=!1,this.backoff.reset(),this.updateSocketIds(),this.emitAll("reconnect",t)}},function(t,e,i){var n=i(170),r=i(283),s=i(290),o=i(291);e.polling=function(t){var e=!1,i=!1,o=!1!==t.jsonp;if(global.location){var a="https:"===location.protocol,h=location.port;h||(h=a?443:80),e=t.hostname!==location.hostname||h!==t.port,i=t.secure!==a}if(t.xdomain=e,t.xscheme=i,"open"in new n(t)&&!t.forceJSONP)return new r(t);if(!o)throw new Error("JSONP disabled");return new s(t)},e.websocket=o},function(t,e){t.exports=require("child_process")},function(t,e,i){function n(t){var e=t&&t.forceBase64;u&&!e||(this.supportsBinary=!1),r.call(this,t)}var r=i(171),s=i(112),o=i(77),a=i(113),h=i(221),c=i(45)("engine.io-client:polling");t.exports=n;var u=null!=new(i(170))({xdomain:!1}).responseType;a(n,r),n.prototype.name="polling",n.prototype.doOpen=function(){this.poll()},n.prototype.pause=function(t){function e(){c("paused"),i.readyState="paused",t()}var i=this;if(this.readyState="pausing",this.polling||!this.writable){var n=0;this.polling&&(c("we are currently polling - waiting to pause"),n++,this.once("pollComplete",function(){c("pre-pause polling complete"),--n||e()})),this.writable||(c("we are currently writing - waiting to pause"),n++,this.once("drain",function(){c("pre-pause writing complete"),--n||e()}))}else e()},n.prototype.poll=function(){c("polling"),this.polling=!0,this.doPoll(),this.emit("poll")},n.prototype.onData=function(t){var e=this;c("polling got data %s",t);o.decodePayload(t,this.socket.binaryType,function(t,i,n){if("opening"===e.readyState&&e.onOpen(),"close"===t.type)return e.onClose(),!1;e.onPacket(t)}),"closed"!==this.readyState&&(this.polling=!1,this.emit("pollComplete"),"open"===this.readyState?this.poll():c('ignoring poll - transport state "%s"',this.readyState))},n.prototype.doClose=function(){function t(){c("writing close packet"),e.write([{type:"close"}])}var e=this;"open"===this.readyState?(c("transport open - closing"),t()):(c("transport not open - deferring close"),this.once("open",t))},n.prototype.write=function(t){var e=this;this.writable=!1;var i=function(){e.writable=!0,e.emit("drain")};o.encodePayload(t,this.supportsBinary,function(t){e.doWrite(t,i)})},n.prototype.uri=function(){var t=this.query||{},e=this.secure?"https":"http",i="";!1!==this.timestampRequests&&(t[this.timestampParam]=h()),this.supportsBinary||t.sid||(t.b64=1),t=s.encode(t),this.port&&("https"===e&&443!==Number(this.port)||"http"===e&&80!==Number(this.port))&&(i=":"+this.port),t.length&&(t="?"+t);return e+"://"+(-1!==this.hostname.indexOf(":")?"["+this.hostname+"]":this.hostname)+i+this.path+t}},function(t,e,i){"use strict";function n(t){var e="";do{e=o[t%a]+e,t=Math.floor(t/a)}while(t>0);return e}function r(){var t=n(+new Date);return t!==s?(c=0,s=t):t+"."+n(c++)}for(var s,o="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz-_".split(""),a=64,h={},c=0,u=0;u<a;u++)h[o[u]]=u;r.encode=n,r.decode=function(t){var e=0;for(u=0;u<t.length;u++)e=e*a+h[t.charAt(u)];return e},t.exports=r},function(t,e,i){"use strict";const n=i(10),r=i(24),s=i(223),o=i(111),a=i(75),h=i(73),c=i(114),u=i(294),f=i(224),l=i(173),p=i(225),d=i(227),m=[8,13],g=3e4;class y extends n{constructor(t,e,i){super(),e?"string"==typeof e?e=[e]:Array.isArray(e)||(i=e,e=[]):e=[],this.readyState=y.CONNECTING,this.bytesReceived=0,this.extensions={},this.protocol="",this._binaryType=l.BINARY_TYPES[0],this._finalize=this.finalize.bind(this),this._finalizeCalled=!1,this._closeMessage=null,this._closeTimer=null,this._closeCode=null,this._receiver=null,this._sender=null,this._socket=null,this._ultron=null,Array.isArray(t)?function(t,e,i,n){this.protocolVersion=n.protocolVersion,this.extensions=n.extensions,this.maxPayload=n.maxPayload,this.protocol=n.protocol,this.upgradeReq=t,this._isServer=!0,this.setSocket(e,i)}.call(this,t[0],t[1],t[2],i):function(t,e,i){if(i=Object.assign({protocolVersion:m[1],protocol:e.join(","),perMessageDeflate:!0,localAddress:null,headers:null,family:null,origin:null,agent:null,host:null,checkServerIdentity:null,rejectUnauthorized:null,passphrase:null,ciphers:null,cert:null,key:null,pfx:null,ca:null},i),-1===m.indexOf(i.protocolVersion))throw new Error(`unsupported protocol version: ${i.protocolVersion} `+`(supported versions: ${m.join(", ")})`);this.protocolVersion=i.protocolVersion,this._isServer=!1,this.url=t;const n=h.parse(t),s="ws+unix:"===n.protocol;if(!(n.host||s&&n.path))throw new Error("invalid url");const u="wss:"===n.protocol||"https:"===n.protocol,p=r.randomBytes(16).toString("base64"),d=u?o:a,g={};var w;i.perMessageDeflate&&(w=new c(!0!==i.perMessageDeflate?i.perMessageDeflate:{},!1),g[c.extensionName]=w.offer());const b={port:n.port||(u?443:80),host:n.hostname,path:"/",headers:{"Sec-WebSocket-Version":i.protocolVersion,"Sec-WebSocket-Key":p,Connection:"Upgrade",Upgrade:"websocket"}};if(i.headers&&Object.assign(b.headers,i.headers),Object.keys(g).length&&(b.headers["Sec-WebSocket-Extensions"]=f.format(g)),i.protocol&&(b.headers["Sec-WebSocket-Protocol"]=i.protocol),i.origin&&(i.protocolVersion<13?b.headers["Sec-WebSocket-Origin"]=i.origin:b.headers.Origin=i.origin),i.host&&(b.headers.Host=i.host),n.auth&&(b.auth=n.auth),i.localAddress&&(b.localAddress=i.localAddress),i.family&&(b.family=i.family),s){const t=n.path.split(":");b.socketPath=t[0],b.path=t[1]}else n.path&&("/"!==n.path.charAt(0)?b.path=`/${n.path}`:b.path=n.path);var v=i.agent;(null!=i.rejectUnauthorized||i.checkServerIdentity||i.passphrase||i.ciphers||i.cert||i.key||i.pfx||i.ca)&&(i.passphrase&&(b.passphrase=i.passphrase),i.ciphers&&(b.ciphers=i.ciphers),i.cert&&(b.cert=i.cert),i.key&&(b.key=i.key),i.pfx&&(b.pfx=i.pfx),i.ca&&(b.ca=i.ca),i.checkServerIdentity&&(b.checkServerIdentity=i.checkServerIdentity),null!=i.rejectUnauthorized&&(b.rejectUnauthorized=i.rejectUnauthorized),v||(v=new d.Agent(b))),v&&(b.agent=v),this._req=d.get(b),this._req.on("error",t=>{this._req.aborted||(this._req=null,this.emit("error",t),this.finalize(!0))}),this._req.on("response",t=>{this.emit("unexpected-response",this._req,t)||(this._req.abort(),this.emit("error",new Error(`unexpected server response (${t.statusCode})`)),this.finalize(!0))}),this._req.on("upgrade",(t,e,n)=>{if(this.emit("headers",t.headers,t),this.readyState!==y.CONNECTING)return;this._req=null;const s=r.createHash("sha1").update(p+l.GUID,"binary").digest("base64");if(t.headers["sec-websocket-accept"]!==s)return e.destroy(),this.emit("error",new Error("invalid server key")),this.finalize(!0);const o=t.headers["sec-websocket-protocol"],a=(i.protocol||"").split(/, */);var h;if(!i.protocol&&o?h="server sent a subprotocol even though none requested":i.protocol&&!o?h="server sent no subprotocol even though requested":o&&-1===a.indexOf(o)&&(h="server responded with an invalid protocol"),h)return e.destroy(),this.emit("error",new Error(h)),this.finalize(!0);o&&(this.protocol=o);const u=f.parse(t.headers["sec-websocket-extensions"]);if(w&&u[c.extensionName]){try{w.accept(u[c.extensionName])}catch(t){return e.destroy(),this.emit("error",new Error("invalid extension parameter")),this.finalize(!0)}this.extensions[c.extensionName]=w}this.setSocket(e,n)})}.call(this,t,e,i)}get CONNECTING(){return y.CONNECTING}get CLOSING(){return y.CLOSING}get CLOSED(){return y.CLOSED}get OPEN(){return y.OPEN}get bufferedAmount(){var t=0;return this._socket&&(t=this._socket.bufferSize+this._sender.bufferedBytes),t}get binaryType(){return this._binaryType}set binaryType(t){l.BINARY_TYPES.indexOf(t)<0||(this._binaryType=t,this._receiver&&(this._receiver.binaryType=t))}setSocket(t,e){t.setTimeout(0),t.setNoDelay(),this._receiver=new p(this.extensions,this.maxPayload,this.binaryType),this._sender=new d(t,this.extensions),this._ultron=new s(t),this._socket=t,this._ultron.on("close",this._finalize),this._ultron.on("error",this._finalize),this._ultron.on("end",this._finalize),e&&e.length>0&&(t.unshift(e),e=null),this._ultron.on("data",t=>{this.bytesReceived+=t.length,this._receiver.add(t)}),this._receiver.onmessage=((t,e)=>this.emit("message",t,e)),this._receiver.onping=((t,e)=>{this.pong(t,!this._isServer,!0),this.emit("ping",t,e)}),this._receiver.onpong=((t,e)=>this.emit("pong",t,e)),this._receiver.onclose=((t,e)=>{this._closeMessage=e,this._closeCode=t,this.close(t,e)}),this._receiver.onerror=((t,e)=>{this.close(e,""),this.emit("error",t)}),this._sender.onerror=(t=>{this.close(1002,""),this.emit("error",t)}),this.readyState=y.OPEN,this.emit("open")}finalize(t){this._finalizeCalled||(this.readyState=y.CLOSING,this._finalizeCalled=!0,clearTimeout(this._closeTimer),this._closeTimer=null,t&&(this._closeCode=1006),this._socket&&(this._ultron.destroy(),this._socket.on("error",function(){this.destroy()}),t?this._socket.destroy():this._socket.end(),this._socket=null,this._ultron=null),this._sender&&(this._sender=this._sender.onerror=null),this._receiver?(this._receiver.cleanup(()=>this.emitClose()),this._receiver=null):this.emitClose())}emitClose(){this.readyState=y.CLOSED,this.emit("close",this._closeCode||1006,this._closeMessage||""),this.extensions[c.extensionName]&&this.extensions[c.extensionName].cleanup(),this.extensions=null,this.removeAllListeners(),this.on("error",l.NOOP)}pause(){if(this.readyState!==y.OPEN)throw new Error("not opened");this._socket.pause()}resume(){if(this.readyState!==y.OPEN)throw new Error("not opened");this._socket.resume()}close(t,e){this.readyState!==y.CLOSED&&(this.readyState!==y.CONNECTING?this.readyState!==y.CLOSING?(this.readyState=y.CLOSING,this._sender.close(t,e,!this._isServer,t=>{t&&this.emit("error",t),this._socket&&(this._closeCode&&this._socket.end(),clearTimeout(this._closeTimer),this._closeTimer=setTimeout(this._finalize,g,!0))})):this._closeCode&&this._socket&&this._socket.end():this._req&&!this._req.aborted&&(this._req.abort(),this.emit("error",new Error("closed before the connection is established")),this.finalize(!0)))}ping(t,e,i){if(this.readyState!==y.OPEN){if(i)return;throw new Error("not opened")}"number"==typeof t&&(t=t.toString()),void 0===e&&(e=!this._isServer),this._sender.ping(t||l.EMPTY_BUFFER,e)}pong(t,e,i){if(this.readyState!==y.OPEN){if(i)return;throw new Error("not opened")}"number"==typeof t&&(t=t.toString()),void 0===e&&(e=!this._isServer),this._sender.pong(t||l.EMPTY_BUFFER,e)}send(t,e,i){if("function"==typeof e&&(i=e,e={}),this.readyState!==y.OPEN){if(!i)throw new Error("not opened");return void i(new Error("not opened"))}"number"==typeof t&&(t=t.toString());const n=Object.assign({binary:"string"!=typeof t,mask:!this._isServer,compress:!0,fin:!0},e);this.extensions[c.extensionName]||(n.compress=!1),this._sender.send(t||l.EMPTY_BUFFER,n,i)}terminate(){this.readyState!==y.CLOSED&&(this.readyState!==y.CONNECTING?this.finalize(!0):this._req&&!this._req.aborted&&(this._req.abort(),this.emit("error",new Error("closed before the connection is established")),this.finalize(!0)))}}y.CONNECTING=0,y.OPEN=1,y.CLOSING=2,y.CLOSED=3,["open","error","close","message"].forEach(t=>{Object.defineProperty(y.prototype,`on${t}`,{get(){const e=this.listeners(t);for(var i=0;i<e.length;i++)if(e[i]._listener)return e[i]._listener},set(e){const i=this.listeners(t);for(var n=0;n<i.length;n++)i[n]._listener&&this.removeListener(t,i[n]);this.addEventListener(t,e)}})}),y.prototype.addEventListener=u.addEventListener,y.prototype.removeEventListener=u.removeEventListener,t.exports=y},function(t,e,i){"use strict";function n(t){if(!(this instanceof n))return new n(t);this.id=s++,this.ee=t}var r=Object.prototype.hasOwnProperty,s=0;n.prototype.on=function(t,e,i){return e.__ultron=this.id,this.ee.on(t,e,i),this},n.prototype.once=function(t,e,i){return e.__ultron=this.id,this.ee.once(t,e,i),this},n.prototype.remove=function(){var t,e=arguments,i=this.ee;if(1===e.length&&"string"==typeof e[0])e=e[0].split(/[, ]+/);else if(!e.length)if(i.eventNames)e=i.eventNames();else if(i._events){e=[];for(t in i._events)r.call(i._events,t)&&e.push(t);Object.getOwnPropertySymbols&&(e=e.concat(Object.getOwnPropertySymbols(i._events)))}for(var n=0;n<e.length;n++)for(var s=i.listeners(e[n]),o=0;o<s.length;o++){if((t=s[o]).listener){if(t.listener.__ultron!==this.id)continue;delete t.listener.__ultron}else{if(t.__ultron!==this.id)continue;delete t.__ultron}i.removeListener(e[n],t)}return this},n.prototype.destroy=function(){return!!this.ee&&(this.remove(),this.ee=null,!0)},t.exports=n},function(t,e,i){"use strict";t.exports={format:t=>Object.keys(t).map(e=>{var i=t[e];return Array.isArray(i)||(i=[i]),i.map(t=>[e].concat(Object.keys(t).map(e=>{var i=t[e];return Array.isArray(i)||(i=[i]),i.map(t=>!0===t?e:`${e}=${t}`).join("; ")})).join("; ")).join(", ")}).join(", "),parse:t=>{const e={};return(t=t||"").split(",").forEach(t=>{const i=t.split(";"),n=i.shift().trim(),r=e[n]=e[n]||[],s={};i.forEach(t=>{const e=t.trim().split("="),i=e[0];var n=e[1];void 0===n?n=!0:('"'===n[0]&&(n=n.slice(1)),'"'===n[n.length-1]&&(n=n.slice(0,n.length-1))),(s[i]=s[i]||[]).push(n)}),r.push(s)}),e}}},function(t,e,i){"use strict";function n(t,e){return 1===t.length?t[0]:t.length>1?a.concat(t,e):c.EMPTY_BUFFER}const r=i(78),s=i(114),o=i(295),a=i(172),h=i(226),c=i(173),u=r.Buffer,f=0,l=1,p=2,d=3,m=4,g=5;t.exports=class{constructor(t,e,i){this.binaryType=i||c.BINARY_TYPES[0],this.extensions=t||{},this.maxPayload=0|e,this.bufferedBytes=0,this.buffers=[],this.compressed=!1,this.payloadLength=0,this.fragmented=0,this.masked=!1,this.fin=!1,this.mask=null,this.opcode=0,this.totalPayloadLength=0,this.messageLength=0,this.fragments=[],this.cleanupCallback=null,this.hadError=!1,this.dead=!1,this.loop=!1,this.onmessage=null,this.onclose=null,this.onerror=null,this.onping=null,this.onpong=null,this.state=f}readBuffer(t){var e,i,n=0;if(this.bufferedBytes-=t,t===this.buffers[0].length)return this.buffers.shift();if(t<this.buffers[0].length)return e=this.buffers[0].slice(0,t),this.buffers[0]=this.buffers[0].slice(t),e;for(e=u.allocUnsafe(t);t>0;)t>=(i=this.buffers[0].length)?(this.buffers[0].copy(e,n),n+=i,this.buffers.shift()):(this.buffers[0].copy(e,n,0,t),this.buffers[0]=this.buffers[0].slice(t)),t-=i;return e}hasBufferedBytes(t){return this.bufferedBytes>=t||(this.loop=!1,this.dead&&this.cleanup(this.cleanupCallback),!1)}add(t){this.dead||(this.bufferedBytes+=t.length,this.buffers.push(t),this.startLoop())}startLoop(){for(this.loop=!0;this.loop;)switch(this.state){case f:this.getInfo();break;case l:this.getPayloadLength16();break;case p:this.getPayloadLength64();break;case d:this.getMask();break;case m:this.getData();break;default:this.loop=!1}}getInfo(){if(!this.hasBufferedBytes(2))return;const t=this.readBuffer(2);if(0!=(48&t[0]))return void this.error(new Error("RSV2 and RSV3 must be clear"),1002);const e=64==(64&t[0]);if(!e||this.extensions[s.extensionName]){if(this.fin=128==(128&t[0]),this.opcode=15&t[0],this.payloadLength=127&t[1],0===this.opcode){if(e)return void this.error(new Error("RSV1 must be clear"),1002);if(!this.fragmented)return void this.error(new Error(`invalid opcode: ${this.opcode}`),1002);this.opcode=this.fragmented}else if(1===this.opcode||2===this.opcode){if(this.fragmented)return void this.error(new Error(`invalid opcode: ${this.opcode}`),1002);this.compressed=e}else{if(!(this.opcode>7&&this.opcode<11))return void this.error(new Error(`invalid opcode: ${this.opcode}`),1002);if(!this.fin)return void this.error(new Error("FIN must be set"),1002);if(e)return void this.error(new Error("RSV1 must be clear"),1002);if(this.payloadLength>125)return void this.error(new Error("invalid payload length"),1002)}this.fin||this.fragmented||(this.fragmented=this.opcode),this.masked=128==(128&t[1]),126===this.payloadLength?this.state=l:127===this.payloadLength?this.state=p:this.haveLength()}else this.error(new Error("RSV1 must be clear"),1002)}getPayloadLength16(){this.hasBufferedBytes(2)&&(this.payloadLength=this.readBuffer(2).readUInt16BE(0,!0),this.haveLength())}getPayloadLength64(){if(!this.hasBufferedBytes(8))return;const t=this.readBuffer(8),e=t.readUInt32BE(0,!0);e>Math.pow(2,21)-1?this.error(new Error("max payload size exceeded"),1009):(this.payloadLength=e*Math.pow(2,32)+t.readUInt32BE(4,!0),this.haveLength())}haveLength(){this.opcode<8&&this.maxPayloadExceeded(this.payloadLength)||(this.masked?this.state=d:this.state=m)}getMask(){this.hasBufferedBytes(4)&&(this.mask=this.readBuffer(4),this.state=m)}getData(){var t=c.EMPTY_BUFFER;if(this.payloadLength){if(!this.hasBufferedBytes(this.payloadLength))return;t=this.readBuffer(this.payloadLength),this.masked&&a.unmask(t,this.mask)}this.opcode>7?this.controlMessage(t):this.compressed?(this.state=g,this.decompress(t)):this.pushFragment(t)&&this.dataMessage()}decompress(t){this.extensions[s.extensionName].decompress(t,this.fin,(t,e)=>{t?this.error(t,1009===t.closeCode?1009:1007):(this.pushFragment(e)&&this.dataMessage(),this.startLoop())})}dataMessage(){if(this.fin){const e=this.messageLength,i=this.fragments;if(this.totalPayloadLength=0,this.messageLength=0,this.fragmented=0,this.fragments=[],2===this.opcode){var t;t="nodebuffer"===this.binaryType?n(i,e):"arraybuffer"===this.binaryType?function(t){return 0===t.byteOffset&&t.byteLength===t.buffer.byteLength?t.buffer:t.buffer.slice(t.byteOffset,t.byteOffset+t.byteLength)}(n(i,e)):i,this.onmessage(t,{masked:this.masked,binary:!0})}else{const t=n(i,e);if(!o(t))return void this.error(new Error("invalid utf8 sequence"),1007);this.onmessage(t.toString(),{masked:this.masked})}}this.state=f}controlMessage(t){if(8===this.opcode){if(0===t.length)this.onclose(1e3,"",{masked:this.masked}),this.loop=!1,this.cleanup(this.cleanupCallback);else if(1===t.length)this.error(new Error("invalid payload length"),1002);else{const e=t.readUInt16BE(0,!0);if(!h.isValidErrorCode(e))return void this.error(new Error(`invalid status code: ${e}`),1002);const i=t.slice(2);if(!o(i))return void this.error(new Error("invalid utf8 sequence"),1007);this.onclose(e,i.toString(),{masked:this.masked}),this.loop=!1,this.cleanup(this.cleanupCallback)}return}const e={masked:this.masked,binary:!0};9===this.opcode?this.onping(t,e):this.onpong(t,e),this.state=f}error(t,e){this.onerror(t,e),this.hadError=!0,this.loop=!1,this.cleanup(this.cleanupCallback)}maxPayloadExceeded(t){if(0===t||this.maxPayload<1)return!1;const e=this.totalPayloadLength+t;return e<=this.maxPayload?(this.totalPayloadLength=e,!1):(this.error(new Error("max payload size exceeded"),1009),!0)}pushFragment(t){if(0===t.length)return!0;const e=this.messageLength+t.length;return this.maxPayload<1||e<=this.maxPayload?(this.messageLength=e,this.fragments.push(t),!0):(this.error(new Error("max payload size exceeded"),1009),!1)}cleanup(t){this.dead=!0,this.hadError||!this.loop&&this.state!==g?(this.extensions=null,this.fragments=null,this.buffers=null,this.mask=null,this.cleanupCallback=null,this.onmessage=null,this.onclose=null,this.onerror=null,this.onping=null,this.onpong=null,t&&t()):this.cleanupCallback=t}}},function(t,e,i){"use strict";t.exports={isValidErrorCode:function(t){return t>=1e3&&t<=1013&&1004!==t&&1005!==t&&1006!==t||t>=3e3&&t<=4999},1e3:"normal",1001:"going away",1002:"protocol error",1003:"unsupported data",1004:"reserved",1005:"reserved for extensions",1006:"reserved for extensions",1007:"inconsistent or invalid data",1008:"policy violation",1009:"message too big",1010:"extension handshake missing",1011:"an unexpected condition prevented the request from being fulfilled",1012:"service restart",1013:"try again later"}},function(t,e,i){"use strict";function n(t){const e=c.from(t.buffer);return t.byteLength!==t.buffer.byteLength?e.slice(t.byteOffset,t.byteOffset+t.byteLength):e}const r=i(78),s=i(24),o=i(114),a=i(172),h=i(226),c=r.Buffer;class u{constructor(t,e){this.perMessageDeflate=(e||{})[o.extensionName],this._socket=t,this.firstFragment=!0,this.compress=!1,this.bufferedBytes=0,this.deflating=!1,this.queue=[],this.onerror=null}static frame(t,e){const i=t.length<1024||e.mask&&e.readOnly;var n=e.mask?6:2,r=t.length;t.length>=65536?(n+=8,r=127):t.length>125&&(n+=2,r=126);const o=c.allocUnsafe(i?t.length+n:n);if(o[0]=e.fin?128|e.opcode:e.opcode,e.rsv1&&(o[0]|=64),126===r?o.writeUInt16BE(t.length,2,!0):127===r&&(o.writeUInt32BE(0,2,!0),o.writeUInt32BE(t.length,6,!0)),!e.mask)return o[1]=r,i?(t.copy(o,n),[o]):[o,t];const h=s.randomBytes(4);return o[1]=128|r,o[n-4]=h[0],o[n-3]=h[1],o[n-2]=h[2],o[n-1]=h[3],i?(a.mask(t,h,o,n,t.length),[o]):(a.mask(t,h,t,0,t.length),[o,t])}close(t,e,i,n){if(void 0!==t&&("number"!=typeof t||!h.isValidErrorCode(t)))throw new Error("first argument must be a valid error code number");const r=c.allocUnsafe(2+(e?c.byteLength(e):0));r.writeUInt16BE(t||1e3,0,!0),r.length>2&&r.write(e,2),this.deflating?this.enqueue([this.doClose,r,i,n]):this.doClose(r,i,n)}doClose(t,e,i){this.sendFrame(u.frame(t,{fin:!0,rsv1:!1,opcode:8,mask:e,readOnly:!1}),i)}ping(t,e){var i=!0;c.isBuffer(t)||(t instanceof ArrayBuffer?t=c.from(t):ArrayBuffer.isView(t)?t=n(t):(t=c.from(t),i=!1)),this.deflating?this.enqueue([this.doPing,t,e,i]):this.doPing(t,e,i)}doPing(t,e,i){this.sendFrame(u.frame(t,{fin:!0,rsv1:!1,opcode:9,mask:e,readOnly:i}))}pong(t,e){var i=!0;c.isBuffer(t)||(t instanceof ArrayBuffer?t=c.from(t):ArrayBuffer.isView(t)?t=n(t):(t=c.from(t),i=!1)),this.deflating?this.enqueue([this.doPong,t,e,i]):this.doPong(t,e,i)}doPong(t,e,i){this.sendFrame(u.frame(t,{fin:!0,rsv1:!1,opcode:10,mask:e,readOnly:i}))}send(t,e,i){var r=e.binary?2:1,s=e.compress,o=!0;if(c.isBuffer(t)||(t instanceof ArrayBuffer?t=c.from(t):ArrayBuffer.isView(t)?t=n(t):(t=c.from(t),o=!1)),this.firstFragment?(this.firstFragment=!1,s&&this.perMessageDeflate&&(s=t.length>=this.perMessageDeflate.threshold),this.compress=s):(s=!1,r=0),e.fin&&(this.firstFragment=!0),this.perMessageDeflate){const n={fin:e.fin,rsv1:s,opcode:r,mask:e.mask,readOnly:o};this.deflating?this.enqueue([this.dispatch,t,this.compress,n,i]):this.dispatch(t,this.compress,n,i)}else this.sendFrame(u.frame(t,{fin:e.fin,rsv1:!1,opcode:r,mask:e.mask,readOnly:o}),i)}dispatch(t,e,i,n){e?(this.deflating=!0,this.perMessageDeflate.compress(t,i.fin,(t,e)=>{t?n?n(t):this.onerror(t):(i.readOnly=!1,this.sendFrame(u.frame(e,i),n),this.deflating=!1,this.dequeue())})):this.sendFrame(u.frame(t,i),n)}dequeue(){for(;!this.deflating&&this.queue.length;){const t=this.queue.shift();this.bufferedBytes-=t[1].length,t[0].apply(this,t.slice(1))}}enqueue(t){this.bufferedBytes+=t[1].length,this.queue.push(t)}sendFrame(t,e){2===t.length?(this._socket.write(t[0]),this._socket.write(t[1],e)):this._socket.write(t[0],e)}}t.exports=u},function(t,e){var i=[].indexOf;t.exports=function(t,e){if(i)return t.indexOf(e);for(var n=0;n<t.length;++n)if(t[n]===e)return n;return-1}},function(t,e,i){function n(t,e,i){this.io=t,this.nsp=e,this.json=this,this.ids=0,this.acks={},this.receiveBuffer=[],this.sendBuffer=[],this.connected=!1,this.disconnected=!0,i&&i.query&&(this.query=i.query),this.io.autoConnect&&this.open()}var r=i(169),s=i(76),o=i(298),a=i(230),h=i(231),c=i(45)("socket.io-client:socket"),u=i(112);t.exports=n;var f={connect:1,connect_error:1,connect_timeout:1,connecting:1,disconnect:1,error:1,reconnect:1,reconnect_attempt:1,reconnect_failed:1,reconnect_error:1,reconnecting:1,ping:1,pong:1},l=s.prototype.emit;s(n.prototype),n.prototype.subEvents=function(){if(!this.subs){var t=this.io;this.subs=[a(t,"open",h(this,"onopen")),a(t,"packet",h(this,"onpacket")),a(t,"close",h(this,"onclose"))]}},n.prototype.open=n.prototype.connect=function(){return this.connected?this:(this.subEvents(),this.io.open(),"open"===this.io.readyState&&this.onopen(),this.emit("connecting"),this)},n.prototype.send=function(){var t=o(arguments);return t.unshift("message"),this.emit.apply(this,t),this},n.prototype.emit=function(t){if(f.hasOwnProperty(t))return l.apply(this,arguments),this;var e=o(arguments),i={type:r.EVENT,data:e};return i.options={},i.options.compress=!this.flags||!1!==this.flags.compress,"function"==typeof e[e.length-1]&&(c("emitting packet with ack id %d",this.ids),this.acks[this.ids]=e.pop(),i.id=this.ids++),this.connected?this.packet(i):this.sendBuffer.push(i),delete this.flags,this},n.prototype.packet=function(t){t.nsp=this.nsp,this.io.packet(t)},n.prototype.onopen=function(){if(c("transport is open - connecting"),"/"!==this.nsp)if(this.query){var t="object"==typeof this.query?u.encode(this.query):this.query;c("sending connect packet with query %s",t),this.packet({type:r.CONNECT,query:t})}else this.packet({type:r.CONNECT})},n.prototype.onclose=function(t){c("close (%s)",t),this.connected=!1,this.disconnected=!0,delete this.id,this.emit("disconnect",t)},n.prototype.onpacket=function(t){if(t.nsp===this.nsp)switch(t.type){case r.CONNECT:this.onconnect();break;case r.EVENT:case r.BINARY_EVENT:this.onevent(t);break;case r.ACK:case r.BINARY_ACK:this.onack(t);break;case r.DISCONNECT:this.ondisconnect();break;case r.ERROR:this.emit("error",t.data)}},n.prototype.onevent=function(t){var e=t.data||[];c("emitting event %j",e),null!=t.id&&(c("attaching ack callback to event"),e.push(this.ack(t.id))),this.connected?l.apply(this,e):this.receiveBuffer.push(e)},n.prototype.ack=function(t){var e=this,i=!1;return function(){if(!i){i=!0;var n=o(arguments);c("sending ack %j",n),e.packet({type:r.ACK,id:t,data:n})}}},n.prototype.onack=function(t){var e=this.acks[t.id];"function"==typeof e?(c("calling ack %s with %j",t.id,t.data),e.apply(this,t.data),delete this.acks[t.id]):c("bad ack %s",t.id)},n.prototype.onconnect=function(){this.connected=!0,this.disconnected=!1,this.emit("connect"),this.emitBuffered()},n.prototype.emitBuffered=function(){var t;for(t=0;t<this.receiveBuffer.length;t++)l.apply(this,this.receiveBuffer[t]);for(this.receiveBuffer=[],t=0;t<this.sendBuffer.length;t++)this.packet(this.sendBuffer[t]);this.sendBuffer=[]},n.prototype.ondisconnect=function(){c("server disconnect (%s)",this.nsp),this.destroy(),this.onclose("io server disconnect")},n.prototype.destroy=function(){if(this.subs){for(var t=0;t<this.subs.length;t++)this.subs[t].destroy();this.subs=null}this.io.destroy(this)},n.prototype.close=n.prototype.disconnect=function(){return this.connected&&(c("performing disconnect (%s)",this.nsp),this.packet({type:r.DISCONNECT})),this.destroy(),this.connected&&this.onclose("io client disconnect"),this},n.prototype.compress=function(t){return this.flags=this.flags||{},this.flags.compress=t,this}},function(t,e){t.exports=function(t,e,i){return t.on(e,i),{destroy:function(){t.removeListener(e,i)}}}},function(t,e){var i=[].slice;t.exports=function(t,e){if("string"==typeof e&&(e=t[e]),"function"!=typeof e)throw new Error("bind() requires a function");var n=i.call(arguments,2);return function(){return e.apply(t,n.concat(i.call(arguments)))}}},function(t,e,i){"use strict";const n=i(0),r={binary:!0,R:Buffer.from([82]),V:Buffer.from([118]),F:Buffer.from([70]),e:function(t){const e=Buffer.allocUnsafe(33);return e[0]=101,function(t,e,i){Buffer.isBuffer(e)?e.copy(t,i):(n("string"==typeof e),t.write(e,i,"hex"))}(e,t,1),e},ee:function(t){return n(Buffer.isBuffer(t)),n(33===t.length),t.toString("hex",1,33)}};t.exports=r},function(t,e,i){"use strict";function n(t){if(!(this instanceof n))return new n(t);h.call(this),this.miner=t,this.network=this.miner.network,this.logger=this.miner.logger.context("cpuminer"),this.workers=this.miner.workers,this.chain=this.miner.chain,this.locker=new u,this.locker2=new u,this.running=!1,this.stopping=!1,this.own=!1,this.job=null,this.stopJob=null,this._init()}function r(t,e){this.miner=t,this.attempt=e,this.destroyed=!1,this.committed=!1,this.start=o.now(),this.nonce1=0,this.nonce2=0,this.refresh()}const s=i(0),o=i(1),a=i(16),h=i(30),c=i(97),u=i(23);Object.setPrototypeOf(n.prototype,h.prototype),n.INTERVAL=2863311,n.prototype._init=function(){this.chain.on("tip",async t=>{this.job&&this.job.attempt.prevBlock===t.prevBlock&&await this.restart()}),this.workers.on("error",async t=>{this.miner.reset(!0)})},n.prototype._open=async function(){},n.prototype._close=async function(){await this.stop()},n.prototype.start=function(){s(!this.running,"Miner is already running."),this._start().catch(()=>{})},n.prototype._start=async function(){for(s(!this.running,"Miner is already running."),this.running=!0,this.stopping=!1;;){this.job=null;try{this.job=await this.createJob()}catch(t){if(this.stopping)break;this.emit("error",t);break}if(this.stopping)break;let t;try{t=await this.mineAsync(this.job)}catch(t){if(this.stopping)break;this.emit("error",t);break}if(this.stopping)break;if(!t)continue;this.own=!0;let e;try{e=await this.chain.add(t)}catch(t){if(this.stopping)break;if("VerifyError"===t.type){this.logger.warning("Mined an invalid block!"),this.logger.error(t);continue}this.emit("error",t);break}if(e){if(this.stopping)break;this.logger.info("Found block: %d (%s).",e.height,e.rhash()),this.logger.debug("Raw: %s",t.toRaw().toString("hex")),this.emit("block",t,e)}else this.logger.warning("Mined a bad-prevblk (race condition?)")}const t=this.stopJob;t&&(this.stopJob=null,t.resolve())},n.prototype.stop=async function(){const t=await this.locker.lock();try{return await this._stop()}finally{t()}},n.prototype._stop=async function(){this.running&&(s(this.running,"Miner is not running."),s(!this.stopping,"Miner is already stopping."),this.stopping=!0,this.job&&(this.job.destroy(),this.job=null,this.workers.destroy()),await this.wait(),this.running=!1,this.stopping=!1,this.job=null)},n.prototype.restart=async function(){const t=await this.locker2.lock();try{return await this._restart()}finally{t()}},n.prototype._restart=async function(){if(this.own)return this.own=!1,this.job.destroy();await this.stop(),await this.start()},n.prototype.wait=function(){return new Promise((t,e)=>{s(!this.stopJob),this.stopJob=a.job(t,e)})},n.prototype.createJob=async function(t,e){return new r(this,await this.miner.createBlock(t,e))},n.prototype.mineBlock=async function(t,e){const i=await this.createJob(t,e);return await this.mineAsync(i)},n.prototype.notifyEntry=function(){this.running&&this.job&&o.now()-this.job.start>10&&(this.job.destroy(),this.job=null)},n.prototype.findNonce=function(t){const e=t.getHeader(),i=t.attempt.target,r=n.INTERVAL;let s,o=0,a=r;for(;a<=4294967295&&-1===(s=c(e,i,o,a));)this.sendStatus(t,a),o+=r,a+=r;return s},n.prototype.findNonceAsync=async function(t){if(!this.workers)return this.findNonce(t);const e=t.getHeader(),i=t.attempt.target,r=n.INTERVAL;let s,o=0,a=r;for(;a<=4294967295&&-1===(s=await this.workers.mine(e,i,o,a));){if(t.destroyed)return s;this.sendStatus(t,a),o+=r,a+=r}return s},n.prototype.mine=function(t){t.start=o.now();let e;for(;-1===(e=this.findNonce(t));)t.updateNonce(),this.sendStatus(t,0);return t.commit(e)},n.prototype.mineAsync=async function(t){let e;for(t.start=o.now();-1===(e=await this.findNonceAsync(t));){if(t.destroyed)return null;t.updateNonce(),this.sendStatus(t,0)}return t.commit(e)},n.prototype.sendStatus=function(t,e){const i=t.attempt,n=o.revHex(i.prevBlock),r=t.getHashes(e),s=t.getRate(e);this.logger.info("Status: hashrate=%dkhs hashes=%d target=%d height=%d tip=%s",Math.floor(s/1e3),r,i.bits,i.height,n),this.emit("status",t,r,s)},r.prototype.getHeader=function(){const t=this.attempt,e=this.nonce1,i=this.nonce2,n=t.time,r=t.getRoot(e,i);return t.getHeader(r,n,0)},r.prototype.commit=function(t){const e=this.attempt,i=this.nonce1,n=this.nonce2,r=e.time;s(!this.committed,"Job already committed."),this.committed=!0;const o=e.getProof(i,n,r,t);return e.commit(o)},r.prototype.mine=function(){return this.miner.mine(this)},r.prototype.mineAsync=function(){return this.miner.mineAsync(this)},r.prototype.refresh=function(){return this.attempt.refresh()},r.prototype.updateNonce=function(){4294967296==++this.nonce2&&(this.nonce2=0,this.nonce1++)},r.prototype.destroy=function(){s(!this.destroyed,"Job already destroyed."),this.destroyed=!0},r.prototype.getHashes=function(t){return 4294967295*(4294967296*this.nonce1+this.nonce2)+t},r.prototype.getRate=function(t){const e=this.getHashes(t),i=o.now()-this.start;return Math.floor(e/Math.max(1,i))},r.prototype.addTX=function(t,e){return this.attempt.addTX(t,e)},r.prototype.pushTX=function(t,e){return this.attempt.pushTX(t,e)},t.exports=n},function(t,e,i){"use strict";function n(){if(!(this instanceof n))return new n;r.call(this),this._raw=c}const r=i(69),s=i(51),o=i(37),a=i(8),h=i(2),c=Buffer.alloc(0);Object.setPrototypeOf(n.prototype,r.prototype),n.prototype.isMemory=function(){return!0},n.prototype.toHead=function(){return this._raw.slice(0,80)},n.prototype.getSize=function(){return this._raw.length},n.prototype.verifyBody=function(){return!0},n.prototype.getCoinbaseHeight=function(){if(this.version<2)return-1;try{return this.parseCoinbaseHeight()}catch(t){return-1}},n.prototype.parseCoinbaseHeight=function(){const t=new h(this._raw,!0);t.seek(80);if(0===t.readVarint())return-1;t.seek(4);let e=t.readVarint();if(0===e&&0!==t.readU8()&&(e=t.readVarint()),0===e)return-1;t.seek(36);const i=t.readVarBytes();return a.getCoinbaseHeight(i)},n.prototype.fromRaw=function(t){const e=new h(t,!0);return this.readHead(e),this._raw=e.data,this},n.fromRaw=function(t){return(new n).fromRaw(t)},n.prototype.toRaw=function(){return this._raw},n.prototype.toNormal=function(){return this._raw},n.prototype.toBlock=function(){const t=s.fromRaw(this._raw);return t._hash=this._hash,t._hhash=this._hhash,t},n.prototype.toHeaders=function(){return o.fromBlock(this)},n.isMemBlock=function(t){return t instanceof n},t.exports=n},function(t,e,i){"use strict";const n=i(95),r=i(46),s=e;s.getIPv4=async function(){try{const t=(await n({method:"GET",uri:"http://ipv4.icanhazip.com",expect:"txt",timeout:2e3})).body.trim(),e=r.toBuffer(t);if(!r.isIPv4(e))throw new Error("Could not find IPv4.");return r.toString(e)}catch(t){return await s.getIPv42()}},s.getIPv42=async function(){const t=await n({method:"GET",uri:"http://checkip.dyndns.org",expect:"html",timeout:2e3}),e=/IP Address:\s*([0-9a-f.:]+)/i.exec(t.body);if(!e)throw new Error("Could not find IPv4.");const i=e[1],s=r.toBuffer(i);if(!r.isIPv4(s))throw new Error("Could not find IPv4.");return r.toString(s)},s.getIPv6=async function(){const t=(await n({method:"GET",uri:"http://ipv6.icanhazip.com",expect:"txt",timeout:2e3})).body.trim(),e=r.toBuffer(t);if(!r.isIPv6(e))throw new Error("Could not find IPv6.");return r.toString(e)}},function(t,e,i){"use strict";function n(t){if(!(this instanceof n))return new n(t);this.network=s.get(t)}const r=i(0),s=i(6),o=i(5);n.prototype.packet=function(t,e,i){r(e,"No payload."),r(t.length<12),r(e.length<=4294967295);const n=Buffer.allocUnsafe(24+e.length);n.writeUInt32LE(this.network.magic,0,!0),n.write(t,4,"ascii");for(let e=4+t.length;e<16;e++)n[e]=0;return n.writeUInt32LE(e.length,16,!0),i||(i=o.hash256(e)),i.copy(n,20,0,4),e.copy(n,24),n},t.exports=n},function(t,e,i){"use strict";function n(t){if(!(this instanceof n))return new n(t);this.options=new s(t),this.network=this.options.network,this.logger=this.options.logger.context("hostlist"),this.address=this.options.address,this.resolve=this.options.resolve,this.dnsSeeds=[],this.dnsNodes=[],this.map=new Map,this.fresh=[],this.totalFresh=0,this.used=[],this.totalUsed=0,this.nodes=[],this.local=new Map,this.banned=new Map,this.timer=null,this.needsFlush=!1,this._init()}function r(t,e){if(!(this instanceof r))return new r(t,e);this.addr=t||new p,this.src=e||new p,this.prev=null,this.next=null,this.used=!1,this.refCount=0,this.attempts=0,this.lastSuccess=0,this.lastAttempt=0,t&&this.fromOptions(t,e)}function s(t){if(!(this instanceof s))return new s(t);this.network=l.primary,this.logger=b.global,this.resolve=w.lookup,this.host="0.0.0.0",this.port=this.network.port,this.services=g.LOCAL_SERVICES,this.onion=!1,this.banTime=g.BAN_TIME,this.address=new p,this.address.services=this.services,this.address.time=this.network.now(),this.seeds=this.network.seeds,this.nodes=[],this.maxBuckets=20,this.maxEntries=50,this.prefix=null,this.filename=null,this.persistent=!1,this.flushInterval=12e4,t&&this.fromOptions(t)}const o=i(0),a=i(33),h=i(75),c=i(1),u=i(46),f=i(16),l=i(6),p=i(79),d=i(94),m=i(68),g=i(60),y=i(305),w=i(99),b=i(34),v=i(59),k=Buffer.allocUnsafe(32);n.HORIZON_DAYS=30,n.RETRIES=3,n.MIN_FAIL_DAYS=7,n.MAX_FAILURES=10,n.MAX_REFS=8,n.VERSION=0,n.scores={NONE:0,IF:1,BIND:2,UPNP:3,HTTP:3,MANUAL:4,MAX:5},n.prototype._init=function(){const t=this.options,e=n.scores,i=u.getPublic(),r=this.address.port;for(let t=0;t<this.options.maxBuckets;t++)this.fresh.push(new Map);for(let t=0;t<this.options.maxBuckets;t++)this.used.push(new d);this.setSeeds(t.seeds),this.setNodes(t.nodes),this.pushLocal(this.address,e.MANUAL),this.addLocal(t.host,t.port,e.BIND);for(const t of i)this.addLocal(t,r,e.IF)},n.prototype.open=async function(){try{await this.loadFile()}catch(t){this.logger.warning("Hosts deserialization failed."),this.logger.error(t)}0===this.size()&&this.injectSeeds(),await this.discoverNodes(),this.start()},n.prototype.close=async function(){this.stop(),await this.flush(),this.reset()},n.prototype.start=function(){this.options.persistent&&this.options.filename&&(o(null==this.timer),this.timer=f.setInterval(this.flush,this.options.flushInterval,this))},n.prototype.stop=function(){this.options.persistent&&this.options.filename&&(o(null!=this.timer),f.clearInterval(this.timer),this.timer=null)},n.prototype.injectSeeds=function(){const t=y.get(this.network.type);for(const e of t){const t=p.fromHostname(e,this.network);t.isRoutable()&&(!this.options.onion&&t.isOnion()||0!==t.port&&this.add(t))}},n.prototype.loadFile=async function(){const t=this.options.filename;if(v.unsupported)return;if(!this.options.persistent)return;if(!t)return;let e;try{e=await v.readFile(t,"utf8")}catch(t){if("ENOENT"===t.code)return;throw t}const i=JSON.parse(e);this.fromJSON(i)},n.prototype.flush=async function(){const t=this.options.filename;if(v.unsupported)return;if(!this.options.persistent)return;if(!t)return;if(!this.needsFlush)return;this.needsFlush=!1,this.logger.debug("Writing hosts to %s.",t);const e=this.toJSON(),i=JSON.stringify(e);try{await v.writeFile(t,i,"utf8")}catch(t){this.logger.warning("Writing hosts failed."),this.logger.error(t)}},n.prototype.size=function(){return this.totalFresh+this.totalUsed},n.prototype.isFull=function(){const t=this.options.maxBuckets*this.options.maxEntries;return this.size()>=t},n.prototype.reset=function(){this.map.clear();for(const t of this.fresh)t.clear();for(const t of this.used)t.reset();this.totalFresh=0,this.totalUsed=0,this.nodes.length=0},n.prototype.ban=function(t){this.banned.set(t,c.now())},n.prototype.unban=function(t){this.banned.delete(t)},n.prototype.clearBanned=function(){this.banned.clear()},n.prototype.isBanned=function(t){const e=this.banned.get(t);return null!=e&&(!(c.now()>e+this.options.banTime)||(this.banned.delete(t),!1))},n.prototype.getHost=function(){let t=null;if(this.totalFresh>0&&(t=this.fresh),this.totalUsed>0&&(0!==this.totalFresh&&0!==c.random(0,2)||(t=this.used)),!t)return null;const e=this.network.now();let i=1;for(;;){let n=c.random(0,t.length);const r=t[n];if(0===r.size)continue;n=c.random(0,r.size);let s;if(t===this.used)for(s=r.head;n--;)s=s.next;else for(s of r.values()){if(0===n)break;n--}if(c.random(0,1<<30)<i*s.chance(e)*(1<<30))return s;i*=1.2}},n.prototype.freshBucket=function(t){const e=t.addr,i=t.src,n=function(t,e){const i=k;return t.copy(i,0),e.copy(i,32),i}(e.raw,i.raw),r=m(n,4221880213)%this.fresh.length;return this.fresh[r]},n.prototype.usedBucket=function(t){const e=t.addr,i=m(e.raw,4221880213)%this.used.length;return this.used[i]},n.prototype.add=function(t,e){o(0!==t.port);let i=this.map.get(t.hostname);if(i){const r=this.network.now();let s=7200,a=86400;if(e||(s=0),i.addr.services|=t.services,i.addr.services>>>=0,r-t.time<86400&&(a=3600),i.addr.time<t.time-a-s&&(i.addr.time=t.time,this.needsFlush=!0),i.addr.time&&t.time<=i.addr.time)return!1;if(i.used)return!1;if(o(i.refCount>0),i.refCount===n.MAX_REFS)return!1;o(i.refCount<n.MAX_REFS);let h=1;for(let t=0;t<i.refCount;t++)h*=2;if(0!==c.random(0,h))return!1}else{if(this.isFull())return!1;e||(e=this.address),i=new r(t,e),this.totalFresh++}const s=this.freshBucket(i);return!s.has(i.key())&&(s.size>=this.options.maxEntries&&this.evictFresh(s),s.set(i.key(),i),i.refCount++,this.map.set(i.key(),i),this.needsFlush=!0,!0)},n.prototype.evictFresh=function(t){let e=null;for(const i of t.values())this.isStale(i)?(t.delete(i.key()),0==--i.refCount&&(this.map.delete(i.key()),this.totalFresh--)):e?i.addr.time<e.addr.time&&(e=i):e=i;e&&(t.delete(e.key()),0==--e.refCount&&(this.map.delete(e.key()),this.totalFresh--))},n.prototype.isStale=function(t){const e=this.network.now();return!(t.lastAttempt&&t.lastAttempt>=e-60)&&(t.addr.time>e+600||(0===t.addr.time||(e-t.addr.time>24*n.HORIZON_DAYS*60*60||(0===t.lastSuccess&&t.attempts>=n.RETRIES||e-t.lastSuccess>24*n.MIN_FAIL_DAYS*60*60&&t.attempts>=n.MAX_FAILURES))))},n.prototype.remove=function(t){const e=this.map.get(t);if(!e)return null;if(e.used){let t=e;for(o(0===e.refCount);t.prev;)t=t.prev;for(const i of this.used)if(i.head===t){i.remove(e),this.totalUsed--,t=null;break}o(!t)}else{for(const t of this.fresh)t.delete(e.key())&&e.refCount--;this.totalFresh--,o(0===e.refCount)}return this.map.delete(e.key()),e.addr},n.prototype.markAttempt=function(t){const e=this.map.get(t),i=this.network.now();e&&(e.attempts++,e.lastAttempt=i)},n.prototype.markSuccess=function(t){const e=this.map.get(t),i=this.network.now();e&&i-e.addr.time>1200&&(e.addr.time=i)},n.prototype.markAck=function(t,e){const i=this.map.get(t);if(!i)return;const n=this.network.now();if(i.addr.services|=e,i.addr.services>>>=0,i.lastSuccess=n,i.lastAttempt=n,i.attempts=0,i.used)return;o(i.refCount>0);let r;for(const t of this.fresh)t.delete(i.key())&&(i.refCount--,r=t);o(r),o(0===i.refCount),this.totalFresh--;const s=this.usedBucket(i);if(s.size<this.options.maxEntries)return i.used=!0,s.push(i),void this.totalUsed++;const a=this.evictUsed(s);let h=this.freshBucket(a);h.size>=this.options.maxEntries&&(h=r),i.used=!0,s.replace(a,i),a.used=!1,h.set(a.key(),a),o(0===a.refCount),a.refCount++,this.totalFresh++},n.prototype.evictUsed=function(t){let e=t.head;for(let i=t.head;i;i=i.next)i.addr.time<e.addr.time&&(e=i);return e},n.prototype.toArray=function(){const t=[];for(const e of this.map.values())t.push(e.addr);return o.strictEqual(t.length,this.size()),t},n.prototype.addSeed=function(t){const e=u.fromHostname(t,this.network.port);if(e.type===u.types.DNS)return this.dnsSeeds.push(e),null;const i=p.fromHost(e.host,e.port,this.network);return this.add(i),i},n.prototype.addNode=function(t){const e=u.fromHostname(t,this.network.port);if(e.type===u.types.DNS)return this.dnsNodes.push(e),null;const i=p.fromHost(e.host,e.port,this.network);return this.nodes.push(i),this.add(i),i},n.prototype.removeNode=function(t){const e=u.fromHostname(t,this.network.port);for(let t=0;t<this.nodes.length;t++){const i=this.nodes[t];if(i.host===e.host&&i.port===e.port)return this.nodes.splice(t,1),!0}return!1},n.prototype.setSeeds=function(t){this.dnsSeeds.length=0;for(const e of t)this.addSeed(e)},n.prototype.setNodes=async function(t){this.dnsNodes.length=0,this.nodes.length=0;const e=await this.setRemoteSeeds();t=t.concat(e);for(const e of t)this.addNode(e)},n.prototype.setRemoteSeeds=function(){const t={host:"worldmobilecoin.network",path:"/seeds.php"};return new Promise((e,i)=>{h.get(t,t=>{const i=[];t.on("data",t=>{i.push(t)}),t.on("end",()=>{e(i.join("").split(";"))})}).on("error",e=>{this.logger.debug("Unable to get seeds list from %s: (%s)",t.host,e)})}).catch(e=>{this.logger.debug("Unable to get seeds list from %s: (%s)",t.host,e)})},n.prototype.addLocal=function(t,e,i){const n=p.fromHost(t,e,this.network);return n.services=this.options.services,this.pushLocal(n,i)},n.prototype.pushLocal=function(t,e){if(!t.isRoutable())return!1;if(this.local.has(t.hostname))return!1;const i=new function(t,e){this.addr=t,this.score=e||0}(t,e);return this.local.set(t.hostname,i),!0},n.prototype.getLocal=function(t){let e=-1,i=-1,n=null;if(t||(t=this.address),0===this.local.size)return null;for(const r of this.local.values()){const s=t.getReachability(r.addr);s<e||(s>e||r.score>i)&&(e=s,i=r.score,n=r.addr)}return n.time=this.network.now(),n},n.prototype.markLocal=function(t){const e=this.local.get(t.hostname);return!!e&&(e.score++,!0)},n.prototype.discoverSeeds=async function(){const t=[];for(const e of this.dnsSeeds)t.push(this.populateSeed(e));await Promise.all(t)},n.prototype.discoverNodes=async function(){const t=[];for(const e of this.dnsNodes)t.push(this.populateNode(e));await Promise.all(t)},n.prototype.populateNode=async function(t){const e=await this.populate(t);0!==e.length&&(this.nodes.push(e[0]),this.add(e[0]))},n.prototype.populateSeed=async function(t){const e=await this.populate(t);for(const t of e)this.add(t)},n.prototype.populate=async function(t){const e=[];o(t.type===u.types.DNS,"Resolved host passed."),this.logger.info("Resolving host: %s.",t.host);let i;try{i=await this.resolve(t.host)}catch(t){return this.logger.error(t),e}for(const n of i){const i=p.fromHost(n,t.port,this.network);e.push(i)}return e},n.prototype.toJSON=function(){const t=[],e=[],i=[];for(const e of this.map.values())t.push(e.toJSON());for(const t of this.fresh){const i=[];for(const e of t.keys())i.push(e);e.push(i)}for(const t of this.used){const e=[];for(let i=t.head;i;i=i.next)e.push(i.key());i.push(e)}return{version:n.VERSION,addrs:t,fresh:e,used:i}},n.prototype.fromJSON=function(t){const e=new Map,i=new Map;let s=0,a=0;const h=[],c=[];o(t&&"object"==typeof t),o(t.version===n.VERSION,"Bad address serialization version."),o(Array.isArray(t.addrs));for(const n of t.addrs){const t=r.fromJSON(n,this.network);let s=e.get(t.src.hostname);s||(s=t.src,e.set(s.hostname,s)),t.src=s,i.set(t.key(),t)}o(Array.isArray(t.fresh)),o(t.fresh.length<=this.options.maxBuckets,"Buckets mismatch.");for(const e of t.fresh){const t=new Map;for(const n of e){const e=i.get(n);o(e),0===e.refCount&&s++,e.refCount++,t.set(n,e)}o(t.size<=this.options.maxEntries,"Bucket size mismatch."),h.push(t)}o(h.length===this.fresh.length,"Buckets mismatch."),o(Array.isArray(t.used)),o(t.used.length<=this.options.maxBuckets,"Buckets mismatch.");for(const e of t.used){const t=new d;for(const n of e){const e=i.get(n);o(e),o(0===e.refCount),o(!e.used),e.used=!0,a++,t.push(e)}o(t.size<=this.options.maxEntries,"Bucket size mismatch."),c.push(t)}o(c.length===this.used.length,"Buckets mismatch.");for(const t of i.values())o(t.used||t.refCount>0);return this.map=i,this.fresh=h,this.totalFresh=s,this.used=c,this.totalUsed=a,this},n.fromJSON=function(t,e){return new r(t).fromJSON(e)},r.prototype.fromOptions=function(t,e){return o(t instanceof p),o(e instanceof p),this.addr=t,this.src=e,this},r.fromOptions=function(t,e){return(new r).fromOptions(t,e)},r.prototype.key=function(){return this.addr.hostname},r.prototype.chance=function(t){let e=1;return t-this.lastAttempt<600&&(e*=.01),e*=Math.pow(.66,Math.min(this.attempts,8))},r.prototype.inspect=function(){return{addr:this.addr,src:this.src,used:this.used,refCount:this.refCount,attempts:this.attempts,lastSuccess:c.date(this.lastSuccess),lastAttempt:c.date(this.lastAttempt)}},r.prototype.toJSON=function(){return{addr:this.addr.hostname,src:this.src.hostname,services:this.addr.services.toString(2),time:this.addr.time,attempts:this.attempts,lastSuccess:this.lastSuccess,lastAttempt:this.lastAttempt}},r.prototype.fromJSON=function(t,e){if(o(t&&"object"==typeof t),o("string"==typeof t.addr),o("string"==typeof t.src),this.addr.fromHostname(t.addr,e),null!=t.services){o("string"==typeof t.services),o(t.services.length>0),o(t.services.length<=32);const e=parseInt(t.services,2);o(c.isU32(e)),this.addr.services=e}return null!=t.time&&(o(c.isU64(t.time)),this.addr.time=t.time),null!=t.src&&(o("string"==typeof t.src),this.src.fromHostname(t.src,e)),null!=t.attempts&&(o(c.isU64(t.attempts)),this.attempts=t.attempts),null!=t.lastSuccess&&(o(c.isU64(t.lastSuccess)),this.lastSuccess=t.lastSuccess),null!=t.lastAttempt&&(o(c.isU64(t.lastAttempt)),this.lastAttempt=t.lastAttempt),this},r.fromJSON=function(t,e){return(new r).fromJSON(t,e)},s.prototype.fromOptions=function(t){if(o(t,"Options are required."),null!=t.network&&(this.network=l.get(t.network),this.seeds=this.network.seeds,this.address.port=this.network.port,this.port=this.network.port),null!=t.logger&&(o("object"==typeof t.logger),this.logger=t.logger),null!=t.resolve&&(o("function"==typeof t.resolve),this.resolve=t.resolve),null!=t.banTime&&(o(t.banTime>=0),this.banTime=t.banTime),t.seeds&&(o(Array.isArray(t.seeds)),this.seeds=t.seeds),t.nodes&&(o(Array.isArray(t.nodes)),this.nodes=t.nodes),null!=t.host){o("string"==typeof t.host);const e=u.toBuffer(t.host);this.host=u.toString(e),u.isRoutable(e)&&this.address.setHost(this.host)}return null!=t.port&&(o("number"==typeof t.port),o(t.port>0&&t.port<=65535),this.port=t.port,this.address.setPort(this.port)),null!=t.publicHost&&(o("string"==typeof t.publicHost),this.address.setHost(t.publicHost)),null!=t.publicPort&&(o("number"==typeof t.publicPort),o(t.publicPort>0&&t.publicPort<=65535),this.address.setPort(t.publicPort)),null!=t.services&&(o("number"==typeof t.services),this.services=t.services),null!=t.onion&&(o("boolean"==typeof t.onion),this.onion=t.onion),null!=t.maxBuckets&&(o("number"==typeof t.maxBuckets),this.maxBuckets=t.maxBuckets),null!=t.maxEntries&&(o("number"==typeof t.maxEntries),this.maxEntries=t.maxEntries),null!=t.persistent&&(o("boolean"==typeof t.persistent),this.persistent=t.persistent),null!=t.prefix&&(o("string"==typeof t.prefix),this.prefix=t.prefix,this.filename=a.join(this.prefix,"hosts.json")),null!=t.filename&&(o("string"==typeof t.filename),this.filename=t.filename),null!=t.flushInterval&&(o(t.flushInterval>=0),this.flushInterval=t.flushInterval),this.address.time=this.network.now(),this.address.services=this.services,this},t.exports=n},function(t,e,i){"use strict";function n(t){if(!(this instanceof n))return new n(t);s.call(this),this.network=o.get(t),this.pending=[],this.total=0,this.waiting=24,this.header=null}const r=i(0),s=i(10),o=i(6),a=i(1),h=i(5),c=i(60),u=i(61);Object.setPrototypeOf(n.prototype,s.prototype),n.prototype.error=function(){const t=a.fmt.apply(a,arguments);this.emit("error",new Error(t))},n.prototype.feed=function(t){for(this.total+=t.length,this.pending.push(t);this.total>=this.waiting;){const t=Buffer.allocUnsafe(this.waiting);let e=0;for(;e<t.length;){const i=this.pending[0].copy(t,e);i===this.pending[0].length?this.pending.shift():this.pending[0]=this.pending[0].slice(i),e+=i}r.strictEqual(e,t.length),this.total-=t.length,this.parse(t)}},n.prototype.parse=function(t){if(r(t.length<=c.MAX_MESSAGE),!this.header)return void(this.header=this.parseHeader(t));const e=h.hash256(t).readUInt32LE(0,!0);if(e!==this.header.checksum)return this.waiting=24,this.header=null,void this.error("Invalid checksum: %s.",a.hex32(e));let i;try{i=this.parsePayload(this.header.cmd,t)}catch(t){return this.waiting=24,this.header=null,void this.emit("error",t)}this.waiting=24,this.header=null,this.emit("packet",i)},n.prototype.parseHeader=function(t){const e=t.readUInt32LE(0,!0);if(e!==this.network.magic)return this.error("Invalid magic value: %s.",a.hex32(e)),null;let i=0;for(;0!==t[i+4]&&i<12;i++);if(12===i)return this.error("Non NULL-terminated command."),null;const n=t.toString("ascii",4,4+i),r=t.readUInt32LE(16,!0);if(r>c.MAX_MESSAGE)return this.waiting=24,this.error("Packet length too large: %dmb.",a.mb(r)),null;this.waiting=r;return new function(t,e,i){this.cmd=t,this.size=e,this.checksum=i}(n,r,t.readUInt32LE(20,!0))},n.prototype.parsePayload=function(t,e){return u.fromRaw(t,e)},t.exports=n},function(t,e,i){"use strict";function n(t,e,i){if(!(this instanceof n))return new n(t,e,i);this.host=t||"239.255.255.250",this.port=e||1900,this.gateway=i||n.INTERNET_GATEWAY,this.locker=new d,this.timeout=null,this.job=null}function r(t){if(!(this instanceof r))return new r(t);this.serviceType=t.serviceType,this.serviceId=t.serviceId,this.controlURL=t.controlURL,this.eventSubURL=t.eventSubURL,this.SCPDURL=t.SCPDURL}function s(t){this.name=t,this.type=t.replace(/^[^:]:/,""),this.children=[],this.text=""}function o(t){const e=t.collect("service"),i=[];for(const t of e)i.push(function(t){const e=Object.create(null);for(const i of t.children)i.children.length>0||(e[i.type]=i.text);return e}(t));return i}function a(t,e){for(const i of t)if(i.serviceType===e)return i;return null}function h(t,e){return-1===e.indexOf("://")&&("/"!==e[0]&&(e="/"+e),e=t+e),e}const c=i(0),u=i(308),f=i(73),l=i(95),p=i(16),d=i(23),m=i(46);n.INTERNET_GATEWAY="urn:schemas-upnp-org:device:InternetGatewayDevice:1",n.WAN_SERVICES=["urn:schemas-upnp-org:service:WANIPConnection:1","urn:schemas-upnp-org:service:WANPPPConnection:1"],n.RESPONSE_TIMEOUT=1e3,n.prototype.cleanupJob=function(){const t=this.job;return c(this.socket),c(this.job),this.job=null,this.socket.close(),this.socket=null,this.stopTimeout(),t},n.prototype.rejectJob=function(t){this.cleanupJob().reject(t)},n.prototype.resolveJob=function(t){this.cleanupJob().resolve(t)},n.prototype.startTimeout=function(){this.stopTimeout(),this.timeout=setTimeout(()=>{this.timeout=null,this.rejectJob(new Error("Request timed out."))},n.RESPONSE_TIMEOUT)},n.prototype.stopTimeout=function(){null!=this.timeout&&(clearTimeout(this.timeout),this.timeout=null)},n.prototype.discover=async function(){const t=await this.locker.lock();try{return await this._discover()}finally{t()}},n.prototype._discover=async function(){const t=u.createSocket("udp4");t.on("error",t=>{this.rejectJob(t)}),t.on("message",(t,e)=>{const i=t.toString("utf8");this.handleMsg(i)}),this.socket=t,this.startTimeout();const e="M-SEARCH * HTTP/1.1\r\n"+`HOST: ${this.host}:${this.port}\r\n`+"MAN: ssdp:discover\r\nMX: 10\r\nST: ssdp:all\r\n";return t.send(e,this.port,this.host),await new Promise((t,e)=>{this.job=p.job(t,e)})},n.prototype.handleMsg=async function(t){if(!this.socket)return;let e;try{e=n.parseHeader(t)}catch(t){return}e.location&&e.st===this.gateway&&this.resolveJob(e.location)},n.prototype.resolve=async function(t,e){const i=function(t){const{protocol:e,host:i}=f.parse(t);return c("http:"===e||"https:"===e,"Bad URL for location."),`${e}//${i}`}(t);e||(e=n.WAN_SERVICES);const r=await l({method:"GET",uri:t,timeout:n.RESPONSE_TIMEOUT,expect:"xml"}),u=o(s.fromRaw(r.body));c(u.length>0,"No services found.");const p=function(t,e){for(const i of e){const e=a(t,i);if(e)return e}return null}(u,e);return c(p,"No service found."),c(p.serviceId,"No service ID found."),c(p.serviceId.length>0,"No service ID found."),c(p.controlURL,"No control URL found."),c(p.controlURL.length>0,"No control URL found."),p.controlURL=h(i,p.controlURL),p.eventSubURL&&(p.eventSubURL=h(i,p.eventSubURL)),p.SCPDURL&&(p.SCPDURL=h(i,p.SCPDURL)),p},n.parseHeader=function(t){const e=t.split(/\r?\n/),i=Object.create(null);for(let t of e){if(0===(t=t.trim()).length)continue;const e=t.indexOf(":");if(-1===e){i[t.toLowerCase()]="";continue}let n=t.substring(0,e),r=t.substring(e+1);n=n.trim(),r=r.trim(),i[n=n.toLowerCase()]=r}return i},n.discover=async function(t,e,i,s){const o=new n(t,e,i),a=await o.discover();return new r(await o.resolve(a,s))},r.prototype.createRequest=function(t,e){const i=JSON.stringify(this.serviceType);let n="";for(const[t,i]of e)n+=`<${t}>`,null!=i&&(n+=i),n+=`</${t}>`;return'<?xml version="1.0"?><s:Envelope xmlns:s="http://schemas.xmlsoap.org/soap/envelope/" s:encodingStyle="http://schemas.xmlsoap.org/soap/encoding/"><s:Body>'+`<u:${t} xmlns:u=${i}>`+`${n}`+`</u:${t}>`+"</s:Body></s:Envelope>"},r.prototype.soapRequest=async function(t,e){const i=this.serviceType,r=this.createRequest(t,e),o=await l({method:"POST",uri:this.controlURL,timeout:n.RESPONSE_TIMEOUT,expect:"xml",headers:{"Content-Type":'text/xml; charset="utf-8"',"Content-Length":Buffer.byteLength(r,"utf8").toString(10),Connection:"close",SOAPAction:JSON.stringify(`${i}#${t}`)},body:r}),a=s.fromRaw(o.body),h=function(t){const e=t.find("UPnPError");if(!e)return null;let i=-1;const n=e.find("errorCode");n&&/^\d+$/.test(n.text)&&(i=parseInt(n.text,10));let r="Unknown";const s=e.find("errorDescription");return s&&(r=s.text),new Error(`UPnPError: ${r} (${i}).`)}(a);if(h)throw h;return a},r.prototype.getExternalIP=async function(){const t=function(t){const e=t.find("NewExternalIPAddress");return e?m.normalize(e.text):null}(await this.soapRequest("GetExternalIPAddress",[]));if(!t)throw new Error("Could not find external IP.");return t},r.prototype.addPortMapping=async function(t,e,i){const n=m.getPrivate();if(0===n.length)throw new Error("Cannot determine local IP.");const r=(await this.soapRequest("AddPortMapping",[["NewRemoteHost",t],["NewExternalPort",e],["NewProtocol","TCP"],["NewInternalClient",n[0]],["NewInternalPort",i],["NewEnabled","True"],["NewPortMappingDescription","upnp:wmcc"],["NewLeaseDuration",0]])).find("AddPortMappingResponse");if(!r)throw new Error("Port mapping failed.");return r.text},r.prototype.removePortMapping=async function(t,e){const i=(await this.soapRequest("DeletePortMapping",[["NewRemoteHost",t],["NewExternalPort",e],["NewProtocol","TCP"]])).find("DeletePortMappingResponse");if(!i)throw new Error("Port unmapping failed.");return i.text},s.fromRaw=function(t){const e=new s(""),i=[e];let n=e,r=!1;for(;t.length>0;){let o;if(o=/^<\?xml[^<>]*\?>/i.exec(t))t=t.substring(o[0].length),c(n===e,"XML declaration inside element."),c(!r,"XML declaration seen twice."),r=!0;else if(o=/^<([\w:]+)[^<>]*?(\/?)>/i.exec(t)){t=t.substring(o[0].length);const e=o[1],r="/"===o[2],a=new s(e);if(r){n.add(a);continue}i.push(a),n.add(a),n=a}else if(o=/^<\/([\w:]+)[^<>]*>/i.exec(t)){t=t.substring(o[0].length);const r=o[1];c(1!==i.length,"No start tag.");const s=i.pop();if(c(s.name===r,"Tag mismatch."),(n=i[i.length-1])===e)break}else{if(!(o=/^([^<]+)/i.exec(t)))throw new Error("XML parse error.");{t=t.substring(o[0].length);const e=o[1];n.text=e.trim()}}}return c(e.children.length>0,"No root element."),e.children[0]},s.prototype.add=function(t){return this.children.push(t)},s.prototype.collect=function(t){return this._collect(t,[])},s.prototype._collect=function(t,e){for(const i of this.children)i.type!==t?i._collect(t,e):e.push(i);return e},s.prototype.find=function(t){for(const e of this.children){if(e.type===t)return e;const i=e.find(t);if(i)return i}return null},t.exports=n},function(t,e,i){"use strict";function n(t){if(!(this instanceof n))return new n(t);f.call(this,t),this.spv=!1,this.chain=new r({network:this.network,logger:this.logger,workers:this.workers,db:this.config.str("db"),prefix:this.config.prefix,maxFiles:this.config.uint("max-files"),cacheSize:this.config.mb("cache-size"),forceFlags:this.config.bool("force-flags"),bip91:this.config.bool("bip91"),bip148:this.config.bool("bip148"),prune:this.config.bool("prune"),checkpoints:this.config.bool("checkpoints"),coinCache:this.config.mb("coin-cache"),entryCache:this.config.uint("entry-cache"),indexTX:this.config.bool("index-tx"),indexAddress:this.config.bool("index-address")}),this.fees=new s(this.logger),this.fees.init(),this.mempool=new o({network:this.network,logger:this.logger,workers:this.workers,chain:this.chain,fees:this.fees,db:this.config.str("db"),prefix:this.config.prefix,persistent:this.config.bool("persistent-mempool"),maxSize:this.config.mb("mempool-size"),limitFree:this.config.bool("limit-free"),limitFreeRelay:this.config.uint("limit-free-relay"),requireStandard:this.config.bool("require-standard"),rejectAbsurdFees:this.config.bool("reject-absurd-fees"),replaceByFee:this.config.bool("replace-by-fee"),indexAddress:this.config.bool("index-address")}),this.pool=new a({network:this.network,logger:this.logger,chain:this.chain,mempool:this.mempool,prefix:this.config.prefix,selfish:this.config.bool("selfish"),compact:this.config.bool("compact"),bip37:this.config.bool("bip37"),bip151:this.config.bool("bip151"),bip150:this.config.bool("bip150"),identityKey:this.config.buf("identity-key"),maxOutbound:this.config.uint("max-outbound"),maxInbound:this.config.uint("max-inbound"),proxy:this.config.str("proxy"),onion:this.config.bool("onion"),upnp:this.config.bool("upnp"),seeds:this.config.array("seeds"),nodes:this.config.array("nodes"),only:this.config.array("only"),publicHost:this.config.str("public-host"),publicPort:this.config.uint("public-port"),host:this.config.str("host"),port:this.config.uint("port"),listen:this.config.bool("listen"),persistent:this.config.bool("persistent")}),this.miner=new h({network:this.network,logger:this.logger,workers:this.workers,chain:this.chain,mempool:this.mempool,address:this.config.array("coinbase-address"),coinbaseFlags:this.config.str("coinbase-flags"),preverify:this.config.bool("preverify"),maxWeight:this.config.uint("max-weight"),reservedWeight:this.config.uint("reserved-weight"),reservedSigops:this.config.uint("reserved-sigops")}),this.rpc=new u(this),c.unsupported||(this.http=new c({network:this.network,logger:this.logger,node:this,prefix:this.config.prefix,ssl:this.config.bool("ssl"),keyFile:this.config.path("ssl-key"),certFile:this.config.path("ssl-cert"),host:this.config.str("http-host"),port:this.config.uint("http-port"),apiKey:this.config.str("api-key"),noAuth:this.config.bool("no-auth")})),this._init()}const r=i(105),s=i(117),o=i(178),a=i(122),h=i(181),c=i(176),u=i(115),f=i(185);Object.setPrototypeOf(n.prototype,f.prototype),n.prototype._init=function(){this.chain.on("error",t=>this.error(t)),this.mempool.on("error",t=>this.error(t)),this.pool.on("error",t=>this.error(t)),this.miner.on("error",t=>this.error(t)),this.http&&this.http.on("error",t=>this.error(t)),this.mempool.on("tx",t=>{this.miner.cpu.notifyEntry(),this.emit("tx",t)}),this.chain.hook("connect",async(t,e)=>{try{await this.mempool._addBlock(t,e.txs)}catch(t){this.error(t)}this.emit("block",e),this.emit("connect",t,e)}),this.chain.hook("disconnect",async(t,e)=>{try{await this.mempool._removeBlock(t,e.txs)}catch(t){this.error(t)}this.emit("disconnect",t,e)}),this.chain.hook("reorganize",async(t,e)=>{try{await this.mempool._handleReorg()}catch(t){this.error(t)}this.emit("reorganize",t,e)}),this.chain.hook("reset",async t=>{try{await this.mempool._reset()}catch(t){this.error(t)}this.emit("reset",t)}),this.loadPlugins()},n.prototype._open=async function(){await this.chain.open(),await this.mempool.open(),await this.miner.open(),await this.pool.open(),await this.openPlugins(),this.http&&await this.http.open(),this.logger.info("Node is loaded.")},n.prototype._close=async function(){this.http&&await this.http.close(),await this.closePlugins(),await this.pool.close(),await this.miner.close(),await this.mempool.close(),await this.chain.close(),this.logger.info("Node is closed.")},n.prototype.scan=function(t,e,i){return this.chain.scan(t,e,i)},n.prototype.broadcast=async function(t){try{await this.pool.broadcast(t)}catch(t){this.emit("error",t)}},n.prototype.sendTX=async function(t){let e;try{e=await this.mempool.addTX(t)}catch(e){if("VerifyError"===e.type&&0===e.score)return this.error(e),this.logger.warning("Verification failed for tx: %s.",t.txid()),this.logger.warning("Attempting to broadcast anyway..."),void this.broadcast(t);throw e}if(e)return this.logger.warning("TX was orphaned in mempool: %s.",t.txid()),this.logger.warning("Attempting to broadcast anyway..."),void this.broadcast(t);this.pool.options.selfish&&this.pool.broadcast(t)},n.prototype.relay=async function(t){try{await this.sendTX(t)}catch(t){this.error(t)}},n.prototype.connect=function(){return this.pool.connect()},n.prototype.disconnect=function(){return this.pool.disconnect()},n.prototype.startSync=function(){return this.pool.startSync()},n.prototype.stopSync=function(){return this.pool.stopSync()},n.prototype.getBlock=function(t){return this.chain.getBlock(t)},n.prototype.getCoin=async function(t,e){const i=this.mempool.getCoin(t,e);return i||(this.mempool.isSpent(t,e)?null:await this.chain.getCoin(t,e))},n.prototype.getCoinsByAddress=async function(t){const e=this.mempool.getCoinsByAddress(t),i=await this.chain.getCoinsByAddress(t),n=[];for(const t of i){this.mempool.isSpent(t.hash,t.index)||n.push(t)}for(const t of e)n.push(t);return n},n.prototype.getMetaByAddress=async function(t){const e=this.mempool.getMetaByAddress(t);return(await this.chain.getMetaByAddress(t)).concat(e)},n.prototype.getMeta=async function(t){const e=this.mempool.getMeta(t);return e||await this.chain.getMeta(t)},n.prototype.getMetaView=async function(t){return-1===t.height?this.mempool.getSpentView(t.tx):this.chain.getSpentView(t.tx)},n.prototype.getTXByAddress=async function(t){const e=await this.getMetaByAddress(t),i=[];for(const t of e)i.push(t.tx);return i},n.prototype.getTX=async function(t){const e=await this.getMeta(t);return e?e.tx:null},n.prototype.hasTX=async function(t){return!!this.mempool.hasEntry(t)||await this.chain.hasTX(t)},t.exports=n},function(t,e,i){"use strict";function n(t){if(!(this instanceof n))return new n(t);c.call(this,t),this.spv=!0,this.chain=new s({network:this.network,logger:this.logger,db:this.config.str("db"),prefix:this.config.prefix,maxFiles:this.config.uint("max-files"),cacheSize:this.config.mb("cache-size"),entryCache:this.config.uint("entry-cache"),forceFlags:this.config.bool("force-flags"),checkpoints:this.config.bool("checkpoints"),bip91:this.config.bool("bip91"),bip148:this.config.bool("bip148"),spv:!0}),this.pool=new o({network:this.network,logger:this.logger,chain:this.chain,prefix:this.config.prefix,proxy:this.config.str("proxy"),onion:this.config.bool("onion"),upnp:this.config.bool("upnp"),seeds:this.config.array("seeds"),nodes:this.config.array("nodes"),only:this.config.array("only"),bip151:this.config.bool("bip151"),bip150:this.config.bool("bip150"),identityKey:this.config.buf("identity-key"),maxOutbound:this.config.uint("max-outbound"),persistent:this.config.bool("persistent"),selfish:!0,listen:!1}),this.rpc=new h(this),a.unsupported||(this.http=new a({network:this.network,logger:this.logger,node:this,prefix:this.config.prefix,ssl:this.config.bool("ssl"),keyFile:this.config.path("ssl-key"),certFile:this.config.path("ssl-cert"),host:this.config.str("http-host"),port:this.config.uint("http-port"),apiKey:this.config.str("api-key"),noAuth:this.config.bool("no-auth")})),this.rescanJob=null,this.scanLock=new r,this.watchLock=new r,this._init()}const r=i(23),s=i(105),o=i(122),a=i(176),h=i(115),c=i(185);Object.setPrototypeOf(n.prototype,c.prototype),n.prototype._init=function(){this.chain.on("error",t=>this.error(t)),this.pool.on("error",t=>this.error(t)),this.http&&this.http.on("error",t=>this.error(t)),this.pool.on("tx",t=>{this.rescanJob||this.emit("tx",t)}),this.chain.on("block",t=>{this.emit("block",t)}),this.chain.on("connect",async(t,e)=>{if(this.rescanJob)try{await this.watchBlock(t,e)}catch(t){this.error(t)}else this.emit("connect",t,e)}),this.chain.on("disconnect",(t,e)=>{this.emit("disconnect",t,e)}),this.chain.on("reorganize",(t,e)=>{this.emit("reorganize",t,e)}),this.chain.on("reset",t=>{this.emit("reset",t)}),this.loadPlugins()},n.prototype._open=async function(t){await this.chain.open(),await this.pool.open(),await this.openPlugins(),this.http&&await this.http.open(),this.logger.info("Node is loaded.")},n.prototype._close=async function(){this.http&&await this.http.close(),await this.closePlugins(),await this.pool.close(),await this.chain.close()},n.prototype.scan=async function(t,e,i){const n=await this.scanLock.lock();this.chain.height;try{await this.chain.replay(t),this.chain.height}finally{n()}},n.prototype.watchUntil=function(t,e){return new Promise((i,n)=>{this.rescanJob=new function(t,e,i,n){this.resolve=t,this.reject=e,this.height=i,this.iter=n}(i,n,t,e)})},n.prototype.watchBlock=async function(t,e){const i=await this.watchLock.lock();try{if(t.height<this.rescanJob.height)return void await this.rescanJob.iter(t,e.txs);this.rescanJob.resolve(),this.rescanJob=null}catch(t){this.rescanJob.reject(t),this.rescanJob=null}finally{i()}},n.prototype.broadcast=async function(t){try{await this.pool.broadcast(t)}catch(t){this.emit("error",t)}},n.prototype.sendTX=function(t){return this.broadcast(t)},n.prototype.relay=function(t){return this.broadcast(t)},n.prototype.connect=function(){return this.pool.connect()},n.prototype.disconnect=function(){return this.pool.disconnect()},n.prototype.startSync=function(){return this.pool.startSync()},n.prototype.stopSync=function(){return this.pool.stopSync()},t.exports=n},function(t,e,i){"use strict";function n(t){if(!(this instanceof n))return new n(t);null==t&&(t=1e4),s(o.isU32(t)),this.size=t,this.keys=[],this.valid=new Map}function r(t,e){this.sig=Buffer.from(t),this.key=Buffer.from(e)}const s=i(0),o=i(1),a=i(12);n.prototype.resize=function(t){s(o.isU32(t)),this.size=t,this.keys.length=0,this.valid.clear()},n.prototype.add=function(t,e,i){if(0!==this.size)if(this.valid.set(t,new r(e,i)),this.keys.length>=this.size){const e=Math.floor(Math.random()*this.keys.length),i=this.keys[e];this.valid.delete(i),this.keys[e]=t}else this.keys.push(t)},n.prototype.has=function(t,e,i){const n=this.valid.get(t);return!!n&&n.equals(e,i)},n.prototype.verify=function(t,e,i){if(0===this.size)return a.verify(t,e,i);const n=t.toString("hex");if(this.has(n,e,i))return!0;return!!a.verify(t,e,i)&&(this.add(n,e,i),!0)},r.prototype.equals=function(t,e){return this.sig.equals(t)&&this.key.equals(e)},t.exports=n},function(t,e,i){"use strict";function n(t){return"string"==typeof t&&(t.length>=12&&t.length<=21)}function r(t){return"string"==typeof t&&(t.length>0&&t.length<=100)}function s(t){return"string"==typeof t&&(t.length>0&&t.length<=255)}function o(t){return"string"==typeof t&&t.length%2==0&&/^[0-9A-Fa-f]+$/.test(t)}function a(t){switch(h(t>>>0===t),(t=t.toString(16)).length){case 1:return`0000000${t}`;case 2:return`000000${t}`;case 3:return`00000${t}`;case 4:return`0000${t}`;case 5:return`000${t}`;case 6:return`00${t}`;case 7:return`0${t}`;case 8:return`${t}`;default:throw new Error}}const h=i(0),c=i(33),u=i(116),{StringDecoder:f}=i(167),l=i(10),{format:p}=i(54),{Lock:d}=i(315),m=i(316),g=i(317),y=i(318),w=i(319),b=i(320).hash256,v=i(52),k=i(1),S=i(7),E=i(94),R=i(6),x=i(180),_=4;class I extends l{constructor(t){super(),this.options=new class{constructor(t){this.node=null,this.chain=null,this.logger=y.global,this.network=R.primary,this.host="0.0.0.0",this.port=6880,this.publicHost="127.0.0.1",this.publicPort=6880,this.maxInbound=50,this.difficulty=1,this.dynamic=!0,this.prefix=c.resolve(u.homedir(),".wmcc","stratum"),this.password=null,this.notify=60,this.fromOptions(t)}fromOptions(t){return h(t,"Options are required."),h(t.node&&"object"==typeof t.node,"Node is required."),this.node=t.node,this.chain=this.node.chain,this.network=this.node.network,this.logger=this.node.logger,this.prefix=this.node.location("stratum"),null!=t.host&&(h("string"==typeof t.host),this.host=t.host),null!=t.port&&(h("number"==typeof t.port),this.port=t.port),null!=t.publicHost&&(h("string"==typeof t.publicHost),this.publicHost=t.publicHost),null!=t.publicPort&&(h("number"==typeof t.publicPort),this.publicPort=t.publicPort),null!=t.maxInbound&&(h("number"==typeof t.maxInbound),this.maxInbound=t.maxInbound),null!=t.difficulty&&(h("number"==typeof t.difficulty),this.difficulty=t.difficulty),null!=t.dynamic&&(h("boolean"==typeof t.dynamic),this.dynamic=t.dynamic),null!=t.password&&(h(s(t.password)),this.password=b(Buffer.from(t.password,"utf8"))),null!=t.notify&&(h("number"==typeof t.notify),this.notify=t.notify),this}static fromOptions(t){return(new this).fromOptions(t)}}(t),this.node=this.options.node,this.chain=this.options.chain,this.network=this.options.network,this.logger=this.options.logger.context("stratum"),this.difficulty=this.options.difficulty,this.server=m.createServer(),this.sharedb=new class{constructor(t){this.network=t.network,this.logger=t.logger,this.location=c.resolve(t.prefix,"shares"),this.map=Object.create(null),this.total=0,this.size=0}async open(){await w.mkdirp(this.location)}async close(){}file(t){const e=t.height+"-"+t.rhash();return c.resolve(this.location,e+".json")}add(t,e){this.map[t]||(this.map[t]=0,this.size++),this.map[t]+=e,this.total+=e}clear(){this.map=Object.create(null),this.size=0,this.total=0}async commit(t,e){const i=e.txs[0],n=i.outputs[0].getAddress();h(n);const r={network:this.network.type,height:t.height,block:e.rhash(),ts:e.time,time:k.now(),txid:i.txid(),address:n.toBase58(this.network),reward:i.getOutputValue(),size:this.size,total:this.total,shares:this.map};this.clear();const s=this.file(t),o=JSON.stringify(r,null,2);this.logger.info("Committing %d payouts to disk for block %d (file=%s).",r.size,t.height,s),await w.writeFile(s,o)}}(this.options),this.userdb=new class{constructor(t){this.network=t.network,this.logger=t.logger,this.location=c.resolve(t.prefix,"users.json"),this.locker=new d,this.lastFail=0,this.stream=null,this.map=new Map,this.size=0}async open(){const t=await this.locker.lock();try{return await this._open()}finally{t()}}async _open(){await this.load()}async close(){const t=await this.locker.lock();try{return await this._close()}finally{t()}}async _close(){if(this.stream){try{this.stream.close()}catch(t){}this.stream=null}}load(){return new Promise((t,e)=>{this._load(t,e)})}_load(t,e){let i="",n=0,r=w.createReadStream(this.location,{flags:"r",encoding:"utf8",autoClose:!0});const s=()=>{if(r){try{r.close()}catch(t){}r=null}};r.on("error",i=>{if(r){if("ENOENT"===i.code)return s(),void t();s(),e(i)}}),r.on("data",t=>{if(!r)return;if((i+=t).length>=1e4)return s(),void e(new Error(`UserDB parse error. Line: ${n}.`));const o=i.split(/\n+/);i=o.pop();for(const t of o){if(n+=1,0===t.length)continue;let i,r;try{i=JSON.parse(t),r=A.fromJSON(i)}catch(t){return s(),void e(new Error(`UserDB parse error. Line: ${n}.`))}this.map.has(r.username)||(this.size+=1),this.map.set(r.username,r)}}),r.on("end",()=>{r&&(this.logger.debug("Loaded %d users into memory.",this.size),r=null,t())})}get(t){return this.map.get(t)}has(t){return this.map.has(t)}add(t){const e=new A(t);h(!this.map.has(e.username),"User already exists."),this.logger.debug("Adding new user (%s).",e.username),this.map.set(e.username,e),this.size+=1,this.write(e.toJSON())}remove(t){h(this.map.has(t),"User not exists."),this.logger.debug("Removing user (%s).",t),this.map.delete(t),this.size-=1,this.delete(t)}setPassword(t,e){const i=this.map.get(t);h(i,"User does not exist."),i.setPassword(e),this.write(i.toJSON())}write(t){const e=this.getStream();if(!e)return;const i=JSON.stringify(t)+"\n";e.write(i,"utf8")}delete(t){const e=w.readFileSync(this.location);let i=e.toString().split("\n"),n=(i=i.filter(e=>!e.includes(`"${t}"`))).join("\n");w.writeFileSync(this.location,n)}getStream(){return this.stream?this.stream:this.lastFail>k.now()-10?null:(this.lastFail=0,this.stream=w.createWriteStream(this.location,{flags:"a"}),this.stream.on("error",t=>{this.logger.warning("UserDB file stream died!"),this.logger.error(t);try{this.stream.close()}catch(t){}this.stream=null,this.lastFail=k.now()}),this.stream)}}(this.options),this.locker=new d,this.jobMap=new Map,this.banned=new Map,this.jobs=new E,this.current=null,this.inbound=new E,this.lastActive=0,this.subscribed=!1,this.uid=0,this.suid=0,this._init()}static init(t){const e=t.config;return new I({node:t,prefix:e.prefix,logger:t.logger,host:e.str("stratum-host"),port:e.uint("stratum-port"),publicHost:e.str("stratum-public-host"),publicPort:e.uint("stratum-public-port"),maxInbound:e.uint("stratum-max-inbound"),difficulty:e.uint("stratum-difficulty"),dynamic:e.bool("stratum-dynamic"),password:e.str("stratum-password"),notify:e.uint("stratum-notify-interval")})}sid(){const t=this.suid;return this.suid+=1,this.suid>>>=0,t}jid(){const t=k.now(),e=this.uid;return this.uid+=1,this.uid>>>=0,`${t}:${e}`}_init(){this.server.on("connection",t=>{this.handleSocket(t)}),this.node.on("connect",async()=>{try{await this.handleBlock()}catch(t){this.emit("error",t)}}),this.node.on("tx",async()=>{try{await this.handleTX()}catch(t){this.emit("error",t)}})}async handleBlock(){const t=await this.locker.lock();try{return await this._handleBlock()}finally{t()}}async _handleBlock(){const t=k.now();this.subscribed?(this.current=null,this.lastActive=t,await this.notifyAll()):this.lastActive=t}async handleTX(){const t=await this.locker.lock();try{return await this._handleTX()}finally{t()}}async _handleTX(){const t=k.now();this.subscribed?t>this.lastActive+I.ACTIVE_TIME&&(this.current=null,this.lastActive=t,await this.notifyAll()):this.lastActive=t}async handleSocket(t){if(!t.remoteAddress)return this.logger.debug("Ignoring disconnected client."),void t.destroy();const e=g.normalize(t.remoteAddress);return this.inbound.size>=this.options.maxInbound?(this.logger.debug("Ignoring client: too many inbound (%s).",e),void t.destroy()):this.isBanned(e)?(this.logger.debug("Ignoring banned client (%s).",e),void t.destroy()):(t.setKeepAlive(!0),t.setNoDelay(!0),void this.addClient(t))}addClient(t){const e=new class extends l{constructor(t,e){super(),this.locker=new d,this.stratum=t,this.logger=t.logger,this.socket=e,this.host=g.normalize(e.remoteAddress),this.port=e.remotePort,this.hostname=g.toHostname(this.host,this.port),this.decoder=new f("utf8"),this.agent="",this.recv="",this.admin=!1,this.users=new Set,this.sid=-1,this.difficulty=-1,this.nextDifficulty=-1,this.banScore=0,this.lastBan=0,this.drainSize=0,this.destroyed=!1,this.lastRetarget=-1,this.submissions=0,this.prev=null,this.next=null,this.job=null,this._init()}_init(){this.on("packet",async t=>{try{await this.readPacket(t)}catch(t){this.error(t)}}),this.socket.on("data",t=>{this.feed(t)}),this.socket.on("error",t=>{this.emit("error",t)}),this.socket.on("close",()=>{this.logger.debug("Client (%s) socket hangup.",this.id()),this.destroy()}),this.socket.on("drain",()=>{this.drainSize=0}),this.sendNotify()}destroy(){this.destroyed||(this.destroyed=!0,this.locker.destroy(),this.socket.destroy(),this.socket=null,this.emit("close"))}send(t){this.destroyed||(t=JSON.stringify(t),t+="\n",this.write(t))}write(t){this.destroyed||!1===this.socket.write(t,"utf8")&&(this.drainSize+=Buffer.byteLength(t,"utf8"),this.drainSize>5<<20&&(this.logger.warning("Client is not reading (%s).",this.id()),this.destroy()))}error(t){if(this.destroyed)return;if(t instanceof Error)return t.message+=` (${this.id()})`,void this.emit("error",t);let e=p.apply(null,arguments);e+=` (${this.id()})`,this.emit("error",new Error(e))}redirect(){const t=this.stratum.options.publicHost,e=this.stratum.options.publicPort,i=["HTTP/1.1 200 OK",`X-Stratum: stratum+tcp://${t}:${e}`,"Connection: Close","Content-Type: application/json; charset=utf-8","Content-Length: 38","","",'{"error":null,"result":false,"id":0}'];this.write(i.join("\r\n")),this.logger.debug("Redirecting client (%s).",this.id()),this.destroy()}feed(t){if(this.recv+=this.decoder.write(t),this.recv.length>=1e5)return this.error("Too much data buffered (%s).",this.id()),void this.destroy();if(/HTTP\/1\.1/i.test(this.recv))return void this.redirect();const e=this.recv.replace(/\r+/g,"").split(/\n+/);this.recv=e.pop();for(const t of e){if(0===t.length)continue;let e;try{e=O.fromRaw(t)}catch(t){this.error(t);continue}this.emit("packet",e)}}async readPacket(t){const e=await this.locker.lock();try{this.socket.pause(),await this.handlePacket(t)}finally{this.destroyed||this.socket.resume(),e()}}async handlePacket(t){return await this.stratum.handlePacket(this,t)}addUser(t){return!this.users.has(t)&&(this.users.add(t),!0)}hasUser(t){return this.users.has(t)}increaseBan(t){const e=Date.now();this.banScore*=Math.pow(1-1/6e4,e-this.lastBan),this.banScore+=t,this.lastBan=e,this.banScore>=I.BAN_SCORE&&(this.logger.debug("Ban score exceeds threshold %d (%s).",this.banScore,this.id()),this.ban())}ban(){this.emit("ban")}sendError(t,e,i){this.logger.spam("Sending error %s (%s).",i,this.id()),this.send({id:t.id,result:null,error:[e,i,!1]})}sendResponse(t,e){this.logger.spam("Sending response %s (%s).",t.id,this.id()),this.send({id:t.id,result:e,error:null})}sendMethod(t,e){this.logger.spam("Sending method %s (%s).",t,this.id()),this.send({id:null,method:t,params:e})}sendDifficulty(t){h(t>0,"Difficulty must be at least 1."),this.logger.debug("Setting difficulty=%d for client (%s).",t,this.id()),this.sendMethod("mining.set_difficulty",[t])}setDifficulty(t){this.nextDifficulty=t}sendJob(t){this.job||(this.job=t),this.logger.debug("Sending job %s to client (%s).",t.id,this.id()),-1!==this.nextDifficulty&&(this.submissions=0,this.lastRetarget=Date.now(),this.sendDifficulty(this.nextDifficulty),this.difficulty=this.nextDifficulty,this.nextDifficulty=-1),this.sendMethod("mining.notify",t.toJSON())}sendNotify(){if(!this.stratum.options.notify)return;const t=setInterval(()=>{if(this.job)try{this.sendJob(this.job)}catch(e){clearInterval(t)}},1e3*this.stratum.options.notify)}retarget(t){const e=Date.now(),i=I.SHARES_PER_MINUTE;if(h(this.difficulty>0),h(-1!==this.lastRetarget),this.submissions+=1,this.submissions%i==0){const n=this.submissions/i*6e4;let r=e-this.lastRetarget,s=4294967296/this.difficulty;return t>-1>>>0&&(t=-1>>>0),Math.abs(n-r)<=5e3?!1:(r<n/4&&(r=n/4),r>4*n&&(r=4*n),s*=r,s/=n,s=4294967296/s,s>>>=0,s=Math.min(t,s),s=Math.max(1,s),this.setDifficulty(s),!0)}return!1}id(){let t=this.host;return this.agent&&(t+="/"+this.agent),t}}(this,t);e.on("error",t=>{this.emit("error",t)}),e.on("close",()=>{h(this.inbound.remove(e))}),e.on("ban",()=>{this.handleBan(e)}),this.inbound.push(e)}handleBan(t){this.logger.warning("Banning client (%s).",t.id()),this.banned.set(t.host,k.now()),t.destroy()}isBanned(t){const e=this.banned.get(t);return null!=e&&(!(k.now()-e>I.BAN_TIME)||(this.banned.delete(t),!1))}async listen(){this.server.maxConnections=this.options.maxInbound,await this.server.listen(this.options.port,this.options.host),this.logger.info("Server listening on %d.",this.options.port)}async open(){if(0===this.node.miner.addresses.length)throw new Error("No addresses available for coinbase.");await this.userdb.open(),await this.sharedb.open(),await this.listen(),this.options.password&&(this.userdb.get("admin")||this.userdb.add({username:"admin",hash:this.options.password})),this.lastActive=k.now()}async close(){let t,e;for(t=this.inbound.head;t;t=e)e=t.next,t.destroy();await this.server.close(),await this.userdb.close(),await this.sharedb.close()}async notifyAll(){const t=await this.getJob();let e;for(this.logger.debug("Notifying all clients of new job: %s.",t.id),e=this.inbound.head;e;e=e.next)-1!==e.sid&&e.sendJob(t)}createBlock(){if(0===this.node.miner.addresses.length)throw new Error("No addresses available for coinbase.");return this.node.miner.createBlock()}addJob(t){this.jobs.size>=I.MAX_JOBS&&this.removeJob(this.jobs.head),h(this.jobs.push(t)),h(!this.jobMap.has(t.id)),this.jobMap.set(t.id,t),this.current=t}removeJob(t){h(this.jobs.remove(t)),h(this.jobMap.has(t.id)),this.jobMap.delete(t.id),t===this.current&&(this.current=null)}async getJob(){if(!this.current){const t=await this.createBlock(),e=class{constructor(t){h("string"==typeof t),this.id=t,this.attempt=null,this.target=S.ZERO_HASH,this.difficulty=0,this.submissions={},this.committed=!1,this.prev=null,this.next=null}fromTemplate(t){return this.attempt=t,this.attempt.refresh(),this.target=t.target,this.difficulty=t.getDifficulty(),this}static fromTemplate(t,e){return new this(t).fromTemplate(e)}insert(t){return t=t.toString("hex"),!this.submissions[t]&&(this.submissions[t]=!0,!0)}check(t,e){const i=e.nonce2,n=e.time,r=e.nonce;return this.attempt.getProof(t,i,n,r)}updateNonce(t){console.log("@updateNonce",t),4294967296==++t.nonce2&&(t.nonce2=0,t.nonce++),console.log("@subm.nonce2",t.nonce2)}commit(t){return h(!this.committed,"Already committed."),this.committed=!0,this.attempt.commit(t)}toJSON(){return[this.id,x.swap32hex(this.attempt.prevBlock),this.attempt.left.toString("hex"),this.attempt.right.toString("hex"),this.attempt.tree.toJSON(),a(this.attempt.version),a(this.attempt.bits),a(this.attempt.time),!1]}}.fromTemplate(this.jid(),t);this.addJob(e),this.logger.debug("New job (id=%s, prev=%s).",e.id,k.revHex(e.attempt.prevBlock))}return this.current}async tryCommit(t,e){try{await this.sharedb.commit(t,e)}catch(t){this.emit("error",t)}}auth(t,e){const i=this.userdb.get(t);if(!i)return!1;const n=Buffer.from(e,"utf8"),r=b(n);return!!v(r,i.password)}authAdmin(t){if(!this.options.password)return!1;const e=Buffer.from(t,"utf8"),i=b(e);return!!v(i,this.options.password)}async addBlock(t,e){this.node.broadcast(e);let i;try{i=await this.chain.add(e)}catch(t){if("VerifyError"===t.type){switch(t.reason){case"high-hash":return new P(23,"high-hash");case"duplicate":return new P(22,"duplicate")}return new P(20,t.reason)}throw t}return i?i.hash!==this.chain.tip.hash?new P(21,"stale-work"):(this.tryCommit(i,e),this.logger.info("Client found block %s (%d) (%s).",i.rhash(),i.height,t.id()),null):new P(21,"stale-prevblk")}async handlePacket(t,e){const i=await this.locker.lock();try{return await this._handlePacket(t,e)}finally{i()}}async _handlePacket(t,e){switch(e.method){case"mining.authorize":return this.handleAuthorize(t,e);case"mining.subscribe":return this.handleSubscribe(t,e);case"mining.extranonce.subscribe":return this.handleExtranonceSubscribe(t,e);case"mining.submit":return this.handleSubmit(t,e);case"mining.get_transactions":return this.handleTransactions(t,e);case"mining.authorize_admin":return this.handleAuthAdmin(t,e);case"mining.add_user":return this.handleAddUser(t,e);default:return this.handleUnknown(t,e)}}async handleAuthorize(t,e){if(typeof e.params.length<2)return void t.sendError(e,0,"invalid params");const i=e.params[0],n=e.params[1];if(r(i)&&s(n)){if(!this.auth(i,n))return this.logger.debug("Client failed auth for user %s (%s).",i,t.id()),void t.sendResponse(e,!1);this.logger.debug("Client successfully authd for %s (%s).",i,t.id()),t.addUser(i),t.sendResponse(e,!0)}else t.sendError(e,0,"invalid params")}async handleSubscribe(t,e){if(!this.chain.synced)return void t.sendError(e,0,"not up to date");if(!t.agent&&e.params.length>0){if(!function(t){return"string"==typeof t&&t.length>0&&t.length<=255}(e.params[0]))return void t.sendError(e,0,"invalid params");t.agent=e.params[0]}if(e.params.length>1){if(!function(t){return"string"==typeof t&&8===t.length&&o(t)}(e.params[1]))return void t.sendError(e,0,"invalid params");t.sid=this.sid()}else t.sid=this.sid();this.subscribed||(this.logger.debug("First subscriber (%s).",t.id()),this.subscribed=!0);const i=a(t.sid),n=await this.getJob();this.logger.debug("Client is subscribing with sid=%s (%s).",i,t.id()),t.sendResponse(e,[[["mining.notify",i],["mining.set_difficulty",i]],i,_]),t.setDifficulty(this.difficulty),t.sendJob(n)}async handleExtranonceSubscribe(t,e){this.handleUnknown(t,e)}async handleSubmit(t,e){const i=this.network.now();let n;try{n=B.fromPacket(e)}catch(i){return void t.sendError(e,0,"invalid params")}if(console.log(t),console.log(e),console.log(n),this.logger.spam("Client submitted job %s (%s).",n.job,t.id()),!t.hasUser(n.username))return void t.sendError(e,24,"unauthorized user");if(-1===t.sid)return void t.sendError(e,25,"not subscribed");const r=this.jobMap.get(n.job);if(!r||r.committed)return void t.sendError(e,21,"job not found");if(r!==this.current&&this.logger.warning("Client is submitting a stale job %s (%s).",r.id,t.id()),n.time<i-7200)return void t.sendError(e,20,"time too old");if(n.time>i+7200)return void t.sendError(e,20,"time too new");const s=r.check(t.sid,n),o=s.getDifficulty();if(r.updateNonce(n),console.log("update nonce:job",r),console.log("update nonce:subm",n),o<t.difficulty-1)return this.logger.debug("Client submitted a low share of %d, hash=%s, ban=%d (%s).",o,s.rhash(),t.banScore,t.id()),t.increaseBan(1),t.sendError(e,23,"high-hash"),void t.sendDifficulty(t.difficulty);if(!r.insert(s.hash))return this.logger.debug("Client submitted a duplicate share: %s (%s).",s.rhash(),t.id()),t.increaseBan(10),void t.sendError(e,22,"duplicate");this.sharedb.add(n.username,o),this.logger.debug("Client submitted share of %d, hash=%s (%s).",o,s.rhash(),t.id());let a;if(s.verify(r.target)){const e=r.commit(s);a=await this.addBlock(t,e)}a?(this.logger.warning("Client found an invalid block: %s (%s).",a.reason,t.id()),t.sendError(e,a.code,a.reason)):t.sendResponse(e,!0),this.options.dynamic&&t.retarget(r.difficulty)&&this.logger.debug("Retargeted client to %d (%s).",t.nextDifficulty,t.id())}async handleTransactions(t,e){if(-1===t.sid)return void t.sendError(e,25,"not subscribed");if(e.params.length<1)return void t.sendError(e,21,"job not found");const i=e.params[0];if(!n(i))return void t.sendError(e,21,"job not found");const r=this.jobMap.get(i);if(!r||r.committed)return void t.sendError(e,21,"job not found");this.logger.debug("Sending tx list (%s).",t.id());const s=r.attempt,o=[];for(const t of s.items)o.push(t.tx.hash("hex"));t.sendResponse(e,o)}async handleAuthAdmin(t,e){if(typeof e.params.length<1)return void t.sendError(e,0,"invalid params");const i=e.params[0];if(s(i)){if(!this.authAdmin(i))return this.logger.debug("Client sent bad admin password (%s).",t.id()),t.increaseBan(10),void t.sendError(e,0,"invalid password");t.admin=!0,t.sendResponse(e,!0)}else t.sendError(e,0,"invalid params")}async handleAddUser(t,e){if(typeof e.params.length<3)return void t.sendError(e,0,"invalid params");const i=e.params[0],n=e.params[1];if(r(i)&&s(n)){if(!t.admin)return this.logger.debug("Client is not an admin (%s).",t.id()),void t.sendError(e,0,"invalid password");try{this.userdb.add({username:i,password:n})}catch(i){return void t.sendError(e,0,i.message)}t.sendResponse(e,!0)}else t.sendError(e,0,"invalid params")}async handleUnknown(t,e){this.logger.debug("Client sent an unknown message (%s):",t.id()),this.logger.debug(e),t.send({id:e.id,result:null,error:!0})}}I.id="stratum",I.ACTIVE_TIME=60,I.MAX_JOBS=6,I.SHARES_PER_MINUTE=8,I.BAN_SCORE=1e3,I.BAN_TIME=600;class A{constructor(t){this.username="",this.password=S.ZERO_HASH,t&&this.fromOptions(t)}fromOptions(t){return h(t,"Options required."),h(r(t.username),"Username required."),h(t.hash||t.password,"Password required."),this.setUsername(t.username),null!=t.hash&&this.setHash(t.hash),null!=t.password&&this.setPassword(t.password),this}static fromOptions(t){return(new this).fromOptions(t)}setUsername(t){h(r(t),"Username must be a string."),this.username=t}setHash(t){return"string"==typeof t?(h(o(t),"Hash must be a hex string."),h(64===t.length,"Hash must be 32 bytes."),Buffer.from(t,"hex")):(h(Buffer.isBuffer(t),"Hash must be a buffer."),h(32===t.length,"Hash must be 32 bytes."),t)}setPassword(t){h(s(t),"Password must be a string."),t=Buffer.from(t,"utf8"),this.password=b(t)}toJSON(){return{username:this.username,password:this.password.toString("hex")}}fromJSON(t){return h(t),h("string"==typeof t.username),this.username=t.username,this.password=this.setHash(t.password),this}static fromJSON(t){return(new this).fromJSON(t)}}class O{constructor(){this.id=null,this.method="unknown",this.params=[]}static fromRaw(t){const e=new O,i=JSON.parse(t);return null!=i.id&&(h("string"==typeof i.id||"number"==typeof i.id),e.id=i.id),h("string"==typeof i.method),h(i.method.length<=50),e.method=i.method,i.params&&(h(Array.isArray(i.params)),e.params=i.params),e}}class B{constructor(){this.username="",this.job="",this.nonce2=0,this.time=0,this.nonce=0}static fromPacket(t){const e=new B;return h(t.params.length>=5,"Invalid parameters."),h(r(t.params[0]),"Name must be a string."),h(n(t.params[1]),"Job ID must be a string."),h("string"==typeof t.params[2],"Nonce2 must be a string."),h(t.params[2].length===2*_,"Nonce2 must be a string."),h(o(t.params[2]),"Nonce2 must be a string."),h("string"==typeof t.params[3],"Time must be a string."),h(8===t.params[3].length,"Time must be a string."),h(o(t.params[3]),"Time must be a string."),h("string"==typeof t.params[4],"Nonce must be a string."),h(8===t.params[4].length,"Nonce must be a string."),h(o(t.params[4]),"Nonce must be a string."),e.username=t.params[0],e.job=t.params[1],e.nonce2=parseInt(t.params[2],16),e.time=parseInt(t.params[3],16),e.nonce=parseInt(t.params[4],16),e}}class P{constructor(t,e){this.code=t,this.reason=e}}t.exports=I},function(t,e,i){"use strict";function n(t){if(!(this instanceof n))return new n(t);t||(t={}),"string"==typeof t&&(t={uri:t}),u.call(this),this.options=t,this.network=c.get(t.network),this.uri=t.uri||`http://localhost:${this.network.rpcPort}`,this.apiKey=t.apiKey,this.socket=null}function r(t,e){"string"==typeof t&&(t=Buffer.from(t,"hex"));const i=p.fromHead(t),n=new m(t);n.seek(80);const r=n.readU32(),s=i.hash("hex");return new l(s,r,i.time)}function s(t,e){const i=r(t),n=[];for(const t of e){const e=o(t);n.push(e)}return new function(t,e){this.entry=t,this.txs=e}(i,n)}function o(t){return f.fromRaw(t,"hex")}function a(t,e,i){return function(n,r){if(n)e(new Error(n.message));else if(r)if(i){try{r=i(r)}catch(t){return void e(t)}t(r)}else t(r);else t(null)}}const h=i(212),c=i(6),u=i(30),f=i(15),{BlockMeta:l}=i(129),p=i(37),d=i(1),m=i(2);Object.setPrototypeOf(n.prototype,u.prototype),n.prototype._open=async function(){this.socket=new h(this.uri,{transports:["websocket"],forceNew:!0}),this.socket.on("error",t=>{this.emit("error",t)}),this.socket.on("version",t=>{t.network!==this.network.type&&this.emit("error",new Error("Wrong network."))}),this.socket.on("block connect",(t,e)=>{let i;try{i=s(t,e)}catch(t){return void this.emit("error",t)}this.emit("block connect",i.entry,i.txs)}),this.socket.on("block disconnect",t=>{let e;try{e=r(t)}catch(t){return void this.emit("error",t)}this.emit("block disconnect",e)}),this.socket.on("block rescan",(t,e,i)=>{let n;try{n=s(t,e)}catch(t){return this.emit("error",t),void i()}this.fire("block rescan",n.entry,n.txs).then(i,i)}),this.socket.on("chain reset",t=>{let e;try{e=r(t)}catch(t){return void this.emit("error",t)}this.emit("chain reset",e)}),this.socket.on("tx",t=>{try{t=o(t)}catch(t){return void this.emit("error",t)}this.emit("tx",t)}),await this.onConnect(),await this.sendAuth(),await this.watchChain(),await this.watchMempool()},n.prototype._close=function(){return this.socket?(this.socket.disconnect(),this.socket=null,Promise.resolve()):Promise.resolve()},n.prototype.onConnect=function(){return new Promise((t,e)=>{this.socket.once("connect",t)})},n.prototype.sendAuth=function(){return new Promise((t,e)=>{this.socket.emit("auth",this.apiKey,a(t,e))})},n.prototype.watchChain=function(){return new Promise((t,e)=>{this.socket.emit("watch chain",a(t,e))})},n.prototype.watchMempool=function(){return new Promise((t,e)=>{this.socket.emit("watch mempool",a(t,e))})},n.prototype.getTip=function(){return new Promise((t,e)=>{this.socket.emit("get tip",a(t,e,r))})},n.prototype.getEntry=function(t){return new Promise((e,i)=>{"string"==typeof t&&(t=d.revHex(t)),this.socket.emit("get entry",t,a(e,i,r))})},n.prototype.send=function(t){return new Promise((e,i)=>{this.socket.emit("send",t.toRaw(),a(e,i))})},n.prototype.setFilter=function(t){return new Promise((e,i)=>{this.socket.emit("set filter",t.toRaw(),a(e,i))})},n.prototype.addFilter=function(t){return Array.isArray(t)||(t=[t]),new Promise((e,i)=>{this.socket.emit("add filter",t,a(e,i))})},n.prototype.resetFilter=function(){return new Promise((t,e)=>{this.socket.emit("reset filter",a(t,e))})},n.prototype.estimateFee=function(t){return new Promise((e,i)=>{this.socket.emit("estimate fee",t,a(e,i))})},n.prototype.rescan=function(t){return new Promise((e,i)=>{"string"==typeof t&&(t=d.revHex(t)),this.socket.emit("rescan",t,a(e,i))})},t.exports=n},function(t,e,i){"use strict";function n(t){if(!(this instanceof n))return new n(t);t=new r(t),h.call(this,t),this.options=t,this.network=this.options.network,this.logger=this.options.logger.context("http"),this.walletdb=this.options.walletdb,this.server=new h(this.options),this.rpc=this.walletdb.rpc,this.init()}function r(t){if(!(this instanceof r))return new r(t);this.network=y.primary,this.logger=null,this.walletdb=null,this.apiKey=u.encode(m.randomBytes(20)),this.apiHash=d.hash256(Buffer.from(this.apiKey,"ascii")),this.serviceHash=this.apiHash,this.noAuth=!1,this.walletAuth=!1,this.prefix=null,this.host="127.0.0.1",this.port=8080,this.ssl=!1,this.keyFile=null,this.certFile=null,this.fromOptions(t)}function s(t,e){if(!t){const t=new Error(e);throw t.statusCode=400,t}}const o=i(0),a=i(33),h=i(166),c=i(1),u=i(25),f=i(48),l=i(21),p=i(8),d=i(5),m=i(28),g=i(52),y=i(6),w=i(74),b=i(11),v=i(47),k=i(62);Object.setPrototypeOf(n.prototype,h.prototype),n.prototype.attach=function(t){t.mount("/wallet",this)},n.prototype.init=function(){this.on("request",(t,e)=>{"POST"===t.method&&"/"===t.pathname||this.logger.debug("Request for method=%s path=%s (%s).",t.method,t.pathname,t.socket.remoteAddress)}),this.on("listening",t=>{this.logger.info("HTTP server listening on %s (port=%d).",t.address,t.port)}),this.initRouter(),this.initSockets()},n.prototype.initRouter=function(){this.use(this.cors()),this.options.noAuth||this.use(this.basicAuth({password:this.options.apiKey,realm:"wallet"})),this.use(this.bodyParser({contentType:"json"})),this.use(this.jsonRPC(this.rpc)),this.hook(async(t,e)=>{const i=t.valid();if(0===t.path.length)return;if("_admin"===t.path[0])return;if("PUT"===t.method&&1===t.path.length)return;const n=i.str("id"),r=i.buf("token");if(!this.options.walletAuth){const i=await this.walletdb.get(n);return i?void(t.wallet=i):void e.send(404)}let s;try{s=await this.walletdb.auth(n,r)}catch(t){return this.logger.info("Auth failure for %s: %s.",n,t.message),void e.error(403,t)}s?(t.wallet=s,this.logger.info("Successful auth for %s.",n)):e.send(404)}),this.post("/_admin/rescan",async(t,e)=>{const i=t.valid().u32("height");e.send(200,{success:!0}),await this.walletdb.rescan(i)}),this.post("/_admin/resend",async(t,e)=>{await this.walletdb.resend(),e.send(200,{success:!0})}),this.post("/_admin/backup",async(t,e)=>{const i=t.valid().str("path");s(i,"Path is required."),await this.walletdb.backup(i),e.send(200,{success:!0})}),this.get("/_admin/wallets",async(t,e)=>{const i=await this.walletdb.getWallets();e.send(200,i)}),this.get("/:id",(t,e)=>{e.send(200,t.wallet.toJSON())}),this.get("/:id/master",(t,e)=>{e.send(200,t.wallet.master.toJSON(!0))}),this.post("/",async(t,e)=>{const i=t.valid(),n=await this.walletdb.create({id:i.str("id"),type:i.str("type"),m:i.u32("m"),n:i.u32("n"),passphrase:i.str("passphrase"),master:i.str("master"),mnemonic:i.str("mnemonic"),witness:i.bool("witness"),accountKey:i.str("accountKey"),watchOnly:i.bool("watchOnly")});e.send(200,n.toJSON())}),this.put("/:id",async(t,e)=>{const i=t.valid(),n=await this.walletdb.create({id:i.str("id"),type:i.str("type"),m:i.u32("m"),n:i.u32("n"),passphrase:i.str("passphrase"),master:i.str("master"),mnemonic:i.str("mnemonic"),witness:i.bool("witness"),accountKey:i.str("accountKey"),watchOnly:i.bool("watchOnly")});e.send(200,n.toJSON())}),this.get("/:id/account",async(t,e)=>{const i=await t.wallet.getAccounts();e.send(200,i)}),this.get("/:id/account/:account",async(t,e)=>{const i=t.valid().str("account"),n=await t.wallet.getAccount(i);n?e.send(200,n.toJSON()):e.send(404)}),this.post("/:id/account",async(t,e)=>{const i=t.valid(),n=i.str("passphrase"),r={name:i.str(["account","name"]),witness:i.bool("witness"),watchOnly:i.bool("watchOnly"),type:i.str("type"),m:i.u32("m"),n:i.u32("n"),accountKey:i.str("accountKey"),lookahead:i.u32("lookahead")},s=await t.wallet.createAccount(r,n);e.send(200,s.toJSON())}),this.put("/:id/account/:account",async(t,e)=>{const i=t.valid(),n=i.str("passphrase"),r={name:i.str("account"),witness:i.bool("witness"),watchOnly:i.bool("watchOnly"),type:i.str("type"),m:i.u32("m"),n:i.u32("n"),accountKey:i.str("accountKey"),lookahead:i.u32("lookahead")},s=await t.wallet.createAccount(r,n);e.send(200,s.toJSON())}),this.post("/:id/passphrase",async(t,e)=>{const i=t.valid(),n=i.str("old"),r=i.str("new");s(n||r,"Passphrase is required."),await t.wallet.setPassphrase(n,r),e.send(200,{success:!0})}),this.post("/:id/unlock",async(t,e)=>{const i=t.valid(),n=i.str("passphrase"),r=i.u32("timeout");s(n,"Passphrase is required."),await t.wallet.unlock(n,r),e.send(200,{success:!0})}),this.post("/:id/lock",async(t,e)=>{await t.wallet.lock(),e.send(200,{success:!0})}),this.post("/:id/import",async(t,e)=>{const i=t.valid(),n=i.str("account"),r=i.buf("publicKey"),o=i.str("privateKey"),a=i.str("address");if(r){const i=v.fromPublic(r,this.network);return await t.wallet.importKey(n,i),void e.send(200,{success:!0})}if(o){const i=v.fromSecret(o,this.network);return await t.wallet.importKey(n,i),void e.send(200,{success:!0})}if(a){const i=b.fromString(a,this.network);return await t.wallet.importAddress(n,i),void e.send(200,{success:!0})}s(!1,"Key or address is required.")}),this.post("/:id/retoken",async(t,e)=>{const i=t.valid().str("passphrase"),n=await t.wallet.retoken(i);e.send(200,{token:n.toString("hex")})}),this.post("/:id/send",async(t,e)=>{const i=t.valid(),n=i.str("passphrase"),r=i.array("outputs"),s={rate:i.u64("rate"),blocks:i.u32("blocks"),maxFee:i.u64("maxFee"),selection:i.str("selection"),smart:i.bool("smart"),subtractFee:i.bool("subtractFee"),subtractIndex:i.i32("subtractIndex"),depth:i.u32(["confirmations","depth"]),outputs:[]};for(const t of r){const e=new w([t]),i=e.buf("script");let n=null;i&&(n=p.fromRaw(i)),s.outputs.push({script:n,address:e.str("address"),value:e.u64("value")})}const o=await t.wallet.send(s,n),a=await t.wallet.getDetails(o.hash("hex"));e.send(200,a.toJSON())}),this.post("/:id/create",async(t,e)=>{const i=t.valid(),n=i.str("passphrase"),r=i.array("outputs"),s={rate:i.u64("rate"),maxFee:i.u64("maxFee"),selection:i.str("selection"),smart:i.bool("smart"),subtractFee:i.bool("subtractFee"),subtractIndex:i.i32("subtractIndex"),depth:i.u32(["confirmations","depth"]),outputs:[]};for(const t of r){const e=new w([t]),i=e.buf("script");let n=null;i&&(n=p.fromRaw(i)),s.outputs.push({script:n,address:e.str("address"),value:e.u64("value")})}const o=await t.wallet.createTX(s);await t.wallet.sign(o,n),e.send(200,o.getJSON(this.network))}),this.post("/:id/sign",async(t,e)=>{const i=t.valid(),n=i.str("passphrase"),r=i.buf("tx");s(r,"TX is required.");const o=f.fromRaw(r);o.view=await t.wallet.getCoinView(o),await t.wallet.sign(o,n),e.send(200,o.getJSON(this.network))}),this.post("/:id/zap",async(t,e)=>{const i=t.valid(),n=i.str("account"),r=i.u32("age");s(r,"Age is required."),await t.wallet.zap(n,r),e.send(200,{success:!0})}),this.del("/:id/tx/:hash",async(t,e)=>{const i=t.valid().hash("hash");s(i,"Hash is required."),await t.wallet.abandon(i),e.send(200,{success:!0})}),this.get("/:id/block",async(t,e)=>{const i=await t.wallet.getBlocks();e.send(200,i)}),this.get("/:id/block/:height",async(t,e)=>{const i=t.valid().u32("height");s(null!=i,"Height is required.");const n=await t.wallet.getBlock(i);n?e.send(200,n.toJSON()):e.send(404)}),this.put("/:id/shared-key",async(t,e)=>{const i=t.valid(),n=i.str("account"),r=i.str("accountKey");s(r,"Key is required."),await t.wallet.addSharedKey(n,r),e.send(200,{success:!0})}),this.del("/:id/shared-key",async(t,e)=>{const i=t.valid(),n=i.str("account"),r=i.str("accountKey");s(r,"Key is required."),await t.wallet.removeSharedKey(n,r),e.send(200,{success:!0})}),this.get("/:id/key/:address",async(t,e)=>{const i=t.valid().str("address");s(i,"Address is required.");const n=await t.wallet.getKey(i);n?e.send(200,n.toJSON()):e.send(404)}),this.get("/:id/wif/:address",async(t,e)=>{const i=t.valid(),n=i.str("address"),r=i.str("passphrase");s(n,"Address is required.");const o=await t.wallet.getPrivateKey(n,r);o?e.send(200,{privateKey:o.toSecret()}):e.send(404)}),this.post("/:id/address",async(t,e)=>{const i=t.valid().str("account"),n=await t.wallet.createReceive(i);e.send(200,n.toJSON())}),this.post("/:id/change",async(t,e)=>{const i=t.valid().str("account"),n=await t.wallet.createChange(i);e.send(200,n.toJSON())}),this.post("/:id/nested",async(t,e)=>{const i=t.valid().str("account"),n=await t.wallet.createNested(i);e.send(200,n.toJSON())}),this.get("/:id/balance",async(t,e)=>{const i=t.valid().str("account"),n=await t.wallet.getBalance(i);n?e.send(200,n.toJSON()):e.send(404)}),this.get("/:id/coin",async(t,e)=>{const i=t.valid().str("account"),n=await t.wallet.getCoins(i),r=[];k.sortCoins(n);for(const t of n)r.push(t.getJSON(this.network));e.send(200,r)}),this.get("/:id/locked",async(t,e)=>{const i=this.wallet.getLocked(),n=[];for(const t of i)n.push(t.toJSON());e.send(200,n)}),this.put("/:id/locked/:hash/:index",async(t,e)=>{const i=t.valid(),n=i.hash("hash"),r=i.u32("index");s(n,"Hash is required."),s(null!=r,"Index is required.");const o=new l(n,r);this.wallet.lockCoin(o)}),this.del("/:id/locked/:hash/:index",async(t,e)=>{const i=t.valid(),n=i.hash("hash"),r=i.u32("index");s(n,"Hash is required."),s(null!=r,"Index is required.");const o=new l(n,r);this.wallet.unlockCoin(o)}),this.get("/:id/coin/:hash/:index",async(t,e)=>{const i=t.valid(),n=i.hash("hash"),r=i.u32("index");s(n,"Hash is required."),s(null!=r,"Index is required.");const o=await t.wallet.getCoin(n,r);o?e.send(200,o.getJSON(this.network)):e.send(404)}),this.get("/:id/tx/history",async(t,e)=>{const i=t.valid().str("account"),n=await t.wallet.getHistory(i);k.sortTX(n);const r=await t.wallet.toDetails(n),s=[];for(const t of r)s.push(t.toJSON());e.send(200,s)}),this.get("/:id/tx/unconfirmed",async(t,e)=>{const i=t.valid().str("account"),n=await t.wallet.getPending(i);k.sortTX(n);const r=await t.wallet.toDetails(n),s=[];for(const t of r)s.push(t.toJSON());e.send(200,s)}),this.get("/:id/tx/range",async(t,e)=>{const i=t.valid(),n=i.str("account"),r={start:i.u32("start"),end:i.u32("end"),limit:i.u32("limit"),reverse:i.bool("reverse")},s=await t.wallet.getRange(n,r),o=await t.wallet.toDetails(s),a=[];for(const t of o)a.push(t.toJSON());e.send(200,a)}),this.get("/:id/tx/last",async(t,e)=>{const i=t.valid(),n=i.str("account"),r=i.u32("limit"),s=await t.wallet.getLast(n,r),o=await t.wallet.toDetails(s),a=[];for(const t of o)a.push(t.toJSON());e.send(200,a)}),this.get("/:id/tx/:hash",async(t,e)=>{const i=t.valid().hash("hash");s(i,"Hash is required.");const n=await t.wallet.getTX(i);if(!n)return void e.send(404);const r=await t.wallet.toDetails(n);e.send(200,r.toJSON())}),this.post("/:id/resend",async(t,e)=>{await t.wallet.resend(),e.send(200,{success:!0})})},n.prototype.initSockets=function(){this.io&&(this.on("socket",t=>{this.handleSocket(t)}),this.walletdb.on("tx",(t,e,i)=>{const n=i.toJSON();this.to(`w:${t}`,"wallet tx",n)}),this.walletdb.on("confirmed",(t,e,i)=>{const n=i.toJSON();this.to(`w:${t}`,"wallet confirmed",n)}),this.walletdb.on("unconfirmed",(t,e,i)=>{const n=i.toJSON();this.to(`w:${t}`,"wallet unconfirmed",n)}),this.walletdb.on("conflict",(t,e,i)=>{const n=i.toJSON();this.to(`w:${t}`,"wallet conflict",n)}),this.walletdb.on("balance",(t,e)=>{const i=e.toJSON();this.to(`w:${t}`,"wallet balance",i)}),this.walletdb.on("address",(t,e)=>{const i=[];for(const t of e)i.push(t.toJSON());this.to(`w:${t}`,"wallet address",i)}))},n.prototype.handleSocket=function(t){t.hook("wallet auth",e=>{if(t.auth)throw new Error("Already authed.");if(!this.options.noAuth){const t=new w([e]).str(0,"");if(t.length>255)throw new Error("Invalid API key.");const i=Buffer.from(t,"utf8"),n=d.hash256(i);if(!g(n,this.options.apiHash))throw new Error("Invalid API key.")}return t.auth=!0,this.logger.info("Successful auth from %s.",t.host),this.handleAuth(t),null})},n.prototype.handleAuth=function(t){t.hook("wallet join",async e=>{const i=new w([e]),n=i.str(0,""),r=i.buf(1);if(!n)throw new Error("Invalid parameter.");if(!this.options.walletAuth)return t.join(`w:${n}`),null;if(!r)throw new Error("Invalid parameter.");let s;try{s=await this.walletdb.auth(n,r)}catch(t){throw this.logger.info("Wallet auth failure for %s: %s.",n,t.message),new Error("Bad token.")}if(!s)throw new Error("Wallet does not exist.");return this.logger.info("Successful wallet auth for %s.",n),t.join(`w:${n}`),null}),t.hook("wallet leave",e=>{const i=new w([e]).str(0,"");if(!i)throw new Error("Invalid parameter.");return t.leave(`w:${i}`),null})},r.prototype.fromOptions=function(t){return o(t),o(t.walletdb&&"object"==typeof t.walletdb,"HTTP Server requires a WalletDB."),this.walletdb=t.walletdb,this.network=t.walletdb.network,this.logger=t.walletdb.logger,this.port=this.network.rpcPort+2,null!=t.logger&&(o("object"==typeof t.logger),this.logger=t.logger),null!=t.apiKey&&(o("string"==typeof t.apiKey,"API key must be a string."),o(t.apiKey.length<=255,"API key must be under 255 bytes."),o(c.isAscii(t.apiKey),"API key must be ASCII."),this.apiKey=t.apiKey,this.apiHash=d.hash256(Buffer.from(this.apiKey,"ascii"))),null!=t.noAuth&&(o("boolean"==typeof t.noAuth),this.noAuth=t.noAuth),null!=t.walletAuth&&(o("boolean"==typeof t.walletAuth),this.walletAuth=t.walletAuth),null!=t.prefix&&(o("string"==typeof t.prefix),this.prefix=t.prefix,this.keyFile=a.join(this.prefix,"key.pem"),this.certFile=a.join(this.prefix,"cert.pem")),null!=t.host&&(o("string"==typeof t.host),this.host=t.host),null!=t.port&&(o(c.isU16(t.port),"Port must be a number."),this.port=t.port),null!=t.ssl&&(o("boolean"==typeof t.ssl),this.ssl=t.ssl),null!=t.keyFile&&(o("string"==typeof t.keyFile),this.keyFile=t.keyFile),null!=t.certFile&&(o("string"==typeof t.certFile),this.certFile=t.certFile),t.apiKey||"127.0.0.1"!==this.host&&"::1"!==this.host||(this.noAuth=!0),this},r.fromOptions=function(t){return(new r).fromOptions(t)},t.exports=n},function(t,e,i){"use strict";function n(t){if(!(this instanceof n))return new n(t);this.encrypted=!1,this.iv=null,this.ciphertext=null,this.key=null,this.mnemonic=null,this.alg=n.alg.PBKDF2,this.N=5e4,this.r=0,this.p=0,this.aesKey=null,this.timer=null,this.until=0,this._onTimeout=this.lock.bind(this),this.locker=new o,t&&this.fromOptions(t)}const r=i(0),s=i(1),o=i(23),a=i(28),h=i(72),c=i(108),u=i(70),f=i(44),l=i(2),p=i(4),d=i(3),m=i(109),g=m.Mnemonic;n.SALT=Buffer.from("wmcc","ascii"),n.alg={PBKDF2:0,SCRYPT:1},n.algByVal={0:"PBKDF2",1:"SCRYPT"},n.prototype.fromOptions=function(t){return r(t),null!=t.encrypted&&(r("boolean"==typeof t.encrypted),this.encrypted=t.encrypted),t.iv&&(r(Buffer.isBuffer(t.iv)),this.iv=t.iv),t.ciphertext&&(r(Buffer.isBuffer(t.ciphertext)),this.ciphertext=t.ciphertext),t.key&&(r(m.isPrivate(t.key)),this.key=t.key),t.mnemonic&&(r(t.mnemonic instanceof g),this.mnemonic=t.mnemonic),null!=t.alg&&("string"==typeof t.alg?(this.alg=n.alg[t.alg.toUpperCase()],r(null!=this.alg,"Unknown algorithm.")):(r("number"==typeof t.alg),r(n.algByVal[t.alg]),this.alg=t.alg)),null!=t.rounds&&(r(s.isU32(t.rounds)),this.N=t.rounds),null!=t.N&&(r(s.isU32(t.N)),this.N=t.N),null!=t.r&&(r(s.isU32(t.r)),this.r=t.r),null!=t.p&&(r(s.isU32(t.p)),this.p=t.p),r(this.encrypted?!this.key:this.key),this},n.fromOptions=function(t){return(new n).fromOptions(t)},n.prototype.unlock=async function(t,e){const i=await this.locker.lock();try{return await this._unlock(t,e)}finally{i()}},n.prototype._unlock=async function(t,e){if(this.key)return this.encrypted&&(r(null!=this.timer),this.start(e)),this.key;if(!t)throw new Error("No passphrase.");r(this.encrypted);const i=await this.derive(t),n=c.decipher(this.ciphertext,i,this.iv);return this.fromKeyRaw(n),this.start(e),this.aesKey=i,this.key},n.prototype.start=function(t){t||(t=60),this.stop(),-1!==t&&(this.until=s.now()+t,this.timer=setTimeout(this._onTimeout,1e3*t))},n.prototype.stop=function(){null!=this.timer&&(clearTimeout(this.timer),this.timer=null,this.until=0)},n.prototype.derive=async function(t){const e=n.SALT,i=this.N,r=this.r,s=this.p;switch("string"==typeof t&&(t=Buffer.from(t,"utf8")),this.alg){case n.alg.PBKDF2:return await u.deriveAsync(t,e,i,32,"sha256");case n.alg.SCRYPT:return await f.deriveAsync(t,e,i,r,s,32);default:throw new Error(`Unknown algorithm: ${this.alg}.`)}},n.prototype.encipher=function(t,e){return this.aesKey?("string"==typeof e&&(e=Buffer.from(e,"hex")),c.encipher(t,this.aesKey,e.slice(0,16))):null},n.prototype.decipher=function(t,e){return this.aesKey?("string"==typeof e&&(e=Buffer.from(e,"hex")),c.decipher(t,this.aesKey,e.slice(0,16))):null},n.prototype.lock=async function(){const t=await this.locker.lock();try{return await this._lock()}finally{t()}},n.prototype._lock=function(){if(!this.encrypted)return r(null==this.timer),void r(this.key);this.stop(),this.key&&(this.key.destroy(!0),this.key=null),this.aesKey&&(h(this.aesKey),this.aesKey=null)},n.prototype.destroy=async function(){await this.lock(),this.locker.destroy()},n.prototype.decrypt=async function(t,e){const i=await this.locker.lock();try{return await this._decrypt(t,e)}finally{i()}},n.prototype._decrypt=async function(t,e){if(!this.encrypted)throw new Error("Master key is not encrypted.");if(!t)throw new Error("No passphrase provided.");this._lock();const i=await this.derive(t),n=c.decipher(this.ciphertext,i,this.iv);return this.fromKeyRaw(n),this.encrypted=!1,this.iv=null,this.ciphertext=null,e?i:(h(i),null)},n.prototype.encrypt=async function(t,e){const i=await this.locker.lock();try{return await this._encrypt(t,e)}finally{i()}},n.prototype._encrypt=async function(t,e){if(this.encrypted)throw new Error("Master key is already encrypted.");if(!t)throw new Error("No passphrase provided.");const i=this.toKeyRaw(),n=a.randomBytes(16);this.stop();const r=await this.derive(t),s=c.encipher(i,r,n);return this.key=null,this.mnemonic=null,this.encrypted=!0,this.iv=n,this.ciphertext=s,e?r:(h(r),null)},n.prototype.getKeySize=function(){let t=0;return t+=this.key.getSize(),t+=1,this.mnemonic&&(t+=this.mnemonic.getSize()),t},n.prototype.toKeyRaw=function(){const t=new p(this.getKeySize());return this.key.toWriter(t),this.mnemonic?(t.writeU8(1),this.mnemonic.toWriter(t)):t.writeU8(0),t.render()},n.prototype.fromKeyRaw=function(t){const e=new l(t);return this.key=m.PrivateKey.fromReader(e),1===e.readU8()&&(this.mnemonic=g.fromReader(e)),this},n.prototype.getSize=function(){let t=0;return this.encrypted?(t+=1,t+=d.sizeVarBytes(this.iv),t+=d.sizeVarBytes(this.ciphertext),t+=13):(t+=1,t+=d.sizeVarlen(this.getKeySize()))},n.prototype.toRaw=function(){const t=new p(this.getSize());if(this.encrypted)return t.writeU8(1),t.writeVarBytes(this.iv),t.writeVarBytes(this.ciphertext),t.writeU8(this.alg),t.writeU32(this.N),t.writeU32(this.r),t.writeU32(this.p),t.render();t.writeU8(0);const e=this.getKeySize();return t.writeVarint(e),t.writeBytes(this.key.toRaw()),this.mnemonic?(t.writeU8(1),this.mnemonic.toWriter(t)):t.writeU8(0),t.render()},n.prototype.fromRaw=function(t){const e=new l(t);return this.encrypted=1===e.readU8(),this.encrypted?(this.iv=e.readVarBytes(),this.ciphertext=e.readVarBytes(),this.alg=e.readU8(),r(n.algByVal[this.alg]),this.N=e.readU32(),this.r=e.readU32(),this.p=e.readU32(),this):(e.readVarint(),this.key=m.PrivateKey.fromRaw(e.readBytes(82)),1===e.readU8()&&(this.mnemonic=g.fromReader(e)),this)},n.fromRaw=function(t){return(new n).fromRaw(t)},n.prototype.fromKey=function(t,e){return this.encrypted=!1,this.iv=null,this.ciphertext=null,this.key=t,this.mnemonic=e||null,this},n.fromKey=function(t,e){return(new n).fromKey(t,e)},n.prototype.toJSON=function(t){return this.encrypted?{encrypted:!0,until:this.until,iv:this.iv.toString("hex"),ciphertext:t?this.ciphertext.toString("hex"):void 0,algorithm:n.algByVal[this.alg].toLowerCase(),N:this.N,r:this.r,p:this.p}:{encrypted:!1,key:t?this.key.toJSON():void 0,mnemonic:t&&this.mnemonic?this.mnemonic.toJSON():void 0}},n.prototype.inspect=function(){const t=this.toJSON(!0);return this.key&&(t.key=this.key.toJSON()),this.mnemonic&&(t.mnemonic=this.mnemonic.toJSON()),t},n.isMasterKey=function(t){return t instanceof n},t.exports=n},function(t,e,i){"use strict";function n(t){if(!(this instanceof n))return new n(t);r.call(this),this.node=t,this.network=t.network,this.filter=null,this.listen=!1,this._init()}const r=i(30);Object.setPrototypeOf(n.prototype,r.prototype),n.prototype._init=function(){this.node.on("connect",(t,e)=>{this.listen&&this.emit("block connect",t,e.txs)}),this.node.on("disconnect",(t,e)=>{this.listen&&this.emit("block disconnect",t)}),this.node.on("tx",t=>{this.listen&&this.emit("tx",t)}),this.node.on("reset",t=>{this.listen&&this.emit("chain reset",t)})},n.prototype._open=function(t){return this.listen=!0,Promise.resolve()},n.prototype._close=function(){return this.listen=!1,Promise.resolve()},n.prototype.getTip=function(){return Promise.resolve(this.node.chain.tip)},n.prototype.getEntry=async function(t){const e=await this.node.chain.getEntry(t);return e&&await this.node.chain.isMainChain(e)?e:null},n.prototype.send=function(t){return this.node.relay(t),Promise.resolve()},n.prototype.setFilter=function(t){return this.filter=t,this.node.pool.setFilter(t),Promise.resolve()},n.prototype.addFilter=function(t){return this.node.pool.queueFilterLoad(),Promise.resolve()},n.prototype.resetFilter=function(){return this.node.pool.queueFilterLoad(),Promise.resolve()},n.prototype.estimateFee=async function(t){return this.node.fees?this.node.fees.estimateFee(t):this.network.feeRate},n.prototype.rescan=function(t){return this.node.chain.scan(t,this.filter,(t,e)=>this.fire("block rescan",t,e))},t.exports=n},function(t,e,i){"use strict";function n(t,e){if(!(this instanceof n))return new n(t,e);s.call(this),r(t,"DB required."),this.db=t,this.network=t.network,this.logger=t.logger,this.readLock=new u,this.writeLock=new c,this.fundLock=new c,this.indexCache=new I(1e4),this.accountCache=new I(1e4),this.pathCache=new I(1e5),this.current=null,this.wid=0,this.id=null,this.initialized=!1,this.watchOnly=!1,this.accountDepth=0,this.token=h.ZERO_HASH,this.tokenDepth=0,this.lock=null,this.chksum=null,this.master=new _,this.txdb=new g(this),this.account=null,e&&this.fromOptions(e)}const r=i(0),s=i(10),o=i(6),a=i(1),h=i(3),c=i(23),u=i(186),f=i(5),l=i(72),p=i(2),d=i(4),m=i(25),g=i(249),y=i(80),w=i(62),b=i(11),v=i(48),k=i(8),S=i(128),E=i(109),R=i(13),x=i(187),_=i(246),I=i(57),A=i(19),O=i(7),B=E.Mnemonic;Object.setPrototypeOf(n.prototype,s.prototype),n.prototype.fromOptions=function(t){let e,i,n,s=t.master;return this.lock=function(t){return Array.isArray(t)?a.concatArrBuf(t):"string"==typeof t?(r(a.isHex(t)),Buffer.from(t,"hex")):(r(Buffer.isBuffer(t)),t)}(t.hsm.locks),this.chksum=t.hsm.passphrase.slice(0,4),s?("string"==typeof s&&(s=E.PrivateKey.fromBase58(s,this.network)),r(E.isPrivate(s),"Must create wallet with hd private key.")):(n=new B(t.mnemonic),s=E.fromMnemonic(n,this.network)),r(s.network===this.network,"Network mismatch for master key."),this.master.fromKey(s,n),null!=t.wid&&(r(a.isU32(t.wid)),this.wid=t.wid),t.id&&(r(w.isName(t.id),"Bad wallet ID."),e=t.id),null!=t.initialized&&(r("boolean"==typeof t.initialized),this.initialized=t.initialized),null!=t.watchOnly&&(r("boolean"==typeof t.watchOnly),this.watchOnly=t.watchOnly),null!=t.accountDepth&&(r(a.isU32(t.accountDepth)),this.accountDepth=t.accountDepth),t.token&&(r(Buffer.isBuffer(t.token)),r(32===t.token.length),i=t.token),null!=t.tokenDepth&&(r(a.isU32(t.tokenDepth)),this.tokenDepth=t.tokenDepth),e||(e=this.getID()),i||(i=this.getToken(this.tokenDepth)),this.id=e,this.token=i,this},n.fromOptions=function(t,e){return new n(t).fromOptions(e)},n.prototype.init=async function(t){let e;const i=t.hsm;e=i.passphrase?i.passphrase.toString("hex"):t.passphrase,r(!this.initialized),this.initialized=!0,e&&await this.master.encrypt(e);const n=await this._createAccount(t,e);r(n),this.account=n,this.logger.info("Wallet initialized (%s).",this.id),await this.txdb.open()},n.prototype.open=async function(){r(this.initialized);const t=await this.getAccount(0);if(!t)throw new Error("Default account not found.");this.account=t,this.logger.info("Wallet opened (%s).",this.id),await this.txdb.open()},n.prototype.destroy=async function(){const t=await this.writeLock.lock(),e=await this.fundLock.lock();try{this.db.unregister(this),await this.master.destroy(),this.readLock.destroy(),this.writeLock.destroy(),this.fundLock.destroy()}finally{e(),t()}},n.prototype.addSharedKey=async function(t,e){const i=await this.writeLock.lock();try{return await this._addSharedKey(t,e)}finally{i()}},n.prototype._addSharedKey=async function(t,e){e||(e=t,t=null),null==t&&(t=0);const i=await this.getAccount(t);if(!i)throw new Error("Account not found.");this.start();let n;try{n=await i.addSharedKey(e)}catch(t){throw this.drop(),t}return await this.commit(),n},n.prototype.removeSharedKey=async function(t,e){const i=await this.writeLock.lock();try{return await this._removeSharedKey(t,e)}finally{i()}},n.prototype._removeSharedKey=async function(t,e){e||(e=t,t=null),null==t&&(t=0);const i=await this.getAccount(t);if(!i)throw new Error("Account not found.");this.start();let n;try{n=await i.removeSharedKey(e)}catch(t){throw this.drop(),t}return await this.commit(),n},n.prototype.setPassphrase=async function(t,e){null==e&&(e=t,t=null),null!=t&&await this.decrypt(t),null!=e&&await this.encrypt(e)},n.prototype.encrypt=async function(t){const e=await this.writeLock.lock();try{return await this._encrypt(t)}finally{e()}},n.prototype._encrypt=async function(t){const e=await this.master.encrypt(t,!0);this.start();try{await this.db.encryptKeys(this,e)}catch(t){throw l(e),this.drop(),t}l(e),this.save(),await this.commit()},n.prototype.decrypt=async function(t){const e=await this.writeLock.lock();try{return await this._decrypt(t)}finally{e()}},n.prototype._decrypt=async function(t){const e=await this.master.decrypt(t,!0);this.start();try{await this.db.decryptKeys(this,e)}catch(t){throw l(e),this.drop(),t}l(e),this.save(),await this.commit()},n.prototype.retoken=async function(t){const e=await this.writeLock.lock();try{return await this._retoken(t)}finally{e()}},n.prototype._retoken=async function(t){return await this.unlock(t),this.tokenDepth++,this.token=this.getToken(this.tokenDepth),this.start(),this.save(),await this.commit(),this.token},n.prototype.rename=async function(t){const e=await this.writeLock.lock();try{return await this.db.rename(this,t)}finally{e()}},n.prototype.renameAccount=async function(t,e){const i=await this.writeLock.lock();try{return await this._renameAccount(t,e)}finally{i()}},n.prototype._renameAccount=async function(t,e){if(!w.isName(e))throw new Error("Bad account name.");const i=await this.getAccount(t);if(!i)throw new Error("Account not found.");if(0===i.accountIndex)throw new Error("Cannot rename default account.");if(await this.hasAccount(e))throw new Error("Account name not available.");const n=i.name;this.start(),this.db.renameAccount(i,e),await this.commit(),this.indexCache.remove(n);const r=this.pathCache.values();for(const t of r)t.account===i.accountIndex&&(t.name=e)},n.prototype.lock=async function(){const t=await this.writeLock.lock(),e=await this.fundLock.lock();try{await this.master.lock()}finally{e(),t()}},n.prototype.unlock=function(t,e){return this.master.unlock(t,e)},n.prototype.getID=function(){r(this.master.key,"Cannot derive id.");const t=this.master.key.derive(44),e=new d(37);e.writeBytes(t.publicKey),e.writeU32(this.network.magic);const i=f.hash160(e.render()),n=new d(27);return n.writeU8(3),n.writeU8(190),n.writeU8(4),n.writeBytes(i),n.writeChecksum(),m.encode(n.render())},n.prototype.getToken=function(t){r(this.master.key,"Cannot derive token.");const e=this.master.key.derive(44,!0),i=new d(36);return i.writeBytes(e.privateKey),i.writeU32(t),f.hash256(i.render())},n.prototype.createAccount=async function(t,e){const i=await this.writeLock.lock();try{return await this._createAccount(t,e)}finally{i()}},n.prototype._createAccount=async function(t,e){let i=t.name;if(i||(i=this.accountDepth.toString(10)),await this.hasAccount(i))throw new Error("Account already exists.");await this.unlock(e);let n;if(this.watchOnly&&t.accountKey){if("string"==typeof(n=t.accountKey)&&(n=E.PublicKey.fromBase58(n,this.network)),!E.isPublic(n))throw new Error("Must add HD public keys to watch only wallet.");r(n.network===this.network,"Network mismatch for watch only key.")}else r(this.master.key),n=(n=this.master.key.deriveAccount(44,this.accountDepth)).toPublic();const s={wid:this.wid,id:this.id,name:0===this.accountDepth?"default":i,witness:t.witness,watchOnly:this.watchOnly,accountKey:n,accountIndex:this.accountDepth,type:t.type,m:t.m,n:t.n,keys:t.keys};this.start();let o;try{(o=x.fromOptions(this.db,s)).wallet=this,await o.init()}catch(t){throw this.drop(),t}return this.logger.info("Created account %s/%s/%d.",o.id,o.name,o.accountIndex),this.accountDepth++,this.save(),await this.commit(),o},n.prototype.ensureAccount=async function(t,e){const i=t.name,n=await this.getAccount(i);return n||await this.createAccount(t,e)},n.prototype.getAccounts=function(){return this.db.getAccounts(this.wid)},n.prototype.getAddressHashes=function(t){return null!=t?this.getAccountHashes(t):this.db.getWalletHashes(this.wid)},n.prototype.getAccountHashes=async function(t){const e=await this.ensureIndex(t,!0);return await this.db.getAccountHashes(this.wid,e)},n.prototype.getAccount=async function(t){if(this.account&&(0===t||"default"===t))return this.account;const e=await this.getAccountIndex(t);if(-1===e)return null;const i=await this.readLock.lock(e);try{return await this._getAccount(e)}finally{i()}},n.prototype._getAccount=async function(t){const e=this.accountCache.get(t);if(e)return e;const i=await this.db.getAccount(this.wid,t);return i?(i.wallet=this,i.wid=this.wid,i.id=this.id,i.watchOnly=this.watchOnly,await i.open(),this.accountCache.set(t,i),i):null},n.prototype.getAccountIndex=async function(t){if(null==t)return-1;if("number"==typeof t)return t;const e=this.indexCache.get(t);if(null!=e)return e;const i=await this.db.getAccountIndex(this.wid,t);return-1===i?-1:(this.indexCache.set(t,i),i)},n.prototype.getAccountName=async function(t){if("string"==typeof t)return t;const e=this.accountCache.get(t);return e?e.name:await this.db.getAccountName(this.wid,t)},n.prototype.hasAccount=async function(t){const e=await this.getAccountIndex(t);return-1!==e&&(!!this.accountCache.has(e)||await this.db.hasAccount(this.wid,e))},n.prototype.createReceive=function(t){return this.createKey(t,0)},n.prototype.createChange=function(t){return this.createKey(t,1)},n.prototype.createNested=function(t){return this.createKey(t,2)},n.prototype.createKey=async function(t,e){const i=await this.writeLock.lock();try{return await this._createKey(t,e)}finally{i()}},n.prototype._createKey=async function(t,e){null==e&&(e=t,t=null),null==t&&(t=0);const i=await this.getAccount(t);if(!i)throw new Error("Account not found.");this.start();let n;try{n=await i.createKey(e)}catch(t){throw this.drop(),t}return await this.commit(),n},n.prototype.save=function(){return this.db.save(this)},n.prototype.start=function(){return this.db.start(this)},n.prototype.drop=function(){return this.db.drop(this)},n.prototype.clear=function(){return this.db.clear(this)},n.prototype.commit=function(){return this.db.commit(this)},n.prototype.hasAddress=async function(t){const e=b.getHash(t,"hex");return null!=await this.getPath(e)},n.prototype.getPath=async function(t){const e=await this.readPath(t);return e?(e.name=await this.getAccountName(e.account),r(e.name),this.pathCache.set(e.hash,e),e):null},n.prototype.readPath=async function(t){const e=b.getHash(t,"hex"),i=this.pathCache.get(e);if(i)return i;const n=await this.db.getPath(this.wid,e);return n?(n.id=this.id,n):null},n.prototype.hasPath=async function(t){const e=b.getHash(t,"hex");return!!this.pathCache.has(e)||await this.db.hasPath(this.wid,e)},n.prototype.getPaths=async function(t){if(null!=t)return await this.getAccountPaths(t);const e=await this.db.getWalletPaths(this.wid),i=[];for(const t of e)t.id=this.id,t.name=await this.getAccountName(t.account),r(t.name),this.pathCache.set(t.hash,t),i.push(t);return i},n.prototype.getAccountPaths=async function(t){const e=await this.ensureIndex(t,!0),i=await this.getAccountHashes(e),n=await this.getAccountName(t);r(n);const s=[];for(const t of i){const i=await this.readPath(t);r(i),r(i.account===e),i.name=n,this.pathCache.set(i.hash,i),s.push(i)}return s},n.prototype.importKey=async function(t,e,i){const n=await this.writeLock.lock();try{return await this._importKey(t,e,i)}finally{n()}},n.prototype._importKey=async function(t,e,i){if(t&&"object"==typeof t&&(i=e,e=t,t=null),null==t&&(t=0),r(e.network===this.network,"Network mismatch for key."),this.watchOnly){if(e.privateKey)throw new Error("Cannot import privkey into watch-only wallet.")}else if(!e.privateKey)throw new Error("Cannot import pubkey into non watch-only wallet.");const n=e.getHash("hex");if(await this.getPath(n))throw new Error("Key already exists.");const s=await this.getAccount(t);if(!s)throw new Error("Account not found.");if(s.type!==x.types.PUBKEYHASH)throw new Error("Cannot import into non-pkh account.");await this.unlock(i);const o=S.fromRing(s,e).toPath();this.master.encrypted&&(o.data=this.master.encipher(o.data,o.hash),r(o.data),o.encrypted=!0),this.start();try{await s.savePath(o)}catch(t){throw this.drop(),t}await this.commit()},n.prototype.importAddress=async function(t,e){const i=await this.writeLock.lock();try{return await this._importAddress(t,e)}finally{i()}},n.prototype._importAddress=async function(t,e){if(e||(e=t,t=null),null==t&&(t=0),r(e.network===this.network,"Network mismatch for address."),!this.watchOnly)throw new Error("Cannot import address into non watch-only wallet.");if(await this.getPath(e))throw new Error("Address already exists.");const i=await this.getAccount(t);if(!i)throw new Error("Account not found.");if(i.type!==x.types.PUBKEYHASH)throw new Error("Cannot import into non-pkh account.");const n=y.fromAddress(i,e);this.start();try{await i.savePath(n)}catch(t){throw this.drop(),t}await this.commit()},n.prototype.fund=async function(t,e,i){const n=await this.fundLock.lock(i);try{return await this._fund(t,e)}finally{n()}},n.prototype._fund=async function(t,e){if(e||(e={}),!this.initialized)throw new Error("Wallet is not initialized.");if(this.watchOnly)throw new Error("Cannot fund from watch-only wallet.");let i;if(null!=e.account){if(!(i=await this.getAccount(e.account)))throw new Error("Account not found.")}else i=this.account;if(!i.initialized)throw new Error("Account is not initialized.");let n=e.rate;null==n&&(n=await this.db.estimateFee(e.blocks));let s;e.smart?s=await this.getSmartCoins(e.account):(s=await this.getCoins(e.account),s=this.txdb.filterLocked(s)),await t.fund(s,{selection:e.selection,round:e.round,depth:e.depth,hardFee:e.hardFee,subtractFee:e.subtractFee,subtractIndex:e.subtractIndex,changeAddress:i.change.getAddress(),height:this.db.state.height,rate:n,maxFee:e.maxFee,estimate:t=>this.estimateSize(t)}),r(t.getFee()<=v.Selector.MAX_FEE,"TX exceeds MAX_FEE.")},n.prototype.getAccountByAddress=async function(t){const e=b.getHash(t,"hex"),i=await this.getPath(e);return i?await this.getAccount(i.account):null},n.prototype.estimateSize=async function(t){const e=O.WITNESS_SCALE_FACTOR,i=t.getAddress();if(!i)return-1;const n=await this.getAccountByAddress(i);if(!n)return-1;let r=0;if(t.isScripthash()&&n.witness)switch(n.type){case x.types.PUBKEYHASH:r+=23,r*=4;break;case x.types.MULTISIG:r+=35,r*=4}switch(n.type){case x.types.PUBKEYHASH:r+=74,r+=34;break;case x.types.MULTISIG:r+=1,r+=74*n.m,r+=3,r+=1,r+=34*n.n,r+=1,r+=1}return n.witness?r=((r+=1)+e-1)/e|0:r+=h.sizeVarint(r),r},n.prototype.createTX=async function(t,e){const i=t.outputs,n=new v;r(Array.isArray(i),"Outputs must be an array."),r(i.length>0,"No outputs available.");for(const t of i){const e=new R(t),i=e.getAddress();if(e.isDust())throw new Error("Output is dust.");if(e.value>0){if(!i)throw new Error("Cannot send to unknown address.");if(i.isNull())throw new Error("Cannot send to null address.")}n.outputs.push(e)}await this.fund(n,t,e),!1!==t.sort&&n.sortMembers(),null!=t.locktime&&n.setLocktime(t.locktime),r(n.isSane(this.db.state.height+1),"TX failed sanity check."),r(n.verifyInputs(this.db.state.height+1),"TX failed context check.");await this.template(n);return n},n.prototype.send=async function(t,e){const i=await this.fundLock.lock();try{return await this._send(t,e)}finally{i()}},n.prototype._send=async function(t,e){const i=await this.createTX(t,!0);if(await this.sign(i,e),!i.isSigned())throw new Error("TX could not be fully signed.");const n=i.toTX();if(n.getSigopsCost(i.view)>A.MAX_TX_SIGOPS_COST)throw new Error("TX exceeds policy sigops.");if(n.getWeight()>A.MAX_TX_WEIGHT)throw new Error("TX exceeds policy weight.");return await this.db.addTX(n),this.logger.debug("Sending wallet tx (%s): %s",this.id,n.txid()),await this.db.send(n),n},n.prototype.increaseFee=async function(t,e,i){r(a.isU32(e),"Rate must be a number.");const n=await this.getTX(t);if(!n)throw new Error("Transaction not found.");if(-1!==n.height)throw new Error("Transaction is confirmed.");const s=n.tx;if(s.isCoinbase())throw new Error("Transaction is a coinbase.");const o=await this.getSpentView(s);if(!s.hasCoins(o))throw new Error("Not all coins available.");const h=s.getFee(o);let c=s.getMinFee(null,e);if(c>v.Selector.MAX_FEE&&(c=v.Selector.MAX_FEE),h>=c)throw new Error("Fee is not increasing.");const u=v.fromTX(s);u.view=o;for(const t of u.inputs)t.script.clear(),t.witness.clear();let f;for(let t=0;t<u.outputs.length;t++){const e=u.outputs[t],i=e.getAddress();if(!i)continue;const n=await this.getPath(i);if(n&&1===n.branch){f=e,u.changeIndex=t;break}}if(!f)throw new Error("No change output.");if(f.value+=h,0!==u.getFee())throw new Error("Arithmetic error for change.");if(f.value-=c,f.value<0)throw new Error("Fee is too high.");if(f.isDust()&&(u.outputs.splice(u.changeIndex,1),u.changeIndex=-1),await this.sign(u,i),!u.isSigned())throw new Error("TX could not be fully signed.");const l=u.toTX();return this.logger.debug("Increasing fee for wallet tx (%s): %s",this.id,l.txid()),await this.db.addTX(l),await this.db.send(l),l},n.prototype.resend=async function(){const t=await this.getPending();t.length>0&&this.logger.info("Rebroadcasting %d transactions.",t.length);const e=[];for(const i of t)e.push(i.tx);const i=w.sortDeps(e);for(const t of i)await this.db.send(t);return e},n.prototype.deriveInputs=async function(t){r(t.mutable);const e=await this.getInputPaths(t),i=[];for(const t of e){const e=await this.getAccount(t.account);if(!e)continue;const n=e.derivePath(t,this.master);n&&i.push(n)}return i},n.prototype.getKey=async function(t){const e=b.getHash(t,"hex"),i=await this.getPath(e);if(!i)return null;const n=await this.getAccount(i.account);return n?n.derivePath(i,this.master):null},n.prototype.getPrivateKey=async function(t,e){const i=b.getHash(t,"hex"),n=await this.getPath(i);if(!n)return null;const r=await this.getAccount(n.account);if(!r)return null;await this.unlock(e);const s=r.derivePath(n,this.master);return s.privateKey?s:null},n.prototype.getInputPaths=async function(t){if(r(t.mutable),!t.hasCoins())throw new Error("Not all coins available.");const e=t.getInputHashes("hex"),i=[];for(const t of e){const e=await this.getPath(t);e&&i.push(e)}return i},n.prototype.getOutputPaths=async function(t){const e=[],i=t.getOutputHashes("hex");for(const t of i){const i=await this.getPath(t);i&&e.push(i)}return e},n.prototype.setLookahead=async function(t,e){const i=await this.writeLock.lock();try{return this._setLookahead(t,e)}finally{i()}},n.prototype._setLookahead=async function(t,e){null==e&&(e=t,t=null),null==t&&(t=0);const i=await this.getAccount(t);if(!i)throw new Error("Account not found.");this.start();try{await i.setLookahead(e)}catch(t){throw this.drop(),t}await this.commit()},n.prototype.syncOutputDepth=async function(t){const e=new Map;for(const i of t.outputs){const t=i.path;t&&(-1!==t.index&&(e.has(t.account)||e.set(t.account,[]),e.get(t.account).push(t)))}const i=[];for(const[t,n]of e){let e=-1,s=-1,o=-1;for(const t of n)switch(t.branch){case 0:t.index>e&&(e=t.index);break;case 1:t.index>s&&(s=t.index);break;case 2:t.index>o&&(o=t.index)}e+=2,s+=2,o+=2;const a=await this.getAccount(t);r(a);const h=await a.syncDepth(e,s,o);h&&i.push(h)}return i},n.prototype.getRedeem=async function(t){"string"==typeof t&&(t=Buffer.from(t,"hex"));const e=await this.getKey(t.toString("hex"));return e?e.getRedeem(t):null},n.prototype.template=async function(t){const e=await this.deriveInputs(t);return t.template(e)},n.prototype.sign=async function(t,e){if(this.watchOnly)throw new Error("Cannot sign from a watch-only wallet.");await this.unlock(e);const i=await this.deriveInputs(t);return await t.signAsync(i,k.hashType.ALL,this.db.workers)},n.prototype.getCoinView=function(t){return this.txdb.getCoinView(t)},n.prototype.getSpentView=function(t){return this.txdb.getSpentView(t)},n.prototype.toDetails=function(t){return this.txdb.toDetails(t)},n.prototype.getDetails=function(t){return this.txdb.getDetails(t)},n.prototype.getCoin=function(t,e){return this.txdb.getCoin(t,e)},n.prototype.getTX=function(t){return this.txdb.getTX(t)},n.prototype.getBlocks=function(){return this.txdb.getBlocks()},n.prototype.getBlock=function(t){return this.txdb.getBlock(t)},n.prototype.add=async function(t,e){const i=await this.writeLock.lock();try{return await this._add(t,e)}finally{i()}},n.prototype._add=async function(t,e){this.txdb.start();let i,n;try{(i=await this.txdb._add(t,e))&&(n=await this.syncOutputDepth(i))}catch(t){throw this.txdb.drop(),t}return await this.txdb.commit(),n&&n.length>0&&(this.db.emit("address",this.id,n),this.emit("address",n)),i},n.prototype.unconfirm=async function(t){const e=await this.writeLock.lock();try{return await this.txdb.unconfirm(t)}finally{e()}},n.prototype.remove=async function(t){const e=await this.writeLock.lock();try{return await this.txdb.remove(t)}finally{e()}},n.prototype.zap=async function(t,e){const i=await this.writeLock.lock();try{return await this._zap(t,e)}finally{i()}},n.prototype._zap=async function(t,e){const i=await this.ensureIndex(t);return await this.txdb.zap(i,e)},n.prototype.abandon=async function(t){const e=await this.writeLock.lock();try{return await this._abandon(t)}finally{e()}},n.prototype._abandon=function(t){return this.txdb.abandon(t)},n.prototype.lockCoin=function(t){return this.txdb.lockCoin(t)},n.prototype.unlockCoin=function(t){return this.txdb.unlockCoin(t)},n.prototype.isLocked=function(t){return this.txdb.isLocked(t)},n.prototype.getLocked=function(){return this.txdb.getLocked()},n.prototype.getHistory=async function(t){const e=await this.ensureIndex(t);return this.txdb.getHistory(e)},n.prototype.getCoins=async function(t){const e=await this.ensureIndex(t);return await this.txdb.getCoins(e)},n.prototype.getCredits=async function(t){const e=await this.ensureIndex(t);return await this.txdb.getCredits(e)},n.prototype.getSmartCoins=async function(t){const e=await this.getCredits(t),i=[];for(const t of e){const e=t.coin;t.spent||(this.txdb.isLocked(e)||(-1===e.height?t.own&&i.push(e):i.push(e)))}return i},n.prototype.getPending=async function(t){const e=await this.ensureIndex(t);return await this.txdb.getPending(e)},n.prototype.getPendingDetails=async function(t){const e=await this.ensureIndex(t);return await this.txdb.getPendingDetails(e)},n.prototype.getBalance=async function(t){const e=await this.ensureIndex(t);return await this.txdb.getBalance(e)},n.prototype.getBalanceDetails=async function(t){const e=await this.ensureIndex(t);return await this.txdb.getBalanceDetails(e)},n.prototype.getRange=async function(t,e){t&&"object"==typeof t&&(e=t,t=null);const i=await this.ensureIndex(t);return await this.txdb.getRange(i,e)},n.prototype.getLast=async function(t,e){const i=await this.ensureIndex(t);return await this.txdb.getLast(i,e)},n.prototype.getTransactions=async function(t,e,i){const n=await this.ensureIndex(t);return await this.txdb.getTransactions(n,e,i)},n.prototype.getTotal=async function(t){const e=await this.ensureIndex(t);return await this.txdb.getTotal(e)},n.prototype.ensureIndex=async function(t,e){if(null==t){if(e)throw new Error("No account provided.");return null}const i=await this.getAccountIndex(t);if(-1===i)throw new Error("Account not found.");return i},n.prototype.getAddress=function(t){return this.account.getAddress(t)},n.prototype.getReceive=function(t){return this.account.getReceive(t)},n.prototype.getChange=function(t){return this.account.getChange(t)},n.prototype.getNested=function(t){return this.account.getNested(t)},n.prototype.getTempReceive=function(t){return this.account.getTempReceive(t)},n.prototype.inspect=function(){return{wid:this.wid,id:this.id,network:this.network.type,initialized:this.initialized,accountDepth:this.accountDepth,token:this.token.toString("hex"),tokenDepth:this.tokenDepth,lock:this.lock.toString("hex"),chksum:this.chksum.toString("hex"),state:this.txdb.state?this.txdb.state.toJSON(!0):null,master:this.master,account:this.account}},n.prototype.toJSON=function(t){return{network:this.network.type,wid:this.wid,id:this.id,initialized:this.initialized,watchOnly:this.watchOnly,accountDepth:this.accountDepth,token:this.token.toString("hex"),tokenDepth:this.tokenDepth,lock:this.lock.toString("hex"),chksum:this.chksum.toString("hex"),state:this.txdb.state.toJSON(!0),master:this.master.toJSON(t),account:this.account.toJSON(!0)}},n.prototype.getSize=function(){let t=0;return t+=54,t+=h.sizeVarBytes(this.lock),t+=h.sizeVarString(this.id,"ascii"),t+=h.sizeVarlen(this.master.getSize())},n.prototype.toRaw=function(){const t=this.getSize(),e=new d(t);return e.writeU32(this.network.magic),e.writeU32(this.wid),e.writeVarString(this.id,"ascii"),e.writeU8(this.initialized?1:0),e.writeU8(this.watchOnly?1:0),e.writeU32(this.accountDepth),e.writeBytes(this.token),e.writeU32(this.tokenDepth),e.writeVarBytes(this.lock),e.writeBytes(this.chksum),e.writeVarBytes(this.master.toRaw()),e.render()},n.prototype.fromRaw=function(t){const e=new p(t),i=o.fromMagic(e.readU32());return this.wid=e.readU32(),this.id=e.readVarString("ascii"),this.initialized=1===e.readU8(),this.watchOnly=1===e.readU8(),this.accountDepth=e.readU32(),this.token=e.readBytes(32),this.tokenDepth=e.readU32(),this.lock=e.readVarBytes(),this.chksum=e.readBytes(4),this.master.fromRaw(e.readVarBytes()),r(i===this.db.network,"Wallet network mismatch."),this},n.fromRaw=function(t,e){return new n(t).fromRaw(e)},n.isWallet=function(t){return t instanceof n},t.exports=n},function(t,e,i){"use strict";function n(t){if(!(this instanceof n))return new n(t);this.wallet=t,this.walletdb=t.db,this.db=t.db.db,this.logger=t.db.logger,this.network=t.db.network,this.options=t.db.options,this.coinCache=new l(1e4),this.locked=new Set,this.state=null,this.pending=null,this.events=[]}function r(t,e,i){if(!(this instanceof r))return new r(t,e,i);this.wid=t,this.id=e,this.account=i,this.unconfirmed=0,this.confirmed=0}function s(t,e,i,n){if(!(this instanceof s))return new s(e,i,n);this.wid=e,this.id=i,this.account=n,this.chainHeight=t.walletdb.state.height,this.total=0,this.available=0,this.pending=0,this.immature=0}function o(t,e){this.wid=t,this.id=e,this.tx=0,this.coin=0,this.unconfirmed=0,this.confirmed=0,this.committed=!1}function a(t,e){if(!(this instanceof a))return new a(t,e);this.coin=t||new w,this.spent=e||!1,this.own=!1}function h(t,e,i){if(!(this instanceof h))return new h(t,e,i);this.wallet=t.wallet,this.network=this.wallet.network,this.wid=this.wallet.wid,this.id=this.wallet.id,this.chainHeight=t.walletdb.state.height,this.hash=e.hash,this.tx=e.tx,this.mtime=e.mtime,this.size=this.tx.getSize(),this.vsize=this.tx.getVirtualSize(),this.block=null,this.height=-1,this.time=0,i&&(this.block=i.hash,this.height=i.height,this.time=i.time),this.inputs=[],this.outputs=[],this.init()}function c(){if(!(this instanceof c))return new c;this.value=0,this.address=null,this.path=null}function u(t,e,i){if(!(this instanceof u))return new u(t,e,i);this.hash=t||S.NULL_HASH,this.height=null!=e?e:-1,this.time=i||0,this.hashes=[],this.index=new Set}const f=i(1),l=i(57),p=i(0),d=i(2),m=i(4),g=i(20),y=i(29),w=i(43),b=i(21),v=i(129),k=i(188).txdb,S=i(3),E=i(7),R=i(19),x=i(8),_=v.BlockMapRecord,I=v.OutpointMapRecord,A=v.TXRecord;n.layout=k,n.prototype.open=async function(){const t=await this.getState();t?(this.state=t,this.logger.info("TXDB loaded for %s.",this.wallet.id)):(this.state=new o(this.wallet.wid,this.wallet.id),this.logger.info("TXDB created for %s.",this.wallet.id)),this.logger.info("TXDB State: tx=%d coin=%s.",this.state.tx,this.state.coin),this.logger.info("Balance: unconfirmed=%s confirmed=%s.",g.wmcc(this.state.unconfirmed),g.wmcc(this.state.confirmed))},n.prototype.start=function(){return this.pending=this.state.clone(),this.coinCache.start(),this.wallet.start()},n.prototype.drop=function(){return this.pending=null,this.events.length=0,this.coinCache.drop(),this.wallet.drop()},n.prototype.clear=function(){return this.pending=this.state.clone(),this.events.length=0,this.coinCache.clear(),this.wallet.clear()},n.prototype.commit=async function(){try{await this.wallet.commit()}catch(t){throw this.pending=null,this.events.length=0,this.coinCache.drop(),t}if(this.pending.committed){this.state=this.pending;for(const[t,e,i]of this.events)this.walletdb.emit(t,this.wallet.id,e,i),this.wallet.emit(t,e,i)}this.pending=null,this.events.length=0,this.coinCache.commit()},n.prototype.emit=function(t,e,i){this.events.push([t,e,i])},n.prototype.prefix=function(t){return p(this.wallet.wid),k.prefix(this.wallet.wid,t)},n.prototype.put=function(t,e){p(this.wallet.current),this.wallet.current.put(this.prefix(t),e)},n.prototype.del=function(t){p(this.wallet.current),this.wallet.current.del(this.prefix(t))},n.prototype.get=function(t){return this.db.get(this.prefix(t))},n.prototype.has=function(t){return this.db.has(this.prefix(t))},n.prototype.range=function(t){return t.gte&&(t.gte=this.prefix(t.gte)),t.lte&&(t.lte=this.prefix(t.lte)),this.db.range(t)},n.prototype.offset=function(t){return t.gte&&(t.gte=this.prefix(t.gte)),t.lte&&(t.lte=this.prefix(t.lte)),this.db.offset(t)},n.prototype.keys=function(t){return t.gte&&(t.gte=this.prefix(t.gte)),t.lte&&(t.lte=this.prefix(t.lte)),this.db.keys(t)},n.prototype.values=function(t){return t.gte&&(t.gte=this.prefix(t.gte)),t.lte&&(t.lte=this.prefix(t.lte)),this.db.values(t)},n.prototype.total=function(t){return t.gte&&(t.gte=this.prefix(t.gte)),t.lte&&(t.lte=this.prefix(t.lte)),this.db.count(t)},n.prototype.getPath=async function(t){const e=t.getAddress();return e?await this.wallet.getPath(e):null},n.prototype.hasPath=async function(t){const e=t.getAddress();return!!e&&await this.wallet.hasPath(e)},n.prototype.saveCredit=async function(t,e){const i=t.coin,n=i.toKey(),r=t.toRaw();await this.addOutpointMap(i.hash,i.index),this.put(k.c(i.hash,i.index),r),this.put(k.C(e.account,i.hash,i.index),null),this.coinCache.push(n,r)},n.prototype.removeCredit=async function(t,e){const i=t.coin,n=i.toKey();await this.removeOutpointMap(i.hash,i.index),this.del(k.c(i.hash,i.index)),this.del(k.C(e.account,i.hash,i.index)),this.coinCache.unpush(n)},n.prototype.spendCredit=function(t,e,i){const n=e.inputs[i].prevout,r=b.fromTX(e,i);this.put(k.s(n.hash,n.index),r.toRaw()),this.put(k.d(r.hash,r.index),t.coin.toRaw())},n.prototype.unspendCredit=function(t,e){const i=t.inputs[e].prevout,n=b.fromTX(t,e);this.del(k.s(i.hash,i.index)),this.del(k.d(n.hash,n.index))},n.prototype.writeInput=function(t,e){const i=t.inputs[e].prevout,n=b.fromTX(t,e);this.put(k.s(i.hash,i.index),n.toRaw())},n.prototype.removeInput=function(t,e){const i=t.inputs[e].prevout;this.del(k.s(i.hash,i.index))},n.prototype.resolveInput=async function(t,e,i,n,r){const s=t.hash("hex"),o=await this.getSpent(s,e);if(!o)return!1;if(await this.hasSpentCoin(o))return!1;const h=await this.getTX(o.hash);p(h);const c=a.fromTX(t,e,i);return c.own=r,this.spendCredit(c,h.tx,o.index),-1===h.height&&(c.spent=!0,await this.saveCredit(c,n),-1!==i&&(this.pending.confirmed+=c.coin.value)),!0},n.prototype.isDoubleSpend=async function(t){for(const{prevout:e}of t.inputs){if(await this.isSpent(e.hash,e.index))return!0}return!1},n.prototype.isRBF=async function(t){if(t.isRBF())return!0;for(const{prevout:e}of t.inputs){const t=k.r(e.hash);if(await this.has(t))return!0}return!1},n.prototype.getSpent=async function(t,e){const i=await this.get(k.s(t,e));return i?b.fromRaw(i):null},n.prototype.isSpent=function(t,e){return this.has(k.s(t,e))},n.prototype.addOutpointMap=async function(t,e){let i=await this.walletdb.getOutpointMap(t,e);i||(i=new I(t,e)),i.add(this.wallet.wid)&&this.walletdb.writeOutpointMap(this.wallet,t,e,i)},n.prototype.removeOutpointMap=async function(t,e){const i=await this.walletdb.getOutpointMap(t,e);i&&i.remove(this.wallet.wid)&&(0!==i.wids.size?this.walletdb.writeOutpointMap(this.wallet,t,e,i):this.walletdb.unwriteOutpointMap(this.wallet,t,e))},n.prototype.addBlockMap=async function(t,e){let i=await this.walletdb.getBlockMap(e);i||(i=new _(e)),i.add(t,this.wallet.wid)&&this.walletdb.writeBlockMap(this.wallet,e,i)},n.prototype.removeBlockMap=async function(t,e){const i=await this.walletdb.getBlockMap(e);i&&i.remove(t,this.wallet.wid)&&(0!==i.txs.size?this.walletdb.writeBlockMap(this.wallet,e,i):this.walletdb.unwriteBlockMap(this.wallet,e))},n.prototype.getBlocks=function(){return this.keys({gte:k.b(0),lte:k.b(4294967295),parse:t=>k.bb(t)})},n.prototype.getBlock=async function(t){const e=await this.get(k.b(t));return e?u.fromRaw(e):null},n.prototype.addBlock=async function(t,e){const i=k.b(e.height);let n,r=await this.get(i);r||(r=(n=u.fromMeta(e)).toRaw()),n=Buffer.allocUnsafe(r.length+32),r.copy(n,0);const s=n.readUInt32LE(40,!0);n.writeUInt32LE(s+1,40,!0),t.copy(n,r.length),this.put(i,n)},n.prototype.removeBlock=async function(t,e){const i=k.b(e),n=await this.get(i);if(!n)return;const r=n.readUInt32LE(40,!0);if(p(r>0),p(n.slice(-32).equals(t)),1===r)return void this.del(i);const s=n.slice(0,-32);s.writeUInt32LE(r-1,40,!0),this.put(i,s)},n.prototype.addBlockSlow=async function(t,e){let i=await this.getBlock(e.height);i||(i=u.fromMeta(e)),i.add(t)&&this.put(k.b(e.height),i.toRaw())},n.prototype.removeBlockSlow=async function(t,e){const i=await this.getBlock(e);i&&i.remove(t)&&(0!==i.hashes.length?this.put(k.b(e),i.toRaw()):this.del(k.b(e)))},n.prototype.add=async function(t,e){this.start();let i;try{i=await this._add(t,e)}catch(t){throw this.drop(),t}return await this.commit(),i},n.prototype._add=async function(t,e){const i=t.hash("hex"),n=await this.getTX(i);if(p(!t.mutable,"Cannot add mutable TX to wallet."),n)return-1!==n.height?null:e?await this._confirm(n,e):null;const r=A.fromTX(t,e);if(e)await this.removeConflicts(t,!1),this.del(k.r(i));else{if(await this.isRBF(t))return this.put(k.r(i),null),null;if(!await this.removeConflicts(t,!0))return null}return await this.insert(r,e)},n.prototype.insert=async function(t,e){const i=t.tx,n=t.hash,r=e?e.height:-1,s=new h(this,t,e),o=new Set;let c=!1,u=!1;if(!i.isCoinbase())for(let t=0;t<i.inputs.length;t++){const n=i.inputs[t].prevout,r=await this.getCredit(n.hash,n.index);if(!r){this.writeInput(i,t);continue}const a=r.coin;if(!e&&!await this.verifyInput(i,t,a))return this.clear(),null;const h=await this.getPath(a);p(h),s.setInput(t,h,a),o.add(h.account),this.spendCredit(r,i,t),this.pending.coin--,this.pending.unconfirmed-=a.value,e?(this.pending.confirmed-=a.value,await this.removeCredit(r,h)):(r.spent=!0,await this.saveCredit(r,h)),u=!0,c=!0}for(let t=0;t<i.outputs.length;t++){const n=i.outputs[t],h=await this.getPath(n);if(!h)continue;if(s.setOutput(t,h),o.add(h.account),await this.resolveInput(i,t,r,h,c)){u=!0;continue}const f=a.fromTX(i,t,r);f.own=c,this.pending.coin++,this.pending.unconfirmed+=n.value,e&&(this.pending.confirmed+=n.value),await this.saveCredit(f,h),u=!0}if(!u)return this.clear(),null;this.put(k.t(n),t.toRaw()),this.put(k.m(t.mtime,n),null),e?this.put(k.h(r,n),null):this.put(k.p(n),null);for(const i of o)this.put(k.T(i,n),null),this.put(k.M(i,t.mtime,n),null),e?this.put(k.H(i,r,n),null):this.put(k.P(i,n),null);return e&&(await this.addBlockMap(n,r),await this.addBlock(i.hash(),e)),this.pending.tx++,this.put(k.R,this.pending.commit()),this.unlockTX(i),this.emit("tx",i,s),this.emit("balance",this.pending.toBalance(),s),s},n.prototype.confirm=async function(t,e){const i=await this.getTX(t);if(!i)return null;if(-1!==i.height)throw new Error("TX is already confirmed.");p(e),this.start();let n;try{n=await this._confirm(i,e)}catch(t){throw this.drop(),t}return await this.commit(),n},n.prototype._confirm=async function(t,e){const i=t.tx,n=t.hash,r=e.height,s=new h(this,t,e),o=new Set;if(t.setBlock(e),!i.isCoinbase()){const t=await this.getSpentCredits(i);for(let e=0;e<i.inputs.length;e++){const n=i.inputs[e].prevout;let r=t[e];if(!r){if(!(r=await this.getCredit(n.hash,n.index)))continue;this.spendCredit(r,i,e),this.pending.coin--,this.pending.unconfirmed-=r.coin.value}const a=r.coin;p(-1!==a.height);const h=await this.getPath(a);p(h),s.setInput(e,h,a),o.add(h.account),this.pending.confirmed-=a.value,await this.removeCredit(r,h)}}for(let t=0;t<i.outputs.length;t++){const e=i.outputs[t],a=await this.getPath(e);if(!a)continue;s.setOutput(t,a),o.add(a.account);const h=await this.getCredit(n,t);p(h),h.spent&&await this.updateSpentCoin(i,t,r);h.coin.height=r,this.pending.confirmed+=e.value,await this.saveCredit(h,a)}this.del(k.r(n)),this.put(k.t(n),t.toRaw()),this.del(k.p(n)),this.put(k.h(r,n),null);for(const t of o)this.del(k.P(t,n)),this.put(k.H(t,r,n),null);return e&&(await this.addBlockMap(n,r),await this.addBlock(i.hash(),e)),this.put(k.R,this.pending.commit()),this.unlockTX(i),this.emit("confirmed",i,s),this.emit("balance",this.pending.toBalance(),s),s},n.prototype.remove=async function(t){const e=await this.getTX(t);return e?await this.removeRecursive(e):null},n.prototype.erase=async function(t,e){const i=t.tx,n=t.hash,r=e?e.height:-1,s=new h(this,t,e),o=new Set;if(!i.isCoinbase()){const t=await this.getSpentCredits(i);for(let n=0;n<i.inputs.length;n++){const r=t[n];if(!r){this.removeInput(i,n);continue}const a=r.coin,h=await this.getPath(a);p(h),s.setInput(n,h,a),o.add(h.account),this.pending.coin++,this.pending.unconfirmed+=a.value,e&&(this.pending.confirmed+=a.value),this.unspendCredit(i,n),await this.saveCredit(r,h)}}for(let t=0;t<i.outputs.length;t++){const n=i.outputs[t],h=await this.getPath(n);if(!h)continue;s.setOutput(t,h),o.add(h.account);const c=a.fromTX(i,t,r);this.pending.coin--,this.pending.unconfirmed-=n.value,e&&(this.pending.confirmed-=n.value),await this.removeCredit(c,h)}this.del(k.r(n)),this.del(k.t(n)),this.del(k.m(t.mtime,n)),e?this.del(k.h(r,n)):this.del(k.p(n));for(const i of o)this.del(k.T(i,n)),this.del(k.M(i,t.mtime,n)),e?this.del(k.H(i,r,n)):this.del(k.P(i,n));return e&&(await this.removeBlockMap(n,r),await this.removeBlockSlow(n,r)),this.pending.tx--,this.put(k.R,this.pending.commit()),this.emit("remove tx",i,s),this.emit("balance",this.pending.toBalance(),s),s},n.prototype.removeRecursive=async function(t){const e=t.tx,i=t.hash;for(let t=0;t<e.outputs.length;t++){const e=await this.getSpent(i,t);if(!e)continue;const n=await this.getTX(e.hash);p(n),await this.removeRecursive(n)}this.start();const n=await this.erase(t,t.getBlock());return p(n),await this.commit(),n},n.prototype.unconfirm=async function(t){this.start();let e;try{e=await this._unconfirm(t)}catch(t){throw this.drop(),t}return await this.commit(),e},n.prototype._unconfirm=async function(t){const e=await this.getTX(t);return e?-1===e.height?null:await this.disconnect(e,e.getBlock()):null},n.prototype.disconnect=async function(t,e){const i=t.tx,n=t.hash,r=e.height,s=new h(this,t,e),o=new Set;if(p(e),t.unsetBlock(),!i.isCoinbase()){const t=await this.getSpentCredits(i);for(let e=0;e<i.inputs.length;e++){const i=t[e];if(!i)continue;const n=i.coin;p(-1!==n.height);const r=await this.getPath(n);p(r),s.setInput(e,r,n),o.add(r.account),this.pending.confirmed+=n.value,i.spent=!0,await this.saveCredit(i,r)}}for(let t=0;t<i.outputs.length;t++){const e=i.outputs[t],a=await this.getPath(e);if(!a)continue;const h=await this.getCredit(n,t);if(!h){await this.updateSpentCoin(i,t,r);continue}h.spent&&await this.updateSpentCoin(i,t,r),s.setOutput(t,a),o.add(a.account);h.coin.height=-1,this.pending.confirmed-=e.value,await this.saveCredit(h,a)}await this.removeBlockMap(n,r),await this.removeBlock(i.hash(),r),this.put(k.t(n),t.toRaw()),this.put(k.p(n),null),this.del(k.h(r,n));for(const t of o)this.put(k.P(t,n),null),this.del(k.H(t,r,n));return this.put(k.R,this.pending.commit()),this.emit("unconfirmed",i,s),this.emit("balance",this.pending.toBalance(),s),s},n.prototype.removeConflict=async function(t){const e=t.tx;this.logger.warning("Handling conflicting tx: %s.",e.txid()),this.drop();const i=await this.removeRecursive(t);return this.start(),this.logger.warning("Removed conflict: %s.",e.txid()),this.emit("conflict",e,i),i},n.prototype.removeConflicts=async function(t,e){const i=t.hash("hex"),n=[];if(t.isCoinbase())return!0;for(let r=0;r<t.inputs.length;r++){const s=t.inputs[r].prevout,o=await this.getSpent(s.hash,s.index);if(!o)continue;if(o.hash===i)continue;const a=await this.getTX(o.hash);p(a);const h=a.getBlock();if(e&&h)return!1;n[r]=a}for(const t of n)t&&await this.removeConflict(t);return!0},n.prototype.verifyInput=async function(t,e,i){const n=x.flags.MANDATORY_VERIFY_FLAGS;return!this.options.verify||await t.verifyInputAsync(e,i,n)},n.prototype.lockTX=function(t){if(!t.isCoinbase())for(const e of t.inputs)this.lockCoin(e.prevout)},n.prototype.unlockTX=function(t){if(!t.isCoinbase())for(const e of t.inputs)this.unlockCoin(e.prevout)},n.prototype.lockCoin=function(t){const e=t.toKey();this.locked.add(e)},n.prototype.unlockCoin=function(t){const e=t.toKey();return this.locked.delete(e)},n.prototype.isLocked=function(t){const e=t.toKey();return this.locked.has(e)},n.prototype.filterLocked=function(t){const e=[];for(const i of t)this.isLocked(i)||e.push(i);return e},n.prototype.getLocked=function(){const t=[];for(const e of this.locked.keys())t.push(b.fromKey(e));return t},n.prototype.getAccountHistoryHashes=function(t){return this.keys({gte:k.T(t,S.NULL_HASH),lte:k.T(t,S.HIGH_HASH),parse:t=>{const[,e]=k.Tt(t);return e}})},n.prototype.getHistoryHashes=function(t){return null!=t?this.getAccountHistoryHashes(t):this.keys({gte:k.t(S.NULL_HASH),lte:k.t(S.HIGH_HASH),parse:t=>k.tt(t)})},n.prototype.getAccountPendingHashes=function(t){return this.keys({gte:k.P(t,S.NULL_HASH),lte:k.P(t,S.HIGH_HASH),parse:t=>{const[,e]=k.Pp(t);return e}})},n.prototype.getPendingHashes=function(t){return null!=t?this.getAccountPendingHashes(t):this.keys({gte:k.p(S.NULL_HASH),lte:k.p(S.HIGH_HASH),parse:t=>k.pp(t)})},n.prototype.getAccountOutpoints=function(t){return this.keys({gte:k.C(t,S.NULL_HASH,0),lte:k.C(t,S.HIGH_HASH,4294967295),parse:t=>{const[,e,i]=k.Cc(t);return new b(e,i)}})},n.prototype.getOutpoints=function(t){return null!=t?this.getAccountOutpoints(t):this.keys({gte:k.c(S.NULL_HASH,0),lte:k.c(S.HIGH_HASH,4294967295),parse:t=>{const[e,i]=k.cc(t);return new b(e,i)}})},n.prototype.getAccountHeightRangeHashes=function(t,e){const i=e.start||0,n=e.end||4294967295;return this.keys({gte:k.H(t,i,S.NULL_HASH),lte:k.H(t,n,S.HIGH_HASH),limit:e.limit,reverse:e.reverse,parse:t=>{const[,,e]=k.Hh(t);return e}})},n.prototype.getHeightRangeHashes=function(t,e){if(t&&"object"==typeof t&&(e=t,t=null),null!=t)return this.getAccountHeightRangeHashes(t,e);const i=e.start||0,n=e.end||4294967295;return this.keys({gte:k.h(i,S.NULL_HASH),lte:k.h(n,S.HIGH_HASH),limit:e.limit,reverse:e.reverse,parse:t=>{const[,e]=k.hh(t);return e}})},n.prototype.getHeightHashes=function(t){return this.getHeightRangeHashes({start:t,end:t})},n.prototype.getAccountRangeHashes=function(t,e){const i=e.start||0,n=e.end||4294967295;return this.keys({gte:k.M(t,i,S.NULL_HASH),lte:k.M(t,n,S.HIGH_HASH),limit:e.limit,reverse:e.reverse,parse:t=>{const[,,e]=k.Mm(t);return e}})},n.prototype.getRangeHashes=function(t,e){if(t&&"object"==typeof t&&(e=t,t=null),null!=t)return this.getAccountRangeHashes(t,e);const i=e.start||0,n=e.end||4294967295;return this.keys({gte:k.m(i,S.NULL_HASH),lte:k.m(n,S.HIGH_HASH),limit:e.limit,reverse:e.reverse,parse:t=>{const[,e]=k.mm(t);return e}})},n.prototype.getRange=async function(t,e){const i=[];t&&"object"==typeof t&&(e=t,t=null);const n=await this.getRangeHashes(t,e);for(const t of n){const e=await this.getTX(t);p(e),i.push(e)}return i},n.prototype.getAccountOffsetHashes=async function(t,e){const i=e.start||0,n=e.end||4294967295,r=[];let s=0,o=0;return await this.offset({gte:k.M(t,i,S.NULL_HASH),lte:k.M(t,n,S.HIGH_HASH),reverse:e.reverse,parse:t=>{const[,,e]=k.Mm(t);return e},break:async t=>{const i=await this.getTX(t);p(i);const n=await this.toDetails(i);return n.block&&++s>e.offset&&(r.push(n),o++),o>=e.limit}}),r},n.prototype.getOffsetHashes=async function(t,e){if(t&&"object"==typeof t&&(e=t,t=null),null!=t)return this.getAccountOffsetHashes(t,e);const i=e.start||0,n=e.end||4294967295,r=[];let s=0,o=0;return await this.offset({gte:k.m(i,S.NULL_HASH),lte:k.m(n,S.HIGH_HASH),reverse:e.reverse,parse:t=>{const[,e]=k.mm(t);return e},break:async t=>{const i=await this.getTX(t);p(i);const n=await this.toDetails(i);return n.block&&++s>e.offset&&(r.push(n),o++),o>=e.limit}}),r},n.prototype.getOffset=async function(t,e){return t&&"object"==typeof t&&(e=t,t=null),await this.getOffsetHashes(t,e)},n.prototype.getLast=function(t,e){return this.getRange(t,{start:0,end:4294967295,reverse:!0,limit:e||10})},n.prototype.getTransactions=function(t,e,i){return this.getOffset(t,{start:0,end:4294967295,reverse:!0,offset:i||0,limit:e||10})},n.prototype.getHistory=function(t){return null!=t?this.getAccountHistory(t):this.values({gte:k.t(S.NULL_HASH),lte:k.t(S.HIGH_HASH),parse:A.fromRaw})},n.prototype.getAccountHistory=async function(t){const e=await this.getHistoryHashes(t),i=[];for(const t of e){const e=await this.getTX(t);p(e),i.push(e)}return i},n.prototype.getPending=async function(t){const e=await this.getPendingHashes(t),i=[];for(const t of e){const e=await this.getTX(t);p(e),i.push(e)}return i},n.prototype.getPendingDetails=async function(t){const e=await this.getPendingHashes(t),i=[];for(const t of e){const e=await this.getTX(t);p(e);const n=await this.toDetails(e);i.push(n)}return i},n.prototype.getCredits=function(t){return null!=t?this.getAccountCredits(t):this.range({gte:k.c(S.NULL_HASH,0),lte:k.c(S.HIGH_HASH,4294967295),parse:(t,e)=>{const[i,n]=k.cc(t),r=a.fromRaw(e),s=b.toKey(i,n);return r.coin.hash=i,r.coin.index=n,this.coinCache.set(s,e),r}})},n.prototype.getAccountCredits=async function(t){const e=await this.getOutpoints(t),i=[];for(const t of e){const e=await this.getCredit(t.hash,t.index);p(e),i.push(e)}return i},n.prototype.getSpentCredits=async function(t){if(t.isCoinbase())return[];const e=t.hash("hex"),i=[];for(let e=0;e<t.inputs.length;e++)i.push(null);return await this.range({gte:k.d(e,0),lte:k.d(e,4294967295),parse:(e,n)=>{const[,r]=k.dd(e),s=w.fromRaw(n),o=t.inputs[r];p(o),s.hash=o.prevout.hash,s.index=o.prevout.index,i[r]=new a(s)}}),i},n.prototype.getCoins=async function(t){const e=await this.getCredits(t),i=[];for(const t of e)t.spent||i.push(t.coin);return i},n.prototype.getAccountCoins=async function(t){const e=await this.getAccountCredits(t),i=[];for(const t of e)t.spent||i.push(t.coin);return i},n.prototype.getSpentCoins=async function(t){if(t.isCoinbase())return[];const e=await this.getSpentCredits(t),i=[];for(const t of e)t?i.push(t.coin):i.push(null);return i},n.prototype.getCoinView=async function(t){const e=new y;if(t.isCoinbase())return e;for(const i of t.inputs){const t=i.prevout,n=await this.getCoin(t.hash,t.index);n&&e.addCoin(n)}return e},n.prototype.getSpentView=async function(t){const e=new y;if(t.isCoinbase())return e;const i=await this.getSpentCoins(t);for(const t of i)t&&e.addCoin(t);return e},n.prototype.getState=async function(){const t=await this.get(k.R);return t?o.fromRaw(this.wallet.wid,this.wallet.id,t):null},n.prototype.getTX=async function(t){const e=await this.get(k.t(t));return e?A.fromRaw(e):null},n.prototype.getDetails=async function(t){const e=await this.getTX(t);return e?await this.toDetails(e):null},n.prototype.toDetails=async function(t){const e=[];if(!Array.isArray(t))return await this._toDetails(t);for(const i of t){const t=await this._toDetails(i);t&&e.push(t)}return e},n.prototype._toDetails=async function(t){const e=t.tx,i=new h(this,t,t.getBlock()),n=await this.getSpentCoins(e);for(let t=0;t<e.inputs.length;t++){const e=n[t];let r=null;e&&(r=await this.getPath(e)),i.setInput(t,r,e)}for(let t=0;t<e.outputs.length;t++){const n=e.outputs[t],r=await this.getPath(n);i.setOutput(t,r)}return i},n.prototype.hasTX=function(t){return this.has(k.t(t))},n.prototype.getCoin=async function(t,e){const i=await this.getCredit(t,e);return i?i.coin:null},n.prototype.getCredit=async function(t,e){const i=this.state,n=b.toKey(t,e),r=this.coinCache.get(n);if(r){const i=a.fromRaw(r);return i.coin.hash=t,i.coin.index=e,i}const s=await this.get(k.c(t,e));if(!s)return null;const o=a.fromRaw(s);return o.coin.hash=t,o.coin.index=e,i===this.state&&this.coinCache.set(n,s),o},n.prototype.getSpentCoin=async function(t,e){const i=await this.get(k.d(t.hash,t.index));if(!i)return null;const n=w.fromRaw(i);return n.hash=e.hash,n.index=e.index,n},n.prototype.hasSpentCoin=function(t){return this.has(k.d(t.hash,t.index))},n.prototype.updateSpentCoin=async function(t,e,i){const n=b.fromTX(t,e),r=await this.getSpent(n.hash,n.index);if(!r)return;const s=await this.getSpentCoin(r,n);s&&(s.height=i,this.put(k.d(r.hash,r.index),s.toRaw()))},n.prototype.hasCoin=async function(t,e){const i=b.toKey(t,e);return!!this.coinCache.has(i)||await this.has(k.c(t,e))},n.prototype.getBalance=async function(t){return null!=t?await this.getAccountBalance(t):this.state.toBalance()},n.prototype.getWalletBalance=async function(){const t=await this.getCredits(),e=new r(this.wallet.wid,this.wallet.id,-1);for(const i of t){const t=i.coin;-1!==t.height&&(e.confirmed+=t.value),i.spent||(e.unconfirmed+=t.value)}return e},n.prototype.getAccountBalance=async function(t){const e=await this.getAccountCredits(t),i=new r(this.wallet.wid,this.wallet.id,t);for(const t of e){const e=t.coin;-1!==e.height&&(i.confirmed+=e.value),t.spent||(i.unconfirmed+=e.value)}return i},n.prototype.getBalanceDetails=async function(t){return null!=t?await this.getAccountBalanceDetails(t):this.state.toBalanceDetails()},n.prototype.getWalletBalanceDetails=async function(){const t=await this.getCredits(),e=new s(this.wallet.wid,this.wallet.id,-1);for(const i of t){const t=i.coin;-1!==t.height&&(e.confirmed+=t.value),i.spent||(e.unconfirmed+=t.value)}return e},n.prototype.getAccountBalanceDetails=async function(t){const e=await this.getAccountCredits(t),i=new s(this,this.wallet.wid,this.wallet.id,t),n=await this.getPendingDetails(t),r=1+i.chainHeight-E.COINBASE_MATURITY;for(const t of e){const e=t.coin;e.coinbase&&r<e.height?i.immature+=e.value:(t.own||t.spent||(i.available+=e.value),t.own&&!t.spent&&(i.available+=e.value))}for(const t of n){for(const e of t.inputs)e.path&&(i.pending-=e.value);for(const e of t.outputs)e.path&&(i.pending+=e.value)}return i.available-=i.pending,i.total=i.available+i.pending+i.immature,i},n.prototype.zap=async function(t,e){p(f.isU32(e));const i=f.now(),n=await this.getRange(t,{start:0,end:i-e}),r=[];for(const t of n)-1===t.height&&(p(i-t.mtime>=e),this.logger.debug("Zapping TX: %s (%s)",t.tx.txid(),this.wallet.id),await this.remove(t.hash),r.push(t.hash));return r},n.prototype.abandon=async function(t){if(!await this.has(k.p(t)))throw new Error("TX not eligible.");return await this.remove(t)},n.prototype.getAccountTotal=function(t){return this.total({gte:k.M(t,0,S.NULL_HASH),lte:k.M(t,4294967295,S.HIGH_HASH)})},n.prototype.getTotal=function(t){return null!=t?this.getAccountTotal(t):this.total({gte:k.m(0,S.NULL_HASH),lte:k.m(4294967295,S.HIGH_HASH)})},r.prototype.equal=function(t){return this.wid===t.wid&&this.confirmed===t.confirmed&&this.unconfirmed===t.unconfirmed},r.prototype.toJSON=function(t){return{wid:t?void 0:this.wid,id:t?void 0:this.id,account:t?void 0:this.account,unconfirmed:this.unconfirmed,confirmed:this.confirmed}},r.prototype.toString=function(){return"<Balance"+` unconfirmed=${g.wmcc(this.unconfirmed)}`+` confirmed=${g.wmcc(this.confirmed)}`+">"},r.prototype.inspect=function(){return this.toString()},s.prototype.equal=function(t){return this.wid===t.wid&&this.chainHeight===t.chainHeight&&this.total===t.total&&this.available===t.available&&this.pending===t.pending&&this.immature===t.immature},s.prototype.toJSON=function(t){return{wid:t?void 0:this.wid,id:t?void 0:this.id,account:t?void 0:this.account,chainHeight:t?void 0:this.chainHeight,available:this.available,total:this.total,pending:this.pending,immature:this.immature}},s.prototype.toString=function(){return"<BalanceDetails"+` total=${g.wmcc(this.total)}`+` available=${g.wmcc(this.available)}`+` pending=${g.wmcc(this.pending)}`+` immature=${g.wmcc(this.immature)}`+">"},s.prototype.inspect=function(){return this.toString()},o.prototype.clone=function(){const t=new o(this.wid,this.id);return t.tx=this.tx,t.coin=this.coin,t.unconfirmed=this.unconfirmed,t.confirmed=this.confirmed,t},o.prototype.commit=function(){return this.committed=!0,this.toRaw()},o.prototype.toBalance=function(){const t=new r(this.wid,this.id,-1);return t.unconfirmed=this.unconfirmed,t.confirmed=this.confirmed,t},o.prototype.toRaw=function(){const t=new m(32);return t.writeU64(this.tx),t.writeU64(this.coin),t.writeU64(this.unconfirmed),t.writeU64(this.confirmed),t.render()},o.prototype.fromRaw=function(t){const e=new d(t);return this.tx=e.readU64(),this.coin=e.readU64(),this.unconfirmed=e.readU64(),this.confirmed=e.readU64(),this},o.fromRaw=function(t,e,i){return new o(t,e).fromRaw(i)},o.prototype.toJSON=function(t){return{wid:t?void 0:this.wid,id:t?void 0:this.id,tx:this.tx,coin:this.coin,unconfirmed:this.unconfirmed,confirmed:this.confirmed}},o.prototype.inspect=function(){return this.toJSON()},a.prototype.fromRaw=function(t){const e=new d(t);return this.coin.fromReader(e),this.spent=1===e.readU8(),this.own=!0,e.left()>0&&(this.own=1===e.readU8()),this},a.fromRaw=function(t){return(new a).fromRaw(t)},a.prototype.getSize=function(){return this.coin.getSize()+2},a.prototype.toRaw=function(){const t=this.getSize(),e=new m(t);return this.coin.toWriter(e),e.writeU8(this.spent?1:0),e.writeU8(this.own?1:0),e.render()},a.prototype.fromTX=function(t,e,i){return this.coin.fromTX(t,e,i),this.spent=!1,this.own=!1,this},a.fromTX=function(t,e,i){return(new a).fromTX(t,e,i)},h.prototype.init=function(){for(const t of this.tx.inputs){const e=new c;e.address=t.getAddress(),this.inputs.push(e)}for(const t of this.tx.outputs){const e=new c;e.value=t.value,e.address=t.getAddress(),this.outputs.push(e)}},h.prototype.setInput=function(t,e,i){const n=this.inputs[t];i&&(n.value=i.value,n.address=i.getAddress()),e&&(n.path=e)},h.prototype.setOutput=function(t,e){const i=this.outputs[t];e&&(i.path=e)},h.prototype.getDepth=function(){if(-1===this.height)return 0;const t=this.chainHeight-this.height;return t<0?0:t+1},h.prototype.getFee=function(){let t=0,e=0;for(const e of this.inputs){if(!e.path)return 0;t+=e.value}for(const t of this.outputs)e+=t.value;return t-e},h.prototype.getRate=function(t){return R.getRate(this.vsize,t)},h.prototype.toJSON=function(){const t=this.getFee();let e=this.getRate(t);return Number.isSafeInteger(e)||(e=0),{wid:this.wid,id:this.id,hash:f.revHex(this.hash),height:this.height,block:this.block?f.revHex(this.block):null,time:this.time,mtime:this.mtime,date:f.date(this.time||this.mtime),size:this.size,virtualSize:this.vsize,fee:t,rate:e,confirmations:this.getDepth(),inputs:this.inputs.map(t=>t.getJSON(this.network)),outputs:this.outputs.map(t=>t.getJSON(this.network)),tx:this.tx.toRaw().toString("hex")}},c.prototype.toJSON=function(){return this.getJSON()},c.prototype.getJSON=function(t){return{value:this.value,address:this.address?this.address.toString(t):null,path:this.path?this.path.toJSON():null}},u.prototype.add=function(t){return!this.index.has(t)&&(this.index.add(t),this.hashes.push(t),!0)},u.prototype.remove=function(t){if(!this.index.has(t))return!1;if(this.index.delete(t),this.hashes[this.hashes.length-1]===t)return this.hashes.pop(),!0;const e=this.hashes.indexOf(t);return p(-1!==e),this.hashes.splice(e,1),!0},u.prototype.fromRaw=function(t){const e=new d(t);this.hash=e.readHash("hex"),this.height=e.readU32(),this.time=e.readU32();const i=e.readU32();for(let t=0;t<i;t++){const t=e.readHash("hex");this.index.add(t),this.hashes.push(t)}return this},u.fromRaw=function(t){return(new u).fromRaw(t)},u.prototype.getSize=function(){return 44+32*this.hashes.length},u.prototype.toRaw=function(){const t=this.getSize(),e=new m(t);e.writeHash(this.hash),e.writeU32(this.height),e.writeU32(this.time),e.writeU32(this.hashes.length);for(const t of this.hashes)e.writeHash(t);return e.render()},u.prototype.toJSON=function(){return{hash:f.revHex(this.hash),height:this.height,time:this.time,hashes:this.hashes.map(f.revHex)}},u.prototype.fromMeta=function(t){return this.hash=t.hash,this.height=t.height,this.time=t.time,this},u.fromMeta=function(t){return(new u).fromMeta(t)},t.exports=n},function(t,e,i){"use strict";function n(t){if(!(this instanceof n))return new n(t);k.call(this),a(t,"RPC requires a WalletDB."),this.wdb=t,this.network=t.network,this.logger=t.logger.context("rpc"),this.client=t.client,this.wallet=null,this.init()}function r(t,e){return s(t,e).getHash("hex")}function s(t,e){try{return p.fromString(t,e)}catch(t){throw new x(_.INVALID_ADDRESS_OR_KEY,"Invalid address.")}}function o(t,e){try{return d.fromSecret(t,e)}catch(t){throw new x(_.INVALID_ADDRESS_OR_KEY,"Invalid key.")}}const a=i(0),h=i(59),c=i(1),u=i(5),f=i(20),l=i(8),p=i(11),d=i(47),m=i(71),g=i(48),y=i(21),w=i(13),b=i(15),v=i(3),k=i(174),S=i(96),E=i(74),R=i(62),x=k.RPCError,_=k.errors,I=k.MAGIC_STRING;Object.setPrototypeOf(n.prototype,k.prototype),n.prototype.init=function(){this.add("help",this.help),this.add("stop",this.stop),this.add("fundrawtransaction",this.fundRawTransaction),this.add("resendwallettransactions",this.resendWalletTransactions),this.add("abandontransaction",this.abandonTransaction),this.add("addmultisigaddress",this.addMultisigAddress),this.add("addwitnessaddress",this.addWitnessAddress),this.add("backupwallet",this.backupWallet),this.add("dumpprivkey",this.dumpPrivKey),this.add("dumpwallet",this.dumpWallet),this.add("encryptwallet",this.encryptWallet),this.add("getaccountaddress",this.getAccountAddress),this.add("getaccount",this.getAccount),this.add("getaddressesbyaccount",this.getAddressesByAccount),this.add("getbalance",this.getBalance),this.add("getnewaddress",this.getNewAddress),this.add("getrawchangeaddress",this.getRawChangeAddress),this.add("getreceivedbyaccount",this.getReceivedByAccount),this.add("getreceivedbyaddress",this.getReceivedByAddress),this.add("gettransaction",this.getTransaction),this.add("getunconfirmedbalance",this.getUnconfirmedBalance),this.add("getwalletinfo",this.getWalletInfo),this.add("importprivkey",this.importPrivKey),this.add("importwallet",this.importWallet),this.add("importaddress",this.importAddress),this.add("importprunedfunds",this.importPrunedFunds),this.add("importpubkey",this.importPubkey),this.add("keypoolrefill",this.keyPoolRefill),this.add("listaccounts",this.listAccounts),this.add("listaddressgroupings",this.listAddressGroupings),this.add("listlockunspent",this.listLockUnspent),this.add("listreceivedbyaccount",this.listReceivedByAccount),this.add("listreceivedbyaddress",this.listReceivedByAddress),this.add("listsinceblock",this.listSinceBlock),this.add("listtransactions",this.listTransactions),this.add("listunspent",this.listUnspent),this.add("lockunspent",this.lockUnspent),this.add("move",this.move),this.add("sendfrom",this.sendFrom),this.add("sendmany",this.sendMany),this.add("sendtoaddress",this.sendToAddress),this.add("setaccount",this.setAccount),this.add("settxfee",this.setTXFee),this.add("signmessage",this.signMessage),this.add("walletlock",this.walletLock),this.add("walletpassphrasechange",this.walletPassphraseChange),this.add("walletpassphrase",this.walletPassphrase),this.add("removeprunedfunds",this.removePrunedFunds),this.add("selectwallet",this.selectWallet),this.add("getmemoryinfo",this.getMemoryInfo),this.add("setloglevel",this.setLogLevel)},n.prototype.help=async function(t,e){if(0===t.length)return"Select a command.";const i={method:t[0],params:[]};return await this.execute(i,!0)},n.prototype.stop=async function(t,e){if(e||0!==t.length)throw new x(_.MISC_ERROR,"stop");return this.wdb.close(),"Stopping."},n.prototype.fundRawTransaction=async function(t,e){if(e||t.length<1||t.length>2)throw new x(_.MISC_ERROR,'fundrawtransaction "hexstring" ( options )');const i=this.wallet,n=new E([t]),r=n.buf(0),o=n.obj(1);if(!r)throw new x(_.TYPE_ERROR,"Invalid hex string.");const a=g.fromRaw(r);if(0===a.outputs.length)throw new x(_.INVALID_PARAMETER,"TX must have at least one output.");let h=null,c=null;if(o){const t=new E([o]);h=t.ufixed("feeRate",8),(c=t.str("changeAddress"))&&(c=s(c,this.network))}return await i.fund(a,{rate:h,changeAddress:c}),{hex:a.toRaw().toString("hex"),changepos:a.changeIndex,fee:f.wmcc(a.getFee(),!0)}},n.prototype.resendWalletTransactions=async function(t,e){if(e||0!==t.length)throw new x(_.MISC_ERROR,"resendwallettransactions");const i=this.wallet,n=await i.resend(),r=[];for(const t of n)r.push(t.txid());return r},n.prototype.addMultisigAddress=async function(t,e){if(e||t.length<2||t.length>3)throw new x(_.MISC_ERROR,'addmultisigaddress nrequired ["key",...] ( "account" )');throw new Error("Not implemented.")},n.prototype.addWitnessAddress=async function(t,e){if(e||t.length<1||t.length>1)throw new x(_.MISC_ERROR,'addwitnessaddress "address"');throw new Error("Not implemented.")},n.prototype.backupWallet=async function(t,e){const i=new E([t]).str(0);if(e||1!==t.length||!i)throw new x(_.MISC_ERROR,'backupwallet "destination"');return await this.wdb.backup(i),null},n.prototype.dumpPrivKey=async function(t,e){if(e||1!==t.length)throw new x(_.MISC_ERROR,'dumpprivkey "wmccaddress"');const i=this.wallet,n=r(new E([t]).str(0,""),this.network),s=await i.getPrivateKey(n);if(!s)throw new x(_.MISC_ERROR,"Key not found.");return s.toSecret()},n.prototype.dumpWallet=async function(t,e){if(e||1!==t.length)throw new x(_.MISC_ERROR,'dumpwallet "filename"');const i=this.wallet,n=new E([t]).str(0);if(!n)throw new x(_.TYPE_ERROR,"Invalid parameter.");const r=await this.wdb.getTip(),s=c.date(),o=[c.fmt("# Wallet Dump created by WMCC_Core %s",S.version),c.fmt("# * Created on %s",s),c.fmt("# * Best block at time of backup was %d (%s).",r.height,c.revHex(r.hash)),c.fmt("# * File: %s",n),""],a=await i.getAddressHashes();for(const t of a){const e=await i.getPrivateKey(t);if(!e)continue;const n=e.getAddress("string");let r="%s %s label= addr=%s";1===e.branch&&(r="%s %s change=1 addr=%s");const a=c.fmt(r,e.toSecret(),s,n);o.push(a)}o.push(""),o.push("# End of dump"),o.push("");const u=o.join("\n");return h.unsupported?u:(await h.writeFile(n,u,"utf8"),null)},n.prototype.encryptWallet=async function(t,e){const i=this.wallet;if(!i.master.encrypted&&(e||1!==t.length))throw new x(_.MISC_ERROR,'encryptwallet "passphrase"');const n=new E([t]).str(0,"");if(i.master.encrypted)throw new x(_.WALLET_WRONG_ENC_STATE,"Already running with an encrypted wallet.");if(n.length<1)throw new x(_.MISC_ERROR,'encryptwallet "passphrase"');try{await i.setPassphrase(n)}catch(t){throw new x(_.WALLET_ENCRYPTION_FAILED,"Encryption failed.")}return"wallet encrypted; we do not need to stop!"},n.prototype.getAccountAddress=async function(t,e){if(e||1!==t.length)throw new x(_.MISC_ERROR,'getaccountaddress "account"');const i=this.wallet;let n=new E([t]).str(0,"");n||(n="default");const r=await i.getAccount(n);return r?r.receive.getAddress("string"):""},n.prototype.getAccount=async function(t,e){if(e||1!==t.length)throw new x(_.MISC_ERROR,'getaccount "wmccaddress"');const i=this.wallet,n=r(new E([t]).str(0,""),this.network),s=await i.getPath(n);return s?s.name:""},n.prototype.getAddressesByAccount=async function(t,e){if(e||1!==t.length)throw new x(_.MISC_ERROR,'getaddressesbyaccount "account"');const i=this.wallet;let n=new E([t]).str(0,"");const r=[];""===n&&(n="default");const s=await i.getPaths(n);for(const t of s){const e=t.toAddress();r.push(e.toString(this.network))}return r},n.prototype.getBalance=async function(t,e){if(e||t.length>3)throw new x(_.MISC_ERROR,'getbalance ( "account" minconf includeWatchonly )');const i=this.wallet,n=new E([t]);let r=n.str(0);const s=n.u32(1,0),o=n.bool(2,!1);if(""===r&&(r="default"),"*"===r&&(r=null),i.watchOnly!==o)return 0;const a=await i.getBalance(r);let h;return h=s>0?a.confirmed:a.unconfirmed,f.wmcc(h,!0)},n.prototype.getNewAddress=async function(t,e){if(e||t.length>1)throw new x(_.MISC_ERROR,'getnewaddress ( "account" )');const i=this.wallet;let n=new E([t]).str(0);""===n&&(n="default");return(await i.createReceive(n)).getAddress("string")},n.prototype.getRawChangeAddress=async function(t,e){if(e||t.length>1)throw new x(_.MISC_ERROR,"getrawchangeaddress");const i=this.wallet;return(await i.createChange()).getAddress("string")},n.prototype.getReceivedByAccount=async function(t,e){if(e||t.length<1||t.length>2)throw new x(_.MISC_ERROR,'getreceivedbyaccount "account" ( minconf )');const i=this.wallet,n=new E([t]);let r=n.str(0);const s=n.u32(1,0),o=this.wdb.state.height;""===r&&(r="default");const a=await i.getPaths(r),h=new Set;for(const t of a)h.add(t.hash);const c=await i.getHistory(r);let u=0,l=-1;for(const t of c){const e=t.getDepth(o);if(!(e<s)){(-1===l||e<l)&&(l=e);for(const e of t.tx.outputs){const t=e.getHash("hex");t&&h.has(t)&&(u+=e.value)}}}return f.wmcc(u,!0)},n.prototype.getReceivedByAddress=async function(t,e){if(e||t.length<1||t.length>2)throw new x(_.MISC_ERROR,'getreceivedbyaddress "wmccaddress" ( minconf )');const i=this.wallet,n=new E([t]),s=n.str(0,""),o=n.u32(1,0),a=this.wdb.state.height,h=r(s,this.network),c=await i.getHistory();let u=0;for(const t of c)if(!(t.getDepth(a)<o))for(const e of t.tx.outputs)e.getHash("hex")===h&&(u+=e.value);return f.wmcc(u,!0)},n.prototype._toWalletTX=async function(t){const e=this.wallet,i=await e.toDetails(t);if(!i)throw new x(_.WALLET_ERROR,"TX not found.");let n=!0;for(const t of i.inputs)if(t.path){n=!1;break}const r=[];let s=0,o=0;for(let t=0;t<i.outputs.length;t++){const e=i.outputs[t];if(e.path){if(1===e.path.branch)continue;r.push({account:e.path.name,address:e.address.toString(this.network),category:"receive",amount:f.wmcc(e.value,!0),label:e.path.name,vout:t}),o+=e.value}else n||(r.push({account:"",address:e.address?e.address.toString(this.network):null,category:"send",amount:-f.wmcc(e.value,!0),fee:-f.wmcc(i.fee,!0),vout:t}),s+=e.value)}return{amount:f.wmcc(n?o:-s,!0),confirmations:i.confirmations,blockhash:i.block?c.revHex(i.block):null,blockindex:i.index,blocktime:i.time,txid:c.revHex(i.hash),walletconflicts:[],time:i.mtime,timereceived:i.mtime,"bip125-replaceable":"no",details:r,hex:i.tx.toRaw().toString("hex")}},n.prototype.getTransaction=async function(t,e){if(e||t.length<1||t.length>2)throw new x(_.MISC_ERROR,'gettransaction "txid" ( includeWatchonly )');const i=this.wallet,n=new E([t]),r=n.hash(0),s=n.bool(1,!1);if(!r)throw new x(_.TYPE_ERROR,"Invalid parameter");const o=await i.getTX(r);if(!o)throw new x(_.WALLET_ERROR,"TX not found.");return await this._toWalletTX(o,s)},n.prototype.abandonTransaction=async function(t,e){if(e||1!==t.length)throw new x(_.MISC_ERROR,'abandontransaction "txid"');const i=this.wallet,n=new E([t]).hash(0);if(!n)throw new x(_.TYPE_ERROR,"Invalid parameter.");if(!await i.abandon(n))throw new x(_.WALLET_ERROR,"Transaction not in wallet.");return null},n.prototype.getUnconfirmedBalance=async function(t,e){if(e||t.length>0)throw new x(_.MISC_ERROR,"getunconfirmedbalance");const i=this.wallet,n=await i.getBalance();return f.wmcc(n.unconfirmed,!0)},n.prototype.getWalletInfo=async function(t,e){if(e||0!==t.length)throw new x(_.MISC_ERROR,"getwalletinfo");const i=this.wallet,n=await i.getBalance();return{walletid:i.id,walletversion:6,balance:f.wmcc(n.unconfirmed,!0),unconfirmed_balance:f.wmcc(n.unconfirmed,!0),txcount:i.txdb.state.tx,keypoololdest:0,keypoolsize:0,unlocked_until:i.master.until,paytxfee:f.wmcc(this.wdb.feeRate,!0)}},n.prototype.importPrivKey=async function(t,e){if(e||t.length<1||t.length>3)throw new x(_.MISC_ERROR,'importprivkey "wmccprivkey" ( "label" rescan )');const i=this.wallet,n=new E([t]),r=n.str(0),s=n.bool(2,!1),a=o(r,this.network);return await i.importKey(0,a),s&&await this.wdb.rescan(0),null},n.prototype.importWallet=async function(t,e){if(e||1!==t.length)throw new x(_.MISC_ERROR,'importwallet "filename" ( rescan )');const i=this.wallet,n=new E([t]),r=n.str(0),s=n.bool(1,!1);if(h.unsupported)throw new x(_.INTERNAL_ERROR,"FS not available.");const a=(await h.readFile(r,"utf8")).split(/\n+/),c=[];for(let t of a){if(0===(t=t.trim()).length)continue;if(/^\s*#/.test(t))continue;const e=t.split(/\s+/);if(e.length<4)throw new x(_.DESERIALIZATION_ERROR,"Malformed wallet.");const i=o(e[0],this.network);c.push(i)}for(const t of c)await i.importKey(0,t);return s&&await this.wdb.rescan(0),null},n.prototype.importAddress=async function(t,e){if(e||t.length<1||t.length>4)throw new x(_.MISC_ERROR,'importaddress "address" ( "label" rescan p2sh )');const i=this.wallet,n=new E([t]);let r=n.str(0,"");const o=n.bool(2,!1);if(n.bool(3,!1)){let t=n.buf(0);if(!t)throw new x(_.TYPE_ERROR,"Invalid parameters.");t=l.fromRaw(t),r=(t=l.fromScripthash(t.hash160())).getAddress()}else r=s(r,this.network);return await i.importAddress(0,r),o&&await this.wdb.rescan(0),null},n.prototype.importPubkey=async function(t,e){if(e||t.length<1||t.length>4)throw new x(_.MISC_ERROR,'importpubkey "pubkey" ( "label" rescan )');const i=this.wallet,n=new E([t]),r=n.buf(0),s=n.bool(2,!1);if(!r)throw new x(_.TYPE_ERROR,"Invalid parameter.");const o=d.fromPublic(r,this.network);return await i.importKey(0,o),s&&await this.wdb.rescan(0),null},n.prototype.keyPoolRefill=async function(t,e){if(e||t.length>1)throw new x(_.MISC_ERROR,"keypoolrefill ( newsize )");return null},n.prototype.listAccounts=async function(t,e){if(e||t.length>2)throw new x(_.MISC_ERROR,"listaccounts ( minconf includeWatchonly)");const i=this.wallet,n=new E([t]),r=n.u32(0,0),s=n.bool(1,!1),o=await i.getAccounts(),a={};for(const t of o){const e=await i.getBalance(t);let n=e.unconfirmed;r>0&&(n=e.confirmed),i.watchOnly!==s&&(n=0),a[t]=f.wmcc(n,!0)}return a},n.prototype.listAddressGroupings=async function(t,e){if(e)throw new x(_.MISC_ERROR,"listaddressgroupings");throw new Error("Not implemented.")},n.prototype.listLockUnspent=async function(t,e){if(e||t.length>0)throw new x(_.MISC_ERROR,"listlockunspent");const i=this.wallet.getLocked(),n=[];for(const t of i)n.push({txid:t.txid(),vout:t.index});return n},n.prototype.listReceivedByAccount=async function(t,e){if(e||t.length>3)throw new x(_.MISC_ERROR,"listreceivedbyaccount ( minconf includeempty includeWatchonly )");const i=new E([t]),n=i.u32(0,0),r=i.bool(1,!1),s=i.bool(2,!1);return await this._listReceived(n,r,s,!0)},n.prototype.listReceivedByAddress=async function(t,e){if(e||t.length>3)throw new x(_.MISC_ERROR,"listreceivedbyaddress ( minconf includeempty includeWatchonly )");const i=new E([t]),n=i.u32(0,0),r=i.bool(1,!1),s=i.bool(2,!1);return await this._listReceived(n,r,s,!1)},n.prototype._listReceived=async function(t,e,i,n){const r=this.wallet,s=await r.getPaths(),o=this.wdb.state.height,a=new Map;for(const t of s){const e=t.toAddress();a.set(t.hash,{involvesWatchonly:r.watchOnly,address:e.toString(this.network),account:t.name,amount:0,confirmations:-1,label:""})}const h=await r.getHistory();for(const e of h){const i=e.getDepth(o);if(!(i<t))for(const t of e.tx.outputs){const e=t.getAddress();if(!e)continue;const n=e.getHash("hex"),r=a.get(n);r&&((-1===r.confirmations||i<r.confirmations)&&(r.confirmations=i),r.address=e.toString(this.network),r.amount+=t.value)}}let c=[];for(const t of a.values())c.push(t);if(n){const t=new Map;for(const e of c){const i=t.get(e.account);i?i.amount+=e.amount:(t.set(e.account,e),e.address=void 0)}c=[];for(const e of t.values())c.push(e)}const u=[];for(const t of c)(e||0!==t.amount)&&(-1===t.confirmations&&(t.confirmations=0),t.amount=f.wmcc(t.amount,!0),u.push(t));return u},n.prototype.listSinceBlock=async function(t,e){const i=this.wallet,n=this.wdb.state.height,r=new E([t]),s=r.hash(0),o=r.u32(1,0),a=r.bool(2,!1);if(e)throw new x(_.MISC_ERROR,'listsinceblock ( "blockhash" target-confirmations includeWatchonly)');if(i.watchOnly!==a)return[];let h=-1;if(s){const t=await this.client.getEntry(s);t&&(h=t.height)}-1===h&&(h=this.chain.height);const u=await i.getHistory(),f=[];let l;for(const t of u){if(t.height<h)continue;if(t.getDepth(n)<o)continue;(!l||t.height>l)&&(l=t);const e=await this._toListTX(t);f.push(e)}return{transactions:f,lastblock:l&&l.block?c.revHex(l.block):v.NULL_HASH}},n.prototype._toListTX=async function(t){const e=this.wallet,i=await e.toDetails(t);if(!i)throw new x(_.WALLET_ERROR,"TX not found.");let n=!0;for(const t of i.inputs)if(t.path){n=!1;break}let r,s,o,h,u=0,l=0;for(let t=0;t<i.outputs.length;t++){const e=i.outputs[t];if(e.path){if(1===e.path.branch)continue;l+=e.value,s=e,h=t}else u+=e.value,r=e,o=t}let p,d;return n?(p=s,d=h):(p=r,d=o),p||(a(!n),p=s,d=h),{account:p.path?p.path.name:"",address:p.address?p.address.toString(this.network):null,category:n?"receive":"send",amount:f.wmcc(n?l:-u,!0),label:p.path?p.path.name:void 0,vout:d,confirmations:i.getDepth(),blockhash:i.block?c.revHex(i.block):null,blockindex:i.index,blocktime:i.time,txid:c.revHex(i.hash),walletconflicts:[],time:i.mtime,timereceived:i.mtime,"bip125-replaceable":"no"}},n.prototype.listTransactions=async function(t,e){if(e||t.length>4)throw new x(_.MISC_ERROR,'listtransactions ( "account" count from includeWatchonly)');const i=this.wallet,n=new E([t]);let r=n.str(0);const s=n.u32(1,10),o=n.u32(2,0),a=n.bool(3,!1);if(i.watchOnly!==a)return[];""===r&&(r="default");const h=await i.getHistory();R.sortTX(h);const c=o+s,u=Math.min(c,h.length),f=[];for(let t=o;t<u;t++){const e=h[t],i=await this._toListTX(e);f.push(i)}return f},n.prototype.listUnspent=async function(t,e){if(e||t.length>3)throw new x(_.MISC_ERROR,'listunspent ( minconf maxconf  ["address",...] )');const i=this.wallet,n=new E([t]),s=n.u32(0,1),o=n.u32(1,9999999),a=n.array(2),h=this.wdb.state.height,c=new Set;if(a){const t=new E([a]);for(let e=0;e<a.length;e++){const i=r(t.str(e,""),this.network);if(c.has(i))throw new x(_.INVALID_PARAMETER,"Duplicate address.");c.add(i)}}const u=await i.getCoins();R.sortCoins(u);const l=[];for(const t of u){const e=t.getDepth(h);if(e<s||e>o)continue;const n=t.getAddress();if(!n)continue;const r=t.getHash("hex");if(a&&(!r||!c.has(r)))continue;const u=await i.getKey(r);l.push({txid:t.txid(),vout:t.index,address:n?n.toString(this.network):null,account:u?u.name:void 0,redeemScript:u&&u.script?u.script.toJSON():void 0,scriptPubKey:t.script.toJSON(),amount:f.wmcc(t.value,!0),confirmations:e,spendable:!i.isLocked(t),solvable:!0})}return l},n.prototype.lockUnspent=async function(t,e){if(e||t.length<1||t.length>2)throw new x(_.MISC_ERROR,'lockunspent unlock ([{"txid":"txid","vout":n},...])');const i=this.wallet,n=new E([t]),r=n.bool(0,!1),s=n.array(1);if(1===t.length)return r&&i.unlockCoins(),!0;if(!s)throw new x(_.TYPE_ERROR,"Invalid parameter.");for(const t of s){const e=new E([t]),n=e.hash("txid"),s=e.u32("vout");if(null==n||null==s)throw new x(_.INVALID_PARAMETER,"Invalid parameter.");const o=new y(n,s);r?i.unlockCoin(o):i.lockCoin(o)}return!0},n.prototype.move=async function(t,e){throw new Error("Not implemented.")},n.prototype.sendFrom=async function(t,e){if(e||t.length<3||t.length>6)throw new x(_.MISC_ERROR,'sendfrom "fromaccount" "towmccaddress" amount ( minconf "comment" "comment-to" )');const i=this.wallet,n=new E([t]);let r=n.str(0);const o=n.str(1),a=n.ufixed(2,8),h=n.u32(3,0),c=s(o,this.network);if(!c||null==a)throw new x(_.TYPE_ERROR,"Invalid parameter.");""===r&&(r="default");const u={account:r,depth:h,outputs:[{address:c,value:a}]};return(await i.send(u)).txid()},n.prototype.sendMany=async function(t,e){if(e||t.length<2||t.length>5)throw new x(_.MISC_ERROR,'sendmany "fromaccount" {"address":amount,...} ( minconf "comment" ["address",...] )');const i=this.wallet,n=new E([t]);let r=n.str(0);const o=n.obj(1),a=n.u32(2,1),h=n.bool(4,!1);if(""===r&&(r="default"),!o)throw new x(_.TYPE_ERROR,"Invalid parameter.");const c=new E([o]),u=new Set,f=[];for(const t of Object.keys(o)){const e=c.ufixed(t,8),i=s(t,this.network),n=i.getHash("hex");if(null==e)throw new x(_.INVALID_PARAMETER,"Invalid parameter.");if(u.has(n))throw new x(_.INVALID_PARAMETER,"Invalid parameter.");u.add(n);const r=new w;r.value=e,r.script.fromAddress(i),f.push(r)}const l={outputs:f,subtractFee:h,account:r,depth:a};return(await i.send(l)).txid()},n.prototype.sendToAddress=async function(t,e){if(e||t.length<2||t.length>5)throw new x(_.MISC_ERROR,'sendtoaddress "wmccaddress" amount ( "comment" "comment-to" subtractfeefromamount )');const i=this.wallet,n=new E([t]),r=n.str(0),o=n.ufixed(1,8),a=n.bool(4,!1),h=s(r,this.network);if(!h||null==o)throw new x(_.TYPE_ERROR,"Invalid parameter.");const c={subtractFee:a,outputs:[{address:h,value:o}]};return(await i.send(c)).txid()},n.prototype.setAccount=async function(t,e){if(e||t.length<1||t.length>2)throw new x(_.MISC_ERROR,'setaccount "wmccaddress" "account"');throw new Error("Not implemented.")},n.prototype.setTXFee=async function(t,e){const i=new E([t]).ufixed(0,8);if(e||t.length<1||t.length>1)throw new x(_.MISC_ERROR,"settxfee amount");if(null==i)throw new x(_.TYPE_ERROR,"Invalid parameter.");return this.wdb.feeRate=i,!0},n.prototype.signMessage=async function(t,e){if(e||2!==t.length)throw new x(_.MISC_ERROR,'signmessage "wmccaddress" "message"');const i=this.wallet,n=new E([t]),s=n.str(0,""),o=n.str(1,""),a=r(s,this.network),h=await i.getKey(a);if(!h)throw new x(_.WALLET_ERROR,"Address not found.");if(!i.master.key)throw new x(_.WALLET_UNLOCK_NEEDED,"Wallet is locked.");const c=Buffer.from(I+o,"utf8"),f=u.hash256(c);return h.sign(f).toString("base64")},n.prototype.walletLock=async function(t,e){const i=this.wallet;if(e||i.master.encrypted&&0!==t.length)throw new x(_.MISC_ERROR,"walletlock");if(!i.master.encrypted)throw new x(_.WALLET_WRONG_ENC_STATE,"Wallet is not encrypted.");return await i.lock(),null},n.prototype.walletPassphraseChange=async function(t,e){const i=this.wallet;if(e||i.master.encrypted&&2!==t.length)throw new x(_.MISC_ERROR,'walletpassphrasechange "oldpassphrase" "newpassphrase"');const n=new E([t]),r=n.str(0,""),s=n.str(1,"");if(!i.master.encrypted)throw new x(_.WALLET_WRONG_ENC_STATE,"Wallet is not encrypted.");if(r.length<1||s.length<1)throw new x(_.INVALID_PARAMETER,"Invalid parameter");return await i.setPassphrase(r,s),null},n.prototype.walletPassphrase=async function(t,e){const i=this.wallet,n=new E([t]),r=n.str(0,""),s=n.u32(1);if(e||i.master.encrypted&&2!==t.length)throw new x(_.MISC_ERROR,'walletpassphrase "passphrase" timeout');if(!i.master.encrypted)throw new x(_.WALLET_WRONG_ENC_STATE,"Wallet is not encrypted.");if(r.length<1)throw new x(_.INVALID_PARAMETER,"Invalid parameter");if(null==s)throw new x(_.TYPE_ERROR,"Invalid parameter");return await i.unlock(r,s),null},n.prototype.importPrunedFunds=async function(t,e){if(e||t.length<2||t.length>3)throw new x(_.MISC_ERROR,'importprunedfunds "rawtransaction" "txoutproof" ( "label" )');const i=new E([t]),n=i.buf(0),r=i.buf(1);if(!n||!r)throw new x(_.TYPE_ERROR,"Invalid parameter.");const s=b.fromRaw(n),o=m.fromRaw(r),a=o.hash("hex");if(!o.verify())throw new x(_.VERIFY_ERROR,"Invalid proof.");if(!o.hasTX(s.hash("hex")))throw new x(_.VERIFY_ERROR,"Invalid proof.");const h=await this.client.getEntry(a);if(-1===h)throw new x(_.VERIFY_ERROR,"Invalid proof.");const c={hash:a,time:o.time,height:h};if(!await this.wdb.addTX(s,c))throw new x(_.WALLET_ERROR,"No tracked address for TX.");return null},n.prototype.removePrunedFunds=async function(t,e){if(e||1!==t.length)throw new x(_.MISC_ERROR,'removeprunedfunds "txid"');const i=this.wallet,n=new E([t]).hash(0);if(!n)throw new x(_.TYPE_ERROR,"Invalid parameter.");if(!await i.remove(n))throw new x(_.WALLET_ERROR,"Transaction not in wallet.");return null},n.prototype.selectWallet=async function(t,e){const i=new E([t]).str(0);if(e||1!==t.length)throw new x(_.MISC_ERROR,'selectwallet "id"');const n=await this.wdb.get(i);if(!n)throw new x(_.WALLET_ERROR,"Wallet not found.");return this.wallet=n,null},n.prototype.getMemoryInfo=async function(t,e){if(e||0!==t.length)throw new x(_.MISC_ERROR,"getmemoryinfo");return c.memoryUsage()},n.prototype.setLogLevel=async function(t,e){if(e||1!==t.length)throw new x(_.MISC_ERROR,'setloglevel "level"');const i=new E([t]).str(0,"");return this.logger.setLevel(i),null},t.exports=n},function(t,e,i){"use strict";const n=e;n.set=function(t){return n.network.set(t),n},n.cache=function(){},n.bip70=i(252),n.blockchain=i(255),n.chain=i(105),n.chaindb=i(160),n.chainentry=i(104),n.wmcc=i(257),n.amount=i(20),n.uri=i(201),n.coins=i(258),n.coinview=i(29),n.crypto=i(259),n.bn=i(26),n.secp256k1=i(12),n.schnorr=i(205),n.db=i(260),n.ldb=i(92),n.hd=i(261),n.http=i(270),n.rpc=i(115),n.txmempool=i(301),n.fees=i(117),n.mempool=i(178),n.mempoolentry=i(177),n.mining=i(302),n.miner=i(181),n.template=i(182),n.net=i(303),n.bip150=i(119),n.bip151=i(120),n.bip152=i(98),n.dns=i(99),n.packets=i(61),n.peer=i(184),n.pool=i(122),n.tcp=i(121),n.node=i(309),n.config=i(123),n.fullnode=i(240),n.logger=i(34),n.spvnode=i(241),n.primitives=i(311),n.address=i(11),n.block=i(51),n.coin=i(43),n.headers=i(37),n.input=i(41),n.invitem=i(36),n.keyring=i(47),n.merkleblock=i(71),n.mtx=i(48),n.netaddress=i(79),n.outpoint=i(21),n.output=i(13),n.tx=i(15),n.protocol=i(312),n.consensus=i(7),n.errors=i(107),n.network=i(6),n.networks=i(83),n.policy=i(19),n.timedata=i(84),n.txscript=i(313),n.opcode=i(90),n.program=i(85),n.script=i(8),n.scriptnum=i(32),n.sigcache=i(242),n.stack=i(40),n.witness=i(56),n.stratum=i(314),n.stratumserver=i(243),n.utils=i(321),n.base32=i(175),n.base58=i(25),n.bloom=i(42),n.co=i(16),n.encoding=i(3),n.int64=i(49),n.lock=i(23),n.reader=i(2),n.staticwriter=i(4),n.util=i(1),n.writer=i(63),n.wallet=i(324),n.common=i(62),n.path=i(80),n.walletkey=i(128),n.walletdb=i(130),n.workers=i(327),n.workerpool=i(124),n.pkg=i(96),n.native=i(18),global.wmcc_core=n},function(t,e,i){"use strict";e.certs=i(189),e.PaymentACK=i(253),e.PaymentDetails=i(159),e.Payment=i(190),e.PaymentRequest=i(254),e.pk=i(193),e.x509=i(191)},function(t,e,i){"use strict";function n(t){if(!(this instanceof n))return new n(t);this.payment=new a,this.memo=null,t&&this.fromOptions(t)}const r=i(0),s=i(81),o=i(82),a=i(190);n.prototype.fromOptions=function(t){return t.payment&&this.payment.fromOptions(t.payment),null!=t.memo&&(r("string"==typeof t.memo),this.memo=t.memo),this},n.fromOptions=function(t){return(new n).fromOptions(t)},n.prototype.fromRaw=function(t){const e=new s(t);return this.payment.fromRaw(e.readFieldBytes(1)),this.memo=e.readFieldString(2,!0),this},n.fromRaw=function(t,e){return"string"==typeof t&&(t=Buffer.from(t,e)),(new n).fromRaw(t)},n.prototype.toRaw=function(){const t=new o;return t.writeFieldBytes(1,this.payment.toRaw()),null!=this.memo&&t.writeFieldString(2,this.memo),t.render()},t.exports=n},function(t,e,i){"use strict";function n(t){if(!(this instanceof n))return new n(t);this.version=-1,this.pkiType=null,this.pkiData=null,this.paymentDetails=new f,this.signature=null,t&&this.fromOptions(t)}const r=i(0),s=i(1),o=i(5),a=i(191),h=i(101),c=i(81),u=i(82),f=i(159);n.prototype.fromOptions=function(t){return null!=t.version&&(r(s.isInt(t.version)),this.version=t.version),null!=t.pkiType&&(r("string"==typeof t.pkiType),this.pkiType=t.pkiType),t.pkiData&&(r(Buffer.isBuffer(t.pkiData)),this.pkiData=t.pkiData),t.paymentDetails&&this.paymentDetails.fromOptions(t.paymentDetails),t.signature&&(r(Buffer.isBuffer(t.signature)),this.signature=t.signature),t.chain&&this.setChain(t.chain),this},n.fromOptions=function(t){return(new n).fromOptions(t)},n.prototype.fromRaw=function(t){const e=new c(t);return this.version=e.readFieldU32(1,!0),this.pkiType=e.readFieldString(2,!0),this.pkiData=e.readFieldBytes(3,!0),this.paymentDetails.fromRaw(e.readFieldBytes(4)),this.signature=e.readFieldBytes(5,!0),this},n.fromRaw=function(t,e){return"string"==typeof t&&(t=Buffer.from(t,e)),(new n).fromRaw(t)},n.prototype.toRaw=function(){const t=new u;return-1!==this.version&&t.writeFieldU32(1,this.version),null!=this.pkiType&&t.writeFieldString(2,this.pkiType),this.pkiData&&t.writeFieldBytes(3,this.pkiData),t.writeFieldBytes(4,this.paymentDetails.toRaw()),this.signature&&t.writeFieldBytes(5,this.signature),t.render()},n.prototype.getAlgorithm=function(){if(!this.pkiType)throw new Error("No PKI type available.");const t=this.pkiType.split("+");if(2!==t.length)throw new Error("Could not parse PKI algorithm.");if("x509"!==t[0])throw new Error(`Unknown PKI type: ${t[0]}.`);if("sha1"!==t[1]&&"sha256"!==t[1])throw new Error(`Unknown hash algorithm: ${t[1]}.`);return new function(t,e){this.key=t,this.hash=e}(t[0],t[1])},n.prototype.signatureData=function(){const t=this.signature;this.signature=Buffer.alloc(0);const e=this.toRaw();return this.signature=t,e},n.prototype.signatureHash=function(){const t=this.getAlgorithm();return o.hash(t.hash,this.signatureData())},n.prototype.setChain=function(t){const e=new u;r(Array.isArray(t),"Chain must be an array.");for(let i of t){if("string"==typeof i){const t=h.decode(i);r("certificate"===t.type,"Bad certificate PEM."),i=t.data}r(Buffer.isBuffer(i),"Certificates must be PEM or DER."),e.writeFieldBytes(1,i)}this.pkiData=e.render()},n.prototype.getChain=function(){const t=[];if(!this.pkiData)return t;const e=new c(this.pkiData);for(;1===e.nextTag();)t.push(e.readFieldBytes(1));return t},n.prototype.sign=function(t,e){e&&this.setChain(e),this.pkiType||(this.pkiType="x509+sha256");const i=this.getAlgorithm(),n=this.signatureData(),r=this.getChain();this.signature=a.signSubject(i.hash,n,t,r)},n.prototype.verify=function(){if(!this.pkiType||"none"===this.pkiType)return!1;if(!this.signature)return!1;let t;try{t=this.getAlgorithm()}catch(t){return!1}const e=this.signatureData(),i=this.signature,n=this.getChain();try{return a.verifySubject(t.hash,e,i,n)}catch(t){return!1}},n.prototype.verifyChain=function(){if(!this.pkiType||"none"===this.pkiType)return!1;try{return a.verifyChain(this.getChain())}catch(t){return!1}},n.prototype.getCA=function(){if(!this.pkiType||"none"===this.pkiType)throw new Error("No CA found (pkiType).");const t=this.getChain();if(0===t.length)throw new Error("No CA found (chain).");return new function(t){this.name=a.getCAName(t),this.trusted=a.isTrusted(t),this.cert=t}(a.parse(t[t.length-1]))},t.exports=n},function(t,e,i){"use strict";e.ChainDB=i(160),e.ChainEntry=i(104),e.Chain=i(105),e.common=i(93),e.layout=i(200)},function(t,e){t.exports=require("leveldown")},function(t,e,i){"use strict";e.Amount=i(20),e.URI=i(201)},function(t,e,i){"use strict";e.Coins=i(102),e.CoinView=i(29),e.compress=i(103),e.UndoCoins=i(91)},function(t,e,i){"use strict";const n=i(5),r=i(28),s=i(108);e.aes=i(108),e.AEAD=i(202),e.BN=i(26),e.ccmp=i(52),e.ChaCha20=i(163),e.cleanse=i(72),e.digest=i(5),e.ecdsa=i(195),e.hkdf=i(203),e.HmacDRBG=i(204),e.merkle=i(66),e.pbkdf2=i(70),e.Poly1305=i(164),e.random=i(28),e.rsa=i(194),e.schnorr=i(205),e.scrypt=i(44),e.secp256k1=i(12),e.siphash=i(165),e.X15=i(58),e.hash=n.hash,e.ripemd160=n.ripemd160,e.sha1=n.sha1,e.sha256=n.sha256,e.hash160=n.hash160,e.hash256=n.hash256,e.root256=n.root256,e.hmac=n.hmac,e.encipher=s.encipher,e.decipher=s.decipher,e.randomBytes=r.randomBytes,e.randomInt=r.randomInt,e.randomRange=r.randomRange},function(t,e,i){"use strict";e.backends=i(197),e.LDB=i(92),e.LowlevelUp=i(196),e.MemDB=i(198)},function(t,e,i){"use strict";t.exports=i(109)},function(t,e,i){"use strict";t.exports=["的","一","是","在","不","了","有","和","人","这","中","大","为","上","个","国","我","以","要","他","时","来","用","们","生","到","作","地","于","出","就","分","对","成","会","可","主","发","年","动","同","工","也","能","下","过","子","说","产","种","面","而","方","后","多","定","行","学","法","所","民","得","经","十","三","之","进","着","等","部","度","家","电","力","里","如","水","化","高","自","二","理","起","小","物","现","实","加","量","都","两","体","制","机","当","使","点","从","业","本","去","把","性","好","应","开","它","合","还","因","由","其","些","然","前","外","天","政","四","日","那","社","义","事","平","形","相","全","表","间","样","与","关","各","重","新","线","内","数","正","心","反","你","明","看","原","又","么","利","比","或","但","质","气","第","向","道","命","此","变","条","只","没","结","解","问","意","建","月","公","无","系","军","很","情","者","最","立","代","想","已","通","并","提","直","题","党","程","展","五","果","料","象","员","革","位","入","常","文","总","次","品","式","活","设","及","管","特","件","长","求","老","头","基","资","边","流","路","级","少","图","山","统","接","知","较","将","组","见","计","别","她","手","角","期","根","论","运","农","指","几","九","区","强","放","决","西","被","干","做","必","战","先","回","则","任","取","据","处","队","南","给","色","光","门","即","保","治","北","造","百","规","热","领","七","海","口","东","导","器","压","志","世","金","增","争","济","阶","油","思","术","极","交","受","联","什","认","六","共","权","收","证","改","清","美","再","采","转","更","单","风","切","打","白","教","速","花","带","安","场","身","车","例","真","务","具","万","每","目","至","达","走","积","示","议","声","报","斗","完","类","八","离","华","名","确","才","科","张","信","马","节","话","米","整","空","元","况","今","集","温","传","土","许","步","群","广","石","记","需","段","研","界","拉","林","律","叫","且","究","观","越","织","装","影","算","低","持","音","众","书","布","复","容","儿","须","际","商","非","验","连","断","深","难","近","矿","千","周","委","素","技","备","半","办","青","省","列","习","响","约","支","般","史","感","劳","便","团","往","酸","历","市","克","何","除","消","构","府","称","太","准","精","值","号","率","族","维","划","选","标","写","存","候","毛","亲","快","效","斯","院","查","江","型","眼","王","按","格","养","易","置","派","层","片","始","却","专","状","育","厂","京","识","适","属","圆","包","火","住","调","满","县","局","照","参","红","细","引","听","该","铁","价","严","首","底","液","官","德","随","病","苏","失","尔","死","讲","配","女","黄","推","显","谈","罪","神","艺","呢","席","含","企","望","密","批","营","项","防","举","球","英","氧","势","告","李","台","落","木","帮","轮","破","亚","师","围","注","远","字","材","排","供","河","态","封","另","施","减","树","溶","怎","止","案","言","士","均","武","固","叶","鱼","波","视","仅","费","紧","爱","左","章","早","朝","害","续","轻","服","试","食","充","兵","源","判","护","司","足","某","练","差","致","板","田","降","黑","犯","负","击","范","继","兴","似","余","坚","曲","输","修","故","城","夫","够","送","笔","船","占","右","财","吃","富","春","职","觉","汉","画","功","巴","跟","虽","杂","飞","检","吸","助","升","阳","互","初","创","抗","考","投","坏","策","古","径","换","未","跑","留","钢","曾","端","责","站","简","述","钱","副","尽","帝","射","草","冲","承","独","令","限","阿","宣","环","双","请","超","微","让","控","州","良","轴","找","否","纪","益","依","优","顶","础","载","倒","房","突","坐","粉","敌","略","客","袁","冷","胜","绝","析","块","剂","测","丝","协","诉","念","陈","仍","罗","盐","友","洋","错","苦","夜","刑","移","频","逐","靠","混","母","短","皮","终","聚","汽","村","云","哪","既","距","卫","停","烈","央","察","烧","迅","境","若","印","洲","刻","括","激","孔","搞","甚","室","待","核","校","散","侵","吧","甲","游","久","菜","味","旧","模","湖","货","损","预","阻","毫","普","稳","乙","妈","植","息","扩","银","语","挥","酒","守","拿","序","纸","医","缺","雨","吗","针","刘","啊","急","唱","误","训","愿","审","附","获","茶","鲜","粮","斤","孩","脱","硫","肥","善","龙","演","父","渐","血","欢","械","掌","歌","沙","刚","攻","谓","盾","讨","晚","粒","乱","燃","矛","乎","杀","药","宁","鲁","贵","钟","煤","读","班","伯","香","介","迫","句","丰","培","握","兰","担","弦","蛋","沉","假","穿","执","答","乐","谁","顺","烟","缩","征","脸","喜","松","脚","困","异","免","背","星","福","买","染","井","概","慢","怕","磁","倍","祖","皇","促","静","补","评","翻","肉","践","尼","衣","宽","扬","棉","希","伤","操","垂","秋","宜","氢","套","督","振","架","亮","末","宪","庆","编","牛","触","映","雷","销","诗","座","居","抓","裂","胞","呼","娘","景","威","绿","晶","厚","盟","衡","鸡","孙","延","危","胶","屋","乡","临","陆","顾","掉","呀","灯","岁","措","束","耐","剧","玉","赵","跳","哥","季","课","凯","胡","额","款","绍","卷","齐","伟","蒸","殖","永","宗","苗","川","炉","岩","弱","零","杨","奏","沿","露","杆","探","滑","镇","饭","浓","航","怀","赶","库","夺","伊","灵","税","途","灭","赛","归","召","鼓","播","盘","裁","险","康","唯","录","菌","纯","借","糖","盖","横","符","私","努","堂","域","枪","润","幅","哈","竟","熟","虫","泽","脑","壤","碳","欧","遍","侧","寨","敢","彻","虑","斜","薄","庭","纳","弹","饲","伸","折","麦","湿","暗","荷","瓦","塞","床","筑","恶","户","访","塔","奇","透","梁","刀","旋","迹","卡","氯","遇","份","毒","泥","退","洗","摆","灰","彩","卖","耗","夏","择","忙","铜","献","硬","予","繁","圈","雪","函","亦","抽","篇","阵","阴","丁","尺","追","堆","雄","迎","泛","爸","楼","避","谋","吨","野","猪","旗","累","偏","典","馆","索","秦","脂","潮","爷","豆","忽","托","惊","塑","遗","愈","朱","替","纤","粗","倾","尚","痛","楚","谢","奋","购","磨","君","池","旁","碎","骨","监","捕","弟","暴","割","贯","殊","释","词","亡","壁","顿","宝","午","尘","闻","揭","炮","残","冬","桥","妇","警","综","招","吴","付","浮","遭","徐","您","摇","谷","赞","箱","隔","订","男","吹","园","纷","唐","败","宋","玻","巨","耕","坦","荣","闭","湾","键","凡","驻","锅","救","恩","剥","凝","碱","齿","截","炼","麻","纺","禁","废","盛","版","缓","净","睛","昌","婚","涉","筒","嘴","插","岸","朗","庄","街","藏","姑","贸","腐","奴","啦","惯","乘","伙","恢","匀","纱","扎","辩","耳","彪","臣","亿","璃","抵","脉","秀","萨","俄","网","舞","店","喷","纵","寸","汗","挂","洪","贺","闪","柬","爆","烯","津","稻","墙","软","勇","像","滚","厘","蒙","芳","肯","坡","柱","荡","腿","仪","旅","尾","轧","冰","贡","登","黎","削","钻","勒","逃","障","氨","郭","峰","币","港","伏","轨","亩","毕","擦","莫","刺","浪","秘","援","株","健","售","股","岛","甘","泡","睡","童","铸","汤","阀","休","汇","舍","牧","绕","炸","哲","磷","绩","朋","淡","尖","启","陷","柴","呈","徒","颜","泪","稍","忘","泵","蓝","拖","洞","授","镜","辛","壮","锋","贫","虚","弯","摩","泰","幼","廷","尊","窗","纲","弄","隶","疑","氏","宫","姐","震","瑞","怪","尤","琴","循","描","膜","违","夹","腰","缘","珠","穷","森","枝","竹","沟","催","绳","忆","邦","剩","幸","浆","栏","拥","牙","贮","礼","滤","钠","纹","罢","拍","咱","喊","袖","埃","勤","罚","焦","潜","伍","墨","欲","缝","姓","刊","饱","仿","奖","铝","鬼","丽","跨","默","挖","链","扫","喝","袋","炭","污","幕","诸","弧","励","梅","奶","洁","灾","舟","鉴","苯","讼","抱","毁","懂","寒","智","埔","寄","届","跃","渡","挑","丹","艰","贝","碰","拔","爹","戴","码","梦","芽","熔","赤","渔","哭","敬","颗","奔","铅","仲","虎","稀","妹","乏","珍","申","桌","遵","允","隆","螺","仓","魏","锐","晓","氮","兼","隐","碍","赫","拨","忠","肃","缸","牵","抢","博","巧","壳","兄","杜","讯","诚","碧","祥","柯","页","巡","矩","悲","灌","龄","伦","票","寻","桂","铺","圣","恐","恰","郑","趣","抬","荒","腾","贴","柔","滴","猛","阔","辆","妻","填","撤","储","签","闹","扰","紫","砂","递","戏","吊","陶","伐","喂","疗","瓶","婆","抚","臂","摸","忍","虾","蜡","邻","胸","巩","挤","偶","弃","槽","劲","乳","邓","吉","仁","烂","砖","租","乌","舰","伴","瓜","浅","丙","暂","燥","橡","柳","迷","暖","牌","秧","胆","详","簧","踏","瓷","谱","呆","宾","糊","洛","辉","愤","竞","隙","怒","粘","乃","绪","肩","籍","敏","涂","熙","皆","侦","悬","掘","享","纠","醒","狂","锁","淀","恨","牲","霸","爬","赏","逆","玩","陵","祝","秒","浙","貌","役","彼","悉","鸭","趋","凤","晨","畜","辈","秩","卵","署","梯","炎","滩","棋","驱","筛","峡","冒","啥","寿","译","浸","泉","帽","迟","硅","疆","贷","漏","稿","冠","嫩","胁","芯","牢","叛","蚀","奥","鸣","岭","羊","凭","串","塘","绘","酵","融","盆","锡","庙","筹","冻","辅","摄","袭","筋","拒","僚","旱","钾","鸟","漆","沈","眉","疏","添","棒","穗","硝","韩","逼","扭","侨","凉","挺","碗","栽","炒","杯","患","馏","劝","豪","辽","勃","鸿","旦","吏","拜","狗","埋","辊","掩","饮","搬","骂","辞","勾","扣","估","蒋","绒","雾","丈","朵","姆","拟","宇","辑","陕","雕","偿","蓄","崇","剪","倡","厅","咬","驶","薯","刷","斥","番","赋","奉","佛","浇","漫","曼","扇","钙","桃","扶","仔","返","俗","亏","腔","鞋","棱","覆","框","悄","叔","撞","骗","勘","旺","沸","孤","吐","孟","渠","屈","疾","妙","惜","仰","狠","胀","谐","抛","霉","桑","岗","嘛","衰","盗","渗","脏","赖","涌","甜","曹","阅","肌","哩","厉","烃","纬","毅","昨","伪","症","煮","叹","钉","搭","茎","笼","酷","偷","弓","锥","恒","杰","坑","鼻","翼","纶","叙","狱","逮","罐","络","棚","抑","膨","蔬","寺","骤","穆","冶","枯","册","尸","凸","绅","坯","牺","焰","轰","欣","晋","瘦","御","锭","锦","丧","旬","锻","垄","搜","扑","邀","亭","酯","迈","舒","脆","酶","闲","忧","酚","顽","羽","涨","卸","仗","陪","辟","惩","杭","姚","肚","捉","飘","漂","昆","欺","吾","郎","烷","汁","呵","饰","萧","雅","邮","迁","燕","撒","姻","赴","宴","烦","债","帐","斑","铃","旨","醇","董","饼","雏","姿","拌","傅","腹","妥","揉","贤","拆","歪","葡","胺","丢","浩","徽","昂","垫","挡","览","贪","慰","缴","汪","慌","冯","诺","姜","谊","凶","劣","诬","耀","昏","躺","盈","骑","乔","溪","丛","卢","抹","闷","咨","刮","驾","缆","悟","摘","铒","掷","颇","幻","柄","惠","惨","佳","仇","腊","窝","涤","剑","瞧","堡","泼","葱","罩","霍","捞","胎","苍","滨","俩","捅","湘","砍","霞","邵","萄","疯","淮","遂","熊","粪","烘","宿","档","戈","驳","嫂","裕","徙","箭","捐","肠","撑","晒","辨","殿","莲","摊","搅","酱","屏","疫","哀","蔡","堵","沫","皱","畅","叠","阁","莱","敲","辖","钩","痕","坝","巷","饿","祸","丘","玄","溜","曰","逻","彭","尝","卿","妨","艇","吞","韦","怨","矮","歇"]},function(t,e,i){"use strict";t.exports=["的","一","是","在","不","了","有","和","人","這","中","大","為","上","個","國","我","以","要","他","時","來","用","們","生","到","作","地","於","出","就","分","對","成","會","可","主","發","年","動","同","工","也","能","下","過","子","說","產","種","面","而","方","後","多","定","行","學","法","所","民","得","經","十","三","之","進","著","等","部","度","家","電","力","裡","如","水","化","高","自","二","理","起","小","物","現","實","加","量","都","兩","體","制","機","當","使","點","從","業","本","去","把","性","好","應","開","它","合","還","因","由","其","些","然","前","外","天","政","四","日","那","社","義","事","平","形","相","全","表","間","樣","與","關","各","重","新","線","內","數","正","心","反","你","明","看","原","又","麼","利","比","或","但","質","氣","第","向","道","命","此","變","條","只","沒","結","解","問","意","建","月","公","無","系","軍","很","情","者","最","立","代","想","已","通","並","提","直","題","黨","程","展","五","果","料","象","員","革","位","入","常","文","總","次","品","式","活","設","及","管","特","件","長","求","老","頭","基","資","邊","流","路","級","少","圖","山","統","接","知","較","將","組","見","計","別","她","手","角","期","根","論","運","農","指","幾","九","區","強","放","決","西","被","幹","做","必","戰","先","回","則","任","取","據","處","隊","南","給","色","光","門","即","保","治","北","造","百","規","熱","領","七","海","口","東","導","器","壓","志","世","金","增","爭","濟","階","油","思","術","極","交","受","聯","什","認","六","共","權","收","證","改","清","美","再","採","轉","更","單","風","切","打","白","教","速","花","帶","安","場","身","車","例","真","務","具","萬","每","目","至","達","走","積","示","議","聲","報","鬥","完","類","八","離","華","名","確","才","科","張","信","馬","節","話","米","整","空","元","況","今","集","溫","傳","土","許","步","群","廣","石","記","需","段","研","界","拉","林","律","叫","且","究","觀","越","織","裝","影","算","低","持","音","眾","書","布","复","容","兒","須","際","商","非","驗","連","斷","深","難","近","礦","千","週","委","素","技","備","半","辦","青","省","列","習","響","約","支","般","史","感","勞","便","團","往","酸","歷","市","克","何","除","消","構","府","稱","太","準","精","值","號","率","族","維","劃","選","標","寫","存","候","毛","親","快","效","斯","院","查","江","型","眼","王","按","格","養","易","置","派","層","片","始","卻","專","狀","育","廠","京","識","適","屬","圓","包","火","住","調","滿","縣","局","照","參","紅","細","引","聽","該","鐵","價","嚴","首","底","液","官","德","隨","病","蘇","失","爾","死","講","配","女","黃","推","顯","談","罪","神","藝","呢","席","含","企","望","密","批","營","項","防","舉","球","英","氧","勢","告","李","台","落","木","幫","輪","破","亞","師","圍","注","遠","字","材","排","供","河","態","封","另","施","減","樹","溶","怎","止","案","言","士","均","武","固","葉","魚","波","視","僅","費","緊","愛","左","章","早","朝","害","續","輕","服","試","食","充","兵","源","判","護","司","足","某","練","差","致","板","田","降","黑","犯","負","擊","范","繼","興","似","餘","堅","曲","輸","修","故","城","夫","夠","送","筆","船","佔","右","財","吃","富","春","職","覺","漢","畫","功","巴","跟","雖","雜","飛","檢","吸","助","昇","陽","互","初","創","抗","考","投","壞","策","古","徑","換","未","跑","留","鋼","曾","端","責","站","簡","述","錢","副","盡","帝","射","草","衝","承","獨","令","限","阿","宣","環","雙","請","超","微","讓","控","州","良","軸","找","否","紀","益","依","優","頂","礎","載","倒","房","突","坐","粉","敵","略","客","袁","冷","勝","絕","析","塊","劑","測","絲","協","訴","念","陳","仍","羅","鹽","友","洋","錯","苦","夜","刑","移","頻","逐","靠","混","母","短","皮","終","聚","汽","村","雲","哪","既","距","衛","停","烈","央","察","燒","迅","境","若","印","洲","刻","括","激","孔","搞","甚","室","待","核","校","散","侵","吧","甲","遊","久","菜","味","舊","模","湖","貨","損","預","阻","毫","普","穩","乙","媽","植","息","擴","銀","語","揮","酒","守","拿","序","紙","醫","缺","雨","嗎","針","劉","啊","急","唱","誤","訓","願","審","附","獲","茶","鮮","糧","斤","孩","脫","硫","肥","善","龍","演","父","漸","血","歡","械","掌","歌","沙","剛","攻","謂","盾","討","晚","粒","亂","燃","矛","乎","殺","藥","寧","魯","貴","鐘","煤","讀","班","伯","香","介","迫","句","豐","培","握","蘭","擔","弦","蛋","沉","假","穿","執","答","樂","誰","順","煙","縮","徵","臉","喜","松","腳","困","異","免","背","星","福","買","染","井","概","慢","怕","磁","倍","祖","皇","促","靜","補","評","翻","肉","踐","尼","衣","寬","揚","棉","希","傷","操","垂","秋","宜","氫","套","督","振","架","亮","末","憲","慶","編","牛","觸","映","雷","銷","詩","座","居","抓","裂","胞","呼","娘","景","威","綠","晶","厚","盟","衡","雞","孫","延","危","膠","屋","鄉","臨","陸","顧","掉","呀","燈","歲","措","束","耐","劇","玉","趙","跳","哥","季","課","凱","胡","額","款","紹","卷","齊","偉","蒸","殖","永","宗","苗","川","爐","岩","弱","零","楊","奏","沿","露","桿","探","滑","鎮","飯","濃","航","懷","趕","庫","奪","伊","靈","稅","途","滅","賽","歸","召","鼓","播","盤","裁","險","康","唯","錄","菌","純","借","糖","蓋","橫","符","私","努","堂","域","槍","潤","幅","哈","竟","熟","蟲","澤","腦","壤","碳","歐","遍","側","寨","敢","徹","慮","斜","薄","庭","納","彈","飼","伸","折","麥","濕","暗","荷","瓦","塞","床","築","惡","戶","訪","塔","奇","透","梁","刀","旋","跡","卡","氯","遇","份","毒","泥","退","洗","擺","灰","彩","賣","耗","夏","擇","忙","銅","獻","硬","予","繁","圈","雪","函","亦","抽","篇","陣","陰","丁","尺","追","堆","雄","迎","泛","爸","樓","避","謀","噸","野","豬","旗","累","偏","典","館","索","秦","脂","潮","爺","豆","忽","托","驚","塑","遺","愈","朱","替","纖","粗","傾","尚","痛","楚","謝","奮","購","磨","君","池","旁","碎","骨","監","捕","弟","暴","割","貫","殊","釋","詞","亡","壁","頓","寶","午","塵","聞","揭","炮","殘","冬","橋","婦","警","綜","招","吳","付","浮","遭","徐","您","搖","谷","贊","箱","隔","訂","男","吹","園","紛","唐","敗","宋","玻","巨","耕","坦","榮","閉","灣","鍵","凡","駐","鍋","救","恩","剝","凝","鹼","齒","截","煉","麻","紡","禁","廢","盛","版","緩","淨","睛","昌","婚","涉","筒","嘴","插","岸","朗","莊","街","藏","姑","貿","腐","奴","啦","慣","乘","夥","恢","勻","紗","扎","辯","耳","彪","臣","億","璃","抵","脈","秀","薩","俄","網","舞","店","噴","縱","寸","汗","掛","洪","賀","閃","柬","爆","烯","津","稻","牆","軟","勇","像","滾","厘","蒙","芳","肯","坡","柱","盪","腿","儀","旅","尾","軋","冰","貢","登","黎","削","鑽","勒","逃","障","氨","郭","峰","幣","港","伏","軌","畝","畢","擦","莫","刺","浪","秘","援","株","健","售","股","島","甘","泡","睡","童","鑄","湯","閥","休","匯","舍","牧","繞","炸","哲","磷","績","朋","淡","尖","啟","陷","柴","呈","徒","顏","淚","稍","忘","泵","藍","拖","洞","授","鏡","辛","壯","鋒","貧","虛","彎","摩","泰","幼","廷","尊","窗","綱","弄","隸","疑","氏","宮","姐","震","瑞","怪","尤","琴","循","描","膜","違","夾","腰","緣","珠","窮","森","枝","竹","溝","催","繩","憶","邦","剩","幸","漿","欄","擁","牙","貯","禮","濾","鈉","紋","罷","拍","咱","喊","袖","埃","勤","罰","焦","潛","伍","墨","欲","縫","姓","刊","飽","仿","獎","鋁","鬼","麗","跨","默","挖","鏈","掃","喝","袋","炭","污","幕","諸","弧","勵","梅","奶","潔","災","舟","鑑","苯","訟","抱","毀","懂","寒","智","埔","寄","屆","躍","渡","挑","丹","艱","貝","碰","拔","爹","戴","碼","夢","芽","熔","赤","漁","哭","敬","顆","奔","鉛","仲","虎","稀","妹","乏","珍","申","桌","遵","允","隆","螺","倉","魏","銳","曉","氮","兼","隱","礙","赫","撥","忠","肅","缸","牽","搶","博","巧","殼","兄","杜","訊","誠","碧","祥","柯","頁","巡","矩","悲","灌","齡","倫","票","尋","桂","鋪","聖","恐","恰","鄭","趣","抬","荒","騰","貼","柔","滴","猛","闊","輛","妻","填","撤","儲","簽","鬧","擾","紫","砂","遞","戲","吊","陶","伐","餵","療","瓶","婆","撫","臂","摸","忍","蝦","蠟","鄰","胸","鞏","擠","偶","棄","槽","勁","乳","鄧","吉","仁","爛","磚","租","烏","艦","伴","瓜","淺","丙","暫","燥","橡","柳","迷","暖","牌","秧","膽","詳","簧","踏","瓷","譜","呆","賓","糊","洛","輝","憤","競","隙","怒","粘","乃","緒","肩","籍","敏","塗","熙","皆","偵","懸","掘","享","糾","醒","狂","鎖","淀","恨","牲","霸","爬","賞","逆","玩","陵","祝","秒","浙","貌","役","彼","悉","鴨","趨","鳳","晨","畜","輩","秩","卵","署","梯","炎","灘","棋","驅","篩","峽","冒","啥","壽","譯","浸","泉","帽","遲","矽","疆","貸","漏","稿","冠","嫩","脅","芯","牢","叛","蝕","奧","鳴","嶺","羊","憑","串","塘","繪","酵","融","盆","錫","廟","籌","凍","輔","攝","襲","筋","拒","僚","旱","鉀","鳥","漆","沈","眉","疏","添","棒","穗","硝","韓","逼","扭","僑","涼","挺","碗","栽","炒","杯","患","餾","勸","豪","遼","勃","鴻","旦","吏","拜","狗","埋","輥","掩","飲","搬","罵","辭","勾","扣","估","蔣","絨","霧","丈","朵","姆","擬","宇","輯","陝","雕","償","蓄","崇","剪","倡","廳","咬","駛","薯","刷","斥","番","賦","奉","佛","澆","漫","曼","扇","鈣","桃","扶","仔","返","俗","虧","腔","鞋","棱","覆","框","悄","叔","撞","騙","勘","旺","沸","孤","吐","孟","渠","屈","疾","妙","惜","仰","狠","脹","諧","拋","黴","桑","崗","嘛","衰","盜","滲","臟","賴","湧","甜","曹","閱","肌","哩","厲","烴","緯","毅","昨","偽","症","煮","嘆","釘","搭","莖","籠","酷","偷","弓","錐","恆","傑","坑","鼻","翼","綸","敘","獄","逮","罐","絡","棚","抑","膨","蔬","寺","驟","穆","冶","枯","冊","屍","凸","紳","坯","犧","焰","轟","欣","晉","瘦","禦","錠","錦","喪","旬","鍛","壟","搜","撲","邀","亭","酯","邁","舒","脆","酶","閒","憂","酚","頑","羽","漲","卸","仗","陪","闢","懲","杭","姚","肚","捉","飄","漂","昆","欺","吾","郎","烷","汁","呵","飾","蕭","雅","郵","遷","燕","撒","姻","赴","宴","煩","債","帳","斑","鈴","旨","醇","董","餅","雛","姿","拌","傅","腹","妥","揉","賢","拆","歪","葡","胺","丟","浩","徽","昂","墊","擋","覽","貪","慰","繳","汪","慌","馮","諾","姜","誼","兇","劣","誣","耀","昏","躺","盈","騎","喬","溪","叢","盧","抹","悶","諮","刮","駕","纜","悟","摘","鉺","擲","頗","幻","柄","惠","慘","佳","仇","臘","窩","滌","劍","瞧","堡","潑","蔥","罩","霍","撈","胎","蒼","濱","倆","捅","湘","砍","霞","邵","萄","瘋","淮","遂","熊","糞","烘","宿","檔","戈","駁","嫂","裕","徙","箭","捐","腸","撐","曬","辨","殿","蓮","攤","攪","醬","屏","疫","哀","蔡","堵","沫","皺","暢","疊","閣","萊","敲","轄","鉤","痕","壩","巷","餓","禍","丘","玄","溜","曰","邏","彭","嘗","卿","妨","艇","吞","韋","怨","矮","歇"]},function(t,e,i){"use strict";t.exports=["abandon","ability","able","about","above","absent","absorb","abstract","absurd","abuse","access","accident","account","accuse","achieve","acid","acoustic","acquire","across","act","action","actor","actress","actual","adapt","add","addict","address","adjust","admit","adult","advance","advice","aerobic","affair","afford","afraid","again","age","agent","agree","ahead","aim","air","airport","aisle","alarm","album","alcohol","alert","alien","all","alley","allow","almost","alone","alpha","already","also","alter","always","amateur","amazing","among","amount","amused","analyst","anchor","ancient","anger","angle","angry","animal","ankle","announce","annual","another","answer","antenna","antique","anxiety","any","apart","apology","appear","apple","approve","april","arch","arctic","area","arena","argue","arm","armed","armor","army","around","arrange","arrest","arrive","arrow","art","artefact","artist","artwork","ask","aspect","assault","asset","assist","assume","asthma","athlete","atom","attack","attend","attitude","attract","auction","audit","august","aunt","author","auto","autumn","average","avocado","avoid","awake","aware","away","awesome","awful","awkward","axis","baby","bachelor","bacon","badge","bag","balance","balcony","ball","bamboo","banana","banner","bar","barely","bargain","barrel","base","basic","basket","battle","beach","bean","beauty","because","become","beef","before","begin","behave","behind","believe","below","belt","bench","benefit","best","betray","better","between","beyond","bicycle","bid","bike","bind","biology","bird","birth","bitter","black","blade","blame","blanket","blast","bleak","bless","blind","blood","blossom","blouse","blue","blur","blush","board","boat","body","boil","bomb","bone","bonus","book","boost","border","boring","borrow","boss","bottom","bounce","box","boy","bracket","brain","brand","brass","brave","bread","breeze","brick","bridge","brief","bright","bring","brisk","broccoli","broken","bronze","broom","brother","brown","brush","bubble","buddy","budget","buffalo","build","bulb","bulk","bullet","bundle","bunker","burden","burger","burst","bus","business","busy","butter","buyer","buzz","cabbage","cabin","cable","cactus","cage","cake","call","calm","camera","camp","can","canal","cancel","candy","cannon","canoe","canvas","canyon","capable","capital","captain","car","carbon","card","cargo","carpet","carry","cart","case","cash","casino","castle","casual","cat","catalog","catch","category","cattle","caught","cause","caution","cave","ceiling","celery","cement","census","century","cereal","certain","chair","chalk","champion","change","chaos","chapter","charge","chase","chat","cheap","check","cheese","chef","cherry","chest","chicken","chief","child","chimney","choice","choose","chronic","chuckle","chunk","churn","cigar","cinnamon","circle","citizen","city","civil","claim","clap","clarify","claw","clay","clean","clerk","clever","click","client","cliff","climb","clinic","clip","clock","clog","close","cloth","cloud","clown","club","clump","cluster","clutch","coach","coast","coconut","code","coffee","coil","coin","collect","color","column","combine","come","comfort","comic","common","company","concert","conduct","confirm","congress","connect","consider","control","convince","cook","cool","copper","copy","coral","core","corn","correct","cost","cotton","couch","country","couple","course","cousin","cover","coyote","crack","cradle","craft","cram","crane","crash","crater","crawl","crazy","cream","credit","creek","crew","cricket","crime","crisp","critic","crop","cross","crouch","crowd","crucial","cruel","cruise","crumble","crunch","crush","cry","crystal","cube","culture","cup","cupboard","curious","current","curtain","curve","cushion","custom","cute","cycle","dad","damage","damp","dance","danger","daring","dash","daughter","dawn","day","deal","debate","debris","decade","december","decide","decline","decorate","decrease","deer","defense","define","defy","degree","delay","deliver","demand","demise","denial","dentist","deny","depart","depend","deposit","depth","deputy","derive","describe","desert","design","desk","despair","destroy","detail","detect","develop","device","devote","diagram","dial","diamond","diary","dice","diesel","diet","differ","digital","dignity","dilemma","dinner","dinosaur","direct","dirt","disagree","discover","disease","dish","dismiss","disorder","display","distance","divert","divide","divorce","dizzy","doctor","document","dog","doll","dolphin","domain","donate","donkey","donor","door","dose","double","dove","draft","dragon","drama","drastic","draw","dream","dress","drift","drill","drink","drip","drive","drop","drum","dry","duck","dumb","dune","during","dust","dutch","duty","dwarf","dynamic","eager","eagle","early","earn","earth","easily","east","easy","echo","ecology","economy","edge","edit","educate","effort","egg","eight","either","elbow","elder","electric","elegant","element","elephant","elevator","elite","else","embark","embody","embrace","emerge","emotion","employ","empower","empty","enable","enact","end","endless","endorse","enemy","energy","enforce","engage","engine","enhance","enjoy","enlist","enough","enrich","enroll","ensure","enter","entire","entry","envelope","episode","equal","equip","era","erase","erode","erosion","error","erupt","escape","essay","essence","estate","eternal","ethics","evidence","evil","evoke","evolve","exact","example","excess","exchange","excite","exclude","excuse","execute","exercise","exhaust","exhibit","exile","exist","exit","exotic","expand","expect","expire","explain","expose","express","extend","extra","eye","eyebrow","fabric","face","faculty","fade","faint","faith","fall","false","fame","family","famous","fan","fancy","fantasy","farm","fashion","fat","fatal","father","fatigue","fault","favorite","feature","february","federal","fee","feed","feel","female","fence","festival","fetch","fever","few","fiber","fiction","field","figure","file","film","filter","final","find","fine","finger","finish","fire","firm","first","fiscal","fish","fit","fitness","fix","flag","flame","flash","flat","flavor","flee","flight","flip","float","flock","floor","flower","fluid","flush","fly","foam","focus","fog","foil","fold","follow","food","foot","force","forest","forget","fork","fortune","forum","forward","fossil","foster","found","fox","fragile","frame","frequent","fresh","friend","fringe","frog","front","frost","frown","frozen","fruit","fuel","fun","funny","furnace","fury","future","gadget","gain","galaxy","gallery","game","gap","garage","garbage","garden","garlic","garment","gas","gasp","gate","gather","gauge","gaze","general","genius","genre","gentle","genuine","gesture","ghost","giant","gift","giggle","ginger","giraffe","girl","give","glad","glance","glare","glass","glide","glimpse","globe","gloom","glory","glove","glow","glue","goat","goddess","gold","good","goose","gorilla","gospel","gossip","govern","gown","grab","grace","grain","grant","grape","grass","gravity","great","green","grid","grief","grit","grocery","group","grow","grunt","guard","guess","guide","guilt","guitar","gun","gym","habit","hair","half","hammer","hamster","hand","happy","harbor","hard","harsh","harvest","hat","have","hawk","hazard","head","health","heart","heavy","hedgehog","height","hello","helmet","help","hen","hero","hidden","high","hill","hint","hip","hire","history","hobby","hockey","hold","hole","holiday","hollow","home","honey","hood","hope","horn","horror","horse","hospital","host","hotel","hour","hover","hub","huge","human","humble","humor","hundred","hungry","hunt","hurdle","hurry","hurt","husband","hybrid","ice","icon","idea","identify","idle","ignore","ill","illegal","illness","image","imitate","immense","immune","impact","impose","improve","impulse","inch","include","income","increase","index","indicate","indoor","industry","infant","inflict","inform","inhale","inherit","initial","inject","injury","inmate","inner","innocent","input","inquiry","insane","insect","inside","inspire","install","intact","interest","into","invest","invite","involve","iron","island","isolate","issue","item","ivory","jacket","jaguar","jar","jazz","jealous","jeans","jelly","jewel","job","join","joke","journey","joy","judge","juice","jump","jungle","junior","junk","just","kangaroo","keen","keep","ketchup","key","kick","kid","kidney","kind","kingdom","kiss","kit","kitchen","kite","kitten","kiwi","knee","knife","knock","know","lab","label","labor","ladder","lady","lake","lamp","language","laptop","large","later","latin","laugh","laundry","lava","law","lawn","lawsuit","layer","lazy","leader","leaf","learn","leave","lecture","left","leg","legal","legend","leisure","lemon","lend","length","lens","leopard","lesson","letter","level","liar","liberty","library","license","life","lift","light","like","limb","limit","link","lion","liquid","list","little","live","lizard","load","loan","lobster","local","lock","logic","lonely","long","loop","lottery","loud","lounge","love","loyal","lucky","luggage","lumber","lunar","lunch","luxury","lyrics","machine","mad","magic","magnet","maid","mail","main","major","make","mammal","man","manage","mandate","mango","mansion","manual","maple","marble","march","margin","marine","market","marriage","mask","mass","master","match","material","math","matrix","matter","maximum","maze","meadow","mean","measure","meat","mechanic","medal","media","melody","melt","member","memory","mention","menu","mercy","merge","merit","merry","mesh","message","metal","method","middle","midnight","milk","million","mimic","mind","minimum","minor","minute","miracle","mirror","misery","miss","mistake","mix","mixed","mixture","mobile","model","modify","mom","moment","monitor","monkey","monster","month","moon","moral","more","morning","mosquito","mother","motion","motor","mountain","mouse","move","movie","much","muffin","mule","multiply","muscle","museum","mushroom","music","must","mutual","myself","mystery","myth","naive","name","napkin","narrow","nasty","nation","nature","near","neck","need","negative","neglect","neither","nephew","nerve","nest","net","network","neutral","never","news","next","nice","night","noble","noise","nominee","noodle","normal","north","nose","notable","note","nothing","notice","novel","now","nuclear","number","nurse","nut","oak","obey","object","oblige","obscure","observe","obtain","obvious","occur","ocean","october","odor","off","offer","office","often","oil","okay","old","olive","olympic","omit","once","one","onion","online","only","open","opera","opinion","oppose","option","orange","orbit","orchard","order","ordinary","organ","orient","original","orphan","ostrich","other","outdoor","outer","output","outside","oval","oven","over","own","owner","oxygen","oyster","ozone","pact","paddle","page","pair","palace","palm","panda","panel","panic","panther","paper","parade","parent","park","parrot","party","pass","patch","path","patient","patrol","pattern","pause","pave","payment","peace","peanut","pear","peasant","pelican","pen","penalty","pencil","people","pepper","perfect","permit","person","pet","phone","photo","phrase","physical","piano","picnic","picture","piece","pig","pigeon","pill","pilot","pink","pioneer","pipe","pistol","pitch","pizza","place","planet","plastic","plate","play","please","pledge","pluck","plug","plunge","poem","poet","point","polar","pole","police","pond","pony","pool","popular","portion","position","possible","post","potato","pottery","poverty","powder","power","practice","praise","predict","prefer","prepare","present","pretty","prevent","price","pride","primary","print","priority","prison","private","prize","problem","process","produce","profit","program","project","promote","proof","property","prosper","protect","proud","provide","public","pudding","pull","pulp","pulse","pumpkin","punch","pupil","puppy","purchase","purity","purpose","purse","push","put","puzzle","pyramid","quality","quantum","quarter","question","quick","quit","quiz","quote","rabbit","raccoon","race","rack","radar","radio","rail","rain","raise","rally","ramp","ranch","random","range","rapid","rare","rate","rather","raven","raw","razor","ready","real","reason","rebel","rebuild","recall","receive","recipe","record","recycle","reduce","reflect","reform","refuse","region","regret","regular","reject","relax","release","relief","rely","remain","remember","remind","remove","render","renew","rent","reopen","repair","repeat","replace","report","require","rescue","resemble","resist","resource","response","result","retire","retreat","return","reunion","reveal","review","reward","rhythm","rib","ribbon","rice","rich","ride","ridge","rifle","right","rigid","ring","riot","ripple","risk","ritual","rival","river","road","roast","robot","robust","rocket","romance","roof","rookie","room","rose","rotate","rough","round","route","royal","rubber","rude","rug","rule","run","runway","rural","sad","saddle","sadness","safe","sail","salad","salmon","salon","salt","salute","same","sample","sand","satisfy","satoshi","sauce","sausage","save","say","scale","scan","scare","scatter","scene","scheme","school","science","scissors","scorpion","scout","scrap","screen","script","scrub","sea","search","season","seat","second","secret","section","security","seed","seek","segment","select","sell","seminar","senior","sense","sentence","series","service","session","settle","setup","seven","shadow","shaft","shallow","share","shed","shell","sheriff","shield","shift","shine","ship","shiver","shock","shoe","shoot","shop","short","shoulder","shove","shrimp","shrug","shuffle","shy","sibling","sick","side","siege","sight","sign","silent","silk","silly","silver","similar","simple","since","sing","siren","sister","situate","six","size","skate","sketch","ski","skill","skin","skirt","skull","slab","slam","sleep","slender","slice","slide","slight","slim","slogan","slot","slow","slush","small","smart","smile","smoke","smooth","snack","snake","snap","sniff","snow","soap","soccer","social","sock","soda","soft","solar","soldier","solid","solution","solve","someone","song","soon","sorry","sort","soul","sound","soup","source","south","space","spare","spatial","spawn","speak","special","speed","spell","spend","sphere","spice","spider","spike","spin","spirit","split","spoil","sponsor","spoon","sport","spot","spray","spread","spring","spy","square","squeeze","squirrel","stable","stadium","staff","stage","stairs","stamp","stand","start","state","stay","steak","steel","stem","step","stereo","stick","still","sting","stock","stomach","stone","stool","story","stove","strategy","street","strike","strong","struggle","student","stuff","stumble","style","subject","submit","subway","success","such","sudden","suffer","sugar","suggest","suit","summer","sun","sunny","sunset","super","supply","supreme","sure","surface","surge","surprise","surround","survey","suspect","sustain","swallow","swamp","swap","swarm","swear","sweet","swift","swim","swing","switch","sword","symbol","symptom","syrup","system","table","tackle","tag","tail","talent","talk","tank","tape","target","task","taste","tattoo","taxi","teach","team","tell","ten","tenant","tennis","tent","term","test","text","thank","that","theme","then","theory","there","they","thing","this","thought","three","thrive","throw","thumb","thunder","ticket","tide","tiger","tilt","timber","time","tiny","tip","tired","tissue","title","toast","tobacco","today","toddler","toe","together","toilet","token","tomato","tomorrow","tone","tongue","tonight","tool","tooth","top","topic","topple","torch","tornado","tortoise","toss","total","tourist","toward","tower","town","toy","track","trade","traffic","tragic","train","transfer","trap","trash","travel","tray","treat","tree","trend","trial","tribe","trick","trigger","trim","trip","trophy","trouble","truck","true","truly","trumpet","trust","truth","try","tube","tuition","tumble","tuna","tunnel","turkey","turn","turtle","twelve","twenty","twice","twin","twist","two","type","typical","ugly","umbrella","unable","unaware","uncle","uncover","under","undo","unfair","unfold","unhappy","uniform","unique","unit","universe","unknown","unlock","until","unusual","unveil","update","upgrade","uphold","upon","upper","upset","urban","urge","usage","use","used","useful","useless","usual","utility","vacant","vacuum","vague","valid","valley","valve","van","vanish","vapor","various","vast","vault","vehicle","velvet","vendor","venture","venue","verb","verify","version","very","vessel","veteran","viable","vibrant","vicious","victory","video","view","village","vintage","violin","virtual","virus","visa","visit","visual","vital","vivid","vocal","voice","void","volcano","volume","vote","voyage","wage","wagon","wait","walk","wall","walnut","want","warfare","warm","warrior","wash","wasp","waste","water","wave","way","wealth","weapon","wear","weasel","weather","web","wedding","weekend","weird","welcome","west","wet","whale","what","wheat","wheel","when","where","whip","whisper","wide","width","wife","wild","will","win","window","wine","wing","wink","winner","winter","wire","wisdom","wise","wish","witness","wolf","woman","wonder","wood","wool","word","work","world","worry","worth","wrap","wreck","wrestle","wrist","write","wrong","yard","year","yellow","you","young","youth","zebra","zero","zone","zoo"]},function(t,e,i){"use strict";t.exports=["abaisser","abandon","abdiquer","abeille","abolir","aborder","aboutir","aboyer","abrasif","abreuver","abriter","abroger","abrupt","absence","absolu","absurde","abusif","abyssal","académie","acajou","acarien","accabler","accepter","acclamer","accolade","accroche","accuser","acerbe","achat","acheter","aciduler","acier","acompte","acquérir","acronyme","acteur","actif","actuel","adepte","adéquat","adhésif","adjectif","adjuger","admettre","admirer","adopter","adorer","adoucir","adresse","adroit","adulte","adverbe","aérer","aéronef","affaire","affecter","affiche","affreux","affubler","agacer","agencer","agile","agiter","agrafer","agréable","agrume","aider","aiguille","ailier","aimable","aisance","ajouter","ajuster","alarmer","alchimie","alerte","algèbre","algue","aliéner","aliment","alléger","alliage","allouer","allumer","alourdir","alpaga","altesse","alvéole","amateur","ambigu","ambre","aménager","amertume","amidon","amiral","amorcer","amour","amovible","amphibie","ampleur","amusant","analyse","anaphore","anarchie","anatomie","ancien","anéantir","angle","angoisse","anguleux","animal","annexer","annonce","annuel","anodin","anomalie","anonyme","anormal","antenne","antidote","anxieux","apaiser","apéritif","aplanir","apologie","appareil","appeler","apporter","appuyer","aquarium","aqueduc","arbitre","arbuste","ardeur","ardoise","argent","arlequin","armature","armement","armoire","armure","arpenter","arracher","arriver","arroser","arsenic","artériel","article","aspect","asphalte","aspirer","assaut","asservir","assiette","associer","assurer","asticot","astre","astuce","atelier","atome","atrium","atroce","attaque","attentif","attirer","attraper","aubaine","auberge","audace","audible","augurer","aurore","automne","autruche","avaler","avancer","avarice","avenir","averse","aveugle","aviateur","avide","avion","aviser","avoine","avouer","avril","axial","axiome","badge","bafouer","bagage","baguette","baignade","balancer","balcon","baleine","balisage","bambin","bancaire","bandage","banlieue","bannière","banquier","barbier","baril","baron","barque","barrage","bassin","bastion","bataille","bateau","batterie","baudrier","bavarder","belette","bélier","belote","bénéfice","berceau","berger","berline","bermuda","besace","besogne","bétail","beurre","biberon","bicycle","bidule","bijou","bilan","bilingue","billard","binaire","biologie","biopsie","biotype","biscuit","bison","bistouri","bitume","bizarre","blafard","blague","blanchir","blessant","blinder","blond","bloquer","blouson","bobard","bobine","boire","boiser","bolide","bonbon","bondir","bonheur","bonifier","bonus","bordure","borne","botte","boucle","boueux","bougie","boulon","bouquin","bourse","boussole","boutique","boxeur","branche","brasier","brave","brebis","brèche","breuvage","bricoler","brigade","brillant","brioche","brique","brochure","broder","bronzer","brousse","broyeur","brume","brusque","brutal","bruyant","buffle","buisson","bulletin","bureau","burin","bustier","butiner","butoir","buvable","buvette","cabanon","cabine","cachette","cadeau","cadre","caféine","caillou","caisson","calculer","calepin","calibre","calmer","calomnie","calvaire","camarade","caméra","camion","campagne","canal","caneton","canon","cantine","canular","capable","caporal","caprice","capsule","capter","capuche","carabine","carbone","caresser","caribou","carnage","carotte","carreau","carton","cascade","casier","casque","cassure","causer","caution","cavalier","caverne","caviar","cédille","ceinture","céleste","cellule","cendrier","censurer","central","cercle","cérébral","cerise","cerner","cerveau","cesser","chagrin","chaise","chaleur","chambre","chance","chapitre","charbon","chasseur","chaton","chausson","chavirer","chemise","chenille","chéquier","chercher","cheval","chien","chiffre","chignon","chimère","chiot","chlorure","chocolat","choisir","chose","chouette","chrome","chute","cigare","cigogne","cimenter","cinéma","cintrer","circuler","cirer","cirque","citerne","citoyen","citron","civil","clairon","clameur","claquer","classe","clavier","client","cligner","climat","clivage","cloche","clonage","cloporte","cobalt","cobra","cocasse","cocotier","coder","codifier","coffre","cogner","cohésion","coiffer","coincer","colère","colibri","colline","colmater","colonel","combat","comédie","commande","compact","concert","conduire","confier","congeler","connoter","consonne","contact","convexe","copain","copie","corail","corbeau","cordage","corniche","corpus","correct","cortège","cosmique","costume","coton","coude","coupure","courage","couteau","couvrir","coyote","crabe","crainte","cravate","crayon","créature","créditer","crémeux","creuser","crevette","cribler","crier","cristal","critère","croire","croquer","crotale","crucial","cruel","crypter","cubique","cueillir","cuillère","cuisine","cuivre","culminer","cultiver","cumuler","cupide","curatif","curseur","cyanure","cycle","cylindre","cynique","daigner","damier","danger","danseur","dauphin","débattre","débiter","déborder","débrider","débutant","décaler","décembre","déchirer","décider","déclarer","décorer","décrire","décupler","dédale","déductif","déesse","défensif","défiler","défrayer","dégager","dégivrer","déglutir","dégrafer","déjeuner","délice","déloger","demander","demeurer","démolir","dénicher","dénouer","dentelle","dénuder","départ","dépenser","déphaser","déplacer","déposer","déranger","dérober","désastre","descente","désert","désigner","désobéir","dessiner","destrier","détacher","détester","détourer","détresse","devancer","devenir","deviner","devoir","diable","dialogue","diamant","dicter","différer","digérer","digital","digne","diluer","dimanche","diminuer","dioxyde","directif","diriger","discuter","disposer","dissiper","distance","divertir","diviser","docile","docteur","dogme","doigt","domaine","domicile","dompter","donateur","donjon","donner","dopamine","dortoir","dorure","dosage","doseur","dossier","dotation","douanier","double","douceur","douter","doyen","dragon","draper","dresser","dribbler","droiture","duperie","duplexe","durable","durcir","dynastie","éblouir","écarter","écharpe","échelle","éclairer","éclipse","éclore","écluse","école","économie","écorce","écouter","écraser","écrémer","écrivain","écrou","écume","écureuil","édifier","éduquer","effacer","effectif","effigie","effort","effrayer","effusion","égaliser","égarer","éjecter","élaborer","élargir","électron","élégant","éléphant","élève","éligible","élitisme","éloge","élucider","éluder","emballer","embellir","embryon","émeraude","émission","emmener","émotion","émouvoir","empereur","employer","emporter","emprise","émulsion","encadrer","enchère","enclave","encoche","endiguer","endosser","endroit","enduire","énergie","enfance","enfermer","enfouir","engager","engin","englober","énigme","enjamber","enjeu","enlever","ennemi","ennuyeux","enrichir","enrobage","enseigne","entasser","entendre","entier","entourer","entraver","énumérer","envahir","enviable","envoyer","enzyme","éolien","épaissir","épargne","épatant","épaule","épicerie","épidémie","épier","épilogue","épine","épisode","épitaphe","époque","épreuve","éprouver","épuisant","équerre","équipe","ériger","érosion","erreur","éruption","escalier","espadon","espèce","espiègle","espoir","esprit","esquiver","essayer","essence","essieu","essorer","estime","estomac","estrade","étagère","étaler","étanche","étatique","éteindre","étendoir","éternel","éthanol","éthique","ethnie","étirer","étoffer","étoile","étonnant","étourdir","étrange","étroit","étude","euphorie","évaluer","évasion","éventail","évidence","éviter","évolutif","évoquer","exact","exagérer","exaucer","exceller","excitant","exclusif","excuse","exécuter","exemple","exercer","exhaler","exhorter","exigence","exiler","exister","exotique","expédier","explorer","exposer","exprimer","exquis","extensif","extraire","exulter","fable","fabuleux","facette","facile","facture","faiblir","falaise","fameux","famille","farceur","farfelu","farine","farouche","fasciner","fatal","fatigue","faucon","fautif","faveur","favori","fébrile","féconder","fédérer","félin","femme","fémur","fendoir","féodal","fermer","féroce","ferveur","festival","feuille","feutre","février","fiasco","ficeler","fictif","fidèle","figure","filature","filetage","filière","filleul","filmer","filou","filtrer","financer","finir","fiole","firme","fissure","fixer","flairer","flamme","flasque","flatteur","fléau","flèche","fleur","flexion","flocon","flore","fluctuer","fluide","fluvial","folie","fonderie","fongible","fontaine","forcer","forgeron","formuler","fortune","fossile","foudre","fougère","fouiller","foulure","fourmi","fragile","fraise","franchir","frapper","frayeur","frégate","freiner","frelon","frémir","frénésie","frère","friable","friction","frisson","frivole","froid","fromage","frontal","frotter","fruit","fugitif","fuite","fureur","furieux","furtif","fusion","futur","gagner","galaxie","galerie","gambader","garantir","gardien","garnir","garrigue","gazelle","gazon","géant","gélatine","gélule","gendarme","général","génie","genou","gentil","géologie","géomètre","géranium","germe","gestuel","geyser","gibier","gicler","girafe","givre","glace","glaive","glisser","globe","gloire","glorieux","golfeur","gomme","gonfler","gorge","gorille","goudron","gouffre","goulot","goupille","gourmand","goutte","graduel","graffiti","graine","grand","grappin","gratuit","gravir","grenat","griffure","griller","grimper","grogner","gronder","grotte","groupe","gruger","grutier","gruyère","guépard","guerrier","guide","guimauve","guitare","gustatif","gymnaste","gyrostat","habitude","hachoir","halte","hameau","hangar","hanneton","haricot","harmonie","harpon","hasard","hélium","hématome","herbe","hérisson","hermine","héron","hésiter","heureux","hiberner","hibou","hilarant","histoire","hiver","homard","hommage","homogène","honneur","honorer","honteux","horde","horizon","horloge","hormone","horrible","houleux","housse","hublot","huileux","humain","humble","humide","humour","hurler","hydromel","hygiène","hymne","hypnose","idylle","ignorer","iguane","illicite","illusion","image","imbiber","imiter","immense","immobile","immuable","impact","impérial","implorer","imposer","imprimer","imputer","incarner","incendie","incident","incliner","incolore","indexer","indice","inductif","inédit","ineptie","inexact","infini","infliger","informer","infusion","ingérer","inhaler","inhiber","injecter","injure","innocent","inoculer","inonder","inscrire","insecte","insigne","insolite","inspirer","instinct","insulter","intact","intense","intime","intrigue","intuitif","inutile","invasion","inventer","inviter","invoquer","ironique","irradier","irréel","irriter","isoler","ivoire","ivresse","jaguar","jaillir","jambe","janvier","jardin","jauger","jaune","javelot","jetable","jeton","jeudi","jeunesse","joindre","joncher","jongler","joueur","jouissif","journal","jovial","joyau","joyeux","jubiler","jugement","junior","jupon","juriste","justice","juteux","juvénile","kayak","kimono","kiosque","label","labial","labourer","lacérer","lactose","lagune","laine","laisser","laitier","lambeau","lamelle","lampe","lanceur","langage","lanterne","lapin","largeur","larme","laurier","lavabo","lavoir","lecture","légal","léger","légume","lessive","lettre","levier","lexique","lézard","liasse","libérer","libre","licence","licorne","liège","lièvre","ligature","ligoter","ligue","limer","limite","limonade","limpide","linéaire","lingot","lionceau","liquide","lisière","lister","lithium","litige","littoral","livreur","logique","lointain","loisir","lombric","loterie","louer","lourd","loutre","louve","loyal","lubie","lucide","lucratif","lueur","lugubre","luisant","lumière","lunaire","lundi","luron","lutter","luxueux","machine","magasin","magenta","magique","maigre","maillon","maintien","mairie","maison","majorer","malaxer","maléfice","malheur","malice","mallette","mammouth","mandater","maniable","manquant","manteau","manuel","marathon","marbre","marchand","mardi","maritime","marqueur","marron","marteler","mascotte","massif","matériel","matière","matraque","maudire","maussade","mauve","maximal","méchant","méconnu","médaille","médecin","méditer","méduse","meilleur","mélange","mélodie","membre","mémoire","menacer","mener","menhir","mensonge","mentor","mercredi","mérite","merle","messager","mesure","métal","météore","méthode","métier","meuble","miauler","microbe","miette","mignon","migrer","milieu","million","mimique","mince","minéral","minimal","minorer","minute","miracle","miroiter","missile","mixte","mobile","moderne","moelleux","mondial","moniteur","monnaie","monotone","monstre","montagne","monument","moqueur","morceau","morsure","mortier","moteur","motif","mouche","moufle","moulin","mousson","mouton","mouvant","multiple","munition","muraille","murène","murmure","muscle","muséum","musicien","mutation","muter","mutuel","myriade","myrtille","mystère","mythique","nageur","nappe","narquois","narrer","natation","nation","nature","naufrage","nautique","navire","nébuleux","nectar","néfaste","négation","négliger","négocier","neige","nerveux","nettoyer","neurone","neutron","neveu","niche","nickel","nitrate","niveau","noble","nocif","nocturne","noirceur","noisette","nomade","nombreux","nommer","normatif","notable","notifier","notoire","nourrir","nouveau","novateur","novembre","novice","nuage","nuancer","nuire","nuisible","numéro","nuptial","nuque","nutritif","obéir","objectif","obliger","obscur","observer","obstacle","obtenir","obturer","occasion","occuper","océan","octobre","octroyer","octupler","oculaire","odeur","odorant","offenser","officier","offrir","ogive","oiseau","oisillon","olfactif","olivier","ombrage","omettre","onctueux","onduler","onéreux","onirique","opale","opaque","opérer","opinion","opportun","opprimer","opter","optique","orageux","orange","orbite","ordonner","oreille","organe","orgueil","orifice","ornement","orque","ortie","osciller","osmose","ossature","otarie","ouragan","ourson","outil","outrager","ouvrage","ovation","oxyde","oxygène","ozone","paisible","palace","palmarès","palourde","palper","panache","panda","pangolin","paniquer","panneau","panorama","pantalon","papaye","papier","papoter","papyrus","paradoxe","parcelle","paresse","parfumer","parler","parole","parrain","parsemer","partager","parure","parvenir","passion","pastèque","paternel","patience","patron","pavillon","pavoiser","payer","paysage","peigne","peintre","pelage","pélican","pelle","pelouse","peluche","pendule","pénétrer","pénible","pensif","pénurie","pépite","péplum","perdrix","perforer","période","permuter","perplexe","persil","perte","peser","pétale","petit","pétrir","peuple","pharaon","phobie","phoque","photon","phrase","physique","piano","pictural","pièce","pierre","pieuvre","pilote","pinceau","pipette","piquer","pirogue","piscine","piston","pivoter","pixel","pizza","placard","plafond","plaisir","planer","plaque","plastron","plateau","pleurer","plexus","pliage","plomb","plonger","pluie","plumage","pochette","poésie","poète","pointe","poirier","poisson","poivre","polaire","policier","pollen","polygone","pommade","pompier","ponctuel","pondérer","poney","portique","position","posséder","posture","potager","poteau","potion","pouce","poulain","poumon","pourpre","poussin","pouvoir","prairie","pratique","précieux","prédire","préfixe","prélude","prénom","présence","prétexte","prévoir","primitif","prince","prison","priver","problème","procéder","prodige","profond","progrès","proie","projeter","prologue","promener","propre","prospère","protéger","prouesse","proverbe","prudence","pruneau","psychose","public","puceron","puiser","pulpe","pulsar","punaise","punitif","pupitre","purifier","puzzle","pyramide","quasar","querelle","question","quiétude","quitter","quotient","racine","raconter","radieux","ragondin","raideur","raisin","ralentir","rallonge","ramasser","rapide","rasage","ratisser","ravager","ravin","rayonner","réactif","réagir","réaliser","réanimer","recevoir","réciter","réclamer","récolter","recruter","reculer","recycler","rédiger","redouter","refaire","réflexe","réformer","refrain","refuge","régalien","région","réglage","régulier","réitérer","rejeter","rejouer","relatif","relever","relief","remarque","remède","remise","remonter","remplir","remuer","renard","renfort","renifler","renoncer","rentrer","renvoi","replier","reporter","reprise","reptile","requin","réserve","résineux","résoudre","respect","rester","résultat","rétablir","retenir","réticule","retomber","retracer","réunion","réussir","revanche","revivre","révolte","révulsif","richesse","rideau","rieur","rigide","rigoler","rincer","riposter","risible","risque","rituel","rival","rivière","rocheux","romance","rompre","ronce","rondin","roseau","rosier","rotatif","rotor","rotule","rouge","rouille","rouleau","routine","royaume","ruban","rubis","ruche","ruelle","rugueux","ruiner","ruisseau","ruser","rustique","rythme","sabler","saboter","sabre","sacoche","safari","sagesse","saisir","salade","salive","salon","saluer","samedi","sanction","sanglier","sarcasme","sardine","saturer","saugrenu","saumon","sauter","sauvage","savant","savonner","scalpel","scandale","scélérat","scénario","sceptre","schéma","science","scinder","score","scrutin","sculpter","séance","sécable","sécher","secouer","sécréter","sédatif","séduire","seigneur","séjour","sélectif","semaine","sembler","semence","séminal","sénateur","sensible","sentence","séparer","séquence","serein","sergent","sérieux","serrure","sérum","service","sésame","sévir","sevrage","sextuple","sidéral","siècle","siéger","siffler","sigle","signal","silence","silicium","simple","sincère","sinistre","siphon","sirop","sismique","situer","skier","social","socle","sodium","soigneux","soldat","soleil","solitude","soluble","sombre","sommeil","somnoler","sonde","songeur","sonnette","sonore","sorcier","sortir","sosie","sottise","soucieux","soudure","souffle","soulever","soupape","source","soutirer","souvenir","spacieux","spatial","spécial","sphère","spiral","stable","station","sternum","stimulus","stipuler","strict","studieux","stupeur","styliste","sublime","substrat","subtil","subvenir","succès","sucre","suffixe","suggérer","suiveur","sulfate","superbe","supplier","surface","suricate","surmener","surprise","sursaut","survie","suspect","syllabe","symbole","symétrie","synapse","syntaxe","système","tabac","tablier","tactile","tailler","talent","talisman","talonner","tambour","tamiser","tangible","tapis","taquiner","tarder","tarif","tartine","tasse","tatami","tatouage","taupe","taureau","taxer","témoin","temporel","tenaille","tendre","teneur","tenir","tension","terminer","terne","terrible","tétine","texte","thème","théorie","thérapie","thorax","tibia","tiède","timide","tirelire","tiroir","tissu","titane","titre","tituber","toboggan","tolérant","tomate","tonique","tonneau","toponyme","torche","tordre","tornade","torpille","torrent","torse","tortue","totem","toucher","tournage","tousser","toxine","traction","trafic","tragique","trahir","train","trancher","travail","trèfle","tremper","trésor","treuil","triage","tribunal","tricoter","trilogie","triomphe","tripler","triturer","trivial","trombone","tronc","tropical","troupeau","tuile","tulipe","tumulte","tunnel","turbine","tuteur","tutoyer","tuyau","tympan","typhon","typique","tyran","ubuesque","ultime","ultrason","unanime","unifier","union","unique","unitaire","univers","uranium","urbain","urticant","usage","usine","usuel","usure","utile","utopie","vacarme","vaccin","vagabond","vague","vaillant","vaincre","vaisseau","valable","valise","vallon","valve","vampire","vanille","vapeur","varier","vaseux","vassal","vaste","vecteur","vedette","végétal","véhicule","veinard","véloce","vendredi","vénérer","venger","venimeux","ventouse","verdure","vérin","vernir","verrou","verser","vertu","veston","vétéran","vétuste","vexant","vexer","viaduc","viande","victoire","vidange","vidéo","vignette","vigueur","vilain","village","vinaigre","violon","vipère","virement","virtuose","virus","visage","viseur","vision","visqueux","visuel","vital","vitesse","viticole","vitrine","vivace","vivipare","vocation","voguer","voile","voisin","voiture","volaille","volcan","voltiger","volume","vorace","vortex","voter","vouloir","voyage","voyelle","wagon","xénon","yacht","zèbre","zénith","zeste","zoologie"]},function(t,e,i){"use strict";t.exports=["abaco","abbaglio","abbinato","abete","abisso","abolire","abrasivo","abrogato","accadere","accenno","accusato","acetone","achille","acido","acqua","acre","acrilico","acrobata","acuto","adagio","addebito","addome","adeguato","aderire","adipe","adottare","adulare","affabile","affetto","affisso","affranto","aforisma","afoso","africano","agave","agente","agevole","aggancio","agire","agitare","agonismo","agricolo","agrumeto","aguzzo","alabarda","alato","albatro","alberato","albo","albume","alce","alcolico","alettone","alfa","algebra","aliante","alibi","alimento","allagato","allegro","allievo","allodola","allusivo","almeno","alogeno","alpaca","alpestre","altalena","alterno","alticcio","altrove","alunno","alveolo","alzare","amalgama","amanita","amarena","ambito","ambrato","ameba","america","ametista","amico","ammasso","ammenda","ammirare","ammonito","amore","ampio","ampliare","amuleto","anacardo","anagrafe","analista","anarchia","anatra","anca","ancella","ancora","andare","andrea","anello","angelo","angolare","angusto","anima","annegare","annidato","anno","annuncio","anonimo","anticipo","anzi","apatico","apertura","apode","apparire","appetito","appoggio","approdo","appunto","aprile","arabica","arachide","aragosta","araldica","arancio","aratura","arazzo","arbitro","archivio","ardito","arenile","argento","argine","arguto","aria","armonia","arnese","arredato","arringa","arrosto","arsenico","arso","artefice","arzillo","asciutto","ascolto","asepsi","asettico","asfalto","asino","asola","aspirato","aspro","assaggio","asse","assoluto","assurdo","asta","astenuto","astice","astratto","atavico","ateismo","atomico","atono","attesa","attivare","attorno","attrito","attuale","ausilio","austria","autista","autonomo","autunno","avanzato","avere","avvenire","avviso","avvolgere","azione","azoto","azzimo","azzurro","babele","baccano","bacino","baco","badessa","badilata","bagnato","baita","balcone","baldo","balena","ballata","balzano","bambino","bandire","baraonda","barbaro","barca","baritono","barlume","barocco","basilico","basso","batosta","battuto","baule","bava","bavosa","becco","beffa","belgio","belva","benda","benevole","benigno","benzina","bere","berlina","beta","bibita","bici","bidone","bifido","biga","bilancia","bimbo","binocolo","biologo","bipede","bipolare","birbante","birra","biscotto","bisesto","bisnonno","bisonte","bisturi","bizzarro","blando","blatta","bollito","bonifico","bordo","bosco","botanico","bottino","bozzolo","braccio","bradipo","brama","branca","bravura","bretella","brevetto","brezza","briglia","brillante","brindare","broccolo","brodo","bronzina","brullo","bruno","bubbone","buca","budino","buffone","buio","bulbo","buono","burlone","burrasca","bussola","busta","cadetto","caduco","calamaro","calcolo","calesse","calibro","calmo","caloria","cambusa","camerata","camicia","cammino","camola","campale","canapa","candela","cane","canino","canotto","cantina","capace","capello","capitolo","capogiro","cappero","capra","capsula","carapace","carcassa","cardo","carisma","carovana","carretto","cartolina","casaccio","cascata","caserma","caso","cassone","castello","casuale","catasta","catena","catrame","cauto","cavillo","cedibile","cedrata","cefalo","celebre","cellulare","cena","cenone","centesimo","ceramica","cercare","certo","cerume","cervello","cesoia","cespo","ceto","chela","chiaro","chicca","chiedere","chimera","china","chirurgo","chitarra","ciao","ciclismo","cifrare","cigno","cilindro","ciottolo","circa","cirrosi","citrico","cittadino","ciuffo","civetta","civile","classico","clinica","cloro","cocco","codardo","codice","coerente","cognome","collare","colmato","colore","colposo","coltivato","colza","coma","cometa","commando","comodo","computer","comune","conciso","condurre","conferma","congelare","coniuge","connesso","conoscere","consumo","continuo","convegno","coperto","copione","coppia","copricapo","corazza","cordata","coricato","cornice","corolla","corpo","corredo","corsia","cortese","cosmico","costante","cottura","covato","cratere","cravatta","creato","credere","cremoso","crescita","creta","criceto","crinale","crisi","critico","croce","cronaca","crostata","cruciale","crusca","cucire","cuculo","cugino","cullato","cupola","curatore","cursore","curvo","cuscino","custode","dado","daino","dalmata","damerino","daniela","dannoso","danzare","datato","davanti","davvero","debutto","decennio","deciso","declino","decollo","decreto","dedicato","definito","deforme","degno","delegare","delfino","delirio","delta","demenza","denotato","dentro","deposito","derapata","derivare","deroga","descritto","deserto","desiderio","desumere","detersivo","devoto","diametro","dicembre","diedro","difeso","diffuso","digerire","digitale","diluvio","dinamico","dinnanzi","dipinto","diploma","dipolo","diradare","dire","dirotto","dirupo","disagio","discreto","disfare","disgelo","disposto","distanza","disumano","dito","divano","divelto","dividere","divorato","doblone","docente","doganale","dogma","dolce","domato","domenica","dominare","dondolo","dono","dormire","dote","dottore","dovuto","dozzina","drago","druido","dubbio","dubitare","ducale","duna","duomo","duplice","duraturo","ebano","eccesso","ecco","eclissi","economia","edera","edicola","edile","editoria","educare","egemonia","egli","egoismo","egregio","elaborato","elargire","elegante","elencato","eletto","elevare","elfico","elica","elmo","elsa","eluso","emanato","emblema","emesso","emiro","emotivo","emozione","empirico","emulo","endemico","enduro","energia","enfasi","enoteca","entrare","enzima","epatite","epilogo","episodio","epocale","eppure","equatore","erario","erba","erboso","erede","eremita","erigere","ermetico","eroe","erosivo","errante","esagono","esame","esanime","esaudire","esca","esempio","esercito","esibito","esigente","esistere","esito","esofago","esortato","esoso","espanso","espresso","essenza","esso","esteso","estimare","estonia","estroso","esultare","etilico","etnico","etrusco","etto","euclideo","europa","evaso","evidenza","evitato","evoluto","evviva","fabbrica","faccenda","fachiro","falco","famiglia","fanale","fanfara","fango","fantasma","fare","farfalla","farinoso","farmaco","fascia","fastoso","fasullo","faticare","fato","favoloso","febbre","fecola","fede","fegato","felpa","feltro","femmina","fendere","fenomeno","fermento","ferro","fertile","fessura","festivo","fetta","feudo","fiaba","fiducia","fifa","figurato","filo","finanza","finestra","finire","fiore","fiscale","fisico","fiume","flacone","flamenco","flebo","flemma","florido","fluente","fluoro","fobico","focaccia","focoso","foderato","foglio","folata","folclore","folgore","fondente","fonetico","fonia","fontana","forbito","forchetta","foresta","formica","fornaio","foro","fortezza","forzare","fosfato","fosso","fracasso","frana","frassino","fratello","freccetta","frenata","fresco","frigo","frollino","fronde","frugale","frutta","fucilata","fucsia","fuggente","fulmine","fulvo","fumante","fumetto","fumoso","fune","funzione","fuoco","furbo","furgone","furore","fuso","futile","gabbiano","gaffe","galateo","gallina","galoppo","gambero","gamma","garanzia","garbo","garofano","garzone","gasdotto","gasolio","gastrico","gatto","gaudio","gazebo","gazzella","geco","gelatina","gelso","gemello","gemmato","gene","genitore","gennaio","genotipo","gergo","ghepardo","ghiaccio","ghisa","giallo","gilda","ginepro","giocare","gioiello","giorno","giove","girato","girone","gittata","giudizio","giurato","giusto","globulo","glutine","gnomo","gobba","golf","gomito","gommone","gonfio","gonna","governo","gracile","grado","grafico","grammo","grande","grattare","gravoso","grazia","greca","gregge","grifone","grigio","grinza","grotta","gruppo","guadagno","guaio","guanto","guardare","gufo","guidare","ibernato","icona","identico","idillio","idolo","idra","idrico","idrogeno","igiene","ignaro","ignorato","ilare","illeso","illogico","illudere","imballo","imbevuto","imbocco","imbuto","immane","immerso","immolato","impacco","impeto","impiego","importo","impronta","inalare","inarcare","inattivo","incanto","incendio","inchino","incisivo","incluso","incontro","incrocio","incubo","indagine","india","indole","inedito","infatti","infilare","inflitto","ingaggio","ingegno","inglese","ingordo","ingrosso","innesco","inodore","inoltrare","inondato","insano","insetto","insieme","insonnia","insulina","intasato","intero","intonaco","intuito","inumidire","invalido","invece","invito","iperbole","ipnotico","ipotesi","ippica","iride","irlanda","ironico","irrigato","irrorare","isolato","isotopo","isterico","istituto","istrice","italia","iterare","labbro","labirinto","lacca","lacerato","lacrima","lacuna","laddove","lago","lampo","lancetta","lanterna","lardoso","larga","laringe","lastra","latenza","latino","lattuga","lavagna","lavoro","legale","leggero","lembo","lentezza","lenza","leone","lepre","lesivo","lessato","lesto","letterale","leva","levigato","libero","lido","lievito","lilla","limatura","limitare","limpido","lineare","lingua","liquido","lira","lirica","lisca","lite","litigio","livrea","locanda","lode","logica","lombare","londra","longevo","loquace","lorenzo","loto","lotteria","luce","lucidato","lumaca","luminoso","lungo","lupo","luppolo","lusinga","lusso","lutto","macabro","macchina","macero","macinato","madama","magico","maglia","magnete","magro","maiolica","malafede","malgrado","malinteso","malsano","malto","malumore","mana","mancia","mandorla","mangiare","manifesto","mannaro","manovra","mansarda","mantide","manubrio","mappa","maratona","marcire","maretta","marmo","marsupio","maschera","massaia","mastino","materasso","matricola","mattone","maturo","mazurca","meandro","meccanico","mecenate","medesimo","meditare","mega","melassa","melis","melodia","meninge","meno","mensola","mercurio","merenda","merlo","meschino","mese","messere","mestolo","metallo","metodo","mettere","miagolare","mica","micelio","michele","microbo","midollo","miele","migliore","milano","milite","mimosa","minerale","mini","minore","mirino","mirtillo","miscela","missiva","misto","misurare","mitezza","mitigare","mitra","mittente","mnemonico","modello","modifica","modulo","mogano","mogio","mole","molosso","monastero","monco","mondina","monetario","monile","monotono","monsone","montato","monviso","mora","mordere","morsicato","mostro","motivato","motosega","motto","movenza","movimento","mozzo","mucca","mucosa","muffa","mughetto","mugnaio","mulatto","mulinello","multiplo","mummia","munto","muovere","murale","musa","muscolo","musica","mutevole","muto","nababbo","nafta","nanometro","narciso","narice","narrato","nascere","nastrare","naturale","nautica","naviglio","nebulosa","necrosi","negativo","negozio","nemmeno","neofita","neretto","nervo","nessuno","nettuno","neutrale","neve","nevrotico","nicchia","ninfa","nitido","nobile","nocivo","nodo","nome","nomina","nordico","normale","norvegese","nostrano","notare","notizia","notturno","novella","nucleo","nulla","numero","nuovo","nutrire","nuvola","nuziale","oasi","obbedire","obbligo","obelisco","oblio","obolo","obsoleto","occasione","occhio","occidente","occorrere","occultare","ocra","oculato","odierno","odorare","offerta","offrire","offuscato","oggetto","oggi","ognuno","olandese","olfatto","oliato","oliva","ologramma","oltre","omaggio","ombelico","ombra","omega","omissione","ondoso","onere","onice","onnivoro","onorevole","onta","operato","opinione","opposto","oracolo","orafo","ordine","orecchino","orefice","orfano","organico","origine","orizzonte","orma","ormeggio","ornativo","orologio","orrendo","orribile","ortensia","ortica","orzata","orzo","osare","oscurare","osmosi","ospedale","ospite","ossa","ossidare","ostacolo","oste","otite","otre","ottagono","ottimo","ottobre","ovale","ovest","ovino","oviparo","ovocito","ovunque","ovviare","ozio","pacchetto","pace","pacifico","padella","padrone","paese","paga","pagina","palazzina","palesare","pallido","palo","palude","pandoro","pannello","paolo","paonazzo","paprica","parabola","parcella","parere","pargolo","pari","parlato","parola","partire","parvenza","parziale","passivo","pasticca","patacca","patologia","pattume","pavone","peccato","pedalare","pedonale","peggio","peloso","penare","pendice","penisola","pennuto","penombra","pensare","pentola","pepe","pepita","perbene","percorso","perdonato","perforare","pergamena","periodo","permesso","perno","perplesso","persuaso","pertugio","pervaso","pesatore","pesista","peso","pestifero","petalo","pettine","petulante","pezzo","piacere","pianta","piattino","piccino","picozza","piega","pietra","piffero","pigiama","pigolio","pigro","pila","pilifero","pillola","pilota","pimpante","pineta","pinna","pinolo","pioggia","piombo","piramide","piretico","pirite","pirolisi","pitone","pizzico","placebo","planare","plasma","platano","plenario","pochezza","poderoso","podismo","poesia","poggiare","polenta","poligono","pollice","polmonite","polpetta","polso","poltrona","polvere","pomice","pomodoro","ponte","popoloso","porfido","poroso","porpora","porre","portata","posa","positivo","possesso","postulato","potassio","potere","pranzo","prassi","pratica","precluso","predica","prefisso","pregiato","prelievo","premere","prenotare","preparato","presenza","pretesto","prevalso","prima","principe","privato","problema","procura","produrre","profumo","progetto","prolunga","promessa","pronome","proposta","proroga","proteso","prova","prudente","prugna","prurito","psiche","pubblico","pudica","pugilato","pugno","pulce","pulito","pulsante","puntare","pupazzo","pupilla","puro","quadro","qualcosa","quasi","querela","quota","raccolto","raddoppio","radicale","radunato","raffica","ragazzo","ragione","ragno","ramarro","ramingo","ramo","randagio","rantolare","rapato","rapina","rappreso","rasatura","raschiato","rasente","rassegna","rastrello","rata","ravveduto","reale","recepire","recinto","recluta","recondito","recupero","reddito","redimere","regalato","registro","regola","regresso","relazione","remare","remoto","renna","replica","reprimere","reputare","resa","residente","responso","restauro","rete","retina","retorica","rettifica","revocato","riassunto","ribadire","ribelle","ribrezzo","ricarica","ricco","ricevere","riciclato","ricordo","ricreduto","ridicolo","ridurre","rifasare","riflesso","riforma","rifugio","rigare","rigettato","righello","rilassato","rilevato","rimanere","rimbalzo","rimedio","rimorchio","rinascita","rincaro","rinforzo","rinnovo","rinomato","rinsavito","rintocco","rinuncia","rinvenire","riparato","ripetuto","ripieno","riportare","ripresa","ripulire","risata","rischio","riserva","risibile","riso","rispetto","ristoro","risultato","risvolto","ritardo","ritegno","ritmico","ritrovo","riunione","riva","riverso","rivincita","rivolto","rizoma","roba","robotico","robusto","roccia","roco","rodaggio","rodere","roditore","rogito","rollio","romantico","rompere","ronzio","rosolare","rospo","rotante","rotondo","rotula","rovescio","rubizzo","rubrica","ruga","rullino","rumine","rumoroso","ruolo","rupe","russare","rustico","sabato","sabbiare","sabotato","sagoma","salasso","saldatura","salgemma","salivare","salmone","salone","saltare","saluto","salvo","sapere","sapido","saporito","saraceno","sarcasmo","sarto","sassoso","satellite","satira","satollo","saturno","savana","savio","saziato","sbadiglio","sbalzo","sbancato","sbarra","sbattere","sbavare","sbendare","sbirciare","sbloccato","sbocciato","sbrinare","sbruffone","sbuffare","scabroso","scadenza","scala","scambiare","scandalo","scapola","scarso","scatenare","scavato","scelto","scenico","scettro","scheda","schiena","sciarpa","scienza","scindere","scippo","sciroppo","scivolo","sclerare","scodella","scolpito","scomparto","sconforto","scoprire","scorta","scossone","scozzese","scriba","scrollare","scrutinio","scuderia","scultore","scuola","scuro","scusare","sdebitare","sdoganare","seccatura","secondo","sedano","seggiola","segnalato","segregato","seguito","selciato","selettivo","sella","selvaggio","semaforo","sembrare","seme","seminato","sempre","senso","sentire","sepolto","sequenza","serata","serbato","sereno","serio","serpente","serraglio","servire","sestina","setola","settimana","sfacelo","sfaldare","sfamato","sfarzoso","sfaticato","sfera","sfida","sfilato","sfinge","sfocato","sfoderare","sfogo","sfoltire","sforzato","sfratto","sfruttato","sfuggito","sfumare","sfuso","sgabello","sgarbato","sgonfiare","sgorbio","sgrassato","sguardo","sibilo","siccome","sierra","sigla","signore","silenzio","sillaba","simbolo","simpatico","simulato","sinfonia","singolo","sinistro","sino","sintesi","sinusoide","sipario","sisma","sistole","situato","slitta","slogatura","sloveno","smarrito","smemorato","smentito","smeraldo","smilzo","smontare","smottato","smussato","snellire","snervato","snodo","sobbalzo","sobrio","soccorso","sociale","sodale","soffitto","sogno","soldato","solenne","solido","sollazzo","solo","solubile","solvente","somatico","somma","sonda","sonetto","sonnifero","sopire","soppeso","sopra","sorgere","sorpasso","sorriso","sorso","sorteggio","sorvolato","sospiro","sosta","sottile","spada","spalla","spargere","spatola","spavento","spazzola","specie","spedire","spegnere","spelatura","speranza","spessore","spettrale","spezzato","spia","spigoloso","spillato","spinoso","spirale","splendido","sportivo","sposo","spranga","sprecare","spronato","spruzzo","spuntino","squillo","sradicare","srotolato","stabile","stacco","staffa","stagnare","stampato","stantio","starnuto","stasera","statuto","stelo","steppa","sterzo","stiletto","stima","stirpe","stivale","stizzoso","stonato","storico","strappo","stregato","stridulo","strozzare","strutto","stuccare","stufo","stupendo","subentro","succoso","sudore","suggerito","sugo","sultano","suonare","superbo","supporto","surgelato","surrogato","sussurro","sutura","svagare","svedese","sveglio","svelare","svenuto","svezia","sviluppo","svista","svizzera","svolta","svuotare","tabacco","tabulato","tacciare","taciturno","tale","talismano","tampone","tannino","tara","tardivo","targato","tariffa","tarpare","tartaruga","tasto","tattico","taverna","tavolata","tazza","teca","tecnico","telefono","temerario","tempo","temuto","tendone","tenero","tensione","tentacolo","teorema","terme","terrazzo","terzetto","tesi","tesserato","testato","tetro","tettoia","tifare","tigella","timbro","tinto","tipico","tipografo","tiraggio","tiro","titanio","titolo","titubante","tizio","tizzone","toccare","tollerare","tolto","tombola","tomo","tonfo","tonsilla","topazio","topologia","toppa","torba","tornare","torrone","tortora","toscano","tossire","tostatura","totano","trabocco","trachea","trafila","tragedia","tralcio","tramonto","transito","trapano","trarre","trasloco","trattato","trave","treccia","tremolio","trespolo","tributo","tricheco","trifoglio","trillo","trincea","trio","tristezza","triturato","trivella","tromba","trono","troppo","trottola","trovare","truccato","tubatura","tuffato","tulipano","tumulto","tunisia","turbare","turchino","tuta","tutela","ubicato","uccello","uccisore","udire","uditivo","uffa","ufficio","uguale","ulisse","ultimato","umano","umile","umorismo","uncinetto","ungere","ungherese","unicorno","unificato","unisono","unitario","unte","uovo","upupa","uragano","urgenza","urlo","usanza","usato","uscito","usignolo","usuraio","utensile","utilizzo","utopia","vacante","vaccinato","vagabondo","vagliato","valanga","valgo","valico","valletta","valoroso","valutare","valvola","vampata","vangare","vanitoso","vano","vantaggio","vanvera","vapore","varano","varcato","variante","vasca","vedetta","vedova","veduto","vegetale","veicolo","velcro","velina","velluto","veloce","venato","vendemmia","vento","verace","verbale","vergogna","verifica","vero","verruca","verticale","vescica","vessillo","vestale","veterano","vetrina","vetusto","viandante","vibrante","vicenda","vichingo","vicinanza","vidimare","vigilia","vigneto","vigore","vile","villano","vimini","vincitore","viola","vipera","virgola","virologo","virulento","viscoso","visione","vispo","vissuto","visura","vita","vitello","vittima","vivanda","vivido","viziare","voce","voga","volatile","volere","volpe","voragine","vulcano","zampogna","zanna","zappato","zattera","zavorra","zefiro","zelante","zelo","zenzero","zerbino","zibetto","zinco","zircone","zitto","zolla","zotico","zucchero","zufolo","zulu","zuppa"]},function(t,e,i){"use strict";t.exports=["あいこくしん","あいさつ","あいだ","あおぞら","あかちゃん","あきる","あけがた","あける","あこがれる","あさい","あさひ","あしあと","あじわう","あずかる","あずき","あそぶ","あたえる","あたためる","あたりまえ","あたる","あつい","あつかう","あっしゅく","あつまり","あつめる","あてな","あてはまる","あひる","あぶら","あぶる","あふれる","あまい","あまど","あまやかす","あまり","あみもの","あめりか","あやまる","あゆむ","あらいぐま","あらし","あらすじ","あらためる","あらゆる","あらわす","ありがとう","あわせる","あわてる","あんい","あんがい","あんこ","あんぜん","あんてい","あんない","あんまり","いいだす","いおん","いがい","いがく","いきおい","いきなり","いきもの","いきる","いくじ","いくぶん","いけばな","いけん","いこう","いこく","いこつ","いさましい","いさん","いしき","いじゅう","いじょう","いじわる","いずみ","いずれ","いせい","いせえび","いせかい","いせき","いぜん","いそうろう","いそがしい","いだい","いだく","いたずら","いたみ","いたりあ","いちおう","いちじ","いちど","いちば","いちぶ","いちりゅう","いつか","いっしゅん","いっせい","いっそう","いったん","いっち","いってい","いっぽう","いてざ","いてん","いどう","いとこ","いない","いなか","いねむり","いのち","いのる","いはつ","いばる","いはん","いびき","いひん","いふく","いへん","いほう","いみん","いもうと","いもたれ","いもり","いやがる","いやす","いよかん","いよく","いらい","いらすと","いりぐち","いりょう","いれい","いれもの","いれる","いろえんぴつ","いわい","いわう","いわかん","いわば","いわゆる","いんげんまめ","いんさつ","いんしょう","いんよう","うえき","うえる","うおざ","うがい","うかぶ","うかべる","うきわ","うくらいな","うくれれ","うけたまわる","うけつけ","うけとる","うけもつ","うける","うごかす","うごく","うこん","うさぎ","うしなう","うしろがみ","うすい","うすぎ","うすぐらい","うすめる","うせつ","うちあわせ","うちがわ","うちき","うちゅう","うっかり","うつくしい","うったえる","うつる","うどん","うなぎ","うなじ","うなずく","うなる","うねる","うのう","うぶげ","うぶごえ","うまれる","うめる","うもう","うやまう","うよく","うらがえす","うらぐち","うらない","うりあげ","うりきれ","うるさい","うれしい","うれゆき","うれる","うろこ","うわき","うわさ","うんこう","うんちん","うんてん","うんどう","えいえん","えいが","えいきょう","えいご","えいせい","えいぶん","えいよう","えいわ","えおり","えがお","えがく","えきたい","えくせる","えしゃく","えすて","えつらん","えのぐ","えほうまき","えほん","えまき","えもじ","えもの","えらい","えらぶ","えりあ","えんえん","えんかい","えんぎ","えんげき","えんしゅう","えんぜつ","えんそく","えんちょう","えんとつ","おいかける","おいこす","おいしい","おいつく","おうえん","おうさま","おうじ","おうせつ","おうたい","おうふく","おうべい","おうよう","おえる","おおい","おおう","おおどおり","おおや","おおよそ","おかえり","おかず","おがむ","おかわり","おぎなう","おきる","おくさま","おくじょう","おくりがな","おくる","おくれる","おこす","おこなう","おこる","おさえる","おさない","おさめる","おしいれ","おしえる","おじぎ","おじさん","おしゃれ","おそらく","おそわる","おたがい","おたく","おだやか","おちつく","おっと","おつり","おでかけ","おとしもの","おとなしい","おどり","おどろかす","おばさん","おまいり","おめでとう","おもいで","おもう","おもたい","おもちゃ","おやつ","おやゆび","およぼす","おらんだ","おろす","おんがく","おんけい","おんしゃ","おんせん","おんだん","おんちゅう","おんどけい","かあつ","かいが","がいき","がいけん","がいこう","かいさつ","かいしゃ","かいすいよく","かいぜん","かいぞうど","かいつう","かいてん","かいとう","かいふく","がいへき","かいほう","かいよう","がいらい","かいわ","かえる","かおり","かかえる","かがく","かがし","かがみ","かくご","かくとく","かざる","がぞう","かたい","かたち","がちょう","がっきゅう","がっこう","がっさん","がっしょう","かなざわし","かのう","がはく","かぶか","かほう","かほご","かまう","かまぼこ","かめれおん","かゆい","かようび","からい","かるい","かろう","かわく","かわら","がんか","かんけい","かんこう","かんしゃ","かんそう","かんたん","かんち","がんばる","きあい","きあつ","きいろ","ぎいん","きうい","きうん","きえる","きおう","きおく","きおち","きおん","きかい","きかく","きかんしゃ","ききて","きくばり","きくらげ","きけんせい","きこう","きこえる","きこく","きさい","きさく","きさま","きさらぎ","ぎじかがく","ぎしき","ぎじたいけん","ぎじにってい","ぎじゅつしゃ","きすう","きせい","きせき","きせつ","きそう","きぞく","きぞん","きたえる","きちょう","きつえん","ぎっちり","きつつき","きつね","きてい","きどう","きどく","きない","きなが","きなこ","きぬごし","きねん","きのう","きのした","きはく","きびしい","きひん","きふく","きぶん","きぼう","きほん","きまる","きみつ","きむずかしい","きめる","きもだめし","きもち","きもの","きゃく","きやく","ぎゅうにく","きよう","きょうりゅう","きらい","きらく","きりん","きれい","きれつ","きろく","ぎろん","きわめる","ぎんいろ","きんかくじ","きんじょ","きんようび","ぐあい","くいず","くうかん","くうき","くうぐん","くうこう","ぐうせい","くうそう","ぐうたら","くうふく","くうぼ","くかん","くきょう","くげん","ぐこう","くさい","くさき","くさばな","くさる","くしゃみ","くしょう","くすのき","くすりゆび","くせげ","くせん","ぐたいてき","くださる","くたびれる","くちこみ","くちさき","くつした","ぐっすり","くつろぐ","くとうてん","くどく","くなん","くねくね","くのう","くふう","くみあわせ","くみたてる","くめる","くやくしょ","くらす","くらべる","くるま","くれる","くろう","くわしい","ぐんかん","ぐんしょく","ぐんたい","ぐんて","けあな","けいかく","けいけん","けいこ","けいさつ","げいじゅつ","けいたい","げいのうじん","けいれき","けいろ","けおとす","けおりもの","げきか","げきげん","げきだん","げきちん","げきとつ","げきは","げきやく","げこう","げこくじょう","げざい","けさき","げざん","けしき","けしごむ","けしょう","げすと","けたば","けちゃっぷ","けちらす","けつあつ","けつい","けつえき","けっこん","けつじょ","けっせき","けってい","けつまつ","げつようび","げつれい","けつろん","げどく","けとばす","けとる","けなげ","けなす","けなみ","けぬき","げねつ","けねん","けはい","げひん","けぶかい","げぼく","けまり","けみかる","けむし","けむり","けもの","けらい","けろけろ","けわしい","けんい","けんえつ","けんお","けんか","げんき","けんげん","けんこう","けんさく","けんしゅう","けんすう","げんそう","けんちく","けんてい","けんとう","けんない","けんにん","げんぶつ","けんま","けんみん","けんめい","けんらん","けんり","こあくま","こいぬ","こいびと","ごうい","こうえん","こうおん","こうかん","ごうきゅう","ごうけい","こうこう","こうさい","こうじ","こうすい","ごうせい","こうそく","こうたい","こうちゃ","こうつう","こうてい","こうどう","こうない","こうはい","ごうほう","ごうまん","こうもく","こうりつ","こえる","こおり","ごかい","ごがつ","ごかん","こくご","こくさい","こくとう","こくない","こくはく","こぐま","こけい","こける","ここのか","こころ","こさめ","こしつ","こすう","こせい","こせき","こぜん","こそだて","こたい","こたえる","こたつ","こちょう","こっか","こつこつ","こつばん","こつぶ","こてい","こてん","ことがら","ことし","ことば","ことり","こなごな","こねこね","このまま","このみ","このよ","ごはん","こひつじ","こふう","こふん","こぼれる","ごまあぶら","こまかい","ごますり","こまつな","こまる","こむぎこ","こもじ","こもち","こもの","こもん","こやく","こやま","こゆう","こゆび","こよい","こよう","こりる","これくしょん","ころっけ","こわもて","こわれる","こんいん","こんかい","こんき","こんしゅう","こんすい","こんだて","こんとん","こんなん","こんびに","こんぽん","こんまけ","こんや","こんれい","こんわく","ざいえき","さいかい","さいきん","ざいげん","ざいこ","さいしょ","さいせい","ざいたく","ざいちゅう","さいてき","ざいりょう","さうな","さかいし","さがす","さかな","さかみち","さがる","さぎょう","さくし","さくひん","さくら","さこく","さこつ","さずかる","ざせき","さたん","さつえい","ざつおん","ざっか","ざつがく","さっきょく","ざっし","さつじん","ざっそう","さつたば","さつまいも","さてい","さといも","さとう","さとおや","さとし","さとる","さのう","さばく","さびしい","さべつ","さほう","さほど","さます","さみしい","さみだれ","さむけ","さめる","さやえんどう","さゆう","さよう","さよく","さらだ","ざるそば","さわやか","さわる","さんいん","さんか","さんきゃく","さんこう","さんさい","ざんしょ","さんすう","さんせい","さんそ","さんち","さんま","さんみ","さんらん","しあい","しあげ","しあさって","しあわせ","しいく","しいん","しうち","しえい","しおけ","しかい","しかく","じかん","しごと","しすう","じだい","したうけ","したぎ","したて","したみ","しちょう","しちりん","しっかり","しつじ","しつもん","してい","してき","してつ","じてん","じどう","しなぎれ","しなもの","しなん","しねま","しねん","しのぐ","しのぶ","しはい","しばかり","しはつ","しはらい","しはん","しひょう","しふく","じぶん","しへい","しほう","しほん","しまう","しまる","しみん","しむける","じむしょ","しめい","しめる","しもん","しゃいん","しゃうん","しゃおん","じゃがいも","しやくしょ","しゃくほう","しゃけん","しゃこ","しゃざい","しゃしん","しゃせん","しゃそう","しゃたい","しゃちょう","しゃっきん","じゃま","しゃりん","しゃれい","じゆう","じゅうしょ","しゅくはく","じゅしん","しゅっせき","しゅみ","しゅらば","じゅんばん","しょうかい","しょくたく","しょっけん","しょどう","しょもつ","しらせる","しらべる","しんか","しんこう","じんじゃ","しんせいじ","しんちく","しんりん","すあげ","すあし","すあな","ずあん","すいえい","すいか","すいとう","ずいぶん","すいようび","すうがく","すうじつ","すうせん","すおどり","すきま","すくう","すくない","すける","すごい","すこし","ずさん","すずしい","すすむ","すすめる","すっかり","ずっしり","ずっと","すてき","すてる","すねる","すのこ","すはだ","すばらしい","ずひょう","ずぶぬれ","すぶり","すふれ","すべて","すべる","ずほう","すぼん","すまい","すめし","すもう","すやき","すらすら","するめ","すれちがう","すろっと","すわる","すんぜん","すんぽう","せあぶら","せいかつ","せいげん","せいじ","せいよう","せおう","せかいかん","せきにん","せきむ","せきゆ","せきらんうん","せけん","せこう","せすじ","せたい","せたけ","せっかく","せっきゃく","ぜっく","せっけん","せっこつ","せっさたくま","せつぞく","せつだん","せつでん","せっぱん","せつび","せつぶん","せつめい","せつりつ","せなか","せのび","せはば","せびろ","せぼね","せまい","せまる","せめる","せもたれ","せりふ","ぜんあく","せんい","せんえい","せんか","せんきょ","せんく","せんげん","ぜんご","せんさい","せんしゅ","せんすい","せんせい","せんぞ","せんたく","せんちょう","せんてい","せんとう","せんぬき","せんねん","せんぱい","ぜんぶ","ぜんぽう","せんむ","せんめんじょ","せんもん","せんやく","せんゆう","せんよう","ぜんら","ぜんりゃく","せんれい","せんろ","そあく","そいとげる","そいね","そうがんきょう","そうき","そうご","そうしん","そうだん","そうなん","そうび","そうめん","そうり","そえもの","そえん","そがい","そげき","そこう","そこそこ","そざい","そしな","そせい","そせん","そそぐ","そだてる","そつう","そつえん","そっかん","そつぎょう","そっけつ","そっこう","そっせん","そっと","そとがわ","そとづら","そなえる","そなた","そふぼ","そぼく","そぼろ","そまつ","そまる","そむく","そむりえ","そめる","そもそも","そよかぜ","そらまめ","そろう","そんかい","そんけい","そんざい","そんしつ","そんぞく","そんちょう","ぞんび","ぞんぶん","そんみん","たあい","たいいん","たいうん","たいえき","たいおう","だいがく","たいき","たいぐう","たいけん","たいこ","たいざい","だいじょうぶ","だいすき","たいせつ","たいそう","だいたい","たいちょう","たいてい","だいどころ","たいない","たいねつ","たいのう","たいはん","だいひょう","たいふう","たいへん","たいほ","たいまつばな","たいみんぐ","たいむ","たいめん","たいやき","たいよう","たいら","たいりょく","たいる","たいわん","たうえ","たえる","たおす","たおる","たおれる","たかい","たかね","たきび","たくさん","たこく","たこやき","たさい","たしざん","だじゃれ","たすける","たずさわる","たそがれ","たたかう","たたく","ただしい","たたみ","たちばな","だっかい","だっきゃく","だっこ","だっしゅつ","だったい","たてる","たとえる","たなばた","たにん","たぬき","たのしみ","たはつ","たぶん","たべる","たぼう","たまご","たまる","だむる","ためいき","ためす","ためる","たもつ","たやすい","たよる","たらす","たりきほんがん","たりょう","たりる","たると","たれる","たれんと","たろっと","たわむれる","だんあつ","たんい","たんおん","たんか","たんき","たんけん","たんご","たんさん","たんじょうび","だんせい","たんそく","たんたい","だんち","たんてい","たんとう","だんな","たんにん","だんねつ","たんのう","たんぴん","だんぼう","たんまつ","たんめい","だんれつ","だんろ","だんわ","ちあい","ちあん","ちいき","ちいさい","ちえん","ちかい","ちから","ちきゅう","ちきん","ちけいず","ちけん","ちこく","ちさい","ちしき","ちしりょう","ちせい","ちそう","ちたい","ちたん","ちちおや","ちつじょ","ちてき","ちてん","ちぬき","ちぬり","ちのう","ちひょう","ちへいせん","ちほう","ちまた","ちみつ","ちみどろ","ちめいど","ちゃんこなべ","ちゅうい","ちゆりょく","ちょうし","ちょさくけん","ちらし","ちらみ","ちりがみ","ちりょう","ちるど","ちわわ","ちんたい","ちんもく","ついか","ついたち","つうか","つうじょう","つうはん","つうわ","つかう","つかれる","つくね","つくる","つけね","つける","つごう","つたえる","つづく","つつじ","つつむ","つとめる","つながる","つなみ","つねづね","つのる","つぶす","つまらない","つまる","つみき","つめたい","つもり","つもる","つよい","つるぼ","つるみく","つわもの","つわり","てあし","てあて","てあみ","ていおん","ていか","ていき","ていけい","ていこく","ていさつ","ていし","ていせい","ていたい","ていど","ていねい","ていひょう","ていへん","ていぼう","てうち","ておくれ","てきとう","てくび","でこぼこ","てさぎょう","てさげ","てすり","てそう","てちがい","てちょう","てつがく","てつづき","でっぱ","てつぼう","てつや","でぬかえ","てぬき","てぬぐい","てのひら","てはい","てぶくろ","てふだ","てほどき","てほん","てまえ","てまきずし","てみじか","てみやげ","てらす","てれび","てわけ","てわたし","でんあつ","てんいん","てんかい","てんき","てんぐ","てんけん","てんごく","てんさい","てんし","てんすう","でんち","てんてき","てんとう","てんない","てんぷら","てんぼうだい","てんめつ","てんらんかい","でんりょく","でんわ","どあい","といれ","どうかん","とうきゅう","どうぐ","とうし","とうむぎ","とおい","とおか","とおく","とおす","とおる","とかい","とかす","ときおり","ときどき","とくい","とくしゅう","とくてん","とくに","とくべつ","とけい","とける","とこや","とさか","としょかん","とそう","とたん","とちゅう","とっきゅう","とっくん","とつぜん","とつにゅう","とどける","ととのえる","とない","となえる","となり","とのさま","とばす","どぶがわ","とほう","とまる","とめる","ともだち","ともる","どようび","とらえる","とんかつ","どんぶり","ないかく","ないこう","ないしょ","ないす","ないせん","ないそう","なおす","ながい","なくす","なげる","なこうど","なさけ","なたでここ","なっとう","なつやすみ","ななおし","なにごと","なにもの","なにわ","なのか","なふだ","なまいき","なまえ","なまみ","なみだ","なめらか","なめる","なやむ","ならう","ならび","ならぶ","なれる","なわとび","なわばり","にあう","にいがた","にうけ","におい","にかい","にがて","にきび","にくしみ","にくまん","にげる","にさんかたんそ","にしき","にせもの","にちじょう","にちようび","にっか","にっき","にっけい","にっこう","にっさん","にっしょく","にっすう","にっせき","にってい","になう","にほん","にまめ","にもつ","にやり","にゅういん","にりんしゃ","にわとり","にんい","にんか","にんき","にんげん","にんしき","にんずう","にんそう","にんたい","にんち","にんてい","にんにく","にんぷ","にんまり","にんむ","にんめい","にんよう","ぬいくぎ","ぬかす","ぬぐいとる","ぬぐう","ぬくもり","ぬすむ","ぬまえび","ぬめり","ぬらす","ぬんちゃく","ねあげ","ねいき","ねいる","ねいろ","ねぐせ","ねくたい","ねくら","ねこぜ","ねこむ","ねさげ","ねすごす","ねそべる","ねだん","ねつい","ねっしん","ねつぞう","ねったいぎょ","ねぶそく","ねふだ","ねぼう","ねほりはほり","ねまき","ねまわし","ねみみ","ねむい","ねむたい","ねもと","ねらう","ねわざ","ねんいり","ねんおし","ねんかん","ねんきん","ねんぐ","ねんざ","ねんし","ねんちゃく","ねんど","ねんぴ","ねんぶつ","ねんまつ","ねんりょう","ねんれい","のいず","のおづま","のがす","のきなみ","のこぎり","のこす","のこる","のせる","のぞく","のぞむ","のたまう","のちほど","のっく","のばす","のはら","のべる","のぼる","のみもの","のやま","のらいぬ","のらねこ","のりもの","のりゆき","のれん","のんき","ばあい","はあく","ばあさん","ばいか","ばいく","はいけん","はいご","はいしん","はいすい","はいせん","はいそう","はいち","ばいばい","はいれつ","はえる","はおる","はかい","ばかり","はかる","はくしゅ","はけん","はこぶ","はさみ","はさん","はしご","ばしょ","はしる","はせる","ぱそこん","はそん","はたん","はちみつ","はつおん","はっかく","はづき","はっきり","はっくつ","はっけん","はっこう","はっさん","はっしん","はったつ","はっちゅう","はってん","はっぴょう","はっぽう","はなす","はなび","はにかむ","はぶらし","はみがき","はむかう","はめつ","はやい","はやし","はらう","はろうぃん","はわい","はんい","はんえい","はんおん","はんかく","はんきょう","ばんぐみ","はんこ","はんしゃ","はんすう","はんだん","ぱんち","ぱんつ","はんてい","はんとし","はんのう","はんぱ","はんぶん","はんぺん","はんぼうき","はんめい","はんらん","はんろん","ひいき","ひうん","ひえる","ひかく","ひかり","ひかる","ひかん","ひくい","ひけつ","ひこうき","ひこく","ひさい","ひさしぶり","ひさん","びじゅつかん","ひしょ","ひそか","ひそむ","ひたむき","ひだり","ひたる","ひつぎ","ひっこし","ひっし","ひつじゅひん","ひっす","ひつぜん","ぴったり","ぴっちり","ひつよう","ひてい","ひとごみ","ひなまつり","ひなん","ひねる","ひはん","ひびく","ひひょう","ひほう","ひまわり","ひまん","ひみつ","ひめい","ひめじし","ひやけ","ひやす","ひよう","びょうき","ひらがな","ひらく","ひりつ","ひりょう","ひるま","ひるやすみ","ひれい","ひろい","ひろう","ひろき","ひろゆき","ひんかく","ひんけつ","ひんこん","ひんしゅ","ひんそう","ぴんち","ひんぱん","びんぼう","ふあん","ふいうち","ふうけい","ふうせん","ぷうたろう","ふうとう","ふうふ","ふえる","ふおん","ふかい","ふきん","ふくざつ","ふくぶくろ","ふこう","ふさい","ふしぎ","ふじみ","ふすま","ふせい","ふせぐ","ふそく","ぶたにく","ふたん","ふちょう","ふつう","ふつか","ふっかつ","ふっき","ふっこく","ぶどう","ふとる","ふとん","ふのう","ふはい","ふひょう","ふへん","ふまん","ふみん","ふめつ","ふめん","ふよう","ふりこ","ふりる","ふるい","ふんいき","ぶんがく","ぶんぐ","ふんしつ","ぶんせき","ふんそう","ぶんぽう","へいあん","へいおん","へいがい","へいき","へいげん","へいこう","へいさ","へいしゃ","へいせつ","へいそ","へいたく","へいてん","へいねつ","へいわ","へきが","へこむ","べにいろ","べにしょうが","へらす","へんかん","べんきょう","べんごし","へんさい","へんたい","べんり","ほあん","ほいく","ぼうぎょ","ほうこく","ほうそう","ほうほう","ほうもん","ほうりつ","ほえる","ほおん","ほかん","ほきょう","ぼきん","ほくろ","ほけつ","ほけん","ほこう","ほこる","ほしい","ほしつ","ほしゅ","ほしょう","ほせい","ほそい","ほそく","ほたて","ほたる","ぽちぶくろ","ほっきょく","ほっさ","ほったん","ほとんど","ほめる","ほんい","ほんき","ほんけ","ほんしつ","ほんやく","まいにち","まかい","まかせる","まがる","まける","まこと","まさつ","まじめ","ますく","まぜる","まつり","まとめ","まなぶ","まぬけ","まねく","まほう","まもる","まゆげ","まよう","まろやか","まわす","まわり","まわる","まんが","まんきつ","まんぞく","まんなか","みいら","みうち","みえる","みがく","みかた","みかん","みけん","みこん","みじかい","みすい","みすえる","みせる","みっか","みつかる","みつける","みてい","みとめる","みなと","みなみかさい","みねらる","みのう","みのがす","みほん","みもと","みやげ","みらい","みりょく","みわく","みんか","みんぞく","むいか","むえき","むえん","むかい","むかう","むかえ","むかし","むぎちゃ","むける","むげん","むさぼる","むしあつい","むしば","むじゅん","むしろ","むすう","むすこ","むすぶ","むすめ","むせる","むせん","むちゅう","むなしい","むのう","むやみ","むよう","むらさき","むりょう","むろん","めいあん","めいうん","めいえん","めいかく","めいきょく","めいさい","めいし","めいそう","めいぶつ","めいれい","めいわく","めぐまれる","めざす","めした","めずらしい","めだつ","めまい","めやす","めんきょ","めんせき","めんどう","もうしあげる","もうどうけん","もえる","もくし","もくてき","もくようび","もちろん","もどる","もらう","もんく","もんだい","やおや","やける","やさい","やさしい","やすい","やすたろう","やすみ","やせる","やそう","やたい","やちん","やっと","やっぱり","やぶる","やめる","ややこしい","やよい","やわらかい","ゆうき","ゆうびんきょく","ゆうべ","ゆうめい","ゆけつ","ゆしゅつ","ゆせん","ゆそう","ゆたか","ゆちゃく","ゆでる","ゆにゅう","ゆびわ","ゆらい","ゆれる","ようい","ようか","ようきゅう","ようじ","ようす","ようちえん","よかぜ","よかん","よきん","よくせい","よくぼう","よけい","よごれる","よさん","よしゅう","よそう","よそく","よっか","よてい","よどがわく","よねつ","よやく","よゆう","よろこぶ","よろしい","らいう","らくがき","らくご","らくさつ","らくだ","らしんばん","らせん","らぞく","らたい","らっか","られつ","りえき","りかい","りきさく","りきせつ","りくぐん","りくつ","りけん","りこう","りせい","りそう","りそく","りてん","りねん","りゆう","りゅうがく","りよう","りょうり","りょかん","りょくちゃ","りょこう","りりく","りれき","りろん","りんご","るいけい","るいさい","るいじ","るいせき","るすばん","るりがわら","れいかん","れいぎ","れいせい","れいぞうこ","れいとう","れいぼう","れきし","れきだい","れんあい","れんけい","れんこん","れんさい","れんしゅう","れんぞく","れんらく","ろうか","ろうご","ろうじん","ろうそく","ろくが","ろこつ","ろじうら","ろしゅつ","ろせん","ろてん","ろめん","ろれつ","ろんぎ","ろんぱ","ろんぶん","ろんり","わかす","わかめ","わかやま","わかれる","わしつ","わじまし","わすれもの","わらう","われる"]},function(t,e,i){"use strict";t.exports=["ábaco","abdomen","abeja","abierto","abogado","abono","aborto","abrazo","abrir","abuelo","abuso","acabar","academia","acceso","acción","aceite","acelga","acento","aceptar","ácido","aclarar","acné","acoger","acoso","activo","acto","actriz","actuar","acudir","acuerdo","acusar","adicto","admitir","adoptar","adorno","aduana","adulto","aéreo","afectar","afición","afinar","afirmar","ágil","agitar","agonía","agosto","agotar","agregar","agrio","agua","agudo","águila","aguja","ahogo","ahorro","aire","aislar","ajedrez","ajeno","ajuste","alacrán","alambre","alarma","alba","álbum","alcalde","aldea","alegre","alejar","alerta","aleta","alfiler","alga","algodón","aliado","aliento","alivio","alma","almeja","almíbar","altar","alteza","altivo","alto","altura","alumno","alzar","amable","amante","amapola","amargo","amasar","ámbar","ámbito","ameno","amigo","amistad","amor","amparo","amplio","ancho","anciano","ancla","andar","andén","anemia","ángulo","anillo","ánimo","anís","anotar","antena","antiguo","antojo","anual","anular","anuncio","añadir","añejo","año","apagar","aparato","apetito","apio","aplicar","apodo","aporte","apoyo","aprender","aprobar","apuesta","apuro","arado","araña","arar","árbitro","árbol","arbusto","archivo","arco","arder","ardilla","arduo","área","árido","aries","armonía","arnés","aroma","arpa","arpón","arreglo","arroz","arruga","arte","artista","asa","asado","asalto","ascenso","asegurar","aseo","asesor","asiento","asilo","asistir","asno","asombro","áspero","astilla","astro","astuto","asumir","asunto","atajo","ataque","atar","atento","ateo","ático","atleta","átomo","atraer","atroz","atún","audaz","audio","auge","aula","aumento","ausente","autor","aval","avance","avaro","ave","avellana","avena","avestruz","avión","aviso","ayer","ayuda","ayuno","azafrán","azar","azote","azúcar","azufre","azul","baba","babor","bache","bahía","baile","bajar","balanza","balcón","balde","bambú","banco","banda","baño","barba","barco","barniz","barro","báscula","bastón","basura","batalla","batería","batir","batuta","baúl","bazar","bebé","bebida","bello","besar","beso","bestia","bicho","bien","bingo","blanco","bloque","blusa","boa","bobina","bobo","boca","bocina","boda","bodega","boina","bola","bolero","bolsa","bomba","bondad","bonito","bono","bonsái","borde","borrar","bosque","bote","botín","bóveda","bozal","bravo","brazo","brecha","breve","brillo","brinco","brisa","broca","broma","bronce","brote","bruja","brusco","bruto","buceo","bucle","bueno","buey","bufanda","bufón","búho","buitre","bulto","burbuja","burla","burro","buscar","butaca","buzón","caballo","cabeza","cabina","cabra","cacao","cadáver","cadena","caer","café","caída","caimán","caja","cajón","cal","calamar","calcio","caldo","calidad","calle","calma","calor","calvo","cama","cambio","camello","camino","campo","cáncer","candil","canela","canguro","canica","canto","caña","cañón","caoba","caos","capaz","capitán","capote","captar","capucha","cara","carbón","cárcel","careta","carga","cariño","carne","carpeta","carro","carta","casa","casco","casero","caspa","castor","catorce","catre","caudal","causa","cazo","cebolla","ceder","cedro","celda","célebre","celoso","célula","cemento","ceniza","centro","cerca","cerdo","cereza","cero","cerrar","certeza","césped","cetro","chacal","chaleco","champú","chancla","chapa","charla","chico","chiste","chivo","choque","choza","chuleta","chupar","ciclón","ciego","cielo","cien","cierto","cifra","cigarro","cima","cinco","cine","cinta","ciprés","circo","ciruela","cisne","cita","ciudad","clamor","clan","claro","clase","clave","cliente","clima","clínica","cobre","cocción","cochino","cocina","coco","código","codo","cofre","coger","cohete","cojín","cojo","cola","colcha","colegio","colgar","colina","collar","colmo","columna","combate","comer","comida","cómodo","compra","conde","conejo","conga","conocer","consejo","contar","copa","copia","corazón","corbata","corcho","cordón","corona","correr","coser","cosmos","costa","cráneo","cráter","crear","crecer","creído","crema","cría","crimen","cripta","crisis","cromo","crónica","croqueta","crudo","cruz","cuadro","cuarto","cuatro","cubo","cubrir","cuchara","cuello","cuento","cuerda","cuesta","cueva","cuidar","culebra","culpa","culto","cumbre","cumplir","cuna","cuneta","cuota","cupón","cúpula","curar","curioso","curso","curva","cutis","dama","danza","dar","dardo","dátil","deber","débil","década","decir","dedo","defensa","definir","dejar","delfín","delgado","delito","demora","denso","dental","deporte","derecho","derrota","desayuno","deseo","desfile","desnudo","destino","desvío","detalle","detener","deuda","día","diablo","diadema","diamante","diana","diario","dibujo","dictar","diente","dieta","diez","difícil","digno","dilema","diluir","dinero","directo","dirigir","disco","diseño","disfraz","diva","divino","doble","doce","dolor","domingo","don","donar","dorado","dormir","dorso","dos","dosis","dragón","droga","ducha","duda","duelo","dueño","dulce","dúo","duque","durar","dureza","duro","ébano","ebrio","echar","eco","ecuador","edad","edición","edificio","editor","educar","efecto","eficaz","eje","ejemplo","elefante","elegir","elemento","elevar","elipse","élite","elixir","elogio","eludir","embudo","emitir","emoción","empate","empeño","empleo","empresa","enano","encargo","enchufe","encía","enemigo","enero","enfado","enfermo","engaño","enigma","enlace","enorme","enredo","ensayo","enseñar","entero","entrar","envase","envío","época","equipo","erizo","escala","escena","escolar","escribir","escudo","esencia","esfera","esfuerzo","espada","espejo","espía","esposa","espuma","esquí","estar","este","estilo","estufa","etapa","eterno","ética","etnia","evadir","evaluar","evento","evitar","exacto","examen","exceso","excusa","exento","exigir","exilio","existir","éxito","experto","explicar","exponer","extremo","fábrica","fábula","fachada","fácil","factor","faena","faja","falda","fallo","falso","faltar","fama","familia","famoso","faraón","farmacia","farol","farsa","fase","fatiga","fauna","favor","fax","febrero","fecha","feliz","feo","feria","feroz","fértil","fervor","festín","fiable","fianza","fiar","fibra","ficción","ficha","fideo","fiebre","fiel","fiera","fiesta","figura","fijar","fijo","fila","filete","filial","filtro","fin","finca","fingir","finito","firma","flaco","flauta","flecha","flor","flota","fluir","flujo","flúor","fobia","foca","fogata","fogón","folio","folleto","fondo","forma","forro","fortuna","forzar","fosa","foto","fracaso","frágil","franja","frase","fraude","freír","freno","fresa","frío","frito","fruta","fuego","fuente","fuerza","fuga","fumar","función","funda","furgón","furia","fusil","fútbol","futuro","gacela","gafas","gaita","gajo","gala","galería","gallo","gamba","ganar","gancho","ganga","ganso","garaje","garza","gasolina","gastar","gato","gavilán","gemelo","gemir","gen","género","genio","gente","geranio","gerente","germen","gesto","gigante","gimnasio","girar","giro","glaciar","globo","gloria","gol","golfo","goloso","golpe","goma","gordo","gorila","gorra","gota","goteo","gozar","grada","gráfico","grano","grasa","gratis","grave","grieta","grillo","gripe","gris","grito","grosor","grúa","grueso","grumo","grupo","guante","guapo","guardia","guerra","guía","guiño","guion","guiso","guitarra","gusano","gustar","haber","hábil","hablar","hacer","hacha","hada","hallar","hamaca","harina","haz","hazaña","hebilla","hebra","hecho","helado","helio","hembra","herir","hermano","héroe","hervir","hielo","hierro","hígado","higiene","hijo","himno","historia","hocico","hogar","hoguera","hoja","hombre","hongo","honor","honra","hora","hormiga","horno","hostil","hoyo","hueco","huelga","huerta","hueso","huevo","huida","huir","humano","húmedo","humilde","humo","hundir","huracán","hurto","icono","ideal","idioma","ídolo","iglesia","iglú","igual","ilegal","ilusión","imagen","imán","imitar","impar","imperio","imponer","impulso","incapaz","índice","inerte","infiel","informe","ingenio","inicio","inmenso","inmune","innato","insecto","instante","interés","íntimo","intuir","inútil","invierno","ira","iris","ironía","isla","islote","jabalí","jabón","jamón","jarabe","jardín","jarra","jaula","jazmín","jefe","jeringa","jinete","jornada","joroba","joven","joya","juerga","jueves","juez","jugador","jugo","juguete","juicio","junco","jungla","junio","juntar","júpiter","jurar","justo","juvenil","juzgar","kilo","koala","labio","lacio","lacra","lado","ladrón","lagarto","lágrima","laguna","laico","lamer","lámina","lámpara","lana","lancha","langosta","lanza","lápiz","largo","larva","lástima","lata","látex","latir","laurel","lavar","lazo","leal","lección","leche","lector","leer","legión","legumbre","lejano","lengua","lento","leña","león","leopardo","lesión","letal","letra","leve","leyenda","libertad","libro","licor","líder","lidiar","lienzo","liga","ligero","lima","límite","limón","limpio","lince","lindo","línea","lingote","lino","linterna","líquido","liso","lista","litera","litio","litro","llaga","llama","llanto","llave","llegar","llenar","llevar","llorar","llover","lluvia","lobo","loción","loco","locura","lógica","logro","lombriz","lomo","lonja","lote","lucha","lucir","lugar","lujo","luna","lunes","lupa","lustro","luto","luz","maceta","macho","madera","madre","maduro","maestro","mafia","magia","mago","maíz","maldad","maleta","malla","malo","mamá","mambo","mamut","manco","mando","manejar","manga","maniquí","manjar","mano","manso","manta","mañana","mapa","máquina","mar","marco","marea","marfil","margen","marido","mármol","marrón","martes","marzo","masa","máscara","masivo","matar","materia","matiz","matriz","máximo","mayor","mazorca","mecha","medalla","medio","médula","mejilla","mejor","melena","melón","memoria","menor","mensaje","mente","menú","mercado","merengue","mérito","mes","mesón","meta","meter","método","metro","mezcla","miedo","miel","miembro","miga","mil","milagro","militar","millón","mimo","mina","minero","mínimo","minuto","miope","mirar","misa","miseria","misil","mismo","mitad","mito","mochila","moción","moda","modelo","moho","mojar","molde","moler","molino","momento","momia","monarca","moneda","monja","monto","moño","morada","morder","moreno","morir","morro","morsa","mortal","mosca","mostrar","motivo","mover","móvil","mozo","mucho","mudar","mueble","muela","muerte","muestra","mugre","mujer","mula","muleta","multa","mundo","muñeca","mural","muro","músculo","museo","musgo","música","muslo","nácar","nación","nadar","naipe","naranja","nariz","narrar","nasal","natal","nativo","natural","náusea","naval","nave","navidad","necio","néctar","negar","negocio","negro","neón","nervio","neto","neutro","nevar","nevera","nicho","nido","niebla","nieto","niñez","niño","nítido","nivel","nobleza","noche","nómina","noria","norma","norte","nota","noticia","novato","novela","novio","nube","nuca","núcleo","nudillo","nudo","nuera","nueve","nuez","nulo","número","nutria","oasis","obeso","obispo","objeto","obra","obrero","observar","obtener","obvio","oca","ocaso","océano","ochenta","ocho","ocio","ocre","octavo","octubre","oculto","ocupar","ocurrir","odiar","odio","odisea","oeste","ofensa","oferta","oficio","ofrecer","ogro","oído","oír","ojo","ola","oleada","olfato","olivo","olla","olmo","olor","olvido","ombligo","onda","onza","opaco","opción","ópera","opinar","oponer","optar","óptica","opuesto","oración","orador","oral","órbita","orca","orden","oreja","órgano","orgía","orgullo","oriente","origen","orilla","oro","orquesta","oruga","osadía","oscuro","osezno","oso","ostra","otoño","otro","oveja","óvulo","óxido","oxígeno","oyente","ozono","pacto","padre","paella","página","pago","país","pájaro","palabra","palco","paleta","pálido","palma","paloma","palpar","pan","panal","pánico","pantera","pañuelo","papá","papel","papilla","paquete","parar","parcela","pared","parir","paro","párpado","parque","párrafo","parte","pasar","paseo","pasión","paso","pasta","pata","patio","patria","pausa","pauta","pavo","payaso","peatón","pecado","pecera","pecho","pedal","pedir","pegar","peine","pelar","peldaño","pelea","peligro","pellejo","pelo","peluca","pena","pensar","peñón","peón","peor","pepino","pequeño","pera","percha","perder","pereza","perfil","perico","perla","permiso","perro","persona","pesa","pesca","pésimo","pestaña","pétalo","petróleo","pez","pezuña","picar","pichón","pie","piedra","pierna","pieza","pijama","pilar","piloto","pimienta","pino","pintor","pinza","piña","piojo","pipa","pirata","pisar","piscina","piso","pista","pitón","pizca","placa","plan","plata","playa","plaza","pleito","pleno","plomo","pluma","plural","pobre","poco","poder","podio","poema","poesía","poeta","polen","policía","pollo","polvo","pomada","pomelo","pomo","pompa","poner","porción","portal","posada","poseer","posible","poste","potencia","potro","pozo","prado","precoz","pregunta","premio","prensa","preso","previo","primo","príncipe","prisión","privar","proa","probar","proceso","producto","proeza","profesor","programa","prole","promesa","pronto","propio","próximo","prueba","público","puchero","pudor","pueblo","puerta","puesto","pulga","pulir","pulmón","pulpo","pulso","puma","punto","puñal","puño","pupa","pupila","puré","quedar","queja","quemar","querer","queso","quieto","química","quince","quitar","rábano","rabia","rabo","ración","radical","raíz","rama","rampa","rancho","rango","rapaz","rápido","rapto","rasgo","raspa","rato","rayo","raza","razón","reacción","realidad","rebaño","rebote","recaer","receta","rechazo","recoger","recreo","recto","recurso","red","redondo","reducir","reflejo","reforma","refrán","refugio","regalo","regir","regla","regreso","rehén","reino","reír","reja","relato","relevo","relieve","relleno","reloj","remar","remedio","remo","rencor","rendir","renta","reparto","repetir","reposo","reptil","res","rescate","resina","respeto","resto","resumen","retiro","retorno","retrato","reunir","revés","revista","rey","rezar","rico","riego","rienda","riesgo","rifa","rígido","rigor","rincón","riñón","río","riqueza","risa","ritmo","rito","rizo","roble","roce","rociar","rodar","rodeo","rodilla","roer","rojizo","rojo","romero","romper","ron","ronco","ronda","ropa","ropero","rosa","rosca","rostro","rotar","rubí","rubor","rudo","rueda","rugir","ruido","ruina","ruleta","rulo","rumbo","rumor","ruptura","ruta","rutina","sábado","saber","sabio","sable","sacar","sagaz","sagrado","sala","saldo","salero","salir","salmón","salón","salsa","salto","salud","salvar","samba","sanción","sandía","sanear","sangre","sanidad","sano","santo","sapo","saque","sardina","sartén","sastre","satán","sauna","saxofón","sección","seco","secreto","secta","sed","seguir","seis","sello","selva","semana","semilla","senda","sensor","señal","señor","separar","sepia","sequía","ser","serie","sermón","servir","sesenta","sesión","seta","setenta","severo","sexo","sexto","sidra","siesta","siete","siglo","signo","sílaba","silbar","silencio","silla","símbolo","simio","sirena","sistema","sitio","situar","sobre","socio","sodio","sol","solapa","soldado","soledad","sólido","soltar","solución","sombra","sondeo","sonido","sonoro","sonrisa","sopa","soplar","soporte","sordo","sorpresa","sorteo","sostén","sótano","suave","subir","suceso","sudor","suegra","suelo","sueño","suerte","sufrir","sujeto","sultán","sumar","superar","suplir","suponer","supremo","sur","surco","sureño","surgir","susto","sutil","tabaco","tabique","tabla","tabú","taco","tacto","tajo","talar","talco","talento","talla","talón","tamaño","tambor","tango","tanque","tapa","tapete","tapia","tapón","taquilla","tarde","tarea","tarifa","tarjeta","tarot","tarro","tarta","tatuaje","tauro","taza","tazón","teatro","techo","tecla","técnica","tejado","tejer","tejido","tela","teléfono","tema","temor","templo","tenaz","tender","tener","tenis","tenso","teoría","terapia","terco","término","ternura","terror","tesis","tesoro","testigo","tetera","texto","tez","tibio","tiburón","tiempo","tienda","tierra","tieso","tigre","tijera","tilde","timbre","tímido","timo","tinta","tío","típico","tipo","tira","tirón","titán","títere","título","tiza","toalla","tobillo","tocar","tocino","todo","toga","toldo","tomar","tono","tonto","topar","tope","toque","tórax","torero","tormenta","torneo","toro","torpedo","torre","torso","tortuga","tos","tosco","toser","tóxico","trabajo","tractor","traer","tráfico","trago","traje","tramo","trance","trato","trauma","trazar","trébol","tregua","treinta","tren","trepar","tres","tribu","trigo","tripa","triste","triunfo","trofeo","trompa","tronco","tropa","trote","trozo","truco","trueno","trufa","tubería","tubo","tuerto","tumba","tumor","túnel","túnica","turbina","turismo","turno","tutor","ubicar","úlcera","umbral","unidad","unir","universo","uno","untar","uña","urbano","urbe","urgente","urna","usar","usuario","útil","utopía","uva","vaca","vacío","vacuna","vagar","vago","vaina","vajilla","vale","válido","valle","valor","válvula","vampiro","vara","variar","varón","vaso","vecino","vector","vehículo","veinte","vejez","vela","velero","veloz","vena","vencer","venda","veneno","vengar","venir","venta","venus","ver","verano","verbo","verde","vereda","verja","verso","verter","vía","viaje","vibrar","vicio","víctima","vida","vídeo","vidrio","viejo","viernes","vigor","vil","villa","vinagre","vino","viñedo","violín","viral","virgo","virtud","visor","víspera","vista","vitamina","viudo","vivaz","vivero","vivir","vivo","volcán","volumen","volver","voraz","votar","voto","voz","vuelo","vulgar","yacer","yate","yegua","yema","yerno","yeso","yodo","yoga","yogur","zafiro","zanja","zapato","zarza","zona","zorro","zumo","zurdo"]},function(t,e,i){"use strict";function n(t){if(!(this instanceof n))return new n(t);this.network=u.primary,this.depth=0,this.parentFingerPrint=0,this.childIndex=0,this.chainCode=d.ZERO_HASH,this.privateKey=d.ZERO_HASH,this.publicKey=d.ZERO_KEY,this.fingerPrint=-1,this._xprivkey=null,this._hdPublicKey=null,t&&this.fromOptions(t)}const r=i(0),s=i(1),o=i(5),a=i(72),h=i(28),c=i(12),u=i(6),f=i(4),l=i(2),p=i(25),d=i(3),m=i(110),g=i(206),y=i(209),w=Buffer.from("WMCoin seed","ascii");n.prototype.fromOptions=function(t){return r(t,"No options for HD private key."),r(s.isU8(t.depth)),r(s.isU32(t.parentFingerPrint)),r(s.isU32(t.childIndex)),r(Buffer.isBuffer(t.chainCode)),r(Buffer.isBuffer(t.privateKey)),t.network&&(this.network=u.get(t.network)),this.depth=t.depth,this.parentFingerPrint=t.parentFingerPrint,this.childIndex=t.childIndex,this.chainCode=t.chainCode,this.privateKey=t.privateKey,this.publicKey=c.publicKeyCreate(t.privateKey,!0),this},n.fromOptions=function(t){return(new n).fromOptions(t)},n.prototype.toPublic=function(){let t=this._hdPublicKey;return t||((t=new y).network=this.network,t.depth=this.depth,t.parentFingerPrint=this.parentFingerPrint,t.childIndex=this.childIndex,t.chainCode=this.chainCode,t.publicKey=this.publicKey,this._hdPublicKey=t),t},n.prototype.xprivkey=function(){return this._xprivkey||(this._xprivkey=this.toBase58()),this._xprivkey},n.prototype.xpubkey=function(){return this.toPublic().xpubkey()},n.prototype.destroy=function(t){this.depth=0,this.childIndex=0,this.parentFingerPrint=0,a(this.chainCode),a(this.privateKey),a(this.publicKey),this.fingerPrint=-1,this._hdPublicKey&&(t&&this._hdPublicKey.destroy(),this._hdPublicKey=null),this._xprivkey=null},n.prototype.derive=function(t,e){if(r("number"==typeof t),t>>>0!==t)throw new Error("Index out of range.");if(this.depth>=255)throw new Error("Depth too high.");e&&(t|=m.HARDENED,t>>>=0);const i=this.getID(t),s=m.cache.get(i);if(s)return s;const a=f.pool(37);t&m.HARDENED?(a.writeU8(0),a.writeBytes(this.privateKey),a.writeU32BE(t)):(a.writeBytes(this.publicKey),a.writeU32BE(t));const h=a.render(),u=o.hmac("sha512",h,this.chainCode),l=u.slice(0,32),p=u.slice(32,64);let d;try{d=c.privateKeyTweakAdd(this.privateKey,l)}catch(e){return this.derive(t+1)}if(-1===this.fingerPrint){const t=o.hash160(this.publicKey);this.fingerPrint=t.readUInt32BE(0,!0)}const g=new n;return g.network=this.network,g.depth=this.depth+1,g.parentFingerPrint=this.fingerPrint,g.childIndex=t,g.chainCode=p,g.privateKey=d,g.publicKey=c.publicKeyCreate(d,!0),m.cache.set(i,g),g},n.prototype.getID=function(t){return this.network.keyPrefix.xprivkey58+this.publicKey.toString("hex")+t},n.prototype.deriveAccount=function(t,e){return r(s.isU32(t),"Purpose must be a number."),r(s.isU32(e),"Account index must be a number."),r(this.isMaster(),"Cannot derive account index."),this.derive(t,!0).derive(this.network.keyPrefix.coinType,!0).derive(e,!0)},n.prototype.isMaster=function(){return m.isMaster(this)},n.prototype.isAccount=function(t){return m.isAccount(this,t)},n.isBase58=function(t,e){if("string"!=typeof t)return!1;if(t.length<4)return!1;const i=t.substring(0,4);try{return u.fromPrivate58(i,e),!0}catch(t){return!1}},n.isRaw=function(t,e){if(!Buffer.isBuffer(t))return!1;if(t.length<4)return!1;const i=t.readUInt32BE(0,!0);try{return u.fromPrivate(i,e),!0}catch(t){return!1}},n.isValidPath=function(t){try{return m.parsePath(t,!0),!0}catch(t){return!1}},n.prototype.derivePath=function(t){const e=m.parsePath(t,!0);let i=this;for(const t of e)i=i.derive(t);return i},n.prototype.equals=function(t){return r(n.isHDPrivateKey(t)),this.network===t.network&&this.depth===t.depth&&this.parentFingerPrint===t.parentFingerPrint&&this.childIndex===t.childIndex&&this.chainCode.equals(t.chainCode)&&this.privateKey.equals(t.privateKey)},n.prototype.compare=function(t){r(n.isHDPrivateKey(t));let e=this.depth-t.depth;return 0!==e?e:0!=(e=this.parentFingerPrint-t.parentFingerPrint)?e:0!=(e=this.childIndex-t.childIndex)?e:0!==(e=this.chainCode.compare(t.chainCode))?e:0!==(e=this.privateKey.compare(t.privateKey))?e:0},n.prototype.fromSeed=function(t,e){if(r(Buffer.isBuffer(t)),8*t.length<m.MIN_ENTROPY||8*t.length>m.MAX_ENTROPY)throw new Error("Entropy not in range.");const i=o.hmac("sha512",t,w),n=i.slice(0,32),s=i.slice(32,64);if(!c.privateKeyVerify(n))throw new Error("Master private key is invalid.");return this.network=u.get(e),this.depth=0,this.parentFingerPrint=0,this.childIndex=0,this.chainCode=s,this.privateKey=n,this.publicKey=c.publicKeyCreate(n,!0),this},n.fromSeed=function(t,e){return(new n).fromSeed(t,e)},n.prototype.fromMnemonic=function(t,e){return r(t instanceof g),this.fromSeed(t.toSeed(),e)},n.fromMnemonic=function(t,e){return(new n).fromMnemonic(t,e)},n.prototype.fromPhrase=function(t,e){const i=g.fromPhrase(t);return this.fromMnemonic(i,e),this},n.fromPhrase=function(t,e){return(new n).fromPhrase(t,e)},n.prototype.fromKey=function(t,e,i){return r(Buffer.isBuffer(t)&&32===t.length),r(Buffer.isBuffer(e)&&32===e.length),this.network=u.get(i),this.depth=0,this.parentFingerPrint=0,this.childIndex=0,this.chainCode=e,this.privateKey=t,this.publicKey=c.publicKeyCreate(t,!0),this},n.fromKey=function(t,e,i){return(new n).fromKey(t,e,i)},n.generate=function(t){const e=c.generatePrivateKey(),i=h.randomBytes(32);return n.fromKey(e,i,t)},n.prototype.fromBase58=function(t,e){return r("string"==typeof t),this._xprivkey=t,this.fromRaw(p.decode(t),e)},n.prototype.fromReader=function(t,e){const i=t.readU32BE();return this.network=u.fromPrivate(i,e),this.depth=t.readU8(),this.parentFingerPrint=t.readU32BE(),this.childIndex=t.readU32BE(),this.chainCode=t.readBytes(32),r(0===t.readU8()),this.privateKey=t.readBytes(32),this.publicKey=c.publicKeyCreate(this.privateKey,!0),t.verifyChecksum(),this},n.prototype.fromRaw=function(t,e){return this.fromReader(new l(t),e)},n.prototype.toBase58=function(t){return p.encode(this.toRaw(t))},n.prototype.getSize=function(){return 82},n.prototype.toWriter=function(t,e){return e||(e=this.network),e=u.get(e),t.writeU32BE(e.keyPrefix.xprivkey),t.writeU8(this.depth),t.writeU32BE(this.parentFingerPrint),t.writeU32BE(this.childIndex),t.writeBytes(this.chainCode),t.writeU8(0),t.writeBytes(this.privateKey),t.writeChecksum(),t},n.prototype.toRaw=function(t){return this.toWriter(new f(82),t).render()},n.fromBase58=function(t,e){return(new n).fromBase58(t,e)},n.fromReader=function(t,e){return(new n).fromReader(t,e)},n.fromRaw=function(t,e){return(new n).fromRaw(t,e)},n.prototype.toJSON=function(){return{xprivkey:this.xprivkey()}},n.prototype.fromJSON=function(t,e){return r(t.xprivkey,"Could not handle key JSON."),this.fromBase58(t.xprivkey,e),this},n.fromJSON=function(t,e){return(new n).fromJSON(t,e)},n.isHDPrivateKey=function(t){return t instanceof n},t.exports=n},function(t,e,i){"use strict";e.Base=i(166),e.Client=i(210),e.request=i(95),e.RPCBase=i(174),e.RPCClient=i(211),e.RPC=i(115),e.Server=i(176),e.Wallet=i(300)},function(t,e){t.exports=require("stream")},function(t,e){t.exports=require("querystring")},function(t,e,i){var n=i(213),r=i(45)("socket.io-client:url");t.exports=function(t,e){var i=t;e=e||global.location,null==t&&(t=e.protocol+"//"+e.host),"string"==typeof t&&("/"===t.charAt(0)&&(t="/"===t.charAt(1)?e.protocol+t:e.host+t),/^(https?|wss?):\/\//.test(t)||(r("protocol-less url %s",t),t=void 0!==e?e.protocol+"//"+t:"https://"+t),r("parse %s",t),i=n(t)),i.port||(/^(http|ws)$/.test(i.protocol)?i.port="80":/^(http|ws)s$/.test(i.protocol)&&(i.port="443")),i.path=i.path||"/";var s=-1!==i.host.indexOf(":")?"["+i.host+"]":i.host;return i.id=i.protocol+"://"+s+":"+i.port,i.href=i.protocol+"://"+s+(e&&e.port===i.port?"":":"+i.port),i}},function(t,e,i){function n(){var t;try{t=e.storage.debug}catch(t){}return!t&&"undefined"!=typeof process&&"env"in process&&(t=process.env.DEBUG),t}(e=t.exports=i(214)).log=function(){return"object"==typeof console&&console.log&&Function.prototype.apply.call(console.log,console,arguments)},e.formatArgs=function(t){var i=this.useColors;if(t[0]=(i?"%c":"")+this.namespace+(i?" %c":" ")+t[0]+(i?"%c ":" ")+"+"+e.humanize(this.diff),i){var n="color: "+this.color;t.splice(1,0,n,"color: inherit");var r=0,s=0;t[0].replace(/%[a-zA-Z%]/g,function(t){"%%"!==t&&(r++,"%c"===t&&(s=r))}),t.splice(s,0,n)}},e.save=function(t){try{null==t?e.storage.removeItem("debug"):e.storage.debug=t}catch(t){}},e.load=n,e.useColors=function(){return!("undefined"==typeof window||!window.process||"renderer"!==window.process.type)||"undefined"!=typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"undefined"!=typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)},e.storage="undefined"!=typeof chrome&&void 0!==chrome.storage?chrome.storage.local:function(){try{return window.localStorage}catch(t){}}(),e.colors=["lightseagreen","forestgreen","goldenrod","dodgerblue","darkorchid","crimson"],e.formatters.j=function(t){try{return JSON.stringify(t)}catch(t){return"[UnexpectedJSONParseError]: "+t.message}},e.enable(n())},function(t,e){function i(t,e,i){if(!(t<e))return t<1.5*e?Math.floor(t/e)+" "+i:Math.ceil(t/e)+" "+i+"s"}var n=1e3,r=60*n,s=60*r,o=24*s,a=365.25*o;t.exports=function(t,e){e=e||{};var h=typeof t;if("string"===h&&t.length>0)return function(t){if(!((t=String(t)).length>100)){var e=/^((?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|years?|yrs?|y)?$/i.exec(t);if(e){var i=parseFloat(e[1]);switch((e[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return i*a;case"days":case"day":case"d":return i*o;case"hours":case"hour":case"hrs":case"hr":case"h":return i*s;case"minutes":case"minute":case"mins":case"min":case"m":return i*r;case"seconds":case"second":case"secs":case"sec":case"s":return i*n;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return i;default:return}}}}(t);if("number"===h&&!1===isNaN(t))return e.long?function(t){return i(t,o,"day")||i(t,s,"hour")||i(t,r,"minute")||i(t,n,"second")||t+" ms"}(t):function(t){return t>=o?Math.round(t/o)+"d":t>=s?Math.round(t/s)+"h":t>=r?Math.round(t/r)+"m":t>=n?Math.round(t/n)+"s":t+"ms"}(t);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(t))}},function(t,e,i){function n(){return process.env.DEBUG}var r=i(277),s=i(54);(e=t.exports=i(214)).init=function(t){t.inspectOpts={};for(var i=Object.keys(e.inspectOpts),n=0;n<i.length;n++)t.inspectOpts[i[n]]=e.inspectOpts[i[n]]},e.log=function(){return a.write(s.format.apply(s,arguments)+"\n")},e.formatArgs=function(t){var i=this.namespace;if(this.useColors){var n=this.color,r="  [3"+n+";1m"+i+" [0m";t[0]=r+t[0].split("\n").join("\n"+r),t.push("[3"+n+"m+"+e.humanize(this.diff)+"[0m")}else t[0]=(new Date).toUTCString()+" "+i+" "+t[0]},e.save=function(t){null==t?delete process.env.DEBUG:process.env.DEBUG=t},e.load=n,e.useColors=function(){return"colors"in e.inspectOpts?Boolean(e.inspectOpts.colors):r.isatty(o)},e.colors=[6,2,3,4,5,1],e.inspectOpts=Object.keys(process.env).filter(function(t){return/^debug_/i.test(t)}).reduce(function(t,e){var i=e.substring(6).toLowerCase().replace(/_([a-z])/g,function(t,e){return e.toUpperCase()}),n=process.env[e];return n=!!/^(yes|on|true|enabled)$/i.test(n)||!/^(no|off|false|disabled)$/i.test(n)&&("null"===n?null:Number(n)),t[i]=n,t},{});var o=parseInt(process.env.DEBUG_FD,10)||2;1!==o&&2!==o&&s.deprecate(function(){},"except for stderr(2) and stdout(1), any other usage of DEBUG_FD is deprecated. Override debug.log if you want to use a different log function (https://git.io/debug_fd)")();var a=1===o?process.stdout:2===o?process.stderr:function(t){var e;switch(process.binding("tty_wrap").guessHandleType(t)){case"TTY":(e=new r.WriteStream(t))._type="tty",e._handle&&e._handle.unref&&e._handle.unref();break;case"FILE":(e=new(i(106).SyncWriteStream)(t,{autoClose:!1}))._type="fs";break;case"PIPE":case"TCP":(e=new(i(168).Socket)({fd:t,readable:!1,writable:!0})).readable=!1,e.read=null,e._type="pipe",e._handle&&e._handle.unref&&e._handle.unref();break;default:throw new Error("Implement me. Unknown stream file type!")}return e.fd=t,e._isStdio=!0,e}(o);e.formatters.o=function(t){return this.inspectOpts.colors=this.useColors,s.inspect(t,this.inspectOpts).replace(/\s*\n\s*/g," ")},e.formatters.O=function(t){return this.inspectOpts.colors=this.useColors,s.inspect(t,this.inspectOpts)},e.enable(n())},function(t,e){t.exports=require("tty")},function(t,e,i){function n(t){if(!t||"object"!=typeof t)return!1;if(r(t)){for(var e=0,i=t.length;e<i;e++)if(n(t[e]))return!0;return!1}if("function"==typeof global.Buffer&&global.Buffer.isBuffer&&global.Buffer.isBuffer(t)||"function"==typeof global.ArrayBuffer&&t instanceof ArrayBuffer||o&&t instanceof Blob||a&&t instanceof File)return!0;if(t.toJSON&&"function"==typeof t.toJSON&&1===arguments.length)return n(t.toJSON(),!0);for(var s in t)if(Object.prototype.hasOwnProperty.call(t,s)&&n(t[s]))return!0;return!1}var r=i(215),s=Object.prototype.toString,o="function"==typeof global.Blob||"[object BlobConstructor]"===s.call(global.Blob),a="function"==typeof global.File||"[object FileConstructor]"===s.call(global.File);t.exports=n},function(t,e,i){function n(t,e){if(!t)return t;if(o(t)){var i={_placeholder:!0,num:e.length};return e.push(t),i}if(s(t)){for(var r=new Array(t.length),a=0;a<t.length;a++)r[a]=n(t[a],e);return r}if("object"==typeof t&&!(t instanceof Date)){r={};for(var h in t)r[h]=n(t[h],e);return r}return t}function r(t,e){if(!t)return t;if(t&&t._placeholder)return e[t.num];if(s(t))for(var i=0;i<t.length;i++)t[i]=r(t[i],e);else if("object"==typeof t)for(var n in t)t[n]=r(t[n],e);return t}var s=i(215),o=i(216),a=Object.prototype.toString,h="function"==typeof global.Blob||"[object BlobConstructor]"===a.call(global.Blob),c="function"==typeof global.File||"[object FileConstructor]"===a.call(global.File);e.deconstructPacket=function(t){var e=[],i=t.data,r=t;return r.data=n(i,e),r.attachments=e.length,{packet:r,buffers:e}},e.reconstructPacket=function(t,e){return t.data=r(t.data,e),t.attachments=void 0,t},e.removeBlobs=function(t,e){function i(t,a,u){if(!t)return t;if(h&&t instanceof Blob||c&&t instanceof File){n++;var f=new FileReader;f.onload=function(){u?u[a]=this.result:r=this.result,--n||e(r)},f.readAsArrayBuffer(t)}else if(s(t))for(var l=0;l<t.length;l++)i(t[l],l,t);else if("object"==typeof t&&!o(t))for(var p in t)i(t[p],p,t)}var n=0,r=t;i(r),n||e(r)}},function(t,e,i){t.exports=i(281)},function(t,e,i){t.exports=i(282),t.exports.parser=i(77)},function(t,e,i){function n(t,e){if(!(this instanceof n))return new n(t,e);e=e||{},t&&"object"==typeof t&&(e=t,t=null),t?(t=c(t),e.hostname=t.host,e.secure="https"===t.protocol||"wss"===t.protocol,e.port=t.port,t.query&&(e.query=t.query)):e.host&&(e.hostname=c(e.host).host),this.secure=null!=e.secure?e.secure:global.location&&"https:"===location.protocol,e.hostname&&!e.port&&(e.port=this.secure?"443":"80"),this.agent=e.agent||!1,this.hostname=e.hostname||(global.location?location.hostname:"localhost"),this.port=e.port||(global.location&&location.port?location.port:this.secure?443:80),this.query=e.query||{},"string"==typeof this.query&&(this.query=f.decode(this.query)),this.upgrade=!1!==e.upgrade,this.path=(e.path||"/engine.io").replace(/\/$/,"")+"/",this.forceJSONP=!!e.forceJSONP,this.jsonp=!1!==e.jsonp,this.forceBase64=!!e.forceBase64,this.enablesXDR=!!e.enablesXDR,this.timestampParam=e.timestampParam||"t",this.timestampRequests=e.timestampRequests,this.transports=e.transports||["polling","websocket"],this.transportOptions=e.transportOptions||{},this.readyState="",this.writeBuffer=[],this.prevBufferLen=0,this.policyPort=e.policyPort||843,this.rememberUpgrade=e.rememberUpgrade||!1,this.binaryType=null,this.onlyBinaryUpgrades=e.onlyBinaryUpgrades,this.perMessageDeflate=!1!==e.perMessageDeflate&&(e.perMessageDeflate||{}),!0===this.perMessageDeflate&&(this.perMessageDeflate={}),this.perMessageDeflate&&null==this.perMessageDeflate.threshold&&(this.perMessageDeflate.threshold=1024),this.pfx=e.pfx||null,this.key=e.key||null,this.passphrase=e.passphrase||null,this.cert=e.cert||null,this.ca=e.ca||null,this.ciphers=e.ciphers||null,this.rejectUnauthorized=void 0===e.rejectUnauthorized||e.rejectUnauthorized,this.forceNode=!!e.forceNode;var i="object"==typeof global&&global;i.global===i&&(e.extraHeaders&&Object.keys(e.extraHeaders).length>0&&(this.extraHeaders=e.extraHeaders),e.localAddress&&(this.localAddress=e.localAddress)),this.id=null,this.upgrades=null,this.pingInterval=null,this.pingTimeout=null,this.pingIntervalTimer=null,this.pingTimeoutTimer=null,this.open()}var r=i(218),s=i(76),o=i(45)("engine.io-client:socket"),a=i(228),h=i(77),c=i(213),u=i(297),f=i(112);t.exports=n,n.priorWebsocketSuccess=!1,s(n.prototype),n.protocol=h.protocol,n.Socket=n,n.Transport=i(171),n.transports=i(218),n.parser=i(77),n.prototype.createTransport=function(t){o('creating transport "%s"',t);var e=function(t){var e={};for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i]);return e}(this.query);e.EIO=h.protocol,e.transport=t;var i=this.transportOptions[t]||{};this.id&&(e.sid=this.id);return new r[t]({query:e,socket:this,agent:i.agent||this.agent,hostname:i.hostname||this.hostname,port:i.port||this.port,secure:i.secure||this.secure,path:i.path||this.path,forceJSONP:i.forceJSONP||this.forceJSONP,jsonp:i.jsonp||this.jsonp,forceBase64:i.forceBase64||this.forceBase64,enablesXDR:i.enablesXDR||this.enablesXDR,timestampRequests:i.timestampRequests||this.timestampRequests,timestampParam:i.timestampParam||this.timestampParam,policyPort:i.policyPort||this.policyPort,pfx:i.pfx||this.pfx,key:i.key||this.key,passphrase:i.passphrase||this.passphrase,cert:i.cert||this.cert,ca:i.ca||this.ca,ciphers:i.ciphers||this.ciphers,rejectUnauthorized:i.rejectUnauthorized||this.rejectUnauthorized,perMessageDeflate:i.perMessageDeflate||this.perMessageDeflate,extraHeaders:i.extraHeaders||this.extraHeaders,forceNode:i.forceNode||this.forceNode,localAddress:i.localAddress||this.localAddress,requestTimeout:i.requestTimeout||this.requestTimeout,protocols:i.protocols||void 0})},n.prototype.open=function(){var t;if(this.rememberUpgrade&&n.priorWebsocketSuccess&&-1!==this.transports.indexOf("websocket"))t="websocket";else{if(0===this.transports.length){var e=this;return void setTimeout(function(){e.emit("error","No transports available")},0)}t=this.transports[0]}this.readyState="opening";try{t=this.createTransport(t)}catch(t){return this.transports.shift(),void this.open()}t.open(),this.setTransport(t)},n.prototype.setTransport=function(t){o("setting transport %s",t.name);var e=this;this.transport&&(o("clearing existing transport %s",this.transport.name),this.transport.removeAllListeners()),this.transport=t,t.on("drain",function(){e.onDrain()}).on("packet",function(t){e.onPacket(t)}).on("error",function(t){e.onError(t)}).on("close",function(){e.onClose("transport close")})},n.prototype.probe=function(t){function e(){if(l.onlyBinaryUpgrades){var e=!this.supportsBinary&&l.transport.supportsBinary;f=f||e}f||(o('probe transport "%s" opened',t),u.send([{type:"ping",data:"probe"}]),u.once("packet",function(e){if(!f)if("pong"===e.type&&"probe"===e.data){if(o('probe transport "%s" pong',t),l.upgrading=!0,l.emit("upgrading",u),!u)return;n.priorWebsocketSuccess="websocket"===u.name,o('pausing current transport "%s"',l.transport.name),l.transport.pause(function(){f||"closed"!==l.readyState&&(o("changing transport and sending upgrade packet"),c(),l.setTransport(u),u.send([{type:"upgrade"}]),l.emit("upgrade",u),u=null,l.upgrading=!1,l.flush())})}else{o('probe transport "%s" failed',t);var i=new Error("probe error");i.transport=u.name,l.emit("upgradeError",i)}}))}function i(){f||(f=!0,c(),u.close(),u=null)}function r(e){var n=new Error("probe error: "+e);n.transport=u.name,i(),o('probe transport "%s" failed because of error: %s',t,e),l.emit("upgradeError",n)}function s(){r("transport closed")}function a(){r("socket closed")}function h(t){u&&t.name!==u.name&&(o('"%s" works - aborting "%s"',t.name,u.name),i())}function c(){u.removeListener("open",e),u.removeListener("error",r),u.removeListener("close",s),l.removeListener("close",a),l.removeListener("upgrading",h)}o('probing transport "%s"',t);var u=this.createTransport(t,{probe:1}),f=!1,l=this;n.priorWebsocketSuccess=!1,u.once("open",e),u.once("error",r),u.once("close",s),this.once("close",a),this.once("upgrading",h),u.open()},n.prototype.onOpen=function(){if(o("socket open"),this.readyState="open",n.priorWebsocketSuccess="websocket"===this.transport.name,this.emit("open"),this.flush(),"open"===this.readyState&&this.upgrade&&this.transport.pause){o("starting upgrade probes");for(var t=0,e=this.upgrades.length;t<e;t++)this.probe(this.upgrades[t])}},n.prototype.onPacket=function(t){if("opening"===this.readyState||"open"===this.readyState||"closing"===this.readyState)switch(o('socket receive: type "%s", data "%s"',t.type,t.data),this.emit("packet",t),this.emit("heartbeat"),t.type){case"open":this.onHandshake(u(t.data));break;case"pong":this.setPing(),this.emit("pong");break;case"error":var e=new Error("server error");e.code=t.data,this.onError(e);break;case"message":this.emit("data",t.data),this.emit("message",t.data)}else o('packet received with socket readyState "%s"',this.readyState)},n.prototype.onHandshake=function(t){this.emit("handshake",t),this.id=t.sid,this.transport.query.sid=t.sid,this.upgrades=this.filterUpgrades(t.upgrades),this.pingInterval=t.pingInterval,this.pingTimeout=t.pingTimeout,this.onOpen(),"closed"!==this.readyState&&(this.setPing(),this.removeListener("heartbeat",this.onHeartbeat),this.on("heartbeat",this.onHeartbeat))},n.prototype.onHeartbeat=function(t){clearTimeout(this.pingTimeoutTimer);var e=this;e.pingTimeoutTimer=setTimeout(function(){"closed"!==e.readyState&&e.onClose("ping timeout")},t||e.pingInterval+e.pingTimeout)},n.prototype.setPing=function(){var t=this;clearTimeout(t.pingIntervalTimer),t.pingIntervalTimer=setTimeout(function(){o("writing ping packet - expecting pong within %sms",t.pingTimeout),t.ping(),t.onHeartbeat(t.pingTimeout)},t.pingInterval)},n.prototype.ping=function(){var t=this;this.sendPacket("ping",function(){t.emit("ping")})},n.prototype.onDrain=function(){this.writeBuffer.splice(0,this.prevBufferLen),this.prevBufferLen=0,0===this.writeBuffer.length?this.emit("drain"):this.flush()},n.prototype.flush=function(){"closed"!==this.readyState&&this.transport.writable&&!this.upgrading&&this.writeBuffer.length&&(o("flushing %d packets in socket",this.writeBuffer.length),this.transport.send(this.writeBuffer),this.prevBufferLen=this.writeBuffer.length,this.emit("flush"))},n.prototype.write=n.prototype.send=function(t,e,i){return this.sendPacket("message",t,e,i),this},n.prototype.sendPacket=function(t,e,i,n){if("function"==typeof e&&(n=e,e=void 0),"function"==typeof i&&(n=i,i=null),"closing"!==this.readyState&&"closed"!==this.readyState){(i=i||{}).compress=!1!==i.compress;var r={type:t,data:e,options:i};this.emit("packetCreate",r),this.writeBuffer.push(r),n&&this.once("flush",n),this.flush()}},n.prototype.close=function(){function t(){n.onClose("forced close"),o("socket closing - telling transport to close"),n.transport.close()}function e(){n.removeListener("upgrade",e),n.removeListener("upgradeError",e),t()}function i(){n.once("upgrade",e),n.once("upgradeError",e)}if("opening"===this.readyState||"open"===this.readyState){this.readyState="closing";var n=this;this.writeBuffer.length?this.once("drain",function(){this.upgrading?i():t()}):this.upgrading?i():t()}return this},n.prototype.onError=function(t){o("socket error %j",t),n.priorWebsocketSuccess=!1,this.emit("error",t),this.onClose("transport error",t)},n.prototype.onClose=function(t,e){if("opening"===this.readyState||"open"===this.readyState||"closing"===this.readyState){o('socket close with reason: "%s"',t);clearTimeout(this.pingIntervalTimer),clearTimeout(this.pingTimeoutTimer),this.transport.removeAllListeners("close"),this.transport.close(),this.transport.removeAllListeners(),this.readyState="closed",this.id=null,this.emit("close",t,e),this.writeBuffer=[],this.prevBufferLen=0}},n.prototype.filterUpgrades=function(t){for(var e=[],i=0,n=t.length;i<n;i++)~a(this.transports,t[i])&&e.push(t[i]);return e}},function(t,e,i){function n(){}function r(t){if(h.call(this,t),this.requestTimeout=t.requestTimeout,this.extraHeaders=t.extraHeaders,global.location){var e="https:"===location.protocol,i=location.port;i||(i=e?443:80),this.xd=t.hostname!==global.location.hostname||i!==t.port,this.xs=t.secure!==e}}function s(t){this.method=t.method||"GET",this.uri=t.uri,this.xd=!!t.xd,this.xs=!!t.xs,this.async=!1!==t.async,this.data=void 0!==t.data?t.data:null,this.agent=t.agent,this.isBinary=t.isBinary,this.supportsBinary=t.supportsBinary,this.enablesXDR=t.enablesXDR,this.requestTimeout=t.requestTimeout,this.pfx=t.pfx,this.key=t.key,this.passphrase=t.passphrase,this.cert=t.cert,this.ca=t.ca,this.ciphers=t.ciphers,this.rejectUnauthorized=t.rejectUnauthorized,this.extraHeaders=t.extraHeaders,this.create()}function o(){for(var t in s.requests)s.requests.hasOwnProperty(t)&&s.requests[t].abort()}var a=i(170),h=i(220),c=i(76),u=i(113),f=i(45)("engine.io-client:polling-xhr");t.exports=r,t.exports.Request=s,u(r,h),r.prototype.supportsBinary=!0,r.prototype.request=function(t){return t=t||{},t.uri=this.uri(),t.xd=this.xd,t.xs=this.xs,t.agent=this.agent||!1,t.supportsBinary=this.supportsBinary,t.enablesXDR=this.enablesXDR,t.pfx=this.pfx,t.key=this.key,t.passphrase=this.passphrase,t.cert=this.cert,t.ca=this.ca,t.ciphers=this.ciphers,t.rejectUnauthorized=this.rejectUnauthorized,t.requestTimeout=this.requestTimeout,t.extraHeaders=this.extraHeaders,new s(t)},r.prototype.doWrite=function(t,e){var i="string"!=typeof t&&void 0!==t,n=this.request({method:"POST",data:t,isBinary:i}),r=this;n.on("success",e),n.on("error",function(t){r.onError("xhr post error",t)}),this.sendXhr=n},r.prototype.doPoll=function(){f("xhr poll");var t=this.request(),e=this;t.on("data",function(t){e.onData(t)}),t.on("error",function(t){e.onError("xhr poll error",t)}),this.pollXhr=t},c(s.prototype),s.prototype.create=function(){var t={agent:this.agent,xdomain:this.xd,xscheme:this.xs,enablesXDR:this.enablesXDR};t.pfx=this.pfx,t.key=this.key,t.passphrase=this.passphrase,t.cert=this.cert,t.ca=this.ca,t.ciphers=this.ciphers,t.rejectUnauthorized=this.rejectUnauthorized;var e=this.xhr=new a(t),i=this;try{f("xhr open %s: %s",this.method,this.uri),e.open(this.method,this.uri,this.async);try{if(this.extraHeaders){e.setDisableHeaderCheck&&e.setDisableHeaderCheck(!0);for(var n in this.extraHeaders)this.extraHeaders.hasOwnProperty(n)&&e.setRequestHeader(n,this.extraHeaders[n])}}catch(t){}if("POST"===this.method)try{this.isBinary?e.setRequestHeader("Content-type","application/octet-stream"):e.setRequestHeader("Content-type","text/plain;charset=UTF-8")}catch(t){}try{e.setRequestHeader("Accept","*/*")}catch(t){}"withCredentials"in e&&(e.withCredentials=!0),this.requestTimeout&&(e.timeout=this.requestTimeout),this.hasXDR()?(e.onload=function(){i.onLoad()},e.onerror=function(){i.onError(e.responseText)}):e.onreadystatechange=function(){if(2===e.readyState){var t;try{t=e.getResponseHeader("Content-Type")}catch(t){}"application/octet-stream"===t&&(e.responseType="arraybuffer")}4===e.readyState&&(200===e.status||1223===e.status?i.onLoad():setTimeout(function(){i.onError(e.status)},0))},f("xhr data %s",this.data),e.send(this.data)}catch(t){return void setTimeout(function(){i.onError(t)},0)}global.document&&(this.index=s.requestsCount++,s.requests[this.index]=this)},s.prototype.onSuccess=function(){this.emit("success"),this.cleanup()},s.prototype.onData=function(t){this.emit("data",t),this.onSuccess()},s.prototype.onError=function(t){this.emit("error",t),this.cleanup(!0)},s.prototype.cleanup=function(t){if(void 0!==this.xhr&&null!==this.xhr){if(this.hasXDR()?this.xhr.onload=this.xhr.onerror=n:this.xhr.onreadystatechange=n,t)try{this.xhr.abort()}catch(t){}global.document&&delete s.requests[this.index],this.xhr=null}},s.prototype.onLoad=function(){var t;try{var e;try{e=this.xhr.getResponseHeader("Content-Type")}catch(t){}t="application/octet-stream"===e?this.xhr.response||this.xhr.responseText:this.xhr.responseText}catch(t){this.onError(t)}null!=t&&this.onData(t)},s.prototype.hasXDR=function(){return void 0!==global.XDomainRequest&&!this.xs&&this.enablesXDR},s.prototype.abort=function(){this.cleanup()},s.requestsCount=0,s.requests={},global.document&&(global.attachEvent?global.attachEvent("onunload",o):global.addEventListener&&global.addEventListener("beforeunload",o,!1))},function(t,e,i){function n(t,i,n){if(!i)return e.encodeBase64Packet(t,n);var r=t.data,s=new Buffer(1);return s[0]=l[t.type],n(Buffer.concat([s,r]))}function r(t,e,i){for(var n=new Array(t.length),r=u(t.length,i),s=0;s<t.length;s++)e(t[s],function(t,e){n[s]=e,r(t,n)})}function s(t){for(var e="",i=0,n=t.length;i<n;i++)e+=String.fromCharCode(t[i]);return e}function o(t){for(var e=new Uint8Array(t.buffer||t),i=t.byteLength||t.length,n=t.byteOffset||0,r=new Buffer(i),s=0;s<i;s++)r[s]=e[n+s];return r}function a(t,i){e.encodePacket(t,!0,!0,function(t){var e,n=""+t.length;if("string"==typeof t){(e=new Buffer(n.length+2))[0]=0;for(var r=0;r<n.length;r++)e[r+1]=parseInt(n[r],10);return e[e.length-1]=255,i(null,Buffer.concat([e,function(t){for(var e=new Buffer(t.length),i=0,n=t.length;i<n;i++)e.writeUInt8(t.charCodeAt(i),i);return e}(t)]))}for((e=new Buffer(n.length+2))[0]=1,r=0;r<n.length;r++)e[r+1]=parseInt(n[r],10);e[e.length-1]=255,i(null,Buffer.concat([e,t]))})}var h=i(285),c=i(286),u=i(288),f=i(289);e.protocol=3;var l=e.packets={open:0,close:1,ping:2,pong:3,message:4,upgrade:5,noop:6},p=f(l),d={type:"error",data:"parser error"};e.encodePacket=function(t,e,i,r){if("function"==typeof e&&(r=e,e=null),"function"==typeof i&&(r=i,i=null),Buffer.isBuffer(t.data))return n(t,e,r);if(t.data&&(t.data.buffer||t.data)instanceof ArrayBuffer)return t.data=o(t.data),n(t,e,r);var s=l[t.type];return void 0!==t.data&&(s+=i?h.encode(String(t.data),{strict:!1}):String(t.data)),r(""+s)},e.encodeBase64Packet=function(t,e){Buffer.isBuffer(t.data)||(t.data=o(t.data));var i="b"+l[t.type];return i+=t.data.toString("base64"),e(i)},e.decodePacket=function(t,i,n){if(void 0===t)return d;var r;if("string"==typeof t)return"b"===(r=t.charAt(0))?e.decodeBase64Packet(t.substr(1),i):n&&!1===(t=function(t){try{t=h.decode(t,{strict:!1})}catch(t){return!1}return t}(t))?d:Number(r)==r&&p[r]?t.length>1?{type:p[r],data:t.substring(1)}:{type:p[r]}:d;if("arraybuffer"===i){var s=new Uint8Array(t);return r=s[0],{type:p[r],data:s.buffer.slice(1)}}return t instanceof ArrayBuffer&&(t=o(t)),r=t[0],{type:p[r],data:t.slice(1)}},e.decodeBase64Packet=function(t,e){var i=p[t.charAt(0)],n=new Buffer(t.substr(1),"base64");if("arraybuffer"===e){for(var r=new Uint8Array(n.length),s=0;s<r.length;s++)r[s]=n[s];n=r.buffer}return{type:i,data:n}},e.encodePayload=function(t,i,n){return"function"==typeof i&&(n=i,i=null),i&&c(t)?e.encodePayloadAsBinary(t,n):t.length?void r(t,function(t,n){e.encodePacket(t,i,!1,function(t){n(null,function(t){return t.length+":"+t}(t))})},function(t,e){return n(e.join(""))}):n("0:")},e.decodePayload=function(t,i,n){if("string"!=typeof t)return e.decodePayloadAsBinary(t,i,n);if("function"==typeof i&&(n=i,i=null),""===t)return n(d,0,1);for(var r,s,o,a="",h=0,c=t.length;h<c;h++){var u=t.charAt(h);if(":"===u){if(""===a||a!=(r=Number(a)))return n(d,0,1);if(s=t.substr(h+1,r),a!=s.length)return n(d,0,1);if(s.length){if(o=e.decodePacket(s,i,!1),d.type===o.type&&d.data===o.data)return n(d,0,1);if(!1===n(o,h+r,c))return}h+=r,a=""}else a+=u}return""!==a?n(d,0,1):void 0},e.encodePayloadAsBinary=function(t,e){if(!t.length)return e(new Buffer(0));r(t,a,function(t,i){return e(Buffer.concat(i))})},e.decodePayloadAsBinary=function(t,i,n){"function"==typeof i&&(n=i,i=null);for(var r,o=t,a=[];o.length>0;){var h="",c=0===o[0];for(r=1;255!==o[r];r++){if(h.length>310)return n(d,0,1);h+=""+o[r]}o=o.slice(h.length+1);var u=parseInt(h,10),f=o.slice(1,u+1);c&&(f=s(f)),a.push(f),o=o.slice(u+1)}var l=a.length;for(r=0;r<l;r++){var p=a[r];n(e.decodePacket(p,i,!0),r,l)}}},function(t,e,i){(function(t){var n;!function(r){function s(t){for(var e,i,n=[],r=0,s=t.length;r<s;)(e=t.charCodeAt(r++))>=55296&&e<=56319&&r<s?56320==(64512&(i=t.charCodeAt(r++)))?n.push(((1023&e)<<10)+(1023&i)+65536):(n.push(e),r--):n.push(e);return n}function o(t,e){if(t>=55296&&t<=57343){if(e)throw Error("Lone surrogate U+"+t.toString(16).toUpperCase()+" is not a scalar value");return!1}return!0}function a(t,e){return g(t>>e&63|128)}function h(t,e){if(0==(4294967168&t))return g(t);var i="";return 0==(4294965248&t)?i=g(t>>6&31|192):0==(4294901760&t)?(o(t,e)||(t=65533),i=g(t>>12&15|224),i+=a(t,6)):0==(4292870144&t)&&(i=g(t>>18&7|240),i+=a(t,12),i+=a(t,6)),i+=g(63&t|128)}function c(){if(m>=d)throw Error("Invalid byte index");var t=255&p[m];if(m++,128==(192&t))return 63&t;throw Error("Invalid continuation byte")}function u(t){var e,i,n,r,s;if(m>d)throw Error("Invalid byte index");if(m==d)return!1;if(e=255&p[m],m++,0==(128&e))return e;if(192==(224&e)){if(i=c(),(s=(31&e)<<6|i)>=128)return s;throw Error("Invalid continuation byte")}if(224==(240&e)){if(i=c(),n=c(),(s=(15&e)<<12|i<<6|n)>=2048)return o(s,t)?s:65533;throw Error("Invalid continuation byte")}if(240==(248&e)&&(i=c(),n=c(),r=c(),(s=(7&e)<<18|i<<12|n<<6|r)>=65536&&s<=1114111))return s;throw Error("Invalid UTF-8 detected")}var f="object"==typeof e&&e,l=("object"==typeof t&&t&&t.exports,"object"==typeof global&&global);var p,d,m,g=String.fromCharCode,y={version:"2.1.2",encode:function(t,e){for(var i=!1!==(e=e||{}).strict,n=s(t),r=n.length,o=-1,a="";++o<r;)a+=h(n[o],i);return a},decode:function(t,e){var i=!1!==(e=e||{}).strict;p=s(t),d=p.length,m=0;for(var n,r=[];!1!==(n=u(i));)r.push(n);return function(t){for(var e,i=t.length,n=-1,r="";++n<i;)(e=t[n])>65535&&(r+=g((e-=65536)>>>10&1023|55296),e=56320|1023&e),r+=g(e);return r}(r)}};void 0===(n=function(){return y}.call(e,i,e,t))||(t.exports=n)}()}).call(e,i(64)(t))},function(t,e,i){function n(t){if(!t||"object"!=typeof t)return!1;if(r(t)){for(var e=0,i=t.length;e<i;e++)if(n(t[e]))return!0;return!1}if("function"==typeof global.Buffer&&global.Buffer.isBuffer&&global.Buffer.isBuffer(t)||"function"==typeof global.ArrayBuffer&&t instanceof ArrayBuffer||o&&t instanceof Blob||a&&t instanceof File)return!0;if(t.toJSON&&"function"==typeof t.toJSON&&1===arguments.length)return n(t.toJSON(),!0);for(var s in t)if(Object.prototype.hasOwnProperty.call(t,s)&&n(t[s]))return!0;return!1}var r=i(287),s=Object.prototype.toString,o="function"==typeof global.Blob||"[object BlobConstructor]"===s.call(global.Blob),a="function"==typeof global.File||"[object FileConstructor]"===s.call(global.File);t.exports=n},function(t,e){var i={}.toString;t.exports=Array.isArray||function(t){return"[object Array]"==i.call(t)}},function(t,e){t.exports=function(t,e,i){function n(t,s){if(n.count<=0)throw new Error("after called too many times");--n.count,t?(r=!0,e(t),e=i):0!==n.count||r||e(null,s)}var r=!1;return i=i||function(){},n.count=t,0===t?e():n}},function(t,e){t.exports=Object.keys||function(t){var e=[],i=Object.prototype.hasOwnProperty;for(var n in t)i.call(t,n)&&e.push(n);return e}},function(t,e,i){function n(){}function r(t){s.call(this,t),this.query=this.query||{},a||(global.___eio||(global.___eio=[]),a=global.___eio),this.index=a.length;var e=this;a.push(function(t){e.onData(t)}),this.query.j=this.index,global.document&&global.addEventListener&&global.addEventListener("beforeunload",function(){e.script&&(e.script.onerror=n)},!1)}var s=i(220),o=i(113);t.exports=r;var a,h=/\n/g,c=/\\n/g;o(r,s),r.prototype.supportsBinary=!1,r.prototype.doClose=function(){this.script&&(this.script.parentNode.removeChild(this.script),this.script=null),this.form&&(this.form.parentNode.removeChild(this.form),this.form=null,this.iframe=null),s.prototype.doClose.call(this)},r.prototype.doPoll=function(){var t=this,e=document.createElement("script");this.script&&(this.script.parentNode.removeChild(this.script),this.script=null),e.async=!0,e.src=this.uri(),e.onerror=function(e){t.onError("jsonp poll error",e)};var i=document.getElementsByTagName("script")[0];i?i.parentNode.insertBefore(e,i):(document.head||document.body).appendChild(e),this.script=e;"undefined"!=typeof navigator&&/gecko/i.test(navigator.userAgent)&&setTimeout(function(){var t=document.createElement("iframe");document.body.appendChild(t),document.body.removeChild(t)},100)},r.prototype.doWrite=function(t,e){function i(){n(),e()}function n(){if(r.iframe)try{r.form.removeChild(r.iframe)}catch(t){r.onError("jsonp polling iframe removal error",t)}try{var t='<iframe src="javascript:0" name="'+r.iframeId+'">';s=document.createElement(t)}catch(t){(s=document.createElement("iframe")).name=r.iframeId,s.src="javascript:0"}s.id=r.iframeId,r.form.appendChild(s),r.iframe=s}var r=this;if(!this.form){var s,o=document.createElement("form"),a=document.createElement("textarea"),u=this.iframeId="eio_iframe_"+this.index;o.className="socketio",o.style.position="absolute",o.style.top="-1000px",o.style.left="-1000px",o.target=u,o.method="POST",o.setAttribute("accept-charset","utf-8"),a.name="d",o.appendChild(a),document.body.appendChild(o),this.form=o,this.area=a}this.form.action=this.uri(),n(),t=t.replace(c,"\\\n"),this.area.value=t.replace(h,"\\n");try{this.form.submit()}catch(t){}this.iframe.attachEvent?this.iframe.onreadystatechange=function(){"complete"===r.iframe.readyState&&i()}:this.iframe.onload=i}},function(t,e,i){function n(t){t&&t.forceBase64&&(this.supportsBinary=!1),this.perMessageDeflate=t.perMessageDeflate,this.usingBrowserWebSocket=f&&!t.forceNode,this.protocols=t.protocols,this.usingBrowserWebSocket||(l=r),s.call(this,t)}var r,s=i(171),o=i(77),a=i(112),h=i(113),c=i(221),u=i(45)("engine.io-client:websocket"),f=global.WebSocket||global.MozWebSocket;if("undefined"==typeof window)try{r=i(292)}catch(t){}var l=f;l||"undefined"!=typeof window||(l=r),t.exports=n,h(n,s),n.prototype.name="websocket",n.prototype.supportsBinary=!0,n.prototype.doOpen=function(){if(this.check()){var t=this.uri(),e=this.protocols,i={agent:this.agent,perMessageDeflate:this.perMessageDeflate};i.pfx=this.pfx,i.key=this.key,i.passphrase=this.passphrase,i.cert=this.cert,i.ca=this.ca,i.ciphers=this.ciphers,i.rejectUnauthorized=this.rejectUnauthorized,this.extraHeaders&&(i.headers=this.extraHeaders),this.localAddress&&(i.localAddress=this.localAddress);try{this.ws=this.usingBrowserWebSocket?e?new l(t,e):new l(t):new l(t,e,i)}catch(t){return this.emit("error",t)}void 0===this.ws.binaryType&&(this.supportsBinary=!1),this.ws.supports&&this.ws.supports.binary?(this.supportsBinary=!0,this.ws.binaryType="nodebuffer"):this.ws.binaryType="arraybuffer",this.addEventListeners()}},n.prototype.addEventListeners=function(){var t=this;this.ws.onopen=function(){t.onOpen()},this.ws.onclose=function(){t.onClose()},this.ws.onmessage=function(e){t.onData(e.data)},this.ws.onerror=function(e){t.onError("websocket error",e)}},n.prototype.write=function(t){var e=this;this.writable=!1;for(var i=t.length,n=0,r=i;n<r;n++)!function(t){o.encodePacket(t,e.supportsBinary,function(n){if(!e.usingBrowserWebSocket){var r={};if(t.options&&(r.compress=t.options.compress),e.perMessageDeflate){("string"==typeof n?global.Buffer.byteLength(n):n.length)<e.perMessageDeflate.threshold&&(r.compress=!1)}}try{e.usingBrowserWebSocket?e.ws.send(n):e.ws.send(n,r)}catch(t){u("websocket closed before onclose event")}--i||(e.emit("flush"),setTimeout(function(){e.writable=!0,e.emit("drain")},0))})}(t[n])},n.prototype.onClose=function(){s.prototype.onClose.call(this)},n.prototype.doClose=function(){void 0!==this.ws&&this.ws.close()},n.prototype.uri=function(){var t=this.query||{},e=this.secure?"wss":"ws",i="";this.port&&("wss"===e&&443!==Number(this.port)||"ws"===e&&80!==Number(this.port))&&(i=":"+this.port),this.timestampRequests&&(t[this.timestampParam]=c()),this.supportsBinary||(t.b64=1),(t=a.encode(t)).length&&(t="?"+t);return e+"://"+(-1!==this.hostname.indexOf(":")?"["+this.hostname+"]":this.hostname)+i+this.path+t},n.prototype.check=function(){return!(!l||"__initialize"in l&&this.name===n.prototype.name)}},function(t,e,i){"use strict";const n=i(222);n.Server=i(296),n.Receiver=i(225),n.Sender=i(227),t.exports=n},function(t,e){t.exports=require("zlib")},function(t,e,i){"use strict";class n{constructor(t,e){this.target=e,this.type=t}}class r extends n{constructor(t,e,i){super("message",i),this.binary=e,this.data=t}}class s extends n{constructor(t,e,i){super("close",i),this.wasClean=void 0===t||1e3===t,this.reason=e,this.target=i,this.type="close",this.code=t}}class o extends n{constructor(t){super("open",t)}}const a={addEventListener(t,e){function i(t,i){e.call(this,new r(t,!!i.binary,this))}function n(t,i){e.call(this,new s(t,i,this))}function a(t){t.type="error",t.target=this,e.call(this,t)}function h(){e.call(this,new o(this))}"function"==typeof e&&("message"===t?(i._listener=e,this.on(t,i)):"close"===t?(n._listener=e,this.on(t,n)):"error"===t?(a._listener=e,this.on(t,a)):"open"===t?(h._listener=e,this.on(t,h)):this.on(t,e))},removeEventListener(t,e){const i=this.listeners(t);for(var n=0;n<i.length;n++)i[n]!==e&&i[n]._listener!==e||this.removeListener(t,i[n])}};t.exports=a},function(t,e,i){"use strict";try{const e=i(!function(){var t=new Error('Cannot find module "utf-8-validate"');throw t.code="MODULE_NOT_FOUND",t}());t.exports="object"==typeof e?e.Validation.isValidUTF8:e}catch(e){t.exports=(()=>!0)}},function(t,e,i){"use strict";function n(){this.destroy()}function r(t,e,i){t.writable&&(i=i||c.STATUS_CODES[e],t.write(`HTTP/1.1 ${e} ${c.STATUS_CODES[e]}\r\n`+"Connection: close\r\nContent-type: text/html\r\n"+`Content-Length: ${m.byteLength(i)}\r\n`+"\r\n"+i)),t.removeListener("error",n),t.destroy()}const s=i(78),o=i(10),a=i(24),h=i(223),c=i(75),u=i(73),f=i(114),l=i(224),p=i(173),d=i(222),m=s.Buffer;t.exports=class extends o{constructor(t,e){if(super(),null==(t=Object.assign({maxPayload:104857600,perMessageDeflate:!0,handleProtocols:null,clientTracking:!0,verifyClient:null,noServer:!1,backlog:null,server:null,host:null,path:null,port:null},t)).port&&!t.server&&!t.noServer)throw new TypeError("missing or invalid options");null!=t.port?(this._server=c.createServer((t,e)=>{const i=c.STATUS_CODES[426];e.writeHead(426,{"Content-Length":i.length,"Content-Type":"text/plain"}),e.end(i)}),this._server.allowHalfOpen=!1,this._server.listen(t.port,t.host,t.backlog,e)):t.server&&(this._server=t.server),this._server&&(this._ultron=new h(this._server),this._ultron.on("listening",()=>this.emit("listening")),this._ultron.on("error",t=>this.emit("error",t)),this._ultron.on("upgrade",(t,e,i)=>{this.handleUpgrade(t,e,i,e=>{this.emit(`connection${t.url}`,e),this.emit("connection",e)})})),t.clientTracking&&(this.clients=new Set),this.options=t,this.path=t.path}close(t){if(this.clients)for(const t of this.clients)t.terminate();const e=this._server;if(e&&(this._ultron.destroy(),this._ultron=this._server=null,null!=this.options.port))return e.close(t);t&&t()}shouldHandle(t){return!this.options.path||u.parse(t.url).pathname===this.options.path}handleUpgrade(t,e,i,s){e.on("error",n);const o=+t.headers["sec-websocket-version"];if("GET"!==t.method||"websocket"!==t.headers.upgrade.toLowerCase()||!t.headers["sec-websocket-key"]||8!==o&&13!==o||!this.shouldHandle(t))return r(e,400);var a=(t.headers["sec-websocket-protocol"]||"").split(/, */);if(this.options.handleProtocols){if(!1===(a=this.options.handleProtocols(a,t)))return r(e,401)}else a=a[0];if(this.options.verifyClient){const n={origin:t.headers[`${8===o?"sec-websocket-origin":"origin"}`],secure:!(!t.connection.authorized&&!t.connection.encrypted),req:t};if(2===this.options.verifyClient.length)return void this.options.verifyClient(n,(n,h,c)=>{if(!n)return r(e,h||401,c);this.completeUpgrade(a,o,t,e,i,s)});if(!this.options.verifyClient(n))return r(e,401)}this.completeUpgrade(a,o,t,e,i,s)}completeUpgrade(t,e,i,s,o,h){if(!s.readable||!s.writable)return s.destroy();const c=["HTTP/1.1 101 Switching Protocols","Upgrade: websocket","Connection: Upgrade",`Sec-WebSocket-Accept: ${a.createHash("sha1").update(i.headers["sec-websocket-key"]+p.GUID,"binary").digest("base64")}`];t&&c.push(`Sec-WebSocket-Protocol: ${t}`);const u=l.parse(i.headers["sec-websocket-extensions"]);var m;try{m=function(t,e){const i=t.perMessageDeflate,n={};if(i&&e[f.extensionName]){const r=new f(!0!==i?i:{},!0,t.maxPayload);r.accept(e[f.extensionName]),n[f.extensionName]=r}return n}(this.options,u)}catch(t){return r(s,400)}const g=Object.keys(m);if(g.length){const t=g.reduce((t,e)=>(t[e]=[m[e].params],t),{});c.push(`Sec-WebSocket-Extensions: ${l.format(t)}`)}this.emit("headers",c,i),s.write(c.concat("","").join("\r\n"));const y=new d([i,s,o],null,{maxPayload:this.options.maxPayload,protocolVersion:e,extensions:m,protocol:t});this.clients&&(this.clients.add(y),y.on("close",()=>this.clients.delete(y))),s.removeListener("error",n),h(y)}}},function(t,e){var i=/^[\],:{}\s]*$/,n=/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,r=/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,s=/(?:^|:|,)(?:\s*\[)+/g,o=/^\s+/,a=/\s+$/;t.exports=function(t){return"string"==typeof t&&t?(t=t.replace(o,"").replace(a,""),global.JSON&&JSON.parse?JSON.parse(t):i.test(t.replace(n,"@").replace(r,"]").replace(s,""))?new Function("return "+t)():void 0):null}},function(t,e){t.exports=function(t,e){for(var i=[],n=(e=e||0)||0;n<t.length;n++)i[n-e]=t[n];return i}},function(t,e){function i(t){t=t||{},this.ms=t.min||100,this.max=t.max||1e4,this.factor=t.factor||2,this.jitter=t.jitter>0&&t.jitter<=1?t.jitter:0,this.attempts=0}t.exports=i,i.prototype.duration=function(){var t=this.ms*Math.pow(this.factor,this.attempts++);if(this.jitter){var e=Math.random(),i=Math.floor(e*this.jitter*t);t=0==(1&Math.floor(10*e))?t-i:t+i}return 0|Math.min(t,this.max)},i.prototype.reset=function(){this.attempts=0},i.prototype.setMin=function(t){this.ms=t},i.prototype.setMax=function(t){this.max=t},i.prototype.setJitter=function(t){this.jitter=t}},function(t,e,i){"use strict";function n(t){if(!(this instanceof n))return new n(t);s.call(this),t||(t={}),"string"==typeof t&&(t={uri:t}),this.options=t,this.network=o.get(t.network),this.client=new a(t),this.uri=t.uri,this.id=null,this.token=null,t.id&&(this.id=t.id),t.token&&(this.token=t.token,Buffer.isBuffer(this.token)&&(this.token=this.token.toString("hex")),this.client.token=this.token),this._init()}const r=i(0),s=i(10),o=i(6),a=i(210);Object.setPrototypeOf(n.prototype,s.prototype),n.prototype._init=function(){this.client.on("tx",t=>{this.emit("tx",t)}),this.client.on("confirmed",t=>{this.emit("confirmed",t)}),this.client.on("unconfirmed",(t,e)=>{this.emit("unconfirmed",e)}),this.client.on("conflict",(t,e)=>{this.emit("conflict",e)}),this.client.on("balance",t=>{this.emit("balance",t)}),this.client.on("address",t=>{this.emit("address",t)}),this.client.on("error",t=>{this.emit("error",t)})},n.prototype.open=async function(t){t&&(t.id&&(this.id=t.id),t.token&&(this.token=t.token,Buffer.isBuffer(this.token)&&(this.token=this.token.toString("hex")),this.client.token=this.token)),r(this.id,"No ID provided."),await this.client.open(),await this.client.sendWalletAuth(),await this.client.join(this.id,this.token)},n.prototype.create=async function(t){await this.client.open(),await this.client.sendWalletAuth();const e=await this.client.createWallet(t);return this.id=e.id,this.token=e.token,this.client.token=this.token,await this.client.join(this.id,this.token),e},n.prototype.close=function(){return this.client.close()},n.prototype.onDisconnect=function(){return this.client.onDisconnect()},n.prototype.getHistory=function(t){return this.client.getHistory(this.id,t)},n.prototype.getCoins=function(t){return this.client.getCoins(this.id,t)},n.prototype.getPending=function(t){return this.client.getPending(this.id,t)},n.prototype.getBalance=function(t){return this.client.getBalance(this.id,t)},n.prototype.getLast=function(t,e){return this.client.getLast(this.id,t,e)},n.prototype.getRange=function(t,e){return this.client.getRange(this.id,t,e)},n.prototype.getTX=function(t){return this.client.getWalletTX(this.id,t)},n.prototype.getBlocks=function(){return this.client.getWalletBlocks(this.id)},n.prototype.getBlock=function(t){return this.client.getWalletBlock(this.id,t)},n.prototype.getCoin=function(t,e,i){return this.client.getWalletCoin(this.id,t,e,i)},n.prototype.zap=function(t,e){return this.client.zapWallet(this.id,t,e)},n.prototype.createTX=function(t,e){return this.client.createTX(this.id,t,e)},n.prototype.send=function(t){return this.client.send(this.id,t)},n.prototype.sign=function(t,e){return this.client.sign(this.id,t,e)},n.prototype.getInfo=function(){return this.client.getWallet(this.id)},n.prototype.getAccounts=function(){return this.client.getAccounts(this.id)},n.prototype.getMaster=function(){return this.client.getMaster(this.id)},n.prototype.getAccount=function(t){return this.client.getAccount(this.id,t)},n.prototype.createAccount=function(t,e){return this.client.createAccount(this.id,t,e)},n.prototype.createAddress=function(t){return this.client.createAddress(this.id,t)},n.prototype.createChange=function(t){return this.client.createChange(this.id,t)},n.prototype.createNested=function(t){return this.client.createNested(this.id,t)},n.prototype.setPassphrase=function(t,e){return this.client.setPassphrase(this.id,t,e)},n.prototype.retoken=async function(t){const e=await this.client.retoken(this.id,t);return this.token=e,this.client.token=e,e},n.prototype.importPrivate=function(t,e){return this.client.importPrivate(this.id,t,e)},n.prototype.importPublic=function(t,e){return this.client.importPublic(this.id,t,e)},n.prototype.importAddress=function(t,e){return this.client.importAddress(this.id,t,e)},n.prototype.lockCoin=function(t,e){return this.client.lockCoin(this.id,t,e)},n.prototype.unlockCoin=function(t,e){return this.client.unlockCoin(this.id,t,e)},n.prototype.getLocked=function(){return this.client.getLocked(this.id)},n.prototype.lock=function(){return this.client.lock(this.id)},n.prototype.unlock=function(t,e){return this.client.unlock(this.id,t,e)},n.prototype.getKey=function(t){return this.client.getKey(this.id,t)},n.prototype.getWIF=function(t,e){return this.client.getWIF(this.id,t,e)},n.prototype.addSharedKey=function(t,e){return this.client.addSharedKey(this.id,t,e)},n.prototype.removeSharedKey=function(t,e){return this.client.removeSharedKey(this.id,t,e)},n.prototype.resend=function(){return this.client.resendWallet(this.id)},t.exports=n},function(t,e,i){"use strict";e.Fees=i(117),e.layout=i(232),e.MempoolEntry=i(177),e.Mempool=i(178)},function(t,e,i){"use strict";e.common=i(180),e.CPUMiner=i(233),e.mine=i(97),e.Miner=i(181),e.BlockTemplate=i(182)},function(t,e,i){"use strict";e.BIP150=i(119),e.BIP151=i(120),e.bip152=i(98),e.common=i(60),e.dns=i(99),e.external=i(235),e.Framer=i(236),e.HostList=i(237),e.packets=i(61),e.Parser=i(238),e.Peer=i(184),e.Pool=i(122),e.socks=i(183),e.tcp=i(121),e.UPNP=i(239)},function(t,e){t.exports=require("dns")},function(t,e,i){"use strict";const n=i(306),r=i(307);e.get=function(t){switch(t){case"mainnet":return n;case"testnet":return r;default:return[]}}},function(t,e,i){"use strict";t.exports=[""]},function(t,e,i){"use strict";t.exports=[]},function(t,e){t.exports=require("dgram")},function(t,e,i){"use strict";e.Config=i(123),e.FullNode=i(240),e.Logger=i(34),e.Node=i(185),e.SPVNode=i(241)},function(t,e,i){"use strict";function n(t){if(!(this instanceof n))return new n(t);r.call(this),function(){if(h)return;h=!0,function(t){const e=()=>{process.exit(129)},i=()=>{process.exit(130)},n=()=>{process.exit(143)},r=t=>{t&&t.stack?console.error(String(t.stack)):console.error(String(t)),process.exit(1)};process.once("exit",t),0===process.listenerCount("SIGHUP")&&process.once("SIGHUP",e),0===process.listenerCount("SIGINT")&&process.once("SIGINT",i),0===process.listenerCount("SIGTERM")&&process.once("SIGTERM",n),0===process.listenerCount("uncaughtException")&&process.once("uncaughtException",r),process.on("newListener",t=>{switch(t){case"SIGHUP":process.removeListener(t,e);break;case"SIGINT":process.removeListener(t,i);break;case"SIGTERM":process.removeListener(t,n);break;case"uncaughtException":process.removeListener(t,r)}})}(()=>{for(const t of a)t.destroy()})}(),a.add(this),this.init(t)}const r=i(10),s=i(33),o=i(219),a=new Set;let h=!1;Object.setPrototypeOf(n.prototype,r.prototype),n.hasSupport=function(){return!0},n.prototype.init=function(t){const e=process.argv[0],i=s.resolve(__dirname,t),n={stdio:"pipe",env:process.versions.electron?Object.assign({},process.env,{ELECTRON_RUN_AS_NODE:"1"}):process.env};this.child=o.spawn(e,[i],n),this.child.unref(),this.child.stdin.unref(),this.child.stdout.unref(),this.child.stderr.unref(),this.child.on("error",t=>{this.emit("error",t)}),this.child.once("exit",(t,e)=>{a.delete(this),this.emit("exit",null==t?-1:t,e)}),this.child.stdin.on("error",t=>{this.emit("error",t)}),this.child.stdout.on("error",t=>{this.emit("error",t)}),this.child.stderr.on("error",t=>{this.emit("error",t)}),this.child.stdout.on("data",t=>{this.emit("data",t)})},n.prototype.write=function(t){return this.child.stdin.write(t)},n.prototype.destroy=function(){this.child.kill("SIGTERM")},t.exports=n},function(t,e,i){"use strict";e.AbstractBlock=i(69),e.Address=i(11),e.Block=i(51),e.Coin=i(43),e.Headers=i(37),e.Input=i(41),e.InvItem=i(36),e.KeyRing=i(47),e.MemBlock=i(234),e.MerkleBlock=i(71),e.MTX=i(48),e.NetAddress=i(79),e.Outpoint=i(21),e.Output=i(13),e.TX=i(15),e.TXMeta=i(162)},function(t,e,i){"use strict";e.consensus=i(7),e.errors=i(107),e.Network=i(6),e.networks=i(83),e.policy=i(19),e.timedata=i(84)},function(t,e,i){"use strict";e.common=i(27),e.Opcode=i(90),e.Program=i(85),e.Script=i(8),e.ScriptError=i(35),e.ScriptNum=i(32),e.sigcache=i(242),e.Stack=i(40),e.Witness=i(56)},function(t,e,i){"use strict";e.Stratum=i(243)},function(t,e){t.exports=require("wmcc-mutex")},function(t,e){t.exports=require("wmcc-tcp")},function(t,e){t.exports=require("wmcc-inet")},function(t,e){t.exports=require("wmcc-logger")},function(t,e){t.exports=require("wmcc-file")},function(t,e,i){"use strict";function n(){if(!(this instanceof n))return new n;this.s=new Array(8),this.w=new Array(64),this.block=Buffer.allocUnsafe(64),this.bytes=0}function r(){if(!(this instanceof r))return new r;this.inner=new n,this.outer=new n}function s(t,e,i){t[i]=e>>>24,t[i+1]=e>>16&255,t[i+2]=e>>8&255,t[i+3]=255&e}const o=Buffer.allocUnsafe(8),a=Buffer.allocUnsafe(64),h=Buffer.allocUnsafe(64),c=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298];h.fill(0),h[0]=128,n.prototype.init=function(){this.s[0]=1779033703,this.s[1]=3144134277,this.s[2]=1013904242,this.s[3]=2773480762,this.s[4]=1359893119,this.s[5]=2600822924,this.s[6]=528734635,this.s[7]=1541459225,this.bytes=0},n.prototype.update=function(t){return this._update(t,t.length)},n.prototype.finish=function(){return this._finish(Buffer.allocUnsafe(32))},n.prototype._update=function(t,e){let i=63&this.bytes,n=0;if(this.bytes+=e,i>0){let r=64-i;r>e&&(r=e);for(let e=0;e<r;e++)this.block[i+e]=t[e];if(i+=r,e-=r,n+=r,i<64)return;this.transform(this.block,0)}for(;e>=64;)this.transform(t,n),n+=64,e-=64;for(let i=0;i<e;i++)this.block[i]=t[n+i]},n.prototype._finish=function(t){s(o,this.bytes>>>29,0),s(o,this.bytes<<3,4),this._update(h,1+(119-this.bytes%64)%64),this._update(o,8);for(let e=0;e<8;e++)s(t,this.s[e],4*e),this.s[e]=0;return t},n.prototype.transform=function(t,e){const i=this.w;let n=this.s[0],r=this.s[1],s=this.s[2],o=this.s[3],a=this.s[4],h=this.s[5],u=this.s[6],f=this.s[7],l=0;for(;l<16;l++)i[l]=function(t,e){return 16777216*(255&t[e])+((255&t[e+1])<<16)|(255&t[e+2])<<8|255&t[e+3]}(t,e+4*l);for(;l<64;l++)i[l]=function(t){return(t>>>17|t<<15)^(t>>>19|t<<13)^t>>>10}(i[l-2])+i[l-7]+function(t){return(t>>>7|t<<25)^(t>>>18|t<<14)^t>>>3}(i[l-15])+i[l-16];for(l=0;l<64;l++){let t=f+function(t){return(t>>>6|t<<26)^(t>>>11|t<<21)^(t>>>25|t<<7)}(a);t+=function(t,e,i){return i^t&(e^i)}(a,h,u),t+=c[l]+i[l];let e=function(t){return(t>>>2|t<<30)^(t>>>13|t<<19)^(t>>>22|t<<10)}(n);e+=function(t,e,i){return t&e|i&(t|e)}(n,r,s),f=u,u=h,h=a,a=o+t,o=s,s=r,r=n,n=t+e}this.s[0]+=n,this.s[1]+=r,this.s[2]+=s,this.s[3]+=o,this.s[4]+=a,this.s[5]+=h,this.s[6]+=u,this.s[7]+=f,this.s[0]>>>=0,this.s[1]>>>=0,this.s[2]>>>=0,this.s[3]>>>=0,this.s[4]>>>=0,this.s[5]>>>=0,this.s[6]>>>=0,this.s[7]>>>=0},r.prototype.init=function(t){const e=a;t.length>64?(this.inner.init(),this.inner.update(t),this.inner._finish(e),e.fill(0,32,64)):(t.copy(e,0),e.fill(0,t.length,64));for(let t=0;t<e.length;t++)e[t]^=54;this.inner.init(),this.inner.update(e);for(let t=0;t<e.length;t++)e[t]^=106;this.outer.init(),this.outer.update(e)},r.prototype.update=function(t){this.inner.update(t)},r.prototype.finish=function(){return this.outer.update(this.inner.finish()),this.outer.finish()};const u=new n,f=new r;(e=n).SHA256=n,e.SHA256Hmac=r,e.digest=function(t){return u.init(),u.update(t),u.finish()},e.hmac=function(t,e){return f.init(e),f.update(t),f.finish()},e.hash256=function(t){const e=Buffer.allocUnsafe(32);return u.init(),u.update(t),u._finish(e),u.init(),u.update(e),u._finish(e),e},t.exports=e},function(t,e,i){"use strict";e.ASN1=i(192),e.AsyncObject=i(30),e.base32=i(175),e.base58=i(25),e.bech32=i(100),e.Bloom=i(42),e.co=i(16),e.encoding=i(3),e.enforce=i(322),e.fs=i(59),e.GCSFilter=i(323),e.Heap=i(179),e.Int64=i(49),e.IP=i(46),e.List=i(94),e.Lock=i(23),e.LRU=i(57),e.MappedLock=i(186),e.murmur3=i(68),e.nfkd=i(208),e.PEM=i(101),e.ProtoWriter=i(82),e.ProtoReader=i(81),e.RBT=i(199),e.BufferReader=i(2),e.RollingFilter=i(118),e.StaticWriter=i(4),e.util=i(1),e.Validator=i(74),e.BufferWriter=i(63)},function(t,e,i){"use strict";function n(t,e,i,s){t||(s||(s=n),e&&!i&&r(e,s),e||(e="value"),r(`'${e}' must be a(n) ${i}.`,s))}function r(t,e){const i=new TypeError(t);throw Error.captureStackTrace&&e&&Error.captureStackTrace(i,e),i}const s=i(1);n.none=function t(e,i){n(null==e,i,"object",t)},n.nul=function t(e,i){n(null===e,i,"object",t)},n.undef=function t(e,i){n(void 0===e,i,"object",t)},n.str=function t(e,i){n("string"==typeof e,i,"string",t)},n.bool=function t(e,i){n("boolean"==typeof e,i,"boolean",t)},n.num=function t(e,i){n(s.isNumber(e),i,"number",t)},n.obj=function t(e,i){n(e&&"object"==typeof e&&!Array.isArray(e),i,"object",t)},n.array=function t(e,i){n(Array.isArray(e),i,"object",t)},n.func=function t(e,i){n("function"==typeof e,i,"function",t)},n.error=function t(e,i){n(e instanceof Error,i,"object",t)},n.regexp=function t(e,i){n(e&&"function"==typeof e.exec,i,"object",t)},n.buf=function t(e,i){n(Buffer.isBuffer(e),i,"buffer",t)},n.len=function t(e,i,n){("string"!=typeof e&&!e||e.length!==i)&&(n||(n="value"),r(`'${n}' must have a length of ${i}.`,t))},n.instance=function t(e,i,n){e instanceof i||(n||(n="value"),r(`'${n}' must be an instance of ${i.name}.`,t))},n.uint=function t(e,i){n(s.isUInt(e),i,"uint",t)},n.int=function t(e,i){n(s.isInt(e),i,"int",t)},n.u8=function t(e,i){n(s.isU8(e),i,"uint8",t)},n.u16=function t(e,i){n(s.isU16(e),i,"uint16",t)},n.u32=function t(e,i){n(s.isU32(e),i,"uint32",t)},n.u64=function t(e,i){n(s.isU64(e),i,"uint64",t)},n.i8=function t(e,i){n(s.isI8(e),i,"int8",t)},n.i16=function t(e,i){n(s.isI16(e),i,"int16",t)},n.i32=function t(e,i){n(s.isI32(e),i,"int32",t)},n.i64=function t(e,i){n(s.isI64(e),i,"int64",t)},n.ufloat=function t(e,i){n(s.isUfloat(e),i,"positive float",t)},n.float=function t(e,i){n(s.isFloat(e),i,"float",t)},n.ascii=function t(e,i){n(s.isAscii(e),i,"ascii string",t)},n.hex=function t(e,i){n(s.isHex(e),i,"hex string",t)},n.hex160=function t(e,i){n(s.isHex160(e),i,"160 bit hex string",t)},n.hex256=function t(e,i){n(s.isHex256(e),i,"256 bit hex string",t)},n.base58=function t(e,i){n(s.isBase58(e),i,"base58 string",t)},t.exports=n},function(t,e,i){"use strict";function n(){this.n=0,this.p=0,this.m=new u(0),this.data=p}function r(){this.stream=[],this.remain=0}function s(t){this.stream=t,this.pos=0,this.remain=8}function o(t,e){return t.cmp(e)<0?-1:1}function a(t,e){const[i,n]=l(t,e);return u.fromBits(i,n)}function h(t,e){for(const i of e.code)i.data&&0!==i.data.length&&t.push(i.data)}const c=i(0),{U64:u}=i(49),f=i(5),l=i(165),p=Buffer.alloc(0),d=new u(-1);n.prototype.hash=function(t){const e=f.hash256(this.data);return"hex"===t?e.toString("hex"):e},n.prototype.header=function(t){return f.root256(this.hash(),t)},n.prototype.match=function(t,e){const i=new s(this.data),n=a(e,t).imod(this.m);let r=new u(0);for(;r.lt(n);){const t=this.readU64(i);if(t===d)return!1;if(t.iadd(r),t.eq(n))return!0;r=t}return!1},n.prototype.matchAny=function(t,e){c(e.length>0);const i=new s(this.data),n=new u(0),r=[];for(const i of e){const e=a(i,t).imod(this.m);r.push(e)}r.sort(o);let h=r[0],f=1;for(;;){const t=n.cmp(h);if(0===t)break;if(t>0){if(f<r.length){h=r[f],f+=1;continue}return!1}const e=this.readU64(i);if(e===d)return!1;n.iadd(e)}return!0},n.prototype.readU64=function(t){try{return this._readU64(t)}catch(t){if("EOF"===t.message)return d;throw t}},n.prototype._readU64=function(t){const e=new u(0);for(;t.readBit();)e.iaddn(1);const i=t.readBits64(this.p);return e.ishln(this.p).ior(i)},n.prototype.toBytes=function(){return this.data},n.prototype.toNBytes=function(){const t=Buffer.allocUnsafe(4+this.data.length);return t.writeUInt32BE(this.n,0,!0),this.data.copy(t,4),t},n.prototype.toPBytes=function(){const t=Buffer.allocUnsafe(1+this.data.length);return t.writeUInt8(this.p,0,!0),this.data.copy(t,1),t},n.prototype.toNPBytes=function(){const t=Buffer.allocUnsafe(5+this.data.length);return t.writeUInt32BE(this.n,0,!0),t.writeUInt8(this.p,4,!0),this.data.copy(t,5),t},n.prototype.toRaw=function(){return c(20===this.p),this.toNBytes()},n.prototype.fromItems=function(t,e,i){c("number"==typeof t&&isFinite(t)),c(t>=0&&t<=32),c(Buffer.isBuffer(e)),c(16===e.length),c(Array.isArray(i)),c(i.length>0),c(i.length<=4294967295),this.n=i.length,this.p=t,this.m=u(this.n).ishln(this.p);const n=[];for(const t of i){c(Buffer.isBuffer(t));const i=a(t,e).imod(this.m);n.push(i)}n.sort(o);const s=new r;let h=new u(0);for(const t of n){const e=t.sub(h).imaskn(this.p),i=t.sub(h).isub(e).ishrn(this.p);for(h=t;!i.isZero();)s.writeBit(1),i.isubn(1);s.writeBit(0),s.writeBits64(e,this.p)}return this.data=s.render(),this},n.prototype.fromBytes=function(t,e,i){return c("number"==typeof t&&isFinite(t)),c("number"==typeof e&&isFinite(e)),c(e>=0&&e<=32),c(Buffer.isBuffer(i)),this.n=t,this.p=e,this.m=u(this.n).ishln(this.p),this.data=i,this},n.prototype.fromNBytes=function(t,e){c("number"==typeof t&&isFinite(t)),c(Buffer.isBuffer(e)),c(e.length>=4);const i=e.readUInt32BE(0,!0);return this.fromBytes(i,t,e.slice(4))},n.prototype.fromPBytes=function(t,e){c("number"==typeof t&&isFinite(t)),c(Buffer.isBuffer(e)),c(e.length>=1);const i=e.readUInt8(0,!0);return this.fromBytes(t,i,e.slice(1))},n.prototype.fromNPBytes=function(t){c(Buffer.isBuffer(t)),c(t.length>=5);const e=t.readUInt32BE(0,!0),i=t.readUInt8(4,!0);return this.fromBytes(e,i,t.slice(5))},n.prototype.fromRaw=function(t){return this.fromNBytes(20,t)},n.prototype.fromBlock=function(t){const e=t.hash().slice(0,16),i=[];for(let e=0;e<t.txs.length;e++){const n=t.txs[e];if(e>0)for(const t of n.inputs)i.push(t.prevout.toRaw());for(const t of n.outputs)h(i,t.script)}return this.fromItems(20,e,i)},n.prototype.fromExtended=function(t){const e=t.hash().slice(0,16),i=[];for(let e=0;e<t.txs.length;e++){const n=t.txs[e];if(i.push(n.hash()),e>0)for(const t of n.inputs)!function(t,e){for(const i of e.items)0!==i.length&&t.push(i)}(i,t.witness),h(i,t.script)}return this.fromItems(20,e,i)},n.fromItems=function(t,e,i){return(new n).fromItems(t,e,i)},n.fromBytes=function(t,e,i){return(new n).fromBytes(t,e,i)},n.fromNBytes=function(t,e){return(new n).fromNBytes(t,e)},n.fromPBytes=function(t,e){return(new n).fromPBytes(t,e)},n.fromNPBytes=function(t){return(new n).fromNPBytes(t)},n.fromRaw=function(t){return(new n).fromRaw(t)},n.fromBlock=function(t){return(new n).fromBlock(t)},n.fromExtended=function(t){return(new n).fromExtended(t)},r.prototype.writeBit=function(t){if(0===this.remain&&(this.stream.push(0),this.remain=8),t){const t=this.stream.length-1;this.stream[t]|=1<<this.remain-1}this.remain--},r.prototype.writeByte=function(t){0===this.remain&&(this.stream.push(0),this.remain=8);const e=this.stream.length-1;this.stream[e]|=t>>8-this.remain&255,this.stream.push(0),this.stream[e+1]=t<<this.remain&255},r.prototype.writeBits=function(t,e){for(c(e>=0),c(e<=32),t<<=32-e;e>=8;){const i=t>>>24;this.writeByte(i),t<<=8,e-=8}for(;e>0;){const i=t>>>31;this.writeBit(i),t<<=1,e-=1}},r.prototype.writeBits64=function(t,e){c(e>=0),c(e<=64),e>32?(this.writeBits(t.hi,e-32),this.writeBits(t.lo,32)):this.writeBits(t.lo,e)},r.prototype.render=function(){const t=Buffer.allocUnsafe(this.stream.length);for(let e=0;e<this.stream.length;e++)t[e]=this.stream[e];return t},s.prototype.readBit=function(){if(this.pos>=this.stream.length)throw new Error("EOF");if(0===this.remain){if(this.pos+=1,this.pos>=this.stream.length)throw new Error("EOF");this.remain=8}return this.remain-=1,this.stream[this.pos]>>this.remain&1},s.prototype.readByte=function(){if(this.pos>=this.stream.length)throw new Error("EOF");if(0===this.remain){if(this.pos+=1,this.pos>=this.stream.length)throw new Error("EOF");this.remain=8}if(8===this.remain){const t=this.stream[this.pos];return this.pos+=1,t}let t=this.stream[this.pos]&(1<<this.remain)-1;if(t<<=8-this.remain,this.pos+=1,this.pos>=this.stream.length)throw new Error("EOF");return t|=this.stream[this.pos]>>this.remain},s.prototype.readBits=function(t){c(t>=0),c(t<=32);let e=0;for(;t>=8;)e<<=8,e|=this.readByte(),t-=8;for(;t>0;)e<<=1,e|=this.readBit(),t-=1;return e},s.prototype.readBits64=function(t){c(t>=0),c(t<=64);const e=new u;return t>32?(e.hi=this.readBits(t-32),e.lo=this.readBits(32)):e.lo=this.readBits(t),e},t.exports=n},function(t,e,i){"use strict";e.Account=i(187),e.Client=i(244),e.common=i(62),e.HTTPServer=i(245),e.layout=i(188),e.MasterKey=i(246),e.NodeClient=i(247),e.Path=i(80),e.plugin=i(325),e.records=i(129),e.RPC=i(250),e.server=i(326),e.TXDB=i(249),e.WalletDB=i(130),e.Wallet=i(248),e.WalletKey=i(128)},function(t,e,i){"use strict";const n=i(130),r=i(247),s=e;s.id="walletdb",s.init=function(t){const e=t.config,i=new r(t),s=new n({network:t.network,logger:t.logger,workers:t.workers,client:i,prefix:e.prefix,db:e.str(["wallet-db","db"]),maxFiles:e.uint("wallet-max-files"),cacheSize:e.mb("wallet-cache-size"),witness:e.bool("wallet-witness"),checkpoints:e.bool("wallet-checkpoints"),startHeight:e.uint("wallet-start-height"),wipeNoReally:e.bool("wallet-wipe-no-really"),apiKey:e.str(["wallet-api-key","api-key"]),walletAuth:e.bool("wallet-auth"),noAuth:e.bool(["wallet-no-auth","no-auth"]),ssl:e.str("wallet-ssl"),host:e.str("wallet-host"),port:e.uint("wallet-port"),spv:t.spv,verify:t.spv,listen:!1});return t.http&&s.http&&s.http.attach(t.http),s.rpc.attach(t.rpc),s}},function(t,e,i){"use strict";const n=i(130),r=i(124),s=i(123),o=i(34),a=i(244);e.create=function(t){const e=new s("wmcc");let i=new o("debug");e.inject(t),e.load(t),t.config&&e.open("wallet.conf"),e.has("logger")&&(i=e.obj("logger"));const h=new a({network:e.network,uri:e.str("node-uri"),apiKey:e.str("node-api-key")});i.set({filename:e.bool("log-file")?e.location("wallet.log"):null,level:e.str("log-level"),console:e.bool("log-console"),shrink:e.bool("log-shrink")});const c=new r({enabled:e.str("workers-enabled"),size:e.uint("workers-size"),timeout:e.uint("workers-timeout")}),u=new n({network:e.network,logger:i,workers:c,client:h,prefix:e.prefix,db:e.str("db"),maxFiles:e.uint("max-files"),cacheSize:e.mb("cache-size"),witness:e.bool("witness"),checkpoints:e.bool("checkpoints"),startHeight:e.uint("start-height"),wipeNoReally:e.bool("wipe-no-really"),apiKey:e.str("api-key"),walletAuth:e.bool("auth"),noAuth:e.bool("no-auth"),ssl:e.str("ssl"),host:e.str("host"),port:e.uint("port"),spv:e.bool("spv"),verify:e.bool("spv"),listen:!0});return u.on("error",()=>{}),c.on("spawn",t=>{i.info("Spawning worker process: %d.",t.id)}),c.on("exit",(t,e)=>{i.warning("Worker %d exited: %s.",e.id,t)}),c.on("log",(t,e)=>{i.debug("Worker %d says:",e.id),i.debug(t)}),c.on("error",(t,e)=>{e?i.error("Worker %d error: %s",e.id,t.message):u.emit("error",t)}),u}},function(t,e,i){"use strict";e.Framer=i(127),e.jobs=i(125),e.packets=i(53),e.Parser=i(126),e.WorkerPool=i(124)}]);